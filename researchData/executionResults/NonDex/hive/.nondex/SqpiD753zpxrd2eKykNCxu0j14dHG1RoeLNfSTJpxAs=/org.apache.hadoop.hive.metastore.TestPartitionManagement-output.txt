DEBUG StatusLogger Using ShutdownCallbackRegistry class org.apache.logging.log4j.core.util.DefaultShutdownCallbackRegistry
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
DEBUG StatusLogger Took 0,093357 seconds to load 240 plugins from sun.misc.Launcher$AppClassLoader@330bedb4
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger Starting LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@515aebb0]...
DEBUG StatusLogger Reconfiguration started for context[name=330bedb4] at URI null (org.apache.logging.log4j.core.LoggerContext@515aebb0) with optional ClassLoader: null
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
DEBUG StatusLogger PluginManager 'ConfigurationFactory' found 6 plugins
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
DEBUG StatusLogger Missing dependencies for Yaml support, ConfigurationFactory org.apache.logging.log4j.core.config.yaml.YamlConfigurationFactory is inactive
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
DEBUG StatusLogger Using configurationFactory org.apache.logging.log4j.core.config.ConfigurationFactory$Factory@1bd4fdd
TRACE StatusLogger Trying to find [log4j2-test330bedb4.properties] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.properties] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yaml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yaml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yaml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yaml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test330bedb4.json] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.json] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.json] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.json] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test330bedb4.jsn] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.jsn] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.jsn] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.jsn] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test330bedb4.xml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.xml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test.properties] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.properties] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test.yml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test.yml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.yml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.yml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test.yaml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test.yaml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.yaml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.yaml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test.json] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test.json] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.json] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.json] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test.jsn] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test.jsn] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.jsn] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.jsn] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test.xml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.xml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2330bedb4.properties] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2330bedb4.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.properties] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2330bedb4.yml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2330bedb4.yml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.yml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.yml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2330bedb4.yaml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2330bedb4.yaml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.yaml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.yaml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2330bedb4.json] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2330bedb4.json] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.json] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.json] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2330bedb4.jsn] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2330bedb4.jsn] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.jsn] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.jsn] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2330bedb4.xml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2330bedb4.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.xml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2.properties] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
DEBUG StatusLogger Apache Log4j Core 2.13.2 initializing configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@765d7657
DEBUG StatusLogger Installed 1 script engine
DEBUG StatusLogger Oracle Nashorn version: 1.8.0_402, language: ECMAScript, threading: Not Thread Safe, compile: true, names: [nashorn, Nashorn, js, JS, JavaScript, javascript, ECMAScript, ecmascript], factory class: jdk.nashorn.api.scripting.NashornScriptEngineFactory
DEBUG StatusLogger PluginManager 'Core' found 124 plugins
DEBUG StatusLogger PluginManager 'Level' found 0 plugins
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
TRACE StatusLogger TypeConverterRegistry initializing.
DEBUG StatusLogger PluginManager 'TypeConverter' found 26 plugins
DEBUG StatusLogger createProperty(name="filename", value="logs")
DEBUG StatusLogger Building Plugin[name=properties, class=org.apache.logging.log4j.core.config.PropertiesPlugin].
DEBUG StatusLogger configureSubstitutor(={filename=logs}, Configuration(PropertiesConfig))
DEBUG StatusLogger PluginManager 'Lookup' found 16 plugins
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="STDOUT", level="null", Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="CAPTURED", level="null", Filter=null)
DEBUG StatusLogger Building Plugin[name=root, class=org.apache.logging.log4j.core.config.LoggerConfig$RootLogger].
DEBUG StatusLogger createLogger(additivity="null", level="DEBUG", includeLocation="null", ={STDOUT, CAPTURED}, ={}, Configuration(PropertiesConfig), Filter=null)
DEBUG StatusLogger Building Plugin[name=loggers, class=org.apache.logging.log4j.core.config.LoggersPlugin].
DEBUG StatusLogger createLoggers(={root})
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(Configuration(PropertiesConfig), charset="null", PatternSelector=null, footer="null", Replace=null, pattern="[%-5level] %d{yyyy-MM-dd HH:mm:ss.SSS} [%t] %c{1} - %msg%n", header="null", disableAnsi="null", noConsoleNoAnsi="null", alwaysWriteExceptions="null")
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.ConsoleAppender].
DEBUG StatusLogger ConsoleAppender$Builder(follow="null", direct="null", target="null", bufferSize="null", bufferedIo="null", immediateFlush="null", name="STDOUT", ignoreExceptions="null", Configuration(PropertiesConfig), PatternLayout([%-5level] %d{yyyy-MM-dd HH:mm:ss.SSS} [%t] %c{1} - %msg%n), ={}, Filter=null)
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_OUT.false.false
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.hadoop.hive.metastore.testutils.CapturingLogAppender].
DEBUG StatusLogger createAppender(name="CAPTURED")
DEBUG StatusLogger Building Plugin[name=appenders, class=org.apache.logging.log4j.core.config.AppendersPlugin].
DEBUG StatusLogger createAppenders(={STDOUT, CAPTURED})
DEBUG StatusLogger Configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@765d7657 initialized
DEBUG StatusLogger Starting configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@765d7657
DEBUG StatusLogger Started configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@765d7657 OK.
TRACE StatusLogger Stopping org.apache.logging.log4j.core.config.DefaultConfiguration@33cb5951...
TRACE StatusLogger DefaultConfiguration notified 1 ReliabilityStrategies that config will be stopped.
TRACE StatusLogger DefaultConfiguration stopping root LoggerConfig.
TRACE StatusLogger DefaultConfiguration notifying ReliabilityStrategies that appenders will be stopped.
TRACE StatusLogger DefaultConfiguration stopping remaining Appenders.
DEBUG StatusLogger Shutting down OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger OutputStream closed
DEBUG StatusLogger Shut down OutputStreamManager SYSTEM_OUT.false.false-1, all resources released: true
DEBUG StatusLogger Appender DefaultConsole-1 stopped with status true
TRACE StatusLogger DefaultConfiguration stopped 1 remaining Appenders.
TRACE StatusLogger DefaultConfiguration cleaning Appenders from 1 LoggerConfigs.
DEBUG StatusLogger Stopped org.apache.logging.log4j.core.config.DefaultConfiguration@33cb5951 OK
TRACE StatusLogger Reregistering MBeans after reconfigure. Selector=org.apache.logging.log4j.core.selector.ClassLoaderContextSelector@51bd8b5c
TRACE StatusLogger Reregistering context (1/1): '330bedb4' org.apache.logging.log4j.core.LoggerContext@515aebb0
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=StatusLogger'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=ContextSelector'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncAppenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncLoggerRingBuffer'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*,subtype=RingBuffer'
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=StatusLogger
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=ContextSelector
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=STDOUT
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=CAPTURED
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
TRACE StatusLogger Using DummyNanoClock for nanosecond timestamps.
DEBUG StatusLogger Reconfiguration complete for context[name=330bedb4] at URI /home/alex/Repositories/hive/standalone-metastore/metastore-server/target/test-classes/log4j2.properties (org.apache.logging.log4j.core.LoggerContext@515aebb0) with optional ClassLoader: null
DEBUG StatusLogger Shutdown hook enabled. Registering a new one.
DEBUG StatusLogger LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@515aebb0] started OK.
[INFO ] 2024-04-23 23:06:12.372 [main] MetastoreConf - Unable to find config file: hive-site.xml
DEBUG StatusLogger AsyncLogger.ThreadNameStrategy=UNCACHED (user specified null, default is UNCACHED)
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
[INFO ] 2024-04-23 23:06:12.377 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:06:12.377 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:06:12.377 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:06:12.412 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:06:12.412 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:06:12.412 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:06:12.413 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[DEBUG] 2024-04-23 23:06:12.415 [main] MetastoreConf - MetastoreConf object:
Key: <metastore.acid.housekeeper.interval> old hive key: <hive.metastore.acid.housekeeper.interval>  value: <60s>
Key: <metastore.acid.housekeeper.start> old hive key: <hive.metastore.acid.housekeeper.start>  value: <60s>
Key: <metastore.acid.txn.cleaner.interval> old hive key: <hive.metastore.acid.txn.cleaner.interval>  value: <10s>
Key: <metastore.added.jars.path> old hive key: <hive.added.jars.path>  value: <>
Key: <metastore.aggregate.stats.cache.clean.until> old hive key: <hive.metastore.aggregate.stats.cache.clean.until>  value: <0.8>
Key: <metastore.aggregate.stats.cache.enabled> old hive key: <hive.metastore.aggregate.stats.cache.enabled>  value: <false>
Key: <metastore.aggregate.stats.cache.fpp> old hive key: <hive.metastore.aggregate.stats.cache.fpp>  value: <0.01>
Key: <metastore.aggregate.stats.cache.max.full> old hive key: <hive.metastore.aggregate.stats.cache.max.full>  value: <0.9>
Key: <metastore.aggregate.stats.cache.max.partitions> old hive key: <hive.metastore.aggregate.stats.cache.max.partitions>  value: <10000>
Key: <metastore.aggregate.stats.cache.max.reader.wait> old hive key: <hive.metastore.aggregate.stats.cache.max.reader.wait>  value: <1000ms>
Key: <metastore.aggregate.stats.cache.max.variance> old hive key: <hive.metastore.aggregate.stats.cache.max.variance>  value: <0.01>
Key: <metastore.aggregate.stats.cache.max.writer.wait> old hive key: <hive.metastore.aggregate.stats.cache.max.writer.wait>  value: <5000ms>
Key: <metastore.aggregate.stats.cache.size> old hive key: <hive.metastore.aggregate.stats.cache.size>  value: <10000>
Key: <metastore.aggregate.stats.cache.ttl> old hive key: <hive.metastore.aggregate.stats.cache.ttl>  value: <600s>
Key: <metastore.warehouse.tenant.colocation> old hive key: <hive.metastore.warehouse.tenant.colocation>  value: <false>
Key: <metastore.alter.handler> old hive key: <hive.metastore.alter.impl>  value: <org.apache.hadoop.hive.metastore.HiveAlterHandler>
Key: <metastore.async.log.enabled> old hive key: <hive.async.log.enabled>  value: <true>
Key: <metastore.authorization.storage.checks> old hive key: <hive.metastore.authorization.storage.checks>  value: <false>
Key: <datanucleus.schema.autoCreateAll> old hive key: <datanucleus.schema.autoCreateAll>  value: <true>
Key: <metastore.batch.retrieve.max> old hive key: <hive.metastore.batch.retrieve.max>  value: <300>
Key: <metastore.batch.retrieve.table.partition.max> old hive key: <hive.metastore.batch.retrieve.table.partition.max>  value: <1000>
Key: <metastore.cache.pinobjtypes> old hive key: <hive.metastore.cache.pinobjtypes>  value: <Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order>
Key: <metastore.cached.rawstore.impl> old hive key: <hive.metastore.cached.rawstore.impl>  value: <org.apache.hadoop.hive.metastore.ObjectStore>
Key: <metastore.cached.rawstore.cache.update.frequency> old hive key: <hive.metastore.cached.rawstore.cache.update.frequency>  value: <60s>
Key: <metastore.cached.rawstore.cached.object.whitelist> old hive key: <hive.metastore.cached.rawstore.cached.object.whitelist>  value: <.*>
Key: <metastore.cached.rawstore.cached.object.blacklist> old hive key: <hive.metastore.cached.rawstore.cached.object.blacklist>  value: <>
Key: <metastore.cached.rawstore.max.cache.memory> old hive key: <hive.metastore.cached.rawstore.max.cache.memory>  value: <1Gb>
Key: <metastore.client.capability.check> old hive key: <hive.metastore.client.capability.check>  value: <true>
Key: <metastore.catalog.default> old hive key: <metastore.catalog.default>  value: <hive>
Key: <metastore.cached.rawstore.catalogs> old hive key: <metastore.cached.rawstore.catalogs>  value: <hive>
Key: <metastore.client.connect.retry.delay> old hive key: <hive.metastore.client.connect.retry.delay>  value: <1s>
Key: <metastore.client.kerberos.principal> old hive key: <hive.metastore.client.kerberos.principal>  value: <>
Key: <metastore.client.socket.lifetime> old hive key: <hive.metastore.client.socket.lifetime>  value: <0s>
Key: <metastore.client.socket.timeout> old hive key: <hive.metastore.client.socket.timeout>  value: <600s>
Key: <metastore.compactor.history.retention.did.not.initiate> old hive key: <hive.compactor.history.retention.did.not.initiate>  value: <2>
Key: <metastore.compactor.history.retention.failed> old hive key: <hive.compactor.history.retention.failed>  value: <3>
Key: <metastore.compactor.history.retention.succeeded> old hive key: <hive.compactor.history.retention.succeeded>  value: <3>
Key: <metastore.compactor.history.retention.timeout> old hive key: <hive.compactor.history.retention.timeout>  value: <7d>
Key: <metastore.compactor.initiator.failed.compacts.threshold> old hive key: <hive.compactor.initiator.failed.compacts.threshold>  value: <2>
Key: <metastore.compactor.initiator.failed.retry.time> old hive key: <hive.compactor.initiator.failed.retry.time>  value: <7d>
Key: <metastore.compactor.run.as.user> old hive key: <hive.compactor.run.as.user>  value: <>
Key: <metastore.compactor.oldest.replication.open.txn.threshold.warning> old hive key: <hive.compactor.oldest.replication.open.txn.threshold.warning>  value: <14d>
Key: <metastore.compactor.oldest.replication.open.txn.threshold.error> old hive key: <hive.compactor.oldest.replication.open.txn.threshold.error>  value: <21d>
Key: <metastore.compactor.oldest.open.txn.threshold.warning> old hive key: <hive.compactor.oldest.open.txn.threshold.warning>  value: <24h>
Key: <metastore.compactor.oldest.open.txn.threshold.error> old hive key: <hive.compactor.oldest.open.txn.threshold.error>  value: <72h>
Key: <metastore.compactor.oldest.uncleaned.aborted.txn.time.threshold.warning> old hive key: <hive.compactor.oldest.uncleaned.aborted.txn.time.threshold.warning>  value: <24h>
Key: <metastore.compactor.oldest.uncleaned.aborted.txn.time.threshold.error> old hive key: <hive.compactor.oldest.uncleaned.aborted.txn.time.threshold.error>  value: <48h>
Key: <metastore.compactor.tables.with.aborted.txn.threshold> old hive key: <hive.compactor.tables.with.aborted.txn.threshold>  value: <1>
Key: <metastore.compactor.oldest.uncleaned.compaction.time.threshold> old hive key: <hive.compactor.oldest.uncleaned.compaction.time.threshold>  value: <24h>
Key: <metastore.compactor.failed.compaction.ratio.threshold> old hive key: <hive.compactor.failed.compaction.ratio.threshold>  value: <0.01>
Key: <metastore.compactor.oldest.initiated.compaction.time.threshold.warning> old hive key: <hive.compactor.oldest.initiated.compaction.time.threshold.warning>  value: <1h>
Key: <metastore.compactor.oldest.initiated.compaction.time.threshold.error> old hive key: <hive.compactor.oldest.initiated.compaction.time.threshold.error>  value: <12h>
Key: <metastore.compactor.completed.txn.components.record.threshold.warning> old hive key: <hive.compactor.completed.txn.components.record.threshold.warning>  value: <500000>
Key: <metastore.compactor.completed.txn.components.record.threshold.error> old hive key: <hive.compactor.completed.txn.components.record.threshold.error>  value: <1000000>
Key: <metastore.compactor.txn.to.writeid.record.threshold.warning> old hive key: <hive.compactor.txn.to.writeid.record.threshold.warning>  value: <500000>
Key: <metastore.compactor.txn.to.writeid.record.threshold.error> old hive key: <hive.compactor.txn.to.writeid.record.threshold.error>  value: <1000000>
Key: <metastore.compactor.number.of.disabled.compaction.tables.threshold> old hive key: <hive.compactor.number.of.disabled.compaction.tables.threshold>  value: <1>
Key: <metastore.compactor.acid.metrics.logger.frequency> old hive key: <hive.compactor.acid.metrics.logger.frequency>  value: <360m>
Key: <metastore.housekeeping.leader.hostname> old hive key: <hive.metastore.housekeeping.leader.hostname>  value: <>
Key: <metastore.housekeeping.threads.on> old hive key: <hive.metastore.housekeeping.threads.on>  value: <false>
Key: <metastore.acidmetrics.thread.on> old hive key: <hive.metastore.acidmetrics.thread.on>  value: <true>
Key: <metastore.acidmetrics.check.interval> old hive key: <hive.metastore.acidmetrics.check.interval>  value: <300s>
Key: <metastore.acidmetrics.ext.on> old hive key: <hive.metastore.acidmetrics.ext.on>  value: <true>
Key: <metastore.acidmetrics.table.aborted.txns.threshold> old hive key: <hive.metastore.acidmetrics.table.aborted.txns.threshold>  value: <1500>
Key: <metastore.compactor.initiator.on> old hive key: <hive.compactor.initiator.on>  value: <false>
Key: <metastore.compactor.worker.threads> old hive key: <hive.compactor.worker.threads>  value: <0>
Key: <metastore.compactor.worker.detect.multiple.versions.threshold> old hive key: <hive.metastore.compactor.worker.detect.multiple.versions.threshold>  value: <24h>
Key: <metastore.compactor.enable.stats.compression> old hive key: <metastore.compactor.enable.stats.compression>  value: <true>
Key: <javax.jdo.option.ConnectionDriverName> old hive key: <javax.jdo.option.ConnectionDriverName>  value: <org.apache.derby.jdbc.EmbeddedDriver>
Key: <datanucleus.connectionPool.maxPoolSize> old hive key: <datanucleus.connectionPool.maxPoolSize>  value: <10>
Key: <metastore.ds.connection.url.hook> old hive key: <hive.metastore.ds.connection.url.hook>  value: <>
Key: <javax.jdo.option.ConnectionURL> old hive key: <javax.jdo.option.ConnectionURL>  value: <jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true>
Key: <datanucleus.connectionPoolingType> old hive key: <datanucleus.connectionPoolingType>  value: <HikariCP>
Key: <javax.jdo.option.ConnectionUserName> old hive key: <javax.jdo.option.ConnectionUserName>  value: <APP>
Key: <metastore.create.as.acid> old hive key: <hive.create.as.acid>  value: <false>
Key: <metastore.count.open.txns.interval> old hive key: <hive.count.open.txns.interval>  value: <1s>
Key: <datanucleus.autoStartMechanismMode> old hive key: <datanucleus.autoStartMechanismMode>  value: <ignored>
Key: <datanucleus.cache.level2> old hive key: <datanucleus.cache.level2>  value: <false>
Key: <datanucleus.cache.level2.type> old hive key: <datanucleus.cache.level2.type>  value: <none>
Key: <datanucleus.rdbms.initializeColumnInfo> old hive key: <datanucleus.rdbms.initializeColumnInfo>  value: <NONE>
Key: <datanucleus.plugin.pluginRegistryBundleCheck> old hive key: <datanucleus.plugin.pluginRegistryBundleCheck>  value: <LOG>
Key: <datanucleus.transactionIsolation> old hive key: <datanucleus.transactionIsolation>  value: <read-committed>
Key: <datanucleus.rdbms.useLegacyNativeValueStrategy> old hive key: <datanucleus.rdbms.useLegacyNativeValueStrategy>  value: <true>
Key: <metastore.dbaccess.ssl.truststore.path> old hive key: <hive.metastore.dbaccess.ssl.truststore.path>  value: <>
Key: <metastore.dbaccess.ssl.truststore.type> old hive key: <hive.metastore.dbaccess.ssl.truststore.type>  value: <jks>
Key: <metastore.dbaccess.ssl.use.SSL> old hive key: <hive.metastore.dbaccess.ssl.use.SSL>  value: <false>
Key: <metastore.default.partition.name> old hive key: <hive.exec.default.partition.name>  value: <__HIVE_DEFAULT_PARTITION__>
Key: <metastore.cluster.delegation.key.update-interval> old hive key: <hive.cluster.delegation.key.update-interval>  value: <1d>
Key: <metastore.cluster.delegation.token.gc-interval> old hive key: <hive.cluster.delegation.token.gc-interval>  value: <15m>
Key: <metastore.cluster.delegation.token.max-lifetime> old hive key: <hive.cluster.delegation.token.max-lifetime>  value: <7d>
Key: <metastore.cluster.delegation.token.renew-interval> old hive key: <hive.cluster.delegation.token.renew-interval>  value: <1d>
Key: <metastore.cluster.delegation.token.store.class> old hive key: <hive.cluster.delegation.token.store.class>  value: <org.apache.hadoop.hive.metastore.security.MetastoreDelegationTokenManager>
Key: <javax.jdo.option.DetachAllOnCommit> old hive key: <javax.jdo.option.DetachAllOnCommit>  value: <true>
Key: <metastore.direct.sql.max.elements.in.clause> old hive key: <hive.direct.sql.max.elements.in.clause>  value: <1000>
Key: <metastore.direct.sql.max.elements.values.clause> old hive key: <hive.direct.sql.max.elements.values.clause>  value: <1000>
Key: <metastore.direct.sql.max.parameters> old hive key: <hive.direct.sql.max.parameters>  value: <1000>
Key: <metastore.direct.sql.max.query.length> old hive key: <hive.direct.sql.max.query.length>  value: <100>
Key: <metastore.direct.sql.batch.size> old hive key: <hive.metastore.direct.sql.batch.size>  value: <0>
Key: <metastore.disallow.incompatible.col.type.changes> old hive key: <hive.metastore.disallow.incompatible.col.type.changes>  value: <true>
Key: <metastore.allow.incompatible.col.type.changes.serdes> old hive key: <hive.metastore.allow.incompatible.col.type.changes.serdes>  value: <org.apache.hadoop.hive.kudu.KuduSerDe,org.apache.iceberg.mr.hive.HiveIcebergSerDe>
Key: <metastore.dump.config.on.creation> old hive key: <metastore.dump.config.on.creation>  value: <true>
Key: <metastore.end.function.listeners> old hive key: <hive.metastore.end.function.listeners>  value: <>
Key: <metastore.event.clean.freq> old hive key: <hive.metastore.event.clean.freq>  value: <0s>
Key: <metastore.event.expiry.duration> old hive key: <hive.metastore.event.expiry.duration>  value: <0s>
Key: <metastore.event.listeners> old hive key: <hive.metastore.event.listeners>  value: <>
Key: <metastore.event.message.factory> old hive key: <hive.metastore.event.message.factory>  value: <org.apache.hadoop.hive.metastore.messaging.json.gzip.GzipJSONMessageEncoder>
Key: <metastore.repl.message.factory> old hive key: <hive.metastore.repl.message.factory>  value: <org.apache.hadoop.hive.metastore.messaging.json.gzip.GzipJSONMessageEncoder>
Key: <metastore.notification.parameters.exclude.patterns> old hive key: <hive.metastore.notification.parameters.exclude.patterns>  value: <>
Key: <metastore.event.db.listener.timetolive> old hive key: <hive.metastore.event.db.listener.timetolive>  value: <1d>
Key: <metastore.event.db.clean.maxevents> old hive key: <hive.metastore.event.db.clean.maxevents>  value: <10000>
Key: <metastore.event.db.listener.clean.interval> old hive key: <hive.metastore.event.db.listener.clean.interval>  value: <7200s>
Key: <metastore.event.db.listener.clean.startup.wait.interval> old hive key: <hive.metastore.event.db.listener.clean.startup.wait.interval>  value: <1d>
Key: <metastore.metastore.event.db.notification.api.auth> old hive key: <hive.metastore.event.db.notification.api.auth>  value: <true>
Key: <metastore.execute.setugi> old hive key: <hive.metastore.execute.setugi>  value: <true>
Key: <metastore.expression.proxy> old hive key: <hive.metastore.expression.proxy>  value: <org.apache.hadoop.hive.ql.optimizer.ppr.PartitionExpressionForMetastore>
Key: <metastore.decode.filter.expression.tostring> old hive key: <hive.metastore.decode.filter.expression.tostring>  value: <false>
Key: <metastore.file.metadata.threads> old hive key: <hive.metastore.hbase.file.metadata.threads>  value: <1>
Key: <metastore.filter.hook> old hive key: <hive.metastore.filter.hook>  value: <org.apache.hadoop.hive.metastore.DefaultMetaStoreFilterHookImpl>
Key: <metastore.fs.handler.class> old hive key: <hive.metastore.fs.handler.class>  value: <org.apache.hadoop.hive.metastore.HiveMetaStoreFsImpl>
Key: <metastore.fshandler.threads> old hive key: <hive.metastore.fshandler.threads>  value: <15>
Key: <metastore.hmshandler.retry.attempts> old hive key: <hive.hmshandler.retry.attempts>  value: <10>
Key: <metastore.hmshandler.force.reload.conf> old hive key: <hive.hmshandler.force.reload.conf>  value: <false>
Key: <metastore.hmshandler.retry.interval> old hive key: <hive.hmshandler.retry.interval>  value: <2000ms>
Key: <datanucleus.identifierFactory> old hive key: <datanucleus.identifierFactory>  value: <datanucleus1>
Key: <metastore.init.hooks> old hive key: <hive.metastore.init.hooks>  value: <>
Key: <metastore.initial.metadata.count.enabled> old hive key: <hive.metastore.initial.metadata.count.enabled>  value: <true>
Key: <metastore.integral.jdo.pushdown> old hive key: <hive.metastore.integral.jdo.pushdown>  value: <false>
Key: <metastore.jdbc.max.batch.size> old hive key: <hive.metastore.jdbc.max.batch.size>  value: <1000>
Key: <metastore.kerberos.keytab.file> old hive key: <hive.metastore.kerberos.keytab.file>  value: <>
Key: <metastore.kerberos.principal> old hive key: <hive.metastore.kerberos.principal>  value: <hive-metastore/_HOST@EXAMPLE.COM>
Key: <metastore.authentication> old hive key: <hive.metastore.authentication>  value: <NOSASL>
Key: <metastore.custom.authentication.class> old hive key: <hive.metastore.custom.authentication.class>  value: <>
Key: <metastore.authentication.ldap.url> old hive key: <hive.metastore.authentication.ldap.url>  value: <>
Key: <metastore.authentication.ldap.baseDN> old hive key: <hive.metastore.authentication.ldap.baseDN>  value: <>
Key: <metastore.authentication.ldap.Domain> old hive key: <hive.metastore.authentication.ldap.Domain>  value: <>
Key: <metastore.authentication.ldap.groupDNPattern> old hive key: <hive.metastore.authentication.ldap.groupDNPattern>  value: <>
Key: <metastore.authentication.ldap.groupFilter> old hive key: <hive.metastore.authentication.ldap.groupFilter>  value: <>
Key: <metastore.authentication.ldap.userDNPattern> old hive key: <hive.metastore.authentication.ldap.userDNPattern>  value: <>
Key: <metastore.authentication.ldap.userFilter> old hive key: <hive.metastore.authentication.ldap.userFilter>  value: <>
Key: <metastore.authentication.ldap.guidKey> old hive key: <hive.metastore.authentication.ldap.guidKey>  value: <uid>
Key: <metastore.authentication.ldap.groupMembershipKey> old hive key: <hive.metastore.authentication.ldap.groupMembershipKey>  value: <member>
Key: <metastore.authentication.ldap.userMembershipKey> old hive key: <hive.metastore.authentication.ldap.userMembershipKey>  value: <>
Key: <metastore.authentication.ldap.groupClassKey> old hive key: <hive.metastore.authentication.ldap.groupClassKey>  value: <groupOfNames>
Key: <metastore.authentication.ldap.customLDAPQuery> old hive key: <hive.metastore.authentication.ldap.customLDAPQuery>  value: <>
Key: <metastore.authentication.ldap.binddn> old hive key: <hive.metastore.authentication.ldap.binddn>  value: <>
Key: <metastore.authentication.ldap.bindpw> old hive key: <hive.metastore.authentication.ldap.bindpw>  value: <>
Key: <metastore.limit.partition.request> old hive key: <hive.metastore.limit.partition.request>  value: <-1>
Key: <metastore.client.cache.v2.enabled> old hive key: <hive.metastore.client.cache.v2.enabled>  value: <true>
Key: <metastore.client.cache.v2.maxSize> old hive key: <hive.metastore.client.cache.v2.maxSize>  value: <1Gb>
Key: <metastore.client.cache.v2.recordStats> old hive key: <hive.metastore.client.cache.v2.recordStats>  value: <false>
Key: <metastore.log4j.file> old hive key: <hive.log4j.file>  value: <>
Key: <javax.jdo.PersistenceManagerFactoryClass> old hive key: <javax.jdo.PersistenceManagerFactoryClass>  value: <org.datanucleus.api.jdo.JDOPersistenceManagerFactory>
Key: <metastore.materializations.invalidation.impl> old hive key: <hive.metastore.materializations.invalidation.impl>  value: <DEFAULT>
Key: <metastore.materializations.invalidation.clean.frequency> old hive key: <hive.metastore.materializations.invalidation.clean.frequency>  value: <3600s>
Key: <metastore.materializations.invalidation.max.duration> old hive key: <hive.metastore.materializations.invalidation.max.duration>  value: <86400s>
Key: <metastore.runtime.stats.clean.frequency> old hive key: <hive.metastore.runtime.stats.clean.frequency>  value: <3600s>
Key: <metastore.runtime.stats.max.age> old hive key: <hive.metastore.runtime.stats.max.age>  value: <259200s>
Key: <metastore.scheduled.queries.enabled> old hive key: <hive.metastore.scheduled.queries.enabled>  value: <true>
Key: <metastore.scheduled.queries.execution.timeout> old hive key: <hive.metastore.scheduled.queries.progress.timeout>  value: <120s>
Key: <metastore.scheduled.queries.execution.maint.task.frequency> old hive key: <hive.metastore.scheduled.queries.execution.clean.frequency>  value: <60s>
Key: <metastore.scheduled.queries.execution.max.age> old hive key: <hive.metastore.scheduled.queries.execution.max.age>  value: <2592000s>
Key: <metastore.scheduled.queries.autodisable.count> old hive key: <metastore.scheduled.queries.autodisable.count>  value: <0>
Key: <metastore.scheduled.queries.skip.opportunities.after.failures> old hive key: <metastore.scheduled.queries.skip.opportunities.after.failures>  value: <0>
Key: <metastore.metadata.export.location> old hive key: <hive.metadata.export.location>  value: <>
Key: <metastore.max.event.response> old hive key: <hive.metastore.max.event.response>  value: <1000000>
Key: <metastore.client.filter.enabled> old hive key: <hive.metastore.client.filter.enabled>  value: <true>
Key: <metastore.server.filter.enabled> old hive key: <hive.metastore.server.filter.enabled>  value: <false>
Key: <metastore.metadata.move.exported.metadata.to.trash> old hive key: <hive.metadata.move.exported.metadata.to.trash>  value: <true>
Key: <metastore.metrics.enabled> old hive key: <hive.metastore.metrics.enabled>  value: <false>
Key: <metastore.metrics.hadoop2.component> old hive key: <hive.service.metrics.hadoop2.component>  value: <hivemetastore>
Key: <metastore.metrics.file.frequency> old hive key: <hive.service.metrics.file.frequency>  value: <60000ms>
Key: <metastore.metrics.file.location> old hive key: <hive.service.metrics.file.location>  value: </tmp/report.json>
Key: <metastore.metrics.slf4j.frequency> old hive key: <hive.service.metrics.slf4j.frequency>  value: <5m>
Key: <metastore.metrics.slf4j.logging.level> old hive key: <hive.service.metrics.slf4j.logging.level>  value: <INFO>
Key: <metastore.metrics.reporters> old hive key: <metastore.metrics.reporters>  value: <json,jmx>
Key: <metastore.msck.path.validation> old hive key: <hive.msck.path.validation>  value: <throw>
Key: <metastore.msck.repair.batch.size> old hive key: <hive.msck.repair.batch.size>  value: <3000>
Key: <metastore.msck.repair.batch.max.retries> old hive key: <hive.msck.repair.batch.max.retries>  value: <4>
Key: <metastore.msck.repair.enable.partition.retention> old hive key: <metastore.msck.repair.enable.partition.retention>  value: <false>
Key: <metastore.partition.management.task.frequency> old hive key: <metastore.partition.management.task.frequency>  value: <300s>
Key: <metastore.partition.management.table.types> old hive key: <metastore.partition.management.table.types>  value: <MANAGED_TABLE,EXTERNAL_TABLE>
Key: <metastore.partition.management.task.thread.pool.size> old hive key: <metastore.partition.management.task.thread.pool.size>  value: <3>
Key: <metastore.partition.management.catalog.name> old hive key: <metastore.partition.management.catalog.name>  value: <hive>
Key: <metastore.partition.management.database.pattern> old hive key: <metastore.partition.management.database.pattern>  value: <*>
Key: <metastore.partition.management.table.pattern> old hive key: <metastore.partition.management.table.pattern>  value: <*>
Key: <metastore.metadata.transformer.class> old hive key: <metastore.metadata.transformer.class>  value: <org.apache.hadoop.hive.metastore.MetastoreDefaultTransformer>
Key: <metastore.metadata.transformer.translated.to.external.follows.renames> old hive key: <metastore.metadata.transformer.translated.to.external.follows.renames>  value: <true>
Key: <metastore.metadata.transformer.location.mode> old hive key: <metastore.metadata.transformer.location.mode>  value: <force>
Key: <javax.jdo.option.Multithreaded> old hive key: <javax.jdo.option.Multithreaded>  value: <true>
Key: <metastore.max.open.txns> old hive key: <hive.max.open.txns>  value: <100000>
Key: <javax.jdo.option.NonTransactionalRead> old hive key: <javax.jdo.option.NonTransactionalRead>  value: <true>
Key: <metastore.notification.sequence.lock.max.retries> old hive key: <hive.notification.sequence.lock.max.retries>  value: <10>
Key: <metastore.notification.sequence.lock.retry.sleep.interval> old hive key: <hive.notification.sequence.lock.retry.sleep.interval>  value: <10s>
Key: <metastore.orm.retrieveMapNullsAsEmptyStrings> old hive key: <hive.metastore.orm.retrieveMapNullsAsEmptyStrings>  value: <false>
Key: <metastore.partition.name.whitelist.pattern> old hive key: <hive.metastore.partition.name.whitelist.pattern>  value: <>
Key: <metastore.partition.inherit.table.properties> old hive key: <hive.metastore.partition.inherit.table.properties>  value: <>
Key: <metastore.pre.event.listeners> old hive key: <hive.metastore.pre.event.listeners>  value: <>
Key: <metastore.rawstore.impl> old hive key: <hive.metastore.rawstore.impl>  value: <org.apache.hadoop.hive.metastore.ObjectStore>
Key: <metastore.repl.cmrootdir> old hive key: <hive.repl.cmrootdir>  value: </user/${system:user.name}/cmroot/>
Key: <metastore.repl.cm.encryptionzone.rootdir> old hive key: <hive.repl.cm.encryptionzone.rootdir>  value: <.cmroot>
Key: <metastore.repl.cm.nonencryptionzone.rootdir> old hive key: <hive.repl.cm.nonencryptionzone.rootdir>  value: <>
Key: <metastore.repl.cm.retain> old hive key: <hive.repl.cm.retain>  value: <240h>
Key: <metastore.repl.cm.interval> old hive key: <hive.repl.cm.interval>  value: <3600s>
Key: <metastore.repl.cm.enabled> old hive key: <hive.repl.cm.enabled>  value: <false>
Key: <metastore.repl.rootdir> old hive key: <hive.repl.rootdir>  value: </user/${system:user.name}/repl/>
Key: <metastore.repl.copyfile.maxnumfiles> old hive key: <hive.exec.copyfile.maxnumfiles>  value: <1>
Key: <metastore.repl.copyfile.maxsize> old hive key: <hive.exec.copyfile.maxsize>  value: <33554432>
Key: <metastore.repl.event.db.listener.timetolive> old hive key: <hive.repl.event.db.listener.timetolive>  value: <10d>
Key: <metastore.repl.metrics.cache.maxsize> old hive key: <hive.repl.metrics.cache.maxsize>  value: <10000>
Key: <metastore.repl.metrics.update.frequency> old hive key: <hive.repl.metrics.update.frequency>  value: <1m>
Key: <metastore.repl.metrics.cleanup.frequency> old hive key: <hive.metastore.repl.metrics.cleanup.frequency>  value: <1d>
Key: <metastore.repl.metrics.max.age> old hive key: <hive.metastore.repl.metrics.max.age>  value: <7d>
Key: <metastore.repl.txn.timeout> old hive key: <hive.repl.txn.timeout>  value: <11d>
Key: <metastore.schema.info.class> old hive key: <hive.metastore.schema.info.class>  value: <org.apache.hadoop.hive.metastore.MetaStoreSchemaInfo>
Key: <metastore.schema.verification> old hive key: <hive.metastore.schema.verification>  value: <false>
Key: <metastore.schema.verification.record.version> old hive key: <hive.metastore.schema.verification.record.version>  value: <false>
Key: <metastore.serdes.using.metastore.for.schema> old hive key: <hive.serdes.using.metastore.for.schema>  value: <org.apache.hadoop.hive.ql.io.orc.OrcSerde,org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe,org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe,org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe,org.apache.hadoop.hive.serde2.columnar.LazyBinaryColumnarSerDe,org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe,org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe,org.apache.hadoop.hive.serde2.OpenCSVSerde>
Key: <metastore.server.max.message.size> old hive key: <hive.metastore.server.max.message.size>  value: <104857600>
Key: <metastore.server.max.threads> old hive key: <hive.metastore.server.max.threads>  value: <1000>
Key: <metastore.server.min.threads> old hive key: <hive.metastore.server.min.threads>  value: <200>
Key: <metastore.thrift.port> old hive key: <hive.metastore.port>  value: <9083>
Key: <metastore.keystore.path> old hive key: <hive.metastore.keystore.path>  value: <>
Key: <metastore.keystore.type> old hive key: <hive.metastore.keystore.type>  value: <>
Key: <metastore.keymanagerfactory.algorithm> old hive key: <hive.metastore.keymanagerfactory.algorithm>  value: <>
Key: <metastore.ssl.protocol.blacklist> old hive key: <hive.ssl.protocol.blacklist>  value: <SSLv2,SSLv3>
Key: <metastore.truststore.path> old hive key: <hive.metastore.truststore.path>  value: <>
Key: <metastore.truststore.type> old hive key: <hive.metastore.truststore.type>  value: <>
Key: <metastore.trustmanagerfactory.algorithm> old hive key: <hive.metastore.trustmanagerfactory.algorithm>  value: <>
Key: <metastore.stats.autogather> old hive key: <hive.stats.autogather>  value: <true>
Key: <metastore.stats.fetch.bitvector> old hive key: <hive.stats.fetch.bitvector>  value: <false>
Key: <metastore.stats.ndv.tuner> old hive key: <hive.metastore.stats.ndv.tuner>  value: <0.0>
Key: <metastore.stats.ndv.densityfunction> old hive key: <hive.metastore.stats.ndv.densityfunction>  value: <false>
Key: <metastore.stats.default.aggregator> old hive key: <hive.stats.default.aggregator>  value: <>
Key: <metastore.stats.default.publisher> old hive key: <hive.stats.default.publisher>  value: <>
Key: <metastore.stats.auto.analyze> old hive key: <hive.metastore.stats.auto.analyze>  value: <none>
Key: <metastore.stats.auto.analyze.noop.wait> old hive key: <hive.metastore.stats.auto.analyze.noop.wait>  value: <5m>
Key: <metastore.stats.auto.analyze.worker.count> old hive key: <hive.metastore.stats.auto.analyze.worker.count>  value: <1>
Key: <metastore.storage.schema.reader.impl> old hive key: <metastore.storage.schema.reader.impl>  value: <org.apache.hadoop.hive.metastore.DefaultStorageSchemaReader>
Key: <datanucleus.storeManagerType> old hive key: <datanucleus.storeManagerType>  value: <rdbms>
Key: <metastore.strict.managed.tables> old hive key: <hive.strict.managed.tables>  value: <false>
Key: <metastore.support.special.characters.tablename> old hive key: <hive.support.special.characters.tablename>  value: <true>
Key: <metastore.task.threads.always> old hive key: <metastore.task.threads.always>  value: <org.apache.hadoop.hive.metastore.events.EventCleanerTask,org.apache.hadoop.hive.metastore.RuntimeStatsCleanerTask,org.apache.hadoop.hive.metastore.metrics.AcidMetricService,org.apache.hadoop.hive.metastore.HiveProtoEventsCleanerTask,org.apache.hadoop.hive.metastore.ScheduledQueryExecutionsMaintTask,org.apache.hadoop.hive.metastore.ReplicationMetricsMaintTask>
Key: <metastore.task.threads.remote> old hive key: <metastore.task.threads.remote>  value: <org.apache.hadoop.hive.metastore.txn.AcidHouseKeeperService,org.apache.hadoop.hive.metastore.txn.AcidTxnCleanerService,org.apache.hadoop.hive.metastore.txn.AcidOpenTxnsCounterService,org.apache.hadoop.hive.metastore.MaterializationsRebuildLockCleanerTask,org.apache.hadoop.hive.metastore.PartitionManagementTask>
Key: <metastore.server.tcp.keepalive> old hive key: <hive.metastore.server.tcp.keepalive>  value: <true>
Key: <metastore.thread.pool.size> old hive key: <no.such>  value: <10>
Key: <metastore.connect.retries> old hive key: <hive.metastore.connect.retries>  value: <3>
Key: <metastore.failure.retries> old hive key: <hive.metastore.failure.retries>  value: <1>
Key: <metastore.thrift.bind.host> old hive key: <hive.metastore.thrift.bind.host>  value: <>
Key: <metastore.thrift.uris> old hive key: <hive.metastore.uris>  value: <>
Key: <metastore.service.discovery.mode> old hive key: <hive.metastore.service.discovery.mode>  value: <>
Key: <metastore.zookeeper.kerberos.enabled> old hive key: <hive.zookeeper.kerberos.enabled>  value: <true>
Key: <metastore.zookeeper.client.port> old hive key: <hive.zookeeper.client.port>  value: <2181>
Key: <metastore.zookeeper.session.timeout> old hive key: <hive.zookeeper.session.timeout>  value: <120000ms>
Key: <metastore.zookeeper.connection.timeout> old hive key: <hive.zookeeper.connection.timeout>  value: <15s>
Key: <metastore.zookeeper.namespace> old hive key: <hive.zookeeper.namespace>  value: <hive_metastore>
Key: <metastore.zookeeper.connection.max.retries> old hive key: <hive.zookeeper.connection.max.retries>  value: <3>
Key: <metastore.zookeeper.connection.basesleeptime> old hive key: <hive.zookeeper.connection.basesleeptime>  value: <1000ms>
Key: <metastore.zookeeper.ssl.client.enable> old hive key: <hive.zookeeper.ssl.client.enable>  value: <false>
Key: <metastore.zookeeper.ssl.keystore.location> old hive key: <hive.zookeeper.ssl.keystore.location>  value: <>
Key: <metastore.zookeeper.ssl.truststore.location> old hive key: <hive.zookeeper.ssl.truststore.location>  value: <>
Key: <metastore.thrift.uri.selection> old hive key: <hive.metastore.uri.selection>  value: <RANDOM>
Key: <metastore.token.signature> old hive key: <hive.metastore.token.signature>  value: <>
Key: <metastore.cache.can.use.event> old hive key: <hive.metastore.cache.can.use.event>  value: <false>
Key: <metastore.transactional.event.listeners> old hive key: <hive.metastore.transactional.event.listeners>  value: <>
Key: <metastore.try.direct.sql> old hive key: <hive.metastore.try.direct.sql>  value: <true>
Key: <metastore.try.direct.sql.ddl> old hive key: <hive.metastore.try.direct.sql.ddl>  value: <true>
Key: <metastore.txn.max.open.batch> old hive key: <hive.txn.max.open.batch>  value: <1000>
Key: <metastore.txn.retryable.sqlex.regex> old hive key: <hive.txn.retryable.sqlex.regex>  value: <>
Key: <metastore.txn.store.impl> old hive key: <hive.metastore.txn.store.impl>  value: <org.apache.hadoop.hive.metastore.txn.CompactionTxnHandler>
Key: <metastore.txn.timeout> old hive key: <hive.txn.timeout>  value: <300s>
Key: <metastore.txn.opentxn.timeout> old hive key: <hive.txn.opentxn.timeout>  value: <1000ms>
Key: <metastore.txn.use.minhistorylevel> old hive key: <hive.txn.use.minhistorylevel>  value: <true>
Key: <metastore.uri.resolver> old hive key: <hive.metastore.uri.resolver>  value: <>
Key: <metastore.users.in.admin.role> old hive key: <hive.users.in.admin.role>  value: <>
Key: <metastore.use.SSL> old hive key: <hive.metastore.use.SSL>  value: <false>
Key: <metastore.sasl.enabled> old hive key: <hive.metastore.sasl.enabled>  value: <false>
Key: <metastore.client.auth.mode> old hive key: <hive.metastore.client.auth.mode>  value: <NOSASL>
Key: <metastore.client.plain.username> old hive key: <hive.metastore.client.plain.username>  value: <>
Key: <metastore.authentication.config.username> old hive key: <hive.metastore.authentication.config.username>  value: <>
Key: <metastore.authentication.config.password> old hive key: <hive.metastore.authentication.config.password>  value: <>
Key: <metastore.thrift.framed.transport.enabled> old hive key: <hive.metastore.thrift.framed.transport.enabled>  value: <false>
Key: <metastore.thrift.compact.protocol.enabled> old hive key: <hive.metastore.thrift.compact.protocol.enabled>  value: <false>
Key: <datanucleus.schema.validateColumns> old hive key: <datanucleus.schema.validateColumns>  value: <false>
Key: <datanucleus.schema.validateConstraints> old hive key: <datanucleus.schema.validateConstraints>  value: <false>
Key: <datanucleus.schema.validateTables> old hive key: <datanucleus.schema.validateTables>  value: <false>
Key: <metastore.warehouse.dir> old hive key: <hive.metastore.warehouse.dir>  value: <file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse>
Key: <metastore.warehouse.external.dir> old hive key: <hive.metastore.warehouse.external.dir>  value: <file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external>
Key: <metastore.wm.default.pool.size> old hive key: <hive.metastore.wm.default.pool.size>  value: <4>
Key: <metastore.rawstore.batch.size> old hive key: <metastore.rawstore.batch.size>  value: <-1>
Key: <hive.metastore.runworker.in> old hive key: <hive.metastore.runworker.in>  value: <metastore>
Key: <hive.in.test> old hive key: <hive.in.test>  value: <false>
Key: <hive.in.tez.test> old hive key: <hive.in.tez.test>  value: <false>
Key: <hive.in.iceberg.test> old hive key: <hive.in.iceberg.test>  value: <false>
Key: <hive.security.authorization.manager> old hive key: <hive.security.authorization.manager>  value: <org.apache.hadoop.hive.ql.security.authorization.plugin.sqlstd.SQLStdHiveAuthorizerFactory>
Key: <hive.security.metastore.authenticator.manager> old hive key: <hive.security.metastore.authenticator.manager>  value: <org.apache.hadoop.hive.ql.security.HadoopDefaultMetastoreAuthenticator>
Key: <hive.security.metastore.authorization.auth.reads> old hive key: <hive.security.metastore.authorization.auth.reads>  value: <true>
Key: <hive.txn.manager> old hive key: <hive.txn.manager>  value: <org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager>
Key: <hive.support.concurrency> old hive key: <hive.support.concurrency>  value: <false>
Key: <hive.txn.stats.enabled> old hive key: <hive.txn.stats.enabled>  value: <true>
Key: <metastore.use.custom.database.product> old hive key: <hive.metastore.use.custom.database.product>  value: <false>
Key: <metastore.custom.database.product.classname> old hive key: <hive.metastore.custom.database.product.classname>  value: <none>
Key: <hive.blobstore.supported.schemes> old hive key: <hive.blobstore.supported.schemes>  value: <s3,s3a,s3n>
Key: <hive.service.metrics.codahale.reporter.classes> old hive key: <hive.service.metrics.codahale.reporter.classes>  value: <>
Key: <hive.service.metrics.reporter> old hive key: <hive.service.metrics.reporter>  value: <>
Key: <metastore.dbaccess.ssl.properties> old hive key: <hive.metastore.dbaccess.ssl.properties>  value: <>
Key: <metastore.num.striped.table.locks> old hive key: <hive.metastore.num.striped.table.locks>  value: <32>
Key: <metastore.colstats.retain.on.column.removal> old hive key: <hive.metastore.colstats.retain.on.column.removal>  value: <true>
Key: <test.str> old hive key: <hive.test.str>  value: <defaultval>
Key: <test.str.set> old hive key: <hive.test.str.set>  value: <a>
Key: <test.str.list> old hive key: <hive.test.str.list>  value: <a,b,c>
Key: <test.long> old hive key: <hive.test.long>  value: <42>
Key: <test.double> old hive key: <hive.test.double>  value: <3.141592653589793>
Key: <test.time> old hive key: <hive.test.time>  value: <1s>
Key: <test.deprecated> old hive key: <hive.test.deprecated>  value: <0>
Key: <test.time.validator.inclusive> old hive key: <hive.test.time.validator.inclusive>  value: <1s>
Key: <test.time.validator.exclusive> old hive key: <hive.test.time.validator.exclusive>  value: <1s>
Key: <test.bool> old hive key: <hive.test.bool>  value: <true>
Key: <test.class> old hive key: <hive.test.class>  value: <>
Finished MetastoreConf object.

[INFO ] 2024-04-23 23:06:12.434 [main] TestTxnDbUtil - Creating transactional tables
[DEBUG] 2024-04-23 23:06:12.600 [main] Shell - Failed to detect a valid hadoop home directory
java.io.FileNotFoundException: HADOOP_HOME and hadoop.home.dir are unset.
	at org.apache.hadoop.util.Shell.checkHadoopHomeInner(Shell.java:469) ~[hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.util.Shell.checkHadoopHome(Shell.java:440) ~[hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.util.Shell.<clinit>(Shell.java:517) [hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.util.StringUtils.<clinit>(StringUtils.java:78) [hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.conf.Configuration.getStringCollection(Configuration.java:2170) [hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.security.alias.CredentialProviderFactory.getProviders(CredentialProviderFactory.java:65) [hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.conf.Configuration.getPasswordFromCredentialProviders(Configuration.java:2340) [hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.conf.Configuration.getPassword(Configuration.java:2278) [hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.hive.metastore.conf.MetastoreConf.getPassword(MetastoreConf.java:2261) [classes/:?]
	at org.apache.hadoop.hive.metastore.utils.TestTxnDbUtil.getConnection(TestTxnDbUtil.java:400) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.utils.TestTxnDbUtil.prepDb(TestTxnDbUtil.java:90) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreTestUtils.startMetaStoreWithRetry(MetaStoreTestUtils.java:196) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreTestUtils.startMetaStoreWithRetry(MetaStoreTestUtils.java:143) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreTestUtils.startMetaStoreWithRetry(MetaStoreTestUtils.java:131) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.setUp(TestPartitionManagement.java:77) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
[DEBUG] 2024-04-23 23:06:12.646 [main] Shell - setsid exited with exit code 0
[INFO ] 2024-04-23 23:06:13.000 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411;create=true
[INFO ] 2024-04-23 23:06:14.059 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:06:14.099 [MetaStoreThread-43411] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:06:14.220 [MetaStoreThread-43411] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:06:14.272 [MetaStoreThread-43411] HMSHandler - 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:06:14.314 [MetaStoreThread-43411] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:06:14.314 [MetaStoreThread-43411] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:14.314 [MetaStoreThread-43411] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:14.315 [MetaStoreThread-43411] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:06:14.315 [MetaStoreThread-43411] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:06:14.315 [MetaStoreThread-43411] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411;create=true
[DEBUG] 2024-04-23 23:06:14.315 [MetaStoreThread-43411] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:06:14.315 [MetaStoreThread-43411] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:06:14.315 [MetaStoreThread-43411] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:14.315 [MetaStoreThread-43411] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:06:14.315 [MetaStoreThread-43411] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:06:14.315 [MetaStoreThread-43411] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:06:14.315 [MetaStoreThread-43411] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:06:14.316 [MetaStoreThread-43411] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:14.316 [MetaStoreThread-43411] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:14.316 [MetaStoreThread-43411] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:06:14.316 [MetaStoreThread-43411] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:14.316 [MetaStoreThread-43411] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:14.316 [MetaStoreThread-43411] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:14.316 [MetaStoreThread-43411] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:06:14.316 [MetaStoreThread-43411] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:14.316 [MetaStoreThread-43411] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:14.317 [MetaStoreThread-43411] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:14.318 [MetaStoreThread-43411] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:06:14.318 [MetaStoreThread-43411] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:06:14.318 [MetaStoreThread-43411] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:06:14.318 [MetaStoreThread-43411] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:06:14.318 [MetaStoreThread-43411] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:06:14.318 [MetaStoreThread-43411] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:06:14.318 [MetaStoreThread-43411] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:06:14.318 [MetaStoreThread-43411] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:06:14.318 [MetaStoreThread-43411] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:06:14.318 [MetaStoreThread-43411] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:06:14.319 [MetaStoreThread-43411] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411;create=true
[DEBUG] 2024-04-23 23:06:14.319 [MetaStoreThread-43411] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:06:14.319 [MetaStoreThread-43411] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:06:14.319 [MetaStoreThread-43411] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:06:14.319 [MetaStoreThread-43411] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:14.319 [MetaStoreThread-43411] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:06:14.319 [MetaStoreThread-43411] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:06:14.319 [MetaStoreThread-43411] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:06:14.319 [MetaStoreThread-43411] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:06:14.319 [MetaStoreThread-43411] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:14.320 [MetaStoreThread-43411] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:06:14.320 [MetaStoreThread-43411] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:06:14.320 [MetaStoreThread-43411] PersistenceManagerProvider - Updating the pmf due to property change
[INFO ] 2024-04-23 23:06:14.320 [MetaStoreThread-43411] PersistenceManagerProvider - Current pmf properties are uninitialized
[DEBUG] 2024-04-23 23:06:14.330 [MetaStoreThread-43411] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:06:14.337 [MetaStoreThread-43411] HikariConfig - HikariPool-1 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:06:14.337 [MetaStoreThread-43411] HikariConfig - HikariPool-1 - configuration:
[DEBUG] 2024-04-23 23:06:14.338 [MetaStoreThread-43411] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:06:14.339 [MetaStoreThread-43411] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:06:14.339 [MetaStoreThread-43411] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:06:14.339 [MetaStoreThread-43411] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:06:14.339 [MetaStoreThread-43411] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:06:14.339 [MetaStoreThread-43411] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:06:14.339 [MetaStoreThread-43411] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:06:14.339 [MetaStoreThread-43411] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:06:14.339 [MetaStoreThread-43411] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:06:14.340 [MetaStoreThread-43411] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:06:14.340 [MetaStoreThread-43411] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:06:14.340 [MetaStoreThread-43411] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:06:14.340 [MetaStoreThread-43411] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:06:14.340 [MetaStoreThread-43411] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:06:14.340 [MetaStoreThread-43411] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:06:14.340 [MetaStoreThread-43411] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:06:14.341 [MetaStoreThread-43411] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:06:14.341 [MetaStoreThread-43411] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:06:14.341 [MetaStoreThread-43411] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411;create=true"
[DEBUG] 2024-04-23 23:06:14.341 [MetaStoreThread-43411] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:06:14.341 [MetaStoreThread-43411] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:06:14.341 [MetaStoreThread-43411] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:06:14.341 [MetaStoreThread-43411] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:06:14.341 [MetaStoreThread-43411] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:06:14.341 [MetaStoreThread-43411] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:06:14.342 [MetaStoreThread-43411] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:06:14.342 [MetaStoreThread-43411] HikariConfig - poolName........................"HikariPool-1"
[DEBUG] 2024-04-23 23:06:14.342 [MetaStoreThread-43411] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:06:14.342 [MetaStoreThread-43411] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:06:14.342 [MetaStoreThread-43411] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:06:14.342 [MetaStoreThread-43411] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:06:14.342 [MetaStoreThread-43411] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:06:14.342 [MetaStoreThread-43411] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:06:14.342 [MetaStoreThread-43411] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:06:14.343 [MetaStoreThread-43411] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:06:14.344 [MetaStoreThread-43411] HikariDataSource - HikariPool-1 - Starting...
[INFO ] 2024-04-23 23:06:14.354 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:06:14.356 [MetaStoreThread-43411] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:14.358 [MetaStoreThread-43411] HikariDataSource - HikariPool-1 - Start completed.
log4j: Trying to find [log4j.xml] using context classloader sun.misc.Launcher$AppClassLoader@330bedb4.
log4j: Trying to find [log4j.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
log4j: Trying to find [log4j.xml] using ClassLoader.getSystemResource().
log4j: Trying to find [log4j.properties] using context classloader sun.misc.Launcher$AppClassLoader@330bedb4.
log4j: Trying to find [log4j.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
log4j: Trying to find [log4j.properties] using ClassLoader.getSystemResource().
log4j: Could not find resource: [null].
log4j:WARN No appenders could be found for logger (DataNucleus.General).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
[DEBUG] 2024-04-23 23:06:14.458 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:06:14.460 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@940436376 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:14.460 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2033246627 (XID = 1160), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:14.461 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1208213356 (XID = 1162), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:14.462 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@421469932 (XID = 1164), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:14.463 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2100802830 (XID = 1166), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:14.464 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@491905874 (XID = 1168), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:14.465 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@969803432 (XID = 1170), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:14.466 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@346194310 (XID = 1172), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:14.467 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@786985485 (XID = 1174), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:14.467 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:06:14.737 [MetaStoreThread-43411] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:06:14.737 [MetaStoreThread-43411] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7e80c9d2, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:06:14.737 [MetaStoreThread-43411] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:06:14.757 [MetaStoreThread-43411] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7e80c9d2, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6acf19af created in the thread with id: 18
[DEBUG] 2024-04-23 23:06:14.767 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:14.768 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:14.769 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:15.060 [main] MetaStoreTestUtils - Waiting the HMS to start.
[DEBUG] 2024-04-23 23:06:15.752 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:15.938 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@940436376 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:15.966 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@940436376 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:16.024 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@940436376 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:16.051 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@940436376 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:16.059 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@940436376 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:16.060 [main] MetaStoreTestUtils - Waiting the HMS to start.
[DEBUG] 2024-04-23 23:06:16.200 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@940436376 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:16.238 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@940436376 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:16.247 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@940436376 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:16.257 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@940436376 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:16.262 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:16.272 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:16.272 [MetaStoreThread-43411] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:06:16.272 [MetaStoreThread-43411] ObjectStore - Initialized ObjectStore
[DEBUG] 2024-04-23 23:06:16.359 [MetaStoreThread-43411] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:16.364 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:16.383 [MetaStoreThread-43411] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:16.384 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:16.386 [MetaStoreThread-43411] MetaStoreSchemaInfoFactory - HIVE_HOME is not set. Using current directory instead
[DEBUG] 2024-04-23 23:06:16.386 [MetaStoreThread-43411] ObjectStore - Found expected HMS version of 4.0.0
[INFO ] 2024-04-23 23:06:16.386 [MetaStoreThread-43411] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7e80c9d2 from thread id: 18
[DEBUG] 2024-04-23 23:06:16.386 [MetaStoreThread-43411] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:06:16.386 [MetaStoreThread-43411] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:16.395 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:16.401 [MetaStoreThread-43411] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:16.401 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:16.402 [MetaStoreThread-43411] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:06:16.442 [MetaStoreThread-43411] MutableMetricsFactory - field org.apache.hadoop.metrics2.lib.MutableRate org.apache.hadoop.security.UserGroupInformation$UgiMetrics.loginSuccess with annotation @org.apache.hadoop.metrics2.annotation.Metric(valueName=Time, about=, sampleName=Ops, value=[Rate of successful kerberos logins and latency (milliseconds)], always=false, type=DEFAULT)
[DEBUG] 2024-04-23 23:06:16.446 [MetaStoreThread-43411] MutableMetricsFactory - field org.apache.hadoop.metrics2.lib.MutableRate org.apache.hadoop.security.UserGroupInformation$UgiMetrics.getGroups with annotation @org.apache.hadoop.metrics2.annotation.Metric(about=, valueName=Time, sampleName=Ops, type=DEFAULT, always=false, value=[GetGroups])
[DEBUG] 2024-04-23 23:06:16.446 [MetaStoreThread-43411] MutableMetricsFactory - field org.apache.hadoop.metrics2.lib.MutableRate org.apache.hadoop.security.UserGroupInformation$UgiMetrics.loginFailure with annotation @org.apache.hadoop.metrics2.annotation.Metric(type=DEFAULT, value=[Rate of failed kerberos logins and latency (milliseconds)], valueName=Time, sampleName=Ops, always=false, about=)
[DEBUG] 2024-04-23 23:06:16.446 [MetaStoreThread-43411] MutableMetricsFactory - field private org.apache.hadoop.metrics2.lib.MutableGaugeInt org.apache.hadoop.security.UserGroupInformation$UgiMetrics.renewalFailures with annotation @org.apache.hadoop.metrics2.annotation.Metric(valueName=Time, sampleName=Ops, about=, always=false, type=DEFAULT, value=[Renewal failures since last successful login])
[DEBUG] 2024-04-23 23:06:16.446 [MetaStoreThread-43411] MutableMetricsFactory - field private org.apache.hadoop.metrics2.lib.MutableGaugeLong org.apache.hadoop.security.UserGroupInformation$UgiMetrics.renewalFailuresTotal with annotation @org.apache.hadoop.metrics2.annotation.Metric(about=, type=DEFAULT, sampleName=Ops, value=[Renewal failures since startup], valueName=Time, always=false)
[DEBUG] 2024-04-23 23:06:16.447 [MetaStoreThread-43411] MetricsSystemImpl - UgiMetrics, User and group related metrics
[DEBUG] 2024-04-23 23:06:16.459 [MetaStoreThread-43411] SecurityUtil - Setting hadoop.security.token.service.use_ip to true
[DEBUG] 2024-04-23 23:06:16.470 [MetaStoreThread-43411] Groups -  Creating new Groups object
[DEBUG] 2024-04-23 23:06:16.471 [MetaStoreThread-43411] NativeCodeLoader - Trying to load the custom-built native-hadoop library...
[DEBUG] 2024-04-23 23:06:16.472 [MetaStoreThread-43411] NativeCodeLoader - Failed to load native-hadoop with error: java.lang.UnsatisfiedLinkError: no hadoop in java.library.path
[DEBUG] 2024-04-23 23:06:16.472 [MetaStoreThread-43411] NativeCodeLoader - java.library.path=/usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
[WARN ] 2024-04-23 23:06:16.472 [MetaStoreThread-43411] NativeCodeLoader - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[DEBUG] 2024-04-23 23:06:16.472 [MetaStoreThread-43411] PerformanceAdvisory - Falling back to shell based
[DEBUG] 2024-04-23 23:06:16.473 [MetaStoreThread-43411] JniBasedUnixGroupsMappingWithFallback - Group mapping impl=org.apache.hadoop.security.ShellBasedUnixGroupsMapping
[DEBUG] 2024-04-23 23:06:16.485 [MetaStoreThread-43411] Groups - Group mapping impl=org.apache.hadoop.security.JniBasedUnixGroupsMappingWithFallback; cacheTimeout=300000; warningDeltaMs=5000
[DEBUG] 2024-04-23 23:06:16.487 [MetaStoreThread-43411] UserGroupInformation - hadoop login
[DEBUG] 2024-04-23 23:06:16.488 [MetaStoreThread-43411] UserGroupInformation - hadoop login commit
[DEBUG] 2024-04-23 23:06:16.489 [MetaStoreThread-43411] UserGroupInformation - using local user:UnixPrincipal: alex
[DEBUG] 2024-04-23 23:06:16.489 [MetaStoreThread-43411] UserGroupInformation - Using user: "UnixPrincipal: alex" with name alex
[DEBUG] 2024-04-23 23:06:16.489 [MetaStoreThread-43411] UserGroupInformation - User entry: "alex"
[DEBUG] 2024-04-23 23:06:16.490 [MetaStoreThread-43411] UserGroupInformation - UGI loginUser:alex (auth:SIMPLE)
[DEBUG] 2024-04-23 23:06:16.502 [MetaStoreThread-43411] FileSystem - Loading filesystems
[DEBUG] 2024-04-23 23:06:16.508 [MetaStoreThread-43411] FileSystem - file:// = class org.apache.hadoop.fs.LocalFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar
[DEBUG] 2024-04-23 23:06:16.511 [MetaStoreThread-43411] FileSystem - viewfs:// = class org.apache.hadoop.fs.viewfs.ViewFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar
[DEBUG] 2024-04-23 23:06:16.512 [MetaStoreThread-43411] FileSystem - har:// = class org.apache.hadoop.fs.HarFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar
[DEBUG] 2024-04-23 23:06:16.513 [MetaStoreThread-43411] FileSystem - http:// = class org.apache.hadoop.fs.http.HttpFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar
[DEBUG] 2024-04-23 23:06:16.514 [MetaStoreThread-43411] FileSystem - https:// = class org.apache.hadoop.fs.http.HttpsFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar
[DEBUG] 2024-04-23 23:06:16.520 [MetaStoreThread-43411] FileSystem - hdfs:// = class org.apache.hadoop.hdfs.DistributedFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.1.0/hadoop-hdfs-client-3.1.0.jar
[DEBUG] 2024-04-23 23:06:16.741 [MetaStoreThread-43411] FileSystem - webhdfs:// = class org.apache.hadoop.hdfs.web.WebHdfsFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.1.0/hadoop-hdfs-client-3.1.0.jar
[DEBUG] 2024-04-23 23:06:16.741 [MetaStoreThread-43411] FileSystem - swebhdfs:// = class org.apache.hadoop.hdfs.web.SWebHdfsFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.1.0/hadoop-hdfs-client-3.1.0.jar
[DEBUG] 2024-04-23 23:06:16.742 [MetaStoreThread-43411] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:16.742 [MetaStoreThread-43411] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:16.751 [MetaStoreThread-43411] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:16.751 [MetaStoreThread-43411] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:06:16.755 [MetaStoreThread-43411] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:16.756 [MetaStoreThread-43411] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:16.757 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:16.757 [MetaStoreThread-43411] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:16.758 [MetaStoreThread-43411] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:16.771 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:16.781 [MetaStoreThread-43411] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:16.786 [MetaStoreThread-43411] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:16.786 [MetaStoreThread-43411] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:16.786 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:16.786 [MetaStoreThread-43411] ObjectStore - db details for db default retrieved using SQL in 5.609952ms
[DEBUG] 2024-04-23 23:06:16.786 [MetaStoreThread-43411] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:06:16.788 [MetaStoreThread-43411] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:06:16.788 [MetaStoreThread-43411] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:16.806 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:16.819 [MetaStoreThread-43411] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:16.822 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:16.829 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:16.830 [MetaStoreThread-43411] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:06:16.830 [MetaStoreThread-43411] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:16.830 [MetaStoreThread-43411] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:16.836 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:16.840 [MetaStoreThread-43411] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:16.844 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@940436376 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:16.846 [MetaStoreThread-43411] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:16.847 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:16.847 [MetaStoreThread-43411] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:06:16.847 [MetaStoreThread-43411] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:16.847 [MetaStoreThread-43411] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:16.848 [MetaStoreThread-43411] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:16.849 [MetaStoreThread-43411] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:16.849 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:16.849 [MetaStoreThread-43411] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:06:16.852 [MetaStoreThread-43411] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:16.854 [MetaStoreThread-43411] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:16.855 [MetaStoreThread-43411] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:16.857 [MetaStoreThread-43411] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:16.863 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@940436376 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:16.868 [MetaStoreThread-43411] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:16.872 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@940436376 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:16.874 [MetaStoreThread-43411] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:16.875 [MetaStoreThread-43411] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:16.876 [MetaStoreThread-43411] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:06:16.880 [MetaStoreThread-43411] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:06:16.881 [MetaStoreThread-43411] PerfLogger - </PERFLOG method=init start=1713909974220 end=1713909976881 duration=2661 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:17.047 [MetaStoreThread-43411] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:06:17.050 [MetaStoreThread-43411] HiveMetaStore - Started the new metaserver on port [43411]...
[INFO ] 2024-04-23 23:06:17.050 [MetaStoreThread-43411] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:06:17.050 [MetaStoreThread-43411] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:06:17.050 [MetaStoreThread-43411] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:06:17.050 [MetaStoreThread-43411] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:06:17.050 [MetaStoreThread-43411] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:06:17.050 [MetaStoreThread-43411] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:06:17.050 [MetaStoreThread-43411] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:06:17.050 [MetaStoreThread-43411] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:06:17.051 [MetaStoreThread-43411] deprecation - metastore.compactor.history.retention.did.not.initiate is deprecated. Instead, use metastore.compactor.history.retention.attempted
[INFO ] 2024-04-23 23:06:17.051 [MetaStoreThread-43411] deprecation - hive.compactor.history.retention.did.not.initiate is deprecated. Instead, use hive.compactor.history.retention.attempted
[INFO ] 2024-04-23 23:06:17.051 [MetaStoreThread-43411] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:06:17.051 [MetaStoreThread-43411] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:06:17.051 [MetaStoreThread-43411] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:06:17.051 [MetaStoreThread-43411] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:06:17.051 [MetaStoreThread-43411] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:06:17.051 [MetaStoreThread-43411] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:06:17.051 [MetaStoreThread-43411] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:06:17.051 [MetaStoreThread-43411] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:06:17.067 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:06:17.068 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 1: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:06:17.068 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:06:17.077 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/43411) is created
[INFO ] 2024-04-23 23:06:17.077 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 43411 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/43411 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411;create=true
[INFO ] 2024-04-23 23:06:17.077 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:06:17.093 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:06:17.093 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:43411]
[INFO ] 2024-04-23 23:06:17.093 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:43411)
[INFO ] 2024-04-23 23:06:17.104 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:43411) current connections: 1
[DEBUG] 2024-04-23 23:06:17.119 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.119 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713909977119 end=1713909977119 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.123 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.124 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.124 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 create_database: Database(name:db_repl1, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:06:17.125 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db_repl1, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:06:17.126 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:06:17.126 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:06:17.126 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:17.126 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:17.126 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:06:17.126 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:06:17.126 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411;create=true
[DEBUG] 2024-04-23 23:06:17.126 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:06:17.126 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:06:17.126 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:17.126 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:06:17.127 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:06:17.127 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:06:17.127 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:06:17.127 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:17.127 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:17.127 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:06:17.127 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:17.127 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:17.127 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:17.127 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:06:17.127 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:17.127 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:17.127 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:17.127 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:06:17.127 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:06:17.127 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:06:17.127 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:06:17.127 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:06:17.127 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:06:17.127 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:06:17.128 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:06:17.128 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:06:17.128 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:06:17.128 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411;create=true
[DEBUG] 2024-04-23 23:06:17.128 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:06:17.128 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:06:17.128 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:06:17.128 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:17.128 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:06:17.128 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:06:17.128 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:06:17.128 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:06:17.128 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:17.128 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:06:17.128 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:06:17.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@17fd6578, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:06:17.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:06:17.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@17fd6578, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@b78e885 created in the thread with id: 37
[DEBUG] 2024-04-23 23:06:17.129 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.129 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.129 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.134 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.136 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.136 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:06:17.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:06:17.136 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@17fd6578 from thread id: 37
[DEBUG] 2024-04-23 23:06:17.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.137 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.524165ms
[DEBUG] 2024-04-23 23:06:17.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db_repl1, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:06:17.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:06:17.139 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.140 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.141 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.142 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:06:17.143 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:17.143 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:17.143 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:17.143 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:06:17.143 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db
[INFO ] 2024-04-23 23:06:17.146 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db
[INFO ] 2024-04-23 23:06:17.148 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db
[DEBUG] 2024-04-23 23:06:17.149 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.149 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.151 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.162 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.162 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713909977124 end=1713909977162 duration=38 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.172 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.173 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.173 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 create_table_req: Table(tableName:tbl_repl1, dbName:db_repl1, owner:alex, createTime:1713909977, lastAccessTime:1713909977, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:d, type:date, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:bo, type:boolean, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:06:17.174 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl_repl1, dbName:db_repl1, owner:alex, createTime:1713909977, lastAccessTime:1713909977, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:d, type:date, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:bo, type:boolean, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:06:17.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.184 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:17.184 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.184 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.184 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 10.663755ms
[DEBUG] 2024-04-23 23:06:17.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:06:17.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.193 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.196 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:17.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.644943ms
[DEBUG] 2024-04-23 23:06:17.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:17.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:06:17.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:17.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.198 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:17.198 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:17.198 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:17.198 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:06:17.198 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/43411/db_repl1.db/tbl_repl1
[DEBUG] 2024-04-23 23:06:17.204 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.204 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:17.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:17.216 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@940436376 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.223 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@940436376 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.230 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@940436376 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.236 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@940436376 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.263 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.263 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.267 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.269 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713909977173 end=1713909977269 duration=96 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.272 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.274 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.274 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 add_partition : tbl=hive.db_repl1.tbl_repl1
[INFO ] 2024-04-23 23:06:17.274 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db_repl1.tbl_repl1	
[DEBUG] 2024-04-23 23:06:17.274 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.274 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:17.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:06:17.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:17.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.344 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.345 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:17.345 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:17.345 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:17.345 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:06:17.345 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/43411/db_repl1.db/tbl_repl1/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:06:17.352 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.352 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:17.352 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:06:17.354 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:17.357 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@940436376 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.373 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.376 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713909977274 end=1713909977375 duration=101 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.377 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.377 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.377 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 add_partition : tbl=hive.db_repl1.tbl_repl1
[INFO ] 2024-04-23 23:06:17.377 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db_repl1.tbl_repl1	
[DEBUG] 2024-04-23 23:06:17.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:17.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:06:17.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:17.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.388 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.388 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:17.388 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:17.389 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:17.389 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:06:17.389 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/43411/db_repl1.db/tbl_repl1/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:06:17.395 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.395 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:17.395 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:06:17.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:17.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.404 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.406 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713909977377 end=1713909977406 duration=29 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.407 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.408 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.408 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 add_partition : tbl=hive.db_repl1.tbl_repl1
[INFO ] 2024-04-23 23:06:17.408 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db_repl1.tbl_repl1	
[DEBUG] 2024-04-23 23:06:17.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:17.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:06:17.412 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:17.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.420 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:17.420 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:17.420 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:17.420 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:06:17.420 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/43411/db_repl1.db/tbl_repl1/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:06:17.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:17.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:06:17.427 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:17.431 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.431 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.434 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.436 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713909977408 end=1713909977436 duration=28 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.438 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.439 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.440 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713909977439 end=1713909977440 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.442 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.444 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.445 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_table : tbl=hive.db_repl1.tbl_repl1
[INFO ] 2024-04-23 23:06:17.445 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db_repl1.tbl_repl1	
[DEBUG] 2024-04-23 23:06:17.445 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.446 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:17.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.447 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.909495ms
[DEBUG] 2024-04-23 23:06:17.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:06:17.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.458 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:17.460 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:06:17.460 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713909977444 end=1713909977460 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.462 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=22, comments=HMS client
[DEBUG] 2024-04-23 23:06:17.464 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.466 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.466 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_partitions : tbl=hive.db_repl1.tbl_repl1
[INFO ] 2024-04-23 23:06:17.466 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db_repl1.tbl_repl1	
[DEBUG] 2024-04-23 23:06:17.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:06:17.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.473 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 6.270151ms + 0.037134ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:06:17.481 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.800196ms + 0.886528ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:06:17.490 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.952071ms + 5.163522ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:06:17.494 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.562779ms + 0.377928ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:17.497 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.383257ms + 0.196786ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:06:17.499 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.158889ms + 0.154561ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:17.502 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.244591ms + 0.164443ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:17.505 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.243601ms + 0.170333ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:17.508 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.478248ms + 0.512002ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:17.511 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.315146ms + 0.153328ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:06:17.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 44.444374ms
[DEBUG] 2024-04-23 23:06:17.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.512 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.512 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713909977465 end=1713909977512 duration=47 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.527 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.527 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.527 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_partitions : tbl=hive.db_repl1.tbl_repl1
[INFO ] 2024-04-23 23:06:17.527 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db_repl1.tbl_repl1	
[DEBUG] 2024-04-23 23:06:17.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:06:17.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.529 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.303043ms + 0.01942ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:06:17.530 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.787299ms + 0.124564ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:06:17.531 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.386463ms + 0.354636ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:06:17.532 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.302891ms + 0.27041ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:17.532 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.30645ms + 0.132154ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:06:17.533 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.269291ms + 0.126949ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:17.533 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.29635ms + 0.135779ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:17.534 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.299787ms + 0.138078ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:17.535 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.429992ms + 0.420489ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:17.536 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.40051ms + 0.153458ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:06:17.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 8.297153ms
[DEBUG] 2024-04-23 23:06:17.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.536 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.536 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713909977527 end=1713909977536 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.539 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.541 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.541 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_database: db_repl1
[INFO ] 2024-04-23 23:06:17.541 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db_repl1	
[DEBUG] 2024-04-23 23:06:17.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.543 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:17.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.543 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 2.063085ms
[DEBUG] 2024-04-23 23:06:17.543 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713909977541 end=1713909977543 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.544 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=7, comments=HMS client
[DEBUG] 2024-04-23 23:06:17.546 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.547 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.547 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 alter_database @hive#db_repl1
[INFO ] 2024-04-23 23:06:17.547 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_database @hive#db_repl1	
[DEBUG] 2024-04-23 23:06:17.548 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:17.548 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:17.548 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:17.548 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:06:17.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.549 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:17.549 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.549 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.549 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.796346ms
[DEBUG] 2024-04-23 23:06:17.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.551 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.557 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.557 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_database start=1713909977547 end=1713909977557 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.560 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.561 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.561 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 alter_table: hive.db_repl1.tbl_repl1 newtbl=tbl_repl1
[INFO ] 2024-04-23 23:06:17.561 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db_repl1.tbl_repl1 newtbl=tbl_repl1	
[DEBUG] 2024-04-23 23:06:17.561 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.563 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:17.563 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.563 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.563 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.563 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 2.033148ms
[DEBUG] 2024-04-23 23:06:17.564 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:17.564 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:17.564 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:17.564 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:06:17.564 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.565 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:17.565 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.565 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.566 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.566 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.65627ms
[DEBUG] 2024-04-23 23:06:17.566 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.566 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.566 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:06:17.569 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.575 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.578 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:17.579 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.579 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.579 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.543021ms
[DEBUG] 2024-04-23 23:06:17.579 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.579 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:17.579 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:06:17.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:17.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.587 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db_repl1
[WARN ] 2024-04-23 23:06:17.589 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:06:17.589 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.589 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:17.590 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:17.590 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:17.590 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:06:17.591 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:17.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:06:17.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:17.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:06:17.602 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:17.608 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.608 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.610 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.612 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713909977561 end=1713909977612 duration=51 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:17.615 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:06:17.615 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:43411]
[INFO ] 2024-04-23 23:06:17.615 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:43411)
[INFO ] 2024-04-23 23:06:17.615 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:43411) current connections: 2
[DEBUG] 2024-04-23 23:06:17.616 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.616 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713909977616 end=1713909977616 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=3 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.618 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.620 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.620 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 3: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:06:17.620 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:06:17.621 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 3: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411;create=true
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:06:17.622 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411;create=true
[DEBUG] 2024-04-23 23:06:17.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:06:17.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:06:17.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:06:17.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:17.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:06:17.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:06:17.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:06:17.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:06:17.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:17.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:06:17.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:06:17.623 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2c777866, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:06:17.623 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:06:17.623 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2c777866, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5bfb7078 created in the thread with id: 52
[DEBUG] 2024-04-23 23:06:17.623 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.624 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.624 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.627 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.628 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.628 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:06:17.628 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:06:17.628 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2c777866 from thread id: 52
[DEBUG] 2024-04-23 23:06:17.628 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.628 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:06:17.639 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.640 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.640 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713909977620 end=1713909977640 duration=20 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=3 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:17.640 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:06:17.642 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 1
[DEBUG] 2024-04-23 23:06:17.642 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.642 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.643 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.643 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 3: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:06:17.643 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:06:17.643 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:06:17.643 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_partitions : tbl=hive.db_repl1.tbl_repl1
[INFO ] 2024-04-23 23:06:17.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2c777866, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5bfb7078 will be shutdown
[INFO ] 2024-04-23 23:06:17.643 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db_repl1.tbl_repl1	
[DEBUG] 2024-04-23 23:06:17.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:06:17.643 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 3: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:06:17.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[INFO ] 2024-04-23 23:06:17.643 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:06:17.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.643 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713909977642 end=1713909977643 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=3 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.643 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:06:17.643 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 3: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:06:17.643 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:06:17.644 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.308169ms + 0.018429ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:06:17.646 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.110176ms + 0.167503ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:06:17.647 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.312901ms + 0.353712ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:06:17.648 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.267331ms + 0.272962ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:17.648 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.281741ms + 0.12577ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:06:17.648 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.268774ms + 0.123808ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:17.649 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.258293ms + 0.126133ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:17.649 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.248603ms + 0.12335ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:17.650 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.367544ms + 0.335364ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:17.651 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.459935ms + 0.13076ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:06:17.651 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.651 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.651 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 7.958079ms
[DEBUG] 2024-04-23 23:06:17.651 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.651 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.651 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713909977643 end=1713909977651 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.652 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.652 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.653 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 alter_table: hive.db_repl1.tbl_repl1 newtbl=tbl_repl1
[INFO ] 2024-04-23 23:06:17.653 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db_repl1.tbl_repl1 newtbl=tbl_repl1	
[DEBUG] 2024-04-23 23:06:17.653 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.654 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:17.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.655 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 2.138099ms
[DEBUG] 2024-04-23 23:06:17.655 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:17.655 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:17.655 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:17.655 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:06:17.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.656 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:17.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.657 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.730236ms
[DEBUG] 2024-04-23 23:06:17.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:06:17.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.665 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.667 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.668 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.668 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.670 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:17.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.510206ms
[DEBUG] 2024-04-23 23:06:17.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:17.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:06:17.673 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:17.678 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.678 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db_repl1
[WARN ] 2024-04-23 23:06:17.678 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:06:17.678 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.678 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:17.679 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:17.679 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:17.679 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:06:17.680 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:17.682 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:06:17.682 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:17.682 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:06:17.683 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:17.685 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.685 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.690 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.692 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713909977652 end=1713909977692 duration=40 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:17.694 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:06:17.694 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:43411]
[INFO ] 2024-04-23 23:06:17.694 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:43411)
[INFO ] 2024-04-23 23:06:17.694 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:43411) current connections: 2
[DEBUG] 2024-04-23 23:06:17.695 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.695 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713909977695 end=1713909977695 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=4 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.695 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.695 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.696 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 4: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:06:17.696 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:06:17.697 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 4: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411;create=true
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411;create=true
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:06:17.698 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:17.699 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:06:17.699 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:06:17.699 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@49b56573, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:06:17.699 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:06:17.699 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@49b56573, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@78b6eebb created in the thread with id: 53
[DEBUG] 2024-04-23 23:06:17.699 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.699 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.700 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.704 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.704 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.704 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:06:17.704 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:06:17.705 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@49b56573 from thread id: 53
[DEBUG] 2024-04-23 23:06:17.705 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.705 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:06:17.709 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.710 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.710 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.712 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:17.712 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.712 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.712 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.712 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 2.268505ms
[DEBUG] 2024-04-23 23:06:17.712 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713909977695 end=1713909977712 duration=17 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=4 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:17.713 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 1
[DEBUG] 2024-04-23 23:06:17.713 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.713 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.713 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 4: source:127.0.0.1 get_database: db_repl1
[INFO ] 2024-04-23 23:06:17.713 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db_repl1	
[DEBUG] 2024-04-23 23:06:17.714 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.714 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:17.715 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.715 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.715 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.715 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.384259ms
[DEBUG] 2024-04-23 23:06:17.715 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713909977713 end=1713909977715 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=4 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.715 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[INFO ] 2024-04-23 23:06:17.715 [main] MetaStoreUtils - Skipping all the tables which belong to replicated database: db_repl1
[DEBUG] 2024-04-23 23:06:17.716 [main] PartitionManagementTask - Skipping table : tbl_repl1
[INFO ] 2024-04-23 23:06:17.716 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 1
[DEBUG] 2024-04-23 23:06:17.716 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.716 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.716 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.716 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 4: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:06:17.716 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:06:17.716 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:06:17.716 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_partitions : tbl=hive.db_repl1.tbl_repl1
[INFO ] 2024-04-23 23:06:17.716 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@49b56573, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@78b6eebb will be shutdown
[INFO ] 2024-04-23 23:06:17.716 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db_repl1.tbl_repl1	
[DEBUG] 2024-04-23 23:06:17.716 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 4: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:06:17.716 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[INFO ] 2024-04-23 23:06:17.716 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:06:17.716 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713909977716 end=1713909977716 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=4 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.716 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.716 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.716 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:06:17.717 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 4: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:06:17.717 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:06:17.718 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.797238ms + 0.01703ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:06:17.720 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.9822ms + 0.154481ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:06:17.721 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.407736ms + 0.511472ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:06:17.722 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.392018ms + 0.39362ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:17.723 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.461619ms + 0.203409ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:06:17.724 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.439204ms + 0.209513ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:17.724 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.391823ms + 0.257986ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:17.725 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.380773ms + 0.195484ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:17.726 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.521552ms + 0.512005ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:17.727 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.43689ms + 0.194112ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:06:17.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 10.868394ms
[DEBUG] 2024-04-23 23:06:17.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.728 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.728 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713909977716 end=1713909977728 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.730 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.731 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.731 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:06:17.731 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:06:17.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:06:17.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.735 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.737 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713909977731 end=1713909977737 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.739 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.740 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.740 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:06:17.741 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:06:17.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.745 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.746 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713909977740 end=1713909977746 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.747 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.747 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.747 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_database: db_repl1
[INFO ] 2024-04-23 23:06:17.747 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db_repl1	
[DEBUG] 2024-04-23 23:06:17.747 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.749 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:17.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.749 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 2.26599ms
[DEBUG] 2024-04-23 23:06:17.749 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713909977747 end=1713909977749 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.750 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=3, comments=HMS client
[DEBUG] 2024-04-23 23:06:17.751 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.752 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.753 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_tables_by_type: db=@hive#db_repl1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:17.753 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db_repl1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:17.753 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:17.753 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:17.753 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.754 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:17.754 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.754 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.754 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.754 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.467158ms
[DEBUG] 2024-04-23 23:06:17.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.759 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.759 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.759 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 3.992855ms
[DEBUG] 2024-04-23 23:06:17.759 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713909977752 end=1713909977759 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.761 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.762 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.762 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_tables: db=@hive#db_repl1
[INFO ] 2024-04-23 23:06:17.762 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl1	
[DEBUG] 2024-04-23 23:06:17.762 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.767 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.767 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.767 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.767 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 5.078229ms
[DEBUG] 2024-04-23 23:06:17.768 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713909977762 end=1713909977767 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.768 [main] HiveMetaStoreClient - Selecting dropDatabase method for db_repl1 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:06:17.768 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:06:17.770 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.772 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.772 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.774 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:17.774 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.774 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.774 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.774 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 2.480368ms
[DEBUG] 2024-04-23 23:06:17.776 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_multi_table : db=db_repl1 tbls=tbl_repl1
[INFO ] 2024-04-23 23:06:17.776 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db_repl1 tbls=tbl_repl1	
[DEBUG] 2024-04-23 23:06:17.776 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.784 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.785 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:17.785 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.785 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.785 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.84579ms
[DEBUG] 2024-04-23 23:06:17.785 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.786 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.786 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713909977772 end=1713909977786 duration=14 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:17.789 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:17.790 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:17.790 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 drop_database: @hive#db_repl1
[INFO ] 2024-04-23 23:06:17.791 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl1	
[DEBUG] 2024-04-23 23:06:17.791 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:17.791 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.792 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:17.792 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.792 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.792 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.525784ms
[DEBUG] 2024-04-23 23:06:17.792 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_tables: db=@hive#db_repl1
[INFO ] 2024-04-23 23:06:17.793 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl1	
[DEBUG] 2024-04-23 23:06:17.793 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.794 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.794 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.794 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.067968ms
[DEBUG] 2024-04-23 23:06:17.794 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*
[INFO ] 2024-04-23 23:06:17.794 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*	
[DEBUG] 2024-04-23 23:06:17.794 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.810 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@940436376 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.821 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:06:17.821 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:06:17.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.829 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@940436376 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.835 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.835 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:06:17.835 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:06:17.835 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.865 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@940436376 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.870 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.870 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:17.870 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:17.870 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:17.870 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:06:17.870 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:17.870 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:17.871 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.872 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:17.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.371429ms
[DEBUG] 2024-04-23 23:06:17.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.700011ms
[DEBUG] 2024-04-23 23:06:17.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:17.875 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:17.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:17.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:17.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.462902ms
[DEBUG] 2024-04-23 23:06:17.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:06:17.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl1 along with all tables
[DEBUG] 2024-04-23 23:06:17.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:17.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:17.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:17.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:06:17.896 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@940436376 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.903 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:06:17.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:17.927 [TThreadPoolServer WorkerProcess-%d] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:06:17.928 [TThreadPoolServer WorkerProcess-%d] HikariConfig - HikariPool-2 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:06:17.928 [TThreadPoolServer WorkerProcess-%d] HikariConfig - HikariPool-2 - configuration:
[DEBUG] 2024-04-23 23:06:17.928 [TThreadPoolServer WorkerProcess-%d] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:06:17.929 [TThreadPoolServer WorkerProcess-%d] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:06:17.929 [TThreadPoolServer WorkerProcess-%d] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:06:17.929 [TThreadPoolServer WorkerProcess-%d] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:06:17.929 [TThreadPoolServer WorkerProcess-%d] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:06:17.929 [TThreadPoolServer WorkerProcess-%d] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:06:17.929 [TThreadPoolServer WorkerProcess-%d] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:06:17.929 [TThreadPoolServer WorkerProcess-%d] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:06:17.929 [TThreadPoolServer WorkerProcess-%d] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:06:17.929 [TThreadPoolServer WorkerProcess-%d] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:06:17.929 [TThreadPoolServer WorkerProcess-%d] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:06:17.929 [TThreadPoolServer WorkerProcess-%d] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:06:17.929 [TThreadPoolServer WorkerProcess-%d] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:06:17.929 [TThreadPoolServer WorkerProcess-%d] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:06:17.929 [TThreadPoolServer WorkerProcess-%d] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:06:17.929 [TThreadPoolServer WorkerProcess-%d] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:06:17.929 [TThreadPoolServer WorkerProcess-%d] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:06:17.929 [TThreadPoolServer WorkerProcess-%d] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:06:17.929 [TThreadPoolServer WorkerProcess-%d] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411;create=true"
[DEBUG] 2024-04-23 23:06:17.929 [TThreadPoolServer WorkerProcess-%d] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:06:17.929 [TThreadPoolServer WorkerProcess-%d] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:06:17.929 [TThreadPoolServer WorkerProcess-%d] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:06:17.929 [TThreadPoolServer WorkerProcess-%d] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:06:17.930 [TThreadPoolServer WorkerProcess-%d] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:06:17.930 [TThreadPoolServer WorkerProcess-%d] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:06:17.930 [TThreadPoolServer WorkerProcess-%d] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:06:17.930 [TThreadPoolServer WorkerProcess-%d] HikariConfig - poolName........................"HikariPool-2"
[DEBUG] 2024-04-23 23:06:17.930 [TThreadPoolServer WorkerProcess-%d] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:06:17.930 [TThreadPoolServer WorkerProcess-%d] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:06:17.930 [TThreadPoolServer WorkerProcess-%d] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:06:17.930 [TThreadPoolServer WorkerProcess-%d] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:06:17.930 [TThreadPoolServer WorkerProcess-%d] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:06:17.930 [TThreadPoolServer WorkerProcess-%d] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:06:17.930 [TThreadPoolServer WorkerProcess-%d] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:06:17.930 [TThreadPoolServer WorkerProcess-%d] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:06:17.930 [TThreadPoolServer WorkerProcess-%d] HikariDataSource - HikariPool-2 - Starting...
[INFO ] 2024-04-23 23:06:17.932 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:06:17.932 [TThreadPoolServer WorkerProcess-%d] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:17.932 [TThreadPoolServer WorkerProcess-%d] HikariDataSource - HikariPool-2 - Start completed.
[DEBUG] 2024-04-23 23:06:17.933 [TThreadPoolServer WorkerProcess-%d] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:06:17.934 [TThreadPoolServer WorkerProcess-%d] HikariConfig - HikariPool-3 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:06:17.934 [TThreadPoolServer WorkerProcess-%d] HikariConfig - HikariPool-3 - configuration:
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411;create=true"
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - poolName........................"HikariPool-3"
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:06:17.935 [TThreadPoolServer WorkerProcess-%d] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:06:17.936 [TThreadPoolServer WorkerProcess-%d] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:06:17.936 [TThreadPoolServer WorkerProcess-%d] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:06:17.936 [TThreadPoolServer WorkerProcess-%d] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:06:17.936 [TThreadPoolServer WorkerProcess-%d] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:06:17.936 [TThreadPoolServer WorkerProcess-%d] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:06:17.936 [TThreadPoolServer WorkerProcess-%d] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:06:17.936 [TThreadPoolServer WorkerProcess-%d] HikariDataSource - HikariPool-3 - Starting...
[INFO ] 2024-04-23 23:06:17.937 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-3 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:06:17.937 [TThreadPoolServer WorkerProcess-%d] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@685439468 (XID = 1721), (SESSIONID = 27), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:17.938 [TThreadPoolServer WorkerProcess-%d] HikariDataSource - HikariPool-3 - Start completed.
[DEBUG] 2024-04-23 23:06:17.938 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.940 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:17.940 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.941 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:17.944 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:17.946 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:17.949 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:17.952 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:17.954 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:17.956 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:17.956 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:17.962 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:17.963 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:06:17.965 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 42 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 44 more

[DEBUG] 2024-04-23 23:06:18.033 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:06:18.035 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@343508056 (XID = 1732), (SESSIONID = 29), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:18.037 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1430556259 (XID = 1734), (SESSIONID = 31), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:18.038 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:06:18.039 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1683749026 (XID = 1736), (SESSIONID = 33), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:18.040 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2029684335 (XID = 1738), (SESSIONID = 35), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:18.041 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@896233772 (XID = 1740), (SESSIONID = 37), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:18.043 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@969378900 (XID = 1743), (SESSIONID = 39), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:18.043 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1978403311 (XID = 1744), (SESSIONID = 41), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:18.045 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@824551678 (XID = 1747), (SESSIONID = 44), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:18.046 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@146019609 (XID = 1748), (SESSIONID = 45), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:18.048 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1508406043 (XID = 1751), (SESSIONID = 49), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:18.048 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@560764581 (XID = 1752), (SESSIONID = 48), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:18.070 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1553002706 (XID = 1755), (SESSIONID = 52), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:18.072 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@682616546 (XID = 1756), (SESSIONID = 53), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:18.077 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1571212866 (XID = 1759), (SESSIONID = 55), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:18.078 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@186257630 (XID = 1760), (SESSIONID = 57), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:18.078 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:06:18.080 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1399244284 (XID = 1762), (SESSIONID = 59), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:18.083 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@526002782 (XID = 1764), (SESSIONID = 61), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:18.085 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@798629659 (XID = 1766), (SESSIONID = 63), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:18.086 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:06:19.966 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 drop_database: @hive#db_repl1
[INFO ] 2024-04-23 23:06:19.967 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl1	
[DEBUG] 2024-04-23 23:06:19.967 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:19.967 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:19.971 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:19.971 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:19.971 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:19.971 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 4.528962ms
[DEBUG] 2024-04-23 23:06:19.972 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_tables: db=@hive#db_repl1
[INFO ] 2024-04-23 23:06:19.972 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl1	
[DEBUG] 2024-04-23 23:06:19.972 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:19.972 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:19.973 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:19.973 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.886992ms
[DEBUG] 2024-04-23 23:06:19.973 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*
[INFO ] 2024-04-23 23:06:19.973 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*	
[DEBUG] 2024-04-23 23:06:19.973 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:19.974 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:19.974 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:06:19.975 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:06:19.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:19.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:19.976 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:06:19.976 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:06:19.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:19.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:19.977 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:19.977 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:19.977 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:19.978 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:19.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:19.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:19.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.267709ms
[DEBUG] 2024-04-23 23:06:19.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:19.979 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:19.979 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:19.979 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.774281ms
[DEBUG] 2024-04-23 23:06:19.979 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:19.980 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:19.981 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:19.981 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:19.981 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:19.981 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.140972ms
[DEBUG] 2024-04-23 23:06:19.981 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:06:19.981 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl1 along with all tables
[DEBUG] 2024-04-23 23:06:19.981 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:19.981 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:19.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:19.983 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:06:19.983 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:06:19.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:19.985 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:19.985 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:19.985 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:19.985 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:19.985 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:19.985 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:19.985 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:19.985 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:19.985 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:19.985 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:19.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:19.987 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:19.987 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:06:19.988 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 42 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 44 more

[DEBUG] 2024-04-23 23:06:21.988 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 drop_database: @hive#db_repl1
[INFO ] 2024-04-23 23:06:21.989 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl1	
[DEBUG] 2024-04-23 23:06:21.989 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:21.989 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:21.993 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:21.994 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:21.994 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:21.994 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 4.625248ms
[DEBUG] 2024-04-23 23:06:21.994 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_tables: db=@hive#db_repl1
[INFO ] 2024-04-23 23:06:21.994 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl1	
[DEBUG] 2024-04-23 23:06:21.994 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:21.997 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:21.997 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:21.997 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.3187ms
[DEBUG] 2024-04-23 23:06:21.997 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*
[INFO ] 2024-04-23 23:06:21.997 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*	
[DEBUG] 2024-04-23 23:06:21.997 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:22.002 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:22.003 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:06:22.003 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:06:22.003 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:22.007 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:22.007 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:06:22.007 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:06:22.007 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:22.010 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:22.011 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:22.012 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:22.012 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:22.015 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:22.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:22.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:22.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 5.441607ms
[DEBUG] 2024-04-23 23:06:22.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:22.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:22.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:22.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 3.02149ms
[DEBUG] 2024-04-23 23:06:22.021 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:22.023 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:22.026 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:22.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:22.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:22.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 3.110907ms
[DEBUG] 2024-04-23 23:06:22.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:06:22.027 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl1 along with all tables
[DEBUG] 2024-04-23 23:06:22.027 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:22.027 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:22.029 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:22.029 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:06:22.031 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:06:22.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:22.032 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:22.032 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:22.033 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:22.033 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:22.033 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:22.033 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:22.033 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:22.034 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:22.034 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:22.034 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:22.034 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:22.036 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:22.036 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:06:22.037 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 42 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 44 more

[DEBUG] 2024-04-23 23:06:24.037 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 drop_database: @hive#db_repl1
[INFO ] 2024-04-23 23:06:24.038 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl1	
[DEBUG] 2024-04-23 23:06:24.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:24.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:24.042 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:24.042 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:24.042 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:24.042 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 3.675624ms
[DEBUG] 2024-04-23 23:06:24.042 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_tables: db=@hive#db_repl1
[INFO ] 2024-04-23 23:06:24.042 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl1	
[DEBUG] 2024-04-23 23:06:24.042 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:24.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:24.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:24.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.800587ms
[DEBUG] 2024-04-23 23:06:24.043 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*
[INFO ] 2024-04-23 23:06:24.043 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*	
[DEBUG] 2024-04-23 23:06:24.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:24.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:24.045 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:06:24.045 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:06:24.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:24.046 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:24.047 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:06:24.047 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:06:24.047 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:24.047 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:24.048 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:24.048 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:24.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:24.049 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:24.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:24.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:24.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.37263ms
[DEBUG] 2024-04-23 23:06:24.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:24.050 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:24.050 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:24.050 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.820209ms
[DEBUG] 2024-04-23 23:06:24.050 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:24.051 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:24.052 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:24.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:24.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:24.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.368059ms
[DEBUG] 2024-04-23 23:06:24.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:06:24.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl1 along with all tables
[DEBUG] 2024-04-23 23:06:24.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:24.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:24.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:24.055 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:06:24.055 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:06:24.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:24.056 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:24.056 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:24.056 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:24.057 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:24.057 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:24.057 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:24.057 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:24.057 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:24.057 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:24.057 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:24.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:24.059 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:24.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:06:24.059 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 42 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 44 more

[DEBUG] 2024-04-23 23:06:26.060 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 drop_database: @hive#db_repl1
[INFO ] 2024-04-23 23:06:26.060 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl1	
[DEBUG] 2024-04-23 23:06:26.060 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:26.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:26.064 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:26.065 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:26.065 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:26.065 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 4.139166ms
[DEBUG] 2024-04-23 23:06:26.065 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_tables: db=@hive#db_repl1
[INFO ] 2024-04-23 23:06:26.065 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl1	
[DEBUG] 2024-04-23 23:06:26.065 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:26.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:26.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:26.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.736108ms
[DEBUG] 2024-04-23 23:06:26.066 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*
[INFO ] 2024-04-23 23:06:26.066 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*	
[DEBUG] 2024-04-23 23:06:26.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:26.068 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:26.068 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:06:26.068 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:06:26.068 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:26.069 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:26.069 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:06:26.069 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:06:26.070 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:26.070 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:26.071 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:26.071 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:26.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:26.072 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:26.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:26.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:26.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.008311ms
[DEBUG] 2024-04-23 23:06:26.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:26.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:26.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:26.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.634884ms
[DEBUG] 2024-04-23 23:06:26.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:26.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:26.074 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:26.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:26.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:26.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.211407ms
[DEBUG] 2024-04-23 23:06:26.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:06:26.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl1 along with all tables
[DEBUG] 2024-04-23 23:06:26.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:26.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:26.076 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:26.076 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:06:26.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:06:26.078 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:26.078 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:26.078 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:26.078 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:26.078 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:26.078 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:26.078 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:26.078 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:26.079 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:26.079 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:26.079 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:26.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:26.080 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:26.080 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:06:26.080 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 42 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 44 more

[DEBUG] 2024-04-23 23:06:28.081 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 drop_database: @hive#db_repl1
[INFO ] 2024-04-23 23:06:28.081 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl1	
[DEBUG] 2024-04-23 23:06:28.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:28.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:28.085 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:28.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:28.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:28.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 3.280537ms
[DEBUG] 2024-04-23 23:06:28.085 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_tables: db=@hive#db_repl1
[INFO ] 2024-04-23 23:06:28.085 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl1	
[DEBUG] 2024-04-23 23:06:28.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:28.086 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:28.086 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:28.086 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.655603ms
[DEBUG] 2024-04-23 23:06:28.086 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*
[INFO ] 2024-04-23 23:06:28.086 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*	
[DEBUG] 2024-04-23 23:06:28.086 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:28.088 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:28.088 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:06:28.088 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:06:28.088 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:28.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:28.090 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:06:28.090 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:06:28.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:28.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:28.091 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:28.091 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:28.091 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:28.092 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:28.092 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:28.092 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:28.092 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.180115ms
[DEBUG] 2024-04-23 23:06:28.092 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:28.093 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:28.093 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:28.093 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.67318ms
[DEBUG] 2024-04-23 23:06:28.093 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:28.094 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:28.095 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:28.095 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:28.095 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:28.095 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.254999ms
[DEBUG] 2024-04-23 23:06:28.095 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:06:28.095 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl1 along with all tables
[DEBUG] 2024-04-23 23:06:28.095 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:28.095 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:28.097 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:28.097 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:06:28.098 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:06:28.098 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:28.099 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:28.099 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:28.099 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:28.099 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:28.099 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:28.099 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:28.099 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:28.099 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:28.100 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:28.100 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:28.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:28.102 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:28.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:06:28.102 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 42 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 44 more

[DEBUG] 2024-04-23 23:06:30.103 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 drop_database: @hive#db_repl1
[INFO ] 2024-04-23 23:06:30.103 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl1	
[DEBUG] 2024-04-23 23:06:30.103 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:30.103 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:30.105 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:30.106 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:30.106 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:30.106 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 2.351212ms
[DEBUG] 2024-04-23 23:06:30.106 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_tables: db=@hive#db_repl1
[INFO ] 2024-04-23 23:06:30.106 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl1	
[DEBUG] 2024-04-23 23:06:30.106 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:30.107 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:30.107 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:30.107 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.732841ms
[DEBUG] 2024-04-23 23:06:30.107 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*
[INFO ] 2024-04-23 23:06:30.107 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*	
[DEBUG] 2024-04-23 23:06:30.107 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:30.109 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:30.109 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:06:30.109 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:06:30.109 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:30.110 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:30.110 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:06:30.110 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:06:30.110 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:30.111 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:30.111 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:30.111 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:30.111 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:30.112 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:30.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:30.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:30.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.16652ms
[DEBUG] 2024-04-23 23:06:30.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:30.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:30.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:30.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.726383ms
[DEBUG] 2024-04-23 23:06:30.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:30.114 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:30.115 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:30.115 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:30.116 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:30.116 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.261596ms
[DEBUG] 2024-04-23 23:06:30.116 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:06:30.116 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl1 along with all tables
[DEBUG] 2024-04-23 23:06:30.116 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:30.116 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:30.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:30.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:06:30.118 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:06:30.119 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:30.119 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:30.119 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:30.119 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:30.119 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:30.119 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:30.119 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:30.119 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:30.119 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:30.120 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:30.120 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:30.120 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:30.121 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:30.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:06:30.121 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 42 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 44 more

[DEBUG] 2024-04-23 23:06:32.122 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 drop_database: @hive#db_repl1
[INFO ] 2024-04-23 23:06:32.122 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl1	
[DEBUG] 2024-04-23 23:06:32.123 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:32.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:32.127 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:32.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:32.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:32.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 4.255473ms
[DEBUG] 2024-04-23 23:06:32.128 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_tables: db=@hive#db_repl1
[INFO ] 2024-04-23 23:06:32.128 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl1	
[DEBUG] 2024-04-23 23:06:32.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:32.129 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:32.129 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:32.129 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.667036ms
[DEBUG] 2024-04-23 23:06:32.129 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*
[INFO ] 2024-04-23 23:06:32.129 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*	
[DEBUG] 2024-04-23 23:06:32.129 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:32.131 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:32.131 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:06:32.131 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:06:32.131 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:32.132 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:32.132 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:06:32.132 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:06:32.132 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:32.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:32.133 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:32.133 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:32.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:32.134 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:32.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:32.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:32.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.159954ms
[DEBUG] 2024-04-23 23:06:32.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:32.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:32.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:32.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.60259ms
[DEBUG] 2024-04-23 23:06:32.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:32.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:32.137 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:32.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:32.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:32.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.188963ms
[DEBUG] 2024-04-23 23:06:32.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:06:32.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl1 along with all tables
[DEBUG] 2024-04-23 23:06:32.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:32.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:32.139 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:32.139 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:06:32.140 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:06:32.140 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:32.141 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:32.141 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:32.141 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:32.141 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:32.141 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:32.141 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:32.141 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:32.141 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:32.141 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:32.142 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:32.142 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:32.144 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:32.144 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:06:32.144 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 42 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 44 more

[DEBUG] 2024-04-23 23:06:34.145 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 drop_database: @hive#db_repl1
[INFO ] 2024-04-23 23:06:34.145 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl1	
[DEBUG] 2024-04-23 23:06:34.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:34.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:34.146 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:34.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:34.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:34.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.45101ms
[DEBUG] 2024-04-23 23:06:34.147 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_tables: db=@hive#db_repl1
[INFO ] 2024-04-23 23:06:34.147 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl1	
[DEBUG] 2024-04-23 23:06:34.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:34.148 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:34.148 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:34.148 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.796279ms
[DEBUG] 2024-04-23 23:06:34.148 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*
[INFO ] 2024-04-23 23:06:34.148 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*	
[DEBUG] 2024-04-23 23:06:34.148 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:34.150 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:34.150 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:06:34.150 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:06:34.150 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:34.151 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:34.151 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:06:34.151 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:06:34.151 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:34.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:34.153 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:34.153 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:34.153 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:34.154 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:34.154 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:34.154 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:34.154 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.353553ms
[DEBUG] 2024-04-23 23:06:34.154 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:34.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:34.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:34.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.8037ms
[DEBUG] 2024-04-23 23:06:34.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:34.156 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:34.157 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:34.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:34.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:34.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.276507ms
[DEBUG] 2024-04-23 23:06:34.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:06:34.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl1 along with all tables
[DEBUG] 2024-04-23 23:06:34.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:34.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:34.159 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:34.159 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:06:34.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:06:34.161 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:34.161 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:34.161 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:34.161 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:34.161 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:34.162 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:34.162 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:34.162 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:34.162 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:34.162 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:34.162 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:34.162 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:34.164 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:34.164 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:06:34.165 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:06:36.165 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 drop_database: @hive#db_repl1
[INFO ] 2024-04-23 23:06:36.166 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl1	
[DEBUG] 2024-04-23 23:06:36.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:36.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:36.169 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:36.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:36.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:36.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 4.128368ms
[DEBUG] 2024-04-23 23:06:36.170 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_tables: db=@hive#db_repl1
[INFO ] 2024-04-23 23:06:36.170 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl1	
[DEBUG] 2024-04-23 23:06:36.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:36.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:36.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:36.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.699643ms
[DEBUG] 2024-04-23 23:06:36.171 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*
[INFO ] 2024-04-23 23:06:36.171 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*	
[DEBUG] 2024-04-23 23:06:36.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:36.173 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:36.173 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:06:36.173 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:06:36.173 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:36.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:36.174 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:06:36.174 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:06:36.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:36.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:36.175 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:36.175 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:36.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:36.176 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:36.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:36.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:36.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.096208ms
[DEBUG] 2024-04-23 23:06:36.177 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:36.177 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:36.177 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:36.177 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.567945ms
[DEBUG] 2024-04-23 23:06:36.177 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:36.178 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:36.179 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:36.179 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:36.179 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:36.179 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 0.948345ms
[DEBUG] 2024-04-23 23:06:36.179 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:06:36.179 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl1 along with all tables
[DEBUG] 2024-04-23 23:06:36.179 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:36.179 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:36.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:36.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:06:36.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:06:36.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:36.182 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:36.182 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:36.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:36.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:36.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:36.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:36.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:36.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:36.183 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:36.183 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:36.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:36.184 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:36.184 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:06:36.184 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:06:38.185 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 drop_database: @hive#db_repl1
[INFO ] 2024-04-23 23:06:38.185 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl1	
[DEBUG] 2024-04-23 23:06:38.186 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:38.186 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:38.189 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:38.189 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:38.189 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:38.189 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 3.7469ms
[DEBUG] 2024-04-23 23:06:38.189 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_tables: db=@hive#db_repl1
[INFO ] 2024-04-23 23:06:38.190 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl1	
[DEBUG] 2024-04-23 23:06:38.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:38.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:38.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:38.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.814262ms
[DEBUG] 2024-04-23 23:06:38.191 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*
[INFO ] 2024-04-23 23:06:38.191 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*	
[DEBUG] 2024-04-23 23:06:38.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:38.192 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:38.193 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:06:38.193 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:06:38.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:38.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:38.194 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:06:38.194 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:06:38.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:38.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:38.195 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:38.195 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:38.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:38.196 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:38.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:38.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:38.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.249416ms
[DEBUG] 2024-04-23 23:06:38.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:38.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:38.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:38.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.681415ms
[DEBUG] 2024-04-23 23:06:38.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:38.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:38.199 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:38.199 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:38.199 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:38.199 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.317961ms
[DEBUG] 2024-04-23 23:06:38.199 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:06:38.199 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl1 along with all tables
[DEBUG] 2024-04-23 23:06:38.199 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:38.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:38.201 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:38.201 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:06:38.202 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:06:38.202 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:38.203 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:38.203 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:38.203 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:38.203 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:38.203 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:38.203 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:38.203 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:38.203 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:06:38.203 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:38.204 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:38.204 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:38.205 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1166656367 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:38.205 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:06:38.205 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:06:38.205 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713909977790 end=1713909998205 duration=20415 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=-1 error=true>
[INFO ] 2024-04-23 23:06:38.213 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:06:38.214 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:06:38.214 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:06:38.214 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:06:38.225 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:06:38.225 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:06:38.225 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:06:38.225 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:06:38.226 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:06:38.293 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361;create=true
[INFO ] 2024-04-23 23:06:38.881 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:06:38.881 [MetaStoreThread-46361] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:06:38.883 [MetaStoreThread-46361] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:06:38.883 [MetaStoreThread-46361] HMSHandler - 5: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361;create=true
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361;create=true
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:06:38.884 [MetaStoreThread-46361] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361;create=true
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:06:38.885 [MetaStoreThread-46361] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:06:38.887 [MetaStoreThread-46361] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 10
[DEBUG] 2024-04-23 23:06:38.887 [MetaStoreThread-46361] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 28
[DEBUG] 2024-04-23 23:06:38.890 [MetaStoreThread-46361] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 9, unloaded classes: 107
[DEBUG] 2024-04-23 23:06:38.891 [MetaStoreThread-46361] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:38.891 [MetaStoreThread-46361] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:38.891 [MetaStoreThread-46361] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:38.891 [MetaStoreThread-46361] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:38.891 [MetaStoreThread-46361] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:38.891 [MetaStoreThread-46361] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:38.891 [MetaStoreThread-46361] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:38.891 [MetaStoreThread-46361] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:38.891 [MetaStoreThread-46361] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:38.891 [MetaStoreThread-46361] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:38.891 [MetaStoreThread-46361] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:38.891 [MetaStoreThread-46361] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:38.891 [MetaStoreThread-46361] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:38.891 [MetaStoreThread-46361] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:38.891 [MetaStoreThread-46361] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:06:38.891 [MetaStoreThread-46361] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:38.893 [MetaStoreThread-46361] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:06:38.893 [MetaStoreThread-46361] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:06:38.894 [MetaStoreThread-46361] HikariConfig - HikariPool-4 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:06:38.894 [MetaStoreThread-46361] HikariConfig - HikariPool-4 - configuration:
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361;create=true"
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:06:38.895 [MetaStoreThread-46361] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:06:38.896 [MetaStoreThread-46361] HikariConfig - poolName........................"HikariPool-4"
[DEBUG] 2024-04-23 23:06:38.896 [MetaStoreThread-46361] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:06:38.896 [MetaStoreThread-46361] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:06:38.896 [MetaStoreThread-46361] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:06:38.896 [MetaStoreThread-46361] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:06:38.896 [MetaStoreThread-46361] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:06:38.896 [MetaStoreThread-46361] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:06:38.896 [MetaStoreThread-46361] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:06:38.896 [MetaStoreThread-46361] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:06:38.896 [MetaStoreThread-46361] HikariDataSource - HikariPool-4 - Starting...
[INFO ] 2024-04-23 23:06:38.898 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:06:38.898 [MetaStoreThread-46361] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:38.898 [MetaStoreThread-46361] HikariDataSource - HikariPool-4 - Start completed.
[DEBUG] 2024-04-23 23:06:38.998 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:06:39.000 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.001 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@85448091 (XID = 1154), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.002 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@886583384 (XID = 1156), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.003 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1698179796 (XID = 1158), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.005 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1596129266 (XID = 1160), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.006 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1635136341 (XID = 1162), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.007 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1764658370 (XID = 1164), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.008 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@443585011 (XID = 1166), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.009 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2134231101 (XID = 1168), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.010 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:06:39.188 [MetaStoreThread-46361] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:06:39.188 [MetaStoreThread-46361] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@45c9343a, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:06:39.188 [MetaStoreThread-46361] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:06:39.188 [MetaStoreThread-46361] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@45c9343a, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@33bdc637 created in the thread with id: 80
[DEBUG] 2024-04-23 23:06:39.188 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.188 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.189 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.298 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.391 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.413 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.460 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.480 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.487 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.601 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.630 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.639 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.647 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.651 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.653 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.653 [MetaStoreThread-46361] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:06:39.653 [MetaStoreThread-46361] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:06:39.653 [MetaStoreThread-46361] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@45c9343a from thread id: 80
[DEBUG] 2024-04-23 23:06:39.653 [MetaStoreThread-46361] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:06:39.653 [MetaStoreThread-46361] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:39.657 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.661 [MetaStoreThread-46361] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:39.661 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:39.661 [MetaStoreThread-46361] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:06:39.662 [MetaStoreThread-46361] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:39.662 [MetaStoreThread-46361] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:39.663 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.663 [MetaStoreThread-46361] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:39.663 [MetaStoreThread-46361] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:39.666 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.666 [MetaStoreThread-46361] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:39.669 [MetaStoreThread-46361] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:39.669 [MetaStoreThread-46361] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:39.669 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.669 [MetaStoreThread-46361] ObjectStore - db details for db default retrieved using SQL in 2.819801ms
[DEBUG] 2024-04-23 23:06:39.669 [MetaStoreThread-46361] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:06:39.669 [MetaStoreThread-46361] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:06:39.669 [MetaStoreThread-46361] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:39.676 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.678 [MetaStoreThread-46361] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:39.679 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.682 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:39.682 [MetaStoreThread-46361] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:06:39.682 [MetaStoreThread-46361] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:39.682 [MetaStoreThread-46361] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:39.686 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.689 [MetaStoreThread-46361] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:39.693 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.694 [MetaStoreThread-46361] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:39.695 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:39.695 [MetaStoreThread-46361] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:06:39.695 [MetaStoreThread-46361] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:39.695 [MetaStoreThread-46361] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:39.696 [MetaStoreThread-46361] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:39.696 [MetaStoreThread-46361] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:39.697 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:39.697 [MetaStoreThread-46361] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:06:39.697 [MetaStoreThread-46361] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:39.697 [MetaStoreThread-46361] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:39.698 [MetaStoreThread-46361] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:39.698 [MetaStoreThread-46361] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:39.702 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.706 [MetaStoreThread-46361] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:39.709 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.710 [MetaStoreThread-46361] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:39.711 [MetaStoreThread-46361] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:39.712 [MetaStoreThread-46361] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:06:39.712 [MetaStoreThread-46361] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:06:39.712 [MetaStoreThread-46361] PerfLogger - </PERFLOG method=init start=1713909998883 end=1713909999712 duration=829 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=5 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:39.712 [MetaStoreThread-46361] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:06:39.712 [MetaStoreThread-46361] HiveMetaStore - Started the new metaserver on port [46361]...
[INFO ] 2024-04-23 23:06:39.712 [MetaStoreThread-46361] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:06:39.712 [MetaStoreThread-46361] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:06:39.712 [MetaStoreThread-46361] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:06:39.712 [MetaStoreThread-46361] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:06:39.712 [MetaStoreThread-46361] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:06:39.712 [MetaStoreThread-46361] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:06:39.712 [MetaStoreThread-46361] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:06:39.712 [MetaStoreThread-46361] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:06:39.712 [MetaStoreThread-46361] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:06:39.712 [MetaStoreThread-46361] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:06:39.712 [MetaStoreThread-46361] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:06:39.712 [MetaStoreThread-46361] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:06:39.712 [MetaStoreThread-46361] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:06:39.712 [MetaStoreThread-46361] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:06:39.712 [MetaStoreThread-46361] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:06:39.712 [MetaStoreThread-46361] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:06:39.882 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:06:39.882 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 6: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:06:39.882 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:06:39.888 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/46361) is created
[INFO ] 2024-04-23 23:06:39.888 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 46361 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/46361 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361;create=true
[INFO ] 2024-04-23 23:06:39.888 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:06:39.892 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:06:39.892 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:46361]
[INFO ] 2024-04-23 23:06:39.892 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:46361)
[INFO ] 2024-04-23 23:06:39.892 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:46361) current connections: 2
[DEBUG] 2024-04-23 23:06:39.894 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:39.894 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713909999894 end=1713909999894 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:39.894 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:39.894 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:39.895 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 create_database: Database(name:db5, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:06:39.895 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db5, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:06:39.899 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:06:39.899 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:06:39.899 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:39.899 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:39.899 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:06:39.899 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:06:39.899 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361;create=true
[DEBUG] 2024-04-23 23:06:39.899 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:06:39.899 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:06:39.899 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:39.899 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:06:39.899 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:06:39.899 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:06:39.899 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:06:39.899 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:39.899 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:39.899 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:06:39.899 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:39.899 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361;create=true
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:39.900 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:06:39.901 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:06:39.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@44e72665, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:06:39.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:06:39.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@44e72665, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2c634b34 created in the thread with id: 97
[DEBUG] 2024-04-23 23:06:39.902 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.902 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.902 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.907 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.908 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.908 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:06:39.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:06:39.909 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@44e72665 from thread id: 97
[DEBUG] 2024-04-23 23:06:39.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:39.910 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:39.910 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:39.910 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.910 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.470979ms
[DEBUG] 2024-04-23 23:06:39.910 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db5, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:06:39.910 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:06:39.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:39.912 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:39.912 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.913 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:06:39.913 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:39.913 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:39.913 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:39.913 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:06:39.913 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db
[INFO ] 2024-04-23 23:06:39.913 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db
[INFO ] 2024-04-23 23:06:39.917 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db
[DEBUG] 2024-04-23 23:06:39.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:39.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:39.918 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:39.918 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:39.920 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.920 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713909999894 end=1713909999920 duration=26 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:39.921 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:39.921 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:39.921 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 create_table_req: Table(tableName:tbl5, dbName:db5, owner:alex, createTime:1713909999, lastAccessTime:1713909999, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:b, type:binary, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:s, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:06:39.921 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl5, dbName:db5, owner:alex, createTime:1713909999, lastAccessTime:1713909999, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:b, type:binary, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:s, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:06:39.922 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:39.926 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:39.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:39.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:39.927 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 5.573964ms
[DEBUG] 2024-04-23 23:06:39.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:39.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:39.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:06:39.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:39.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:39.935 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:39.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:39.936 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:39.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:39.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:39.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.610097ms
[DEBUG] 2024-04-23 23:06:39.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:39.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:39.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:06:39.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:39.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:39.939 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:39.939 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:39.939 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:39.939 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:06:39.939 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/46361/db5.db/tbl5
[DEBUG] 2024-04-23 23:06:39.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:39.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:39.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:39.960 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.969 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.979 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:39.986 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.007 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.009 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713909999921 end=1713910000009 duration=88 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:40.009 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:40.009 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:40.009 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 add_partition : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:06:40.009 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:06:40.009 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.009 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.009 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:40.009 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:06:40.021 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:40.055 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.055 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.065 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:40.065 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:40.065 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:40.065 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:06:40.065 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/46361/db5.db/tbl5/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:06:40.070 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.070 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:40.070 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:06:40.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:40.076 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.093 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.096 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910000009 end=1713910000095 duration=86 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:40.096 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:40.096 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:40.096 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 add_partition : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:06:40.096 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:06:40.097 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.097 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.097 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:40.097 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:06:40.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:40.105 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.106 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.107 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.107 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:40.107 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:40.107 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:40.107 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:06:40.107 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/46361/db5.db/tbl5/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:06:40.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:40.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:06:40.114 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:40.118 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.118 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.121 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.123 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910000096 end=1713910000122 duration=26 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:40.123 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:40.123 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:40.123 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 add_partition : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:06:40.123 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:06:40.123 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.123 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.123 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:40.123 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:06:40.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:40.129 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.129 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.130 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.130 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:40.130 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:40.130 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:40.130 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:06:40.131 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/46361/db5.db/tbl5/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:06:40.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:40.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:06:40.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:40.140 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.140 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.142 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.144 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910000123 end=1713910000144 duration=21 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:40.145 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:40.145 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:40.145 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713910000145 end=1713910000145 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:40.145 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:40.145 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:40.145 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_table : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:06:40.145 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:06:40.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.147 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:40.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:40.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.148 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.148 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 2.194133ms
[DEBUG] 2024-04-23 23:06:40.148 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.148 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.148 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:06:40.151 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.156 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.158 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:40.159 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:06:40.160 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713910000145 end=1713910000159 duration=14 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:40.160 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=15, comments=HMS client
[DEBUG] 2024-04-23 23:06:40.160 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:40.160 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:40.160 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:06:40.160 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:06:40.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:06:40.161 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.161 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.168 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 7.25391ms + 0.019525ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:06:40.174 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 5.541413ms + 0.105422ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:06:40.177 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.18299ms + 0.323996ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:06:40.179 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.980683ms + 0.238665ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:40.181 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.069999ms + 0.134122ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:06:40.184 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.040167ms + 0.17255ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:40.186 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.183888ms + 0.136453ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:40.189 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.57049ms + 0.212815ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:40.192 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.853293ms + 0.471197ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:40.195 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.33545ms + 0.148642ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:06:40.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:40.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 34.431807ms
[DEBUG] 2024-04-23 23:06:40.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.195 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.195 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910000160 end=1713910000195 duration=35 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:40.206 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:40.207 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:40.207 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 alter_table: hive.db5.tbl5 newtbl=tbl5
[INFO ] 2024-04-23 23:06:40.207 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db5.tbl5 newtbl=tbl5	
[DEBUG] 2024-04-23 23:06:40.207 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.208 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:40.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:40.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.208 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.433763ms
[DEBUG] 2024-04-23 23:06:40.208 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:40.208 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:40.209 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:40.209 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:06:40.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.210 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:40.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:40.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.211 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.917343ms
[DEBUG] 2024-04-23 23:06:40.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:06:40.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.219 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.220 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.223 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:40.223 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:40.223 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.223 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.340313ms
[DEBUG] 2024-04-23 23:06:40.223 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.223 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:40.223 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:06:40.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:40.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.229 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db5
[WARN ] 2024-04-23 23:06:40.229 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:06:40.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:40.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:40.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:40.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:06:40.231 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:40.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:06:40.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:40.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:06:40.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:40.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.245 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.247 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713910000207 end=1713910000247 duration=40 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:40.249 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:06:40.249 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:46361]
[INFO ] 2024-04-23 23:06:40.249 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:46361)
[INFO ] 2024-04-23 23:06:40.250 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:46361) current connections: 3
[DEBUG] 2024-04-23 23:06:40.250 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:40.250 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910000250 end=1713910000250 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=8 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:40.251 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:40.251 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:40.251 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 8: source:127.0.0.1 get_table_metas : tbl=hive.*.*tblfoo*
[INFO ] 2024-04-23 23:06:40.251 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*tblfoo*	
[INFO ] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 8: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361;create=true
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361;create=true
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@554d09a8, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:06:40.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:06:40.254 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@554d09a8, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@8dfae1d created in the thread with id: 111
[DEBUG] 2024-04-23 23:06:40.254 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.254 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.254 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.257 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.257 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.257 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:06:40.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:06:40.258 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@554d09a8 from thread id: 111
[DEBUG] 2024-04-23 23:06:40.258 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.258 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableName.matches(:param2) ) &&  (tableType == :param3 || tableType == :param4 ) params: hive, (?i).*tblfoo.*, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:06:40.266 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.267 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.267 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713910000251 end=1713910000267 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=8 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:40.267 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: *tblfoo* found: 0
[INFO ] 2024-04-23 23:06:40.267 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 2
[DEBUG] 2024-04-23 23:06:40.267 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:40.267 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:40.267 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:40.267 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 8: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:06:40.267 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:06:40.268 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:06:40.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@554d09a8, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@8dfae1d will be shutdown
[DEBUG] 2024-04-23 23:06:40.268 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5
[DEBUG] 2024-04-23 23:06:40.268 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 8: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:06:40.268 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5	
[INFO ] 2024-04-23 23:06:40.268 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:06:40.268 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713910000267 end=1713910000268 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=8 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:40.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:06:40.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.268 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:06:40.268 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 8: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:06:40.268 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:06:40.269 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.266381ms + 0.029304ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:06:40.271 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.852862ms + 0.23437ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:06:40.272 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.312198ms + 0.585757ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:06:40.273 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.353146ms + 0.364941ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:40.274 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.322502ms + 0.286851ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:06:40.274 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.323419ms + 0.205748ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:40.275 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.355176ms + 0.276713ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:40.276 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.331386ms + 0.206364ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:40.277 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.406589ms + 0.564104ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:40.277 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.347471ms + 0.207972ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:06:40.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:40.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 9.528963ms
[DEBUG] 2024-04-23 23:06:40.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.278 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.278 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910000267 end=1713910000278 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:40.281 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:06:40.281 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:46361]
[INFO ] 2024-04-23 23:06:40.281 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:46361)
[INFO ] 2024-04-23 23:06:40.281 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:46361) current connections: 3
[DEBUG] 2024-04-23 23:06:40.282 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:40.282 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910000282 end=1713910000282 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=9 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:40.282 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:40.282 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:40.282 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: source:127.0.0.1 get_table_metas : tbl=hive.*.tbl5*
[INFO ] 2024-04-23 23:06:40.282 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.tbl5*	
[INFO ] 2024-04-23 23:06:40.283 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:06:40.283 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:06:40.283 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:40.283 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:40.283 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:06:40.283 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:06:40.283 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361;create=true
[DEBUG] 2024-04-23 23:06:40.283 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:06:40.283 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:06:40.283 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:40.283 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:06:40.283 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:06:40.283 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:06:40.283 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361;create=true
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4d92726, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4d92726, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@351705d1 created in the thread with id: 112
[DEBUG] 2024-04-23 23:06:40.284 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.285 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.285 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.287 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.288 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.288 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:06:40.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:06:40.288 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4d92726 from thread id: 112
[DEBUG] 2024-04-23 23:06:40.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableName.matches(:param2) ) &&  (tableType == :param3 || tableType == :param4 ) params: hive, (?i)tbl5.*, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:06:40.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.296 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.296 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713910000282 end=1713910000296 duration=14 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=9 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:40.296 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: tbl5* found: 0
[INFO ] 2024-04-23 23:06:40.296 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 2
[DEBUG] 2024-04-23 23:06:40.296 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:40.296 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:40.297 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:40.297 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:06:40.297 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:06:40.297 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:06:40.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4d92726, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@351705d1 will be shutdown
[DEBUG] 2024-04-23 23:06:40.297 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5
[DEBUG] 2024-04-23 23:06:40.297 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:06:40.297 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:06:40.297 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:06:40.297 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713910000296 end=1713910000297 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=9 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:40.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:06:40.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.297 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:06:40.297 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:06:40.297 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:06:40.298 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.346001ms + 0.016792ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:06:40.300 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.88283ms + 0.163169ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:06:40.301 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.315629ms + 0.494903ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:06:40.302 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.294075ms + 0.386727ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:40.302 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.300503ms + 0.227528ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:06:40.303 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.307609ms + 0.264856ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:40.304 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.326554ms + 0.21912ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:40.304 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.33456ms + 0.223842ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:40.306 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.455799ms + 0.623282ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:40.306 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.388135ms + 0.236525ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:06:40.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:40.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 9.437544ms
[DEBUG] 2024-04-23 23:06:40.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.307 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.307 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910000297 end=1713910000307 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:40.308 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:40.308 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:40.308 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:06:40.308 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:06:40.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:06:40.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.312 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.313 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713910000308 end=1713910000313 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:40.313 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:40.313 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:40.313 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:06:40.313 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:06:40.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.318 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.318 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713910000313 end=1713910000318 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:40.318 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:40.318 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:40.318 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_database: db5
[INFO ] 2024-04-23 23:06:40.319 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db5	
[DEBUG] 2024-04-23 23:06:40.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.320 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:40.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:40.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.321 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 2.067769ms
[DEBUG] 2024-04-23 23:06:40.321 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713910000318 end=1713910000321 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:40.321 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=3, comments=HMS client
[DEBUG] 2024-04-23 23:06:40.321 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:40.321 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:40.321 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_tables_by_type: db=@hive#db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:40.321 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:40.321 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:40.322 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:40.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.323 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:40.323 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:40.323 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.323 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.996707ms
[DEBUG] 2024-04-23 23:06:40.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:40.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.328 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.329 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 4.849933ms
[DEBUG] 2024-04-23 23:06:40.329 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713910000321 end=1713910000329 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:40.329 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:40.329 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:40.329 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:06:40.329 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:06:40.329 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:40.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.332 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 3.302505ms
[DEBUG] 2024-04-23 23:06:40.332 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713910000329 end=1713910000332 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:40.332 [main] HiveMetaStoreClient - Selecting dropDatabase method for db5 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:06:40.332 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:06:40.333 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:40.333 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:40.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.334 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:40.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:40.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.334 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.383062ms
[DEBUG] 2024-04-23 23:06:40.334 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_multi_table : db=db5 tbls=tbl5
[INFO ] 2024-04-23 23:06:40.334 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db5 tbls=tbl5	
[DEBUG] 2024-04-23 23:06:40.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.340 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:40.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:40.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.153517ms
[DEBUG] 2024-04-23 23:06:40.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.340 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.340 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713910000333 end=1713910000340 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:40.340 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:40.340 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:40.340 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:06:40.341 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:06:40.341 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:40.341 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.341 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:40.342 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:40.342 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.342 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.993639ms
[DEBUG] 2024-04-23 23:06:40.342 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:06:40.342 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:06:40.342 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.342 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:40.342 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.342 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.525046ms
[DEBUG] 2024-04-23 23:06:40.342 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:06:40.342 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:06:40.342 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.352 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.356 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.356 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:06:40.356 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:06:40.356 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.360 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.364 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:06:40.364 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:06:40.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.385 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.389 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.389 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:40.389 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:40.389 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:40.389 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:06:40.389 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:40.390 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:40.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.390 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:40.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:40.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.098389ms
[DEBUG] 2024-04-23 23:06:40.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:40.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.576405ms
[DEBUG] 2024-04-23 23:06:40.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:40.393 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:40.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:40.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:40.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.975362ms
[DEBUG] 2024-04-23 23:06:40.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:06:40.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:06:40.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:40.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:40.394 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:40.395 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:06:40.411 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:06:40.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:40.420 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:40.420 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.420 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:40.422 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:40.424 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:40.426 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:40.428 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:40.430 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:40.432 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:40.432 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:40.433 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:40.433 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:06:40.434 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:06:42.434 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:06:42.434 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:06:42.435 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:42.435 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:42.436 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:42.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:42.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:42.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 2.264851ms
[DEBUG] 2024-04-23 23:06:42.437 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:06:42.437 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:06:42.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:42.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:42.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:42.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.977599ms
[DEBUG] 2024-04-23 23:06:42.438 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:06:42.438 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:06:42.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:42.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:42.441 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:06:42.441 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:06:42.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:42.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:42.443 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:06:42.443 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:06:42.443 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:42.444 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:42.444 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:42.444 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:42.444 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:42.445 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:42.445 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:42.445 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:42.445 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.95205ms
[DEBUG] 2024-04-23 23:06:42.445 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:42.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:42.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:42.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.531787ms
[DEBUG] 2024-04-23 23:06:42.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:42.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:42.448 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:42.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:42.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:42.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.101759ms
[DEBUG] 2024-04-23 23:06:42.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:06:42.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:06:42.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:42.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:42.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:42.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:06:42.450 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:06:42.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:42.451 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:42.451 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:42.451 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:42.451 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:42.451 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:42.451 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:42.451 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:42.452 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:42.452 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:42.452 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:42.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:42.452 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:42.453 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:06:42.453 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:06:44.454 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:06:44.454 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:06:44.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:44.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:44.457 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:44.458 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:44.458 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:44.458 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 3.564691ms
[DEBUG] 2024-04-23 23:06:44.458 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:06:44.458 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:06:44.458 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:44.458 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:06:44.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:44.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:44.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.733473ms
[DEBUG] 2024-04-23 23:06:44.459 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:06:44.459 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:06:44.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:44.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:44.461 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:06:44.461 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:06:44.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:44.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:44.461 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:06:44.461 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:06:44.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:44.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:44.462 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:44.462 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:44.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:44.463 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:44.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:44.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:44.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.924467ms
[DEBUG] 2024-04-23 23:06:44.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:44.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:44.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:44.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.554777ms
[DEBUG] 2024-04-23 23:06:44.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:44.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:44.466 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:44.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:44.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:44.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.910448ms
[DEBUG] 2024-04-23 23:06:44.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:06:44.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:06:44.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:44.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:44.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:44.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:06:44.468 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:06:44.468 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:44.468 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:44.468 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:44.468 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:44.468 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:44.469 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:44.469 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:44.469 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:44.469 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:44.469 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:44.469 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:44.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:44.470 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:44.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:06:44.470 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:06:46.471 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:06:46.471 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:06:46.471 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:46.471 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:46.474 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:46.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:46.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:46.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 3.733209ms
[DEBUG] 2024-04-23 23:06:46.475 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:06:46.475 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:06:46.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:46.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:46.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:46.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.299124ms
[DEBUG] 2024-04-23 23:06:46.477 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:06:46.477 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:06:46.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:46.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:46.478 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:06:46.478 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:06:46.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:46.479 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:46.479 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:06:46.480 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:06:46.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:46.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:46.481 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:46.481 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:46.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:46.481 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:46.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:46.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:46.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.021917ms
[DEBUG] 2024-04-23 23:06:46.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:46.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:46.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:46.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.622154ms
[DEBUG] 2024-04-23 23:06:46.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:46.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:46.484 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:46.484 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:46.484 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:46.484 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.024226ms
[DEBUG] 2024-04-23 23:06:46.484 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:06:46.484 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:06:46.484 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:46.484 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:46.485 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:46.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:06:46.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:06:46.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:46.487 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:46.487 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:46.487 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:46.487 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:46.487 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:46.487 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:46.488 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:46.488 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:46.488 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:46.488 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:46.488 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:46.489 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:46.489 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:06:46.489 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:06:48.034 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:06:48.039 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:06:48.491 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:06:48.491 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:06:48.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:48.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:48.494 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:48.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:48.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:48.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 2.449556ms
[DEBUG] 2024-04-23 23:06:48.494 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:06:48.494 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:06:48.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:48.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:48.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:48.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.498608ms
[DEBUG] 2024-04-23 23:06:48.494 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:06:48.495 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:06:48.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:48.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:48.496 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:06:48.497 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:06:48.497 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:48.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:48.498 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:06:48.498 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:06:48.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:48.499 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:48.499 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:48.499 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:48.499 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:48.500 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:48.500 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:48.500 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:48.500 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.950396ms
[DEBUG] 2024-04-23 23:06:48.500 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:48.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:48.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:48.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.546845ms
[DEBUG] 2024-04-23 23:06:48.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:48.502 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:48.502 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:48.503 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:48.503 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:48.503 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.934588ms
[DEBUG] 2024-04-23 23:06:48.503 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:06:48.503 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:06:48.503 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:48.503 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:48.504 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:48.504 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:06:48.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:06:48.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:48.506 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:48.506 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:48.506 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:48.506 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:48.506 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:48.506 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:48.506 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:48.506 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:48.507 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:48.507 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:48.507 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:48.507 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:48.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:06:48.508 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:06:50.509 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:06:50.509 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:06:50.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:50.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:50.512 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:50.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:50.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:50.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 3.826814ms
[DEBUG] 2024-04-23 23:06:50.513 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:06:50.513 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:06:50.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:50.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:50.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:50.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.976774ms
[DEBUG] 2024-04-23 23:06:50.516 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:06:50.516 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:06:50.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:50.517 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:50.517 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:06:50.518 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:06:50.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:50.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:50.518 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:06:50.518 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:06:50.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:50.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:50.520 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:50.520 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:50.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:50.520 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:50.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:50.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:50.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.991767ms
[DEBUG] 2024-04-23 23:06:50.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:50.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:50.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:50.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.59213ms
[DEBUG] 2024-04-23 23:06:50.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:50.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:50.523 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:50.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:50.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:50.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.003811ms
[DEBUG] 2024-04-23 23:06:50.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:06:50.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:06:50.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:50.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:50.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:50.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:06:50.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:06:50.526 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:50.526 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:50.526 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:50.526 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:50.526 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:50.526 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:50.526 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:50.526 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:50.526 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:50.527 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:50.527 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:50.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:50.527 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:50.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:06:50.528 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:06:52.529 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:06:52.529 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:06:52.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:52.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:52.532 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:52.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:52.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:52.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 3.742888ms
[DEBUG] 2024-04-23 23:06:52.533 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:06:52.533 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:06:52.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:52.534 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:52.534 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:52.534 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.789935ms
[DEBUG] 2024-04-23 23:06:52.534 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:06:52.534 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:06:52.534 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:52.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:52.536 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:06:52.536 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:06:52.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:52.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:52.537 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:06:52.537 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:06:52.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:52.538 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:52.538 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:52.538 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:52.538 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:52.539 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:52.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:52.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:52.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.989323ms
[DEBUG] 2024-04-23 23:06:52.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:52.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:52.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:52.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.594852ms
[DEBUG] 2024-04-23 23:06:52.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:52.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:52.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:52.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:06:52.567 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:06:52.567 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:52.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:52.572 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.590304ms + 0.012075ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  and "PARTITIONS"."PART_NAME" in (?,?,?)]
[DEBUG] 2024-04-23 23:06:52.578 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.386218ms + 0.011662ms, the query is [delete from "PART_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:06:52.580 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.001817ms + 0.010589ms, the query is [delete from "PART_COL_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:06:52.582 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.103873ms + 0.010388ms, the query is [delete from "PART_COL_STATS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:06:52.585 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.40641ms + 0.028973ms, the query is [delete from "PARTITION_PARAMS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:06:52.587 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.293415ms + 0.023458ms, the query is [delete from "PARTITION_KEY_VALS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:06:52.589 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.056024ms + 0.01064ms, the query is [delete from "PARTITIONS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:06:52.594 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.987901ms + 0.010336ms, the query is [delete from "SD_PARAMS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:06:52.596 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.280052ms + 0.029797ms, the query is [delete from "SORT_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:06:52.598 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.941843ms + 0.011681ms, the query is [delete from "BUCKETING_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:06:52.600 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.020964ms + 0.011823ms, the query is [delete from "SKEWED_COL_NAMES" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:06:52.604 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.360763ms + 0.010899ms, the query is [delete from "SDS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:06:52.606 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.856111ms + 0.010552ms, the query is [delete from "SERDE_PARAMS" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:06:52.608 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.440529ms + 0.01166ms, the query is [delete from "SERDES" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:06:52.612 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:52.613 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:52.613 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 45.042449ms
[DEBUG] 2024-04-23 23:06:52.613 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:52.613 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:06:52.613 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:06:52.613 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:52.614 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_table : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:06:52.614 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_table : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:06:52.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:52.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:52.615 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:52.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:52.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:52.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.097692ms
[DEBUG] 2024-04-23 23:06:52.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:52.616 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:52.616 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:52.616 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:52.616 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.004763ms
[DEBUG] 2024-04-23 23:06:52.616 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:52.616 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:06:52.616 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:06:52.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:06:52.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:52.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:52.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:52.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:52.634 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:52.634 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:52.634 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:06:52.634 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:06:52.635 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:06:52.635 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:06:52.635 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:06:52.643 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:52.648 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:06:52.648 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:06:52.648 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:06:52.648 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:06:52.648 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:06:52.654 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1143660448 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:52.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:06:52.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:06:52.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:06:52.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:06:52.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:06:52.660 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:06:52.660 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:06:52.668 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:06:52.668 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:06:52.668 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:06:52.668 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:06:52.677 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:06:52.677 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:06:52.677 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:06:52.677 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 23:06:52.677 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:06:52.678 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 23:06:52.683 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:06:52.686 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:06:52.686 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:06:52.686 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:06:52.701 [TThreadPoolServer WorkerProcess-%d] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:06:52.701 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:06:52.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:52.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:06:52.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:06:52.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:52.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:52.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:52.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:06:52.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:06:52.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:52.758 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:52.758 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:52.758 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:52.759 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:52.759 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:52.759 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:52.759 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:52.759 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:06:52.759 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:52.759 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:52.759 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:52.760 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1973513045 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:52.761 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:06:52.762 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db5
[DEBUG] 2024-04-23 23:06:52.762 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/46361/db5.db
[INFO ] 2024-04-23 23:06:52.763 [TThreadPoolServer WorkerProcess-%d] deprecation - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
[DEBUG] 2024-04-23 23:06:52.766 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:06:52.766 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db5
[DEBUG] 2024-04-23 23:06:52.766 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db
[DEBUG] 2024-04-23 23:06:52.767 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713910000340 end=1713910012767 duration=12427 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=6 error=false>
[INFO ] 2024-04-23 23:06:52.767 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 1
[DEBUG] 2024-04-23 23:06:52.767 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:52.767 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:52.767 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:06:52.767 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:06:52.767 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@44e72665, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2c634b34 will be shutdown
[DEBUG] 2024-04-23 23:06:52.767 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:06:52.768 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:06:52.768 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713910012767 end=1713910012768 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:52.768 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:06:52.768 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:06:52.768 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:06:52.768 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:06:52.768 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:06:52.769 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:06:52.769 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:06:52.776 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:06:52.776 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:06:52.776 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:06:52.777 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:06:52.778 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:06:52.817 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693;create=true
[INFO ] 2024-04-23 23:06:53.222 [MetaStoreThread-45693] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[INFO ] 2024-04-23 23:06:53.222 [main] MetaStoreTestUtils - Waiting the HMS to start.
[DEBUG] 2024-04-23 23:06:53.223 [MetaStoreThread-45693] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:06:53.223 [MetaStoreThread-45693] HMSHandler - 10: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:06:53.223 [MetaStoreThread-45693] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:06:53.223 [MetaStoreThread-45693] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:53.223 [MetaStoreThread-45693] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:53.223 [MetaStoreThread-45693] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:06:53.223 [MetaStoreThread-45693] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:06:53.223 [MetaStoreThread-45693] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693;create=true
[DEBUG] 2024-04-23 23:06:53.223 [MetaStoreThread-45693] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:06:53.223 [MetaStoreThread-45693] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:06:53.223 [MetaStoreThread-45693] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693;create=true
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:06:53.224 [MetaStoreThread-45693] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46361;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693;create=true
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 31
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 121
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:53.225 [MetaStoreThread-45693] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:53.226 [MetaStoreThread-45693] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:53.226 [MetaStoreThread-45693] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:53.226 [MetaStoreThread-45693] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:53.226 [MetaStoreThread-45693] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:53.226 [MetaStoreThread-45693] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:53.226 [MetaStoreThread-45693] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:53.226 [MetaStoreThread-45693] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:53.226 [MetaStoreThread-45693] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:53.226 [MetaStoreThread-45693] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:06:53.226 [MetaStoreThread-45693] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:06:53.226 [MetaStoreThread-45693] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:53.227 [MetaStoreThread-45693] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:06:53.227 [MetaStoreThread-45693] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:06:53.227 [MetaStoreThread-45693] HikariConfig - HikariPool-5 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:06:53.227 [MetaStoreThread-45693] HikariConfig - HikariPool-5 - configuration:
[DEBUG] 2024-04-23 23:06:53.228 [MetaStoreThread-45693] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:06:53.228 [MetaStoreThread-45693] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:06:53.228 [MetaStoreThread-45693] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:06:53.228 [MetaStoreThread-45693] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:06:53.228 [MetaStoreThread-45693] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:06:53.228 [MetaStoreThread-45693] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:06:53.228 [MetaStoreThread-45693] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:06:53.228 [MetaStoreThread-45693] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:06:53.228 [MetaStoreThread-45693] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:06:53.228 [MetaStoreThread-45693] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:06:53.228 [MetaStoreThread-45693] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:06:53.228 [MetaStoreThread-45693] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:06:53.228 [MetaStoreThread-45693] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:06:53.228 [MetaStoreThread-45693] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:06:53.228 [MetaStoreThread-45693] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:06:53.228 [MetaStoreThread-45693] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:06:53.228 [MetaStoreThread-45693] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:06:53.228 [MetaStoreThread-45693] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:06:53.228 [MetaStoreThread-45693] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693;create=true"
[DEBUG] 2024-04-23 23:06:53.229 [MetaStoreThread-45693] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:06:53.229 [MetaStoreThread-45693] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:06:53.229 [MetaStoreThread-45693] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:06:53.229 [MetaStoreThread-45693] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:06:53.229 [MetaStoreThread-45693] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:06:53.229 [MetaStoreThread-45693] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:06:53.229 [MetaStoreThread-45693] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:06:53.229 [MetaStoreThread-45693] HikariConfig - poolName........................"HikariPool-5"
[DEBUG] 2024-04-23 23:06:53.229 [MetaStoreThread-45693] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:06:53.229 [MetaStoreThread-45693] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:06:53.229 [MetaStoreThread-45693] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:06:53.229 [MetaStoreThread-45693] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:06:53.229 [MetaStoreThread-45693] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:06:53.229 [MetaStoreThread-45693] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:06:53.229 [MetaStoreThread-45693] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:06:53.229 [MetaStoreThread-45693] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:06:53.229 [MetaStoreThread-45693] HikariDataSource - HikariPool-5 - Starting...
[INFO ] 2024-04-23 23:06:53.231 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:06:53.231 [MetaStoreThread-45693] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:53.232 [MetaStoreThread-45693] HikariDataSource - HikariPool-5 - Start completed.
[DEBUG] 2024-04-23 23:06:53.332 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:06:53.334 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1730996539 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.335 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@638706432 (XID = 1157), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.336 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@394109927 (XID = 1159), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.337 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1178475599 (XID = 1161), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.338 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1816545956 (XID = 1163), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.339 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1114678984 (XID = 1165), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.340 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2139667530 (XID = 1167), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.342 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@481591571 (XID = 1169), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.343 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@690220880 (XID = 1171), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.343 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:06:53.459 [MetaStoreThread-45693] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:06:53.459 [MetaStoreThread-45693] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@53e7db27, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:06:53.459 [MetaStoreThread-45693] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:06:53.459 [MetaStoreThread-45693] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@53e7db27, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@51d1ca26 created in the thread with id: 115
[DEBUG] 2024-04-23 23:06:53.459 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.459 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.459 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.569 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.648 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1730996539 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.667 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1730996539 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.722 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1730996539 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.740 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1730996539 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.745 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1730996539 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.857 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1730996539 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.884 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1730996539 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.892 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1730996539 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.900 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1730996539 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.903 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.905 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.906 [MetaStoreThread-45693] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:06:53.906 [MetaStoreThread-45693] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:06:53.906 [MetaStoreThread-45693] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@53e7db27 from thread id: 115
[DEBUG] 2024-04-23 23:06:53.906 [MetaStoreThread-45693] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:06:53.906 [MetaStoreThread-45693] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:53.910 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.914 [MetaStoreThread-45693] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:53.914 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:53.914 [MetaStoreThread-45693] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:06:53.914 [MetaStoreThread-45693] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:53.915 [MetaStoreThread-45693] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:53.915 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.915 [MetaStoreThread-45693] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:53.916 [MetaStoreThread-45693] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:53.919 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.919 [MetaStoreThread-45693] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:53.922 [MetaStoreThread-45693] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:53.922 [MetaStoreThread-45693] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:53.922 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.922 [MetaStoreThread-45693] ObjectStore - db details for db default retrieved using SQL in 3.015774ms
[DEBUG] 2024-04-23 23:06:53.922 [MetaStoreThread-45693] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:06:53.922 [MetaStoreThread-45693] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:06:53.923 [MetaStoreThread-45693] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:53.928 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.930 [MetaStoreThread-45693] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:53.931 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.933 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:53.933 [MetaStoreThread-45693] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:06:53.933 [MetaStoreThread-45693] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:53.933 [MetaStoreThread-45693] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:53.937 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.940 [MetaStoreThread-45693] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:53.943 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1730996539 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.944 [MetaStoreThread-45693] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:53.945 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:53.945 [MetaStoreThread-45693] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:06:53.945 [MetaStoreThread-45693] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:53.945 [MetaStoreThread-45693] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:53.945 [MetaStoreThread-45693] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:53.946 [MetaStoreThread-45693] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:53.946 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:53.946 [MetaStoreThread-45693] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:06:53.947 [MetaStoreThread-45693] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:53.947 [MetaStoreThread-45693] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:53.947 [MetaStoreThread-45693] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:53.947 [MetaStoreThread-45693] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:53.951 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1730996539 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.954 [MetaStoreThread-45693] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:53.956 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1730996539 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:53.957 [MetaStoreThread-45693] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:53.958 [MetaStoreThread-45693] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:53.958 [MetaStoreThread-45693] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:06:53.958 [MetaStoreThread-45693] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:06:53.959 [MetaStoreThread-45693] PerfLogger - </PERFLOG method=init start=1713910013223 end=1713910013958 duration=735 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=10 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:53.959 [MetaStoreThread-45693] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:06:53.959 [MetaStoreThread-45693] HiveMetaStore - Started the new metaserver on port [45693]...
[INFO ] 2024-04-23 23:06:53.959 [MetaStoreThread-45693] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:06:53.959 [MetaStoreThread-45693] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:06:53.959 [MetaStoreThread-45693] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:06:53.959 [MetaStoreThread-45693] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:06:53.959 [MetaStoreThread-45693] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:06:53.959 [MetaStoreThread-45693] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:06:53.959 [MetaStoreThread-45693] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:06:53.959 [MetaStoreThread-45693] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:06:53.959 [MetaStoreThread-45693] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:06:53.959 [MetaStoreThread-45693] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:06:53.959 [MetaStoreThread-45693] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:06:53.959 [MetaStoreThread-45693] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:06:53.959 [MetaStoreThread-45693] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:06:53.959 [MetaStoreThread-45693] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:06:53.959 [MetaStoreThread-45693] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:06:53.959 [MetaStoreThread-45693] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:06:54.225 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:06:54.226 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 11: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:06:54.226 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:06:54.238 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45693) is created
[INFO ] 2024-04-23 23:06:54.238 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 45693 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45693 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693;create=true
[INFO ] 2024-04-23 23:06:54.238 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:06:54.248 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:06:54.248 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:45693]
[INFO ] 2024-04-23 23:06:54.249 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:45693)
[INFO ] 2024-04-23 23:06:54.249 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:45693) current connections: 2
[DEBUG] 2024-04-23 23:06:54.250 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:54.251 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910014250 end=1713910014251 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:54.252 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:54.252 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:54.252 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 create_database: Database(name:db_repl2, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:06:54.252 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db_repl2, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:06:54.254 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693;create=true
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:06:54.255 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693;create=true
[DEBUG] 2024-04-23 23:06:54.256 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:06:54.256 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:06:54.256 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:06:54.256 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:54.256 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:06:54.256 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:06:54.256 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:06:54.256 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:06:54.256 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:54.256 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:06:54.256 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:06:54.256 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4d0a4329, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:06:54.256 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:06:54.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4d0a4329, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@32a9b211 created in the thread with id: 132
[DEBUG] 2024-04-23 23:06:54.258 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.258 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.259 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.264 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.266 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.266 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:06:54.266 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:06:54.266 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4d0a4329 from thread id: 132
[DEBUG] 2024-04-23 23:06:54.266 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:54.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:54.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:54.268 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 2.330556ms
[DEBUG] 2024-04-23 23:06:54.269 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db_repl2, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:06:54.269 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:06:54.269 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:54.271 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:54.271 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.272 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:06:54.272 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:54.272 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:54.272 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:54.272 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:06:54.272 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db
[INFO ] 2024-04-23 23:06:54.273 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db
[INFO ] 2024-04-23 23:06:54.278 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db
[DEBUG] 2024-04-23 23:06:54.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:54.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:54.283 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.284 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713910014252 end=1713910014284 duration=32 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:54.285 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:54.285 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:54.285 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 create_table_req: Table(tableName:tbl_repl2, dbName:db_repl2, owner:alex, createTime:1713910014, lastAccessTime:1713910014, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:s, type:string, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:l, type:bigint, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:06:54.285 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl_repl2, dbName:db_repl2, owner:alex, createTime:1713910014, lastAccessTime:1713910014, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:s, type:string, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:l, type:bigint, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:06:54.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:54.290 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:54.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:54.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:54.290 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 5.147873ms
[DEBUG] 2024-04-23 23:06:54.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:54.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:06:54.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:54.297 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:54.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.298 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:54.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:54.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.185379ms
[DEBUG] 2024-04-23 23:06:54.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:54.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:06:54.299 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:54.299 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.299 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:54.299 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:54.299 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:54.299 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:06:54.299 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45693/db_repl2.db/tbl_repl2
[DEBUG] 2024-04-23 23:06:54.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:54.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:54.311 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1730996539 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.315 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1730996539 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.319 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1730996539 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.324 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1730996539 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:54.339 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.340 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713910014285 end=1713910014339 duration=54 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:54.340 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:54.340 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:54.340 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 add_partition : tbl=hive.db_repl2.tbl_repl2
[INFO ] 2024-04-23 23:06:54.340 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db_repl2.tbl_repl2	
[DEBUG] 2024-04-23 23:06:54.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:54.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:54.341 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:06:54.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:54.386 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.386 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.394 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.395 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:54.395 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:54.395 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:54.395 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:06:54.395 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45693/db_repl2.db/tbl_repl2/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:06:54.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:54.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:06:54.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:54.404 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1730996539 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:54.416 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.418 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910014340 end=1713910014418 duration=78 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:54.418 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:54.418 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:54.418 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 add_partition : tbl=hive.db_repl2.tbl_repl2
[INFO ] 2024-04-23 23:06:54.418 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db_repl2.tbl_repl2	
[DEBUG] 2024-04-23 23:06:54.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:54.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:54.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:06:54.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:54.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.426 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.426 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:54.426 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:54.426 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:54.426 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:06:54.426 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45693/db_repl2.db/tbl_repl2/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:06:54.431 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.431 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:54.431 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:06:54.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:54.435 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.435 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:54.438 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.439 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910014418 end=1713910014439 duration=21 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:54.439 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:54.440 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:54.440 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 add_partition : tbl=hive.db_repl2.tbl_repl2
[INFO ] 2024-04-23 23:06:54.440 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db_repl2.tbl_repl2	
[DEBUG] 2024-04-23 23:06:54.440 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:54.440 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.440 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:54.440 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:06:54.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:54.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.447 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:54.447 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:54.447 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:54.447 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:06:54.447 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45693/db_repl2.db/tbl_repl2/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:06:54.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:54.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:06:54.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:54.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:54.457 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.458 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910014440 end=1713910014458 duration=18 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:54.459 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:54.459 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:54.459 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713910014459 end=1713910014459 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:54.459 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:54.459 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:54.459 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_table : tbl=hive.db_repl2.tbl_repl2
[INFO ] 2024-04-23 23:06:54.459 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db_repl2.tbl_repl2	
[DEBUG] 2024-04-23 23:06:54.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:54.460 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:54.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:54.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:54.461 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.190289ms
[DEBUG] 2024-04-23 23:06:54.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:54.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:06:54.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:54.467 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:54.468 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:06:54.468 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713910014459 end=1713910014468 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:54.468 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=9, comments=HMS client
[DEBUG] 2024-04-23 23:06:54.469 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:54.469 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:54.469 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_partitions : tbl=hive.db_repl2.tbl_repl2
[INFO ] 2024-04-23 23:06:54.469 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db_repl2.tbl_repl2	
[DEBUG] 2024-04-23 23:06:54.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:06:54.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:54.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.474 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.815072ms + 0.013527ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:06:54.478 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.51071ms + 0.096188ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:06:54.481 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.059875ms + 0.347615ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:06:54.483 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.923866ms + 0.223267ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:54.485 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.999187ms + 0.136409ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:06:54.487 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.849764ms + 0.141685ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:54.489 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.810419ms + 0.13142ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:54.491 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.744162ms + 0.133502ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:54.493 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.914404ms + 0.313038ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:54.496 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.980604ms + 0.13725ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:06:54.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:54.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 26.467095ms
[DEBUG] 2024-04-23 23:06:54.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:54.496 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.496 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910014469 end=1713910014496 duration=27 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:54.497 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:54.497 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:54.497 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 alter_table: hive.db_repl2.tbl_repl2 newtbl=tbl_repl2
[INFO ] 2024-04-23 23:06:54.498 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db_repl2.tbl_repl2 newtbl=tbl_repl2	
[DEBUG] 2024-04-23 23:06:54.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:54.499 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:54.499 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:54.499 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:54.499 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.499 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.477026ms
[DEBUG] 2024-04-23 23:06:54.499 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:54.499 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:54.499 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:54.499 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:06:54.499 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:54.500 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:54.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:54.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:54.501 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.406152ms
[DEBUG] 2024-04-23 23:06:54.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:54.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:06:54.503 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.507 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:54.508 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:54.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.510 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:54.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:54.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.251852ms
[DEBUG] 2024-04-23 23:06:54.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:54.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:06:54.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:54.517 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.517 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db_repl2
[WARN ] 2024-04-23 23:06:54.517 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:06:54.517 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.517 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:54.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:54.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:54.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:06:54.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:54.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:06:54.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:54.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:06:54.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:54.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:54.530 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.531 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713910014497 end=1713910014531 duration=34 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:54.532 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:54.532 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:54.532 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_database: db_repl2
[INFO ] 2024-04-23 23:06:54.532 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db_repl2	
[DEBUG] 2024-04-23 23:06:54.532 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:54.533 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:54.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:54.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:54.533 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.337157ms
[DEBUG] 2024-04-23 23:06:54.533 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713910014532 end=1713910014533 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:54.534 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=3, comments=HMS client
[DEBUG] 2024-04-23 23:06:54.534 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:54.534 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:54.534 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 alter_database @hive#db_repl2
[INFO ] 2024-04-23 23:06:54.534 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_database @hive#db_repl2	
[DEBUG] 2024-04-23 23:06:54.534 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:06:54.534 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:06:54.534 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:06:54.534 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:06:54.534 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:54.535 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:54.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:54.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:54.536 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.445665ms
[DEBUG] 2024-04-23 23:06:54.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:54.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:54.541 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.541 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_database start=1713910014534 end=1713910014541 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:54.542 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:06:54.542 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:45693]
[INFO ] 2024-04-23 23:06:54.543 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:45693)
[INFO ] 2024-04-23 23:06:54.543 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:45693) current connections: 3
[DEBUG] 2024-04-23 23:06:54.543 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:54.543 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910014543 end=1713910014543 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=13 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:54.544 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:54.544 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:54.544 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 13: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:06:54.544 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 13: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693;create=true
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693;create=true
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:06:54.545 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:06:54.546 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:06:54.546 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:06:54.546 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:06:54.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2f14bc51, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:06:54.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:06:54.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2f14bc51, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@45c789c3 created in the thread with id: 142
[DEBUG] 2024-04-23 23:06:54.546 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.546 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.546 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.549 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.549 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.549 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:06:54.549 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:06:54.549 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2f14bc51 from thread id: 142
[DEBUG] 2024-04-23 23:06:54.549 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:54.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:06:54.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:54.555 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.555 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713910014544 end=1713910014555 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=13 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:54.555 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:06:54.556 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 2
[DEBUG] 2024-04-23 23:06:54.556 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:54.556 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:54.556 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:06:54.556 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 13: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:06:54.556 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:06:54.556 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:06:54.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2f14bc51, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@45c789c3 will be shutdown
[DEBUG] 2024-04-23 23:06:54.556 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_partitions : tbl=hive.db_repl2.tbl_repl2
[INFO ] 2024-04-23 23:06:54.556 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db_repl2.tbl_repl2	
[DEBUG] 2024-04-23 23:06:54.556 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 13: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:06:54.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[INFO ] 2024-04-23 23:06:54.556 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:06:54.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:54.556 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713910014556 end=1713910014556 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=13 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:54.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:54.556 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:06:54.556 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 13: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:06:54.556 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:06:54.557 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.198096ms + 0.012833ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:06:54.559 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.016536ms + 0.137383ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:06:54.560 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.328674ms + 0.505782ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:06:54.561 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.282218ms + 0.293325ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:54.561 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.268593ms + 0.259109ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:06:54.562 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.280062ms + 0.235453ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:54.562 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.304575ms + 0.188737ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:54.563 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.290919ms + 0.165487ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:54.564 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.341414ms + 0.416787ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:06:54.564 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.325706ms + 0.171277ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:06:54.564 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:54.564 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:54.564 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 8.319312ms
[DEBUG] 2024-04-23 23:06:54.564 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:54.565 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:54.565 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910014556 end=1713910014565 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:08.999 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:07:14.459 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:07:18.035 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:07:18.039 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:07:23.332 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:07:24.569 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:07:24.569 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:45693]
[INFO ] 2024-04-23 23:07:24.569 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:45693)
[INFO ] 2024-04-23 23:07:24.569 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:45693) current connections: 3
[DEBUG] 2024-04-23 23:07:24.570 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:24.570 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910044570 end=1713910044570 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:24.570 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:24.571 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:24.571 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:07:24.571 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693;create=true
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693;create=true
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1b0c16c4, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:07:24.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1b0c16c4, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@627575 created in the thread with id: 143
[DEBUG] 2024-04-23 23:07:24.573 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:24.573 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:24.573 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:24.574 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:24.575 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:24.575 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:07:24.575 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:07:24.575 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1b0c16c4 from thread id: 143
[DEBUG] 2024-04-23 23:07:24.575 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:24.575 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:07:24.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:24.577 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:24.577 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713910044571 end=1713910044577 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[INFO ] 2024-04-23 23:07:24.577 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:07:24.577 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 2
[DEBUG] 2024-04-23 23:07:24.577 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:24.577 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:24.577 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:24.577 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:07:24.577 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:07:24.577 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:07:24.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1b0c16c4, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@627575 will be shutdown
[DEBUG] 2024-04-23 23:07:24.577 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_partitions : tbl=hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:07:24.578 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:07:24.578 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:07:24.578 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db_repl2.tbl_repl2	
[DEBUG] 2024-04-23 23:07:24.578 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713910044577 end=1713910044578 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:24.578 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:07:24.578 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:24.578 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:24.578 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:07:24.578 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:07:24.578 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:07:24.579 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.181793ms + 0.007033ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:07:24.580 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.626065ms + 0.102877ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:07:24.581 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.247656ms + 0.314119ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:07:24.581 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.219403ms + 0.213496ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:07:24.582 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.209149ms + 0.136159ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:07:24.582 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.198955ms + 0.137889ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:07:24.582 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.196316ms + 0.124855ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:07:24.583 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.190089ms + 0.11939ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:07:24.583 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.258029ms + 0.330173ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:07:24.584 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.215569ms + 0.131356ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:07:24.584 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:24.584 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:24.584 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 6.065467ms
[DEBUG] 2024-04-23 23:07:24.584 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:24.584 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:24.584 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910044577 end=1713910044584 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:24.585 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:24.585 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:24.585 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:07:24.585 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:07:24.585 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:07:24.585 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:24.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:24.587 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:24.587 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713910044585 end=1713910044587 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:24.588 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:24.588 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:24.588 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:07:24.588 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:07:24.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:24.590 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:24.591 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:24.591 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713910044588 end=1713910044591 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:24.591 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:24.591 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:24.591 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_database: db_repl2
[INFO ] 2024-04-23 23:07:24.591 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db_repl2	
[DEBUG] 2024-04-23 23:07:24.591 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:24.592 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:24.592 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:24.592 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:24.592 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:24.592 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.148981ms
[DEBUG] 2024-04-23 23:07:24.592 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713910044591 end=1713910044592 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:24.592 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=1, comments=HMS client
[DEBUG] 2024-04-23 23:07:24.593 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:24.593 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:24.593 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_tables_by_type: db=@hive#db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:07:24.593 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:07:24.593 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:07:24.593 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:07:24.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:24.594 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:24.594 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:24.594 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:24.594 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:24.594 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.149494ms
[DEBUG] 2024-04-23 23:07:24.594 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:24.598 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:24.598 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:24.598 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:24.598 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 4.422704ms
[DEBUG] 2024-04-23 23:07:24.598 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713910044593 end=1713910044598 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:24.599 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:24.599 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:24.600 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:07:24.600 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:07:24.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:24.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:24.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:24.604 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:24.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 4.320486ms
[DEBUG] 2024-04-23 23:07:24.604 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713910044599 end=1713910044604 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:24.604 [main] HiveMetaStoreClient - Selecting dropDatabase method for db_repl2 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:07:24.604 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:07:24.604 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:24.605 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:24.605 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:24.606 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:24.606 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:24.606 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:24.606 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:24.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.906299ms
[DEBUG] 2024-04-23 23:07:24.607 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_multi_table : db=db_repl2 tbls=tbl_repl2
[INFO ] 2024-04-23 23:07:24.607 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db_repl2 tbls=tbl_repl2	
[DEBUG] 2024-04-23 23:07:24.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:24.613 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:24.614 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:24.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:24.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:24.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.750368ms
[DEBUG] 2024-04-23 23:07:24.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:24.615 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:24.615 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713910044605 end=1713910044615 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:24.616 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:24.616 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:24.616 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:07:24.616 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:07:24.616 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:24.616 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:24.617 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:24.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:24.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:24.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.54365ms
[DEBUG] 2024-04-23 23:07:24.618 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:07:24.618 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:07:24.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:24.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:24.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:24.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.906035ms
[DEBUG] 2024-04-23 23:07:24.619 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:07:24.619 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:07:24.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:24.628 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1730996539 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:24.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:24.631 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:07:24.631 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:07:24.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:24.635 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1730996539 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:24.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:24.640 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:07:24.640 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:07:24.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:24.670 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1730996539 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:24.674 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:24.674 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:07:24.674 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:07:24.674 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:07:24.674 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:07:24.674 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:07:24.674 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:07:24.674 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:24.675 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:24.675 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:24.675 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:24.675 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.277282ms
[DEBUG] 2024-04-23 23:07:24.676 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:24.676 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:24.676 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:24.676 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.486375ms
[DEBUG] 2024-04-23 23:07:24.676 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:24.677 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:24.677 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:24.677 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:24.677 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:24.677 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.848466ms
[DEBUG] 2024-04-23 23:07:24.677 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:07:24.678 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:07:24.678 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:24.678 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:24.679 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:24.679 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:07:24.696 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1730996539 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:24.699 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:07:24.705 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:24.705 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:07:24.705 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:24.706 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:24.708 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:24.710 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:24.712 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:24.714 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:24.716 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:24.717 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:07:24.717 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:24.717 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:24.719 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:24.719 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:07:24.719 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:07:26.720 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:07:26.721 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:07:26.721 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:26.721 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:26.724 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:26.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:26.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:26.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 4.393966ms
[DEBUG] 2024-04-23 23:07:26.725 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:07:26.725 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:07:26.726 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:26.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:26.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:26.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.300495ms
[DEBUG] 2024-04-23 23:07:26.727 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:07:26.727 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:07:26.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:26.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:26.729 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:07:26.729 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:07:26.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:26.730 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:26.730 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:07:26.730 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:07:26.730 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:26.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:26.731 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:07:26.731 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:07:26.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:26.732 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:26.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:26.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:26.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.99219ms
[DEBUG] 2024-04-23 23:07:26.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:26.733 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:26.733 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:26.733 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.472259ms
[DEBUG] 2024-04-23 23:07:26.733 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:26.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:26.734 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:26.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:26.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:26.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.915943ms
[DEBUG] 2024-04-23 23:07:26.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:07:26.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:07:26.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:26.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:26.736 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:26.736 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:07:26.736 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:07:26.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:26.737 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:07:26.737 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:26.737 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:26.737 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:26.737 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:26.737 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:26.738 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:26.738 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:26.738 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:07:26.738 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:26.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:26.739 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:26.739 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:07:26.740 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:07:28.740 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:07:28.740 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:07:28.740 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:28.740 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:28.741 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:28.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:28.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:28.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.078249ms
[DEBUG] 2024-04-23 23:07:28.741 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:07:28.741 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:07:28.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:28.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:28.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:28.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.503563ms
[DEBUG] 2024-04-23 23:07:28.742 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:07:28.742 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:07:28.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:28.743 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:28.743 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:07:28.743 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:07:28.743 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:28.744 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:28.744 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:07:28.744 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:07:28.744 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:28.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:28.745 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:07:28.745 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:07:28.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:28.746 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:28.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:28.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:28.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.867502ms
[DEBUG] 2024-04-23 23:07:28.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:28.747 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:28.747 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:28.747 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.694297ms
[DEBUG] 2024-04-23 23:07:28.747 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:28.748 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:28.749 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:28.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:28.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:28.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.959424ms
[DEBUG] 2024-04-23 23:07:28.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:07:28.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:07:28.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:28.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:28.750 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:28.750 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:07:28.751 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:07:28.751 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:28.752 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:07:28.752 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:28.752 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:28.752 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:28.752 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:28.752 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:28.752 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:28.752 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:28.752 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:07:28.752 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:28.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:28.754 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:28.754 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:07:28.755 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:07:30.755 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:07:30.755 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:07:30.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:30.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:30.757 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:30.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:30.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:30.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.437212ms
[DEBUG] 2024-04-23 23:07:30.757 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:07:30.757 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:07:30.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:30.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:30.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:30.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.628098ms
[DEBUG] 2024-04-23 23:07:30.758 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:07:30.758 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:07:30.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:30.759 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:30.760 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:07:30.760 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:07:30.760 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:30.761 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:30.761 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:07:30.761 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:07:30.761 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:30.762 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:30.762 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:07:30.762 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:07:30.762 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:30.763 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:30.763 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:30.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:30.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.47863ms
[DEBUG] 2024-04-23 23:07:30.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:30.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:30.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:30.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.753682ms
[DEBUG] 2024-04-23 23:07:30.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:30.765 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:30.766 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:30.767 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:30.767 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:30.767 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.385766ms
[DEBUG] 2024-04-23 23:07:30.767 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:07:30.767 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:07:30.767 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:30.767 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:30.768 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:30.769 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:07:30.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:07:30.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:30.771 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:07:30.771 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:30.771 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:30.771 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:30.771 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:30.771 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:30.771 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:30.771 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:30.771 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:07:30.772 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:30.772 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:30.773 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:30.773 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:07:30.774 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:07:32.774 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:07:32.775 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:07:32.775 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:32.775 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:32.778 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:32.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:32.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:32.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 3.708265ms
[DEBUG] 2024-04-23 23:07:32.779 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:07:32.779 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:07:32.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:32.780 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:32.780 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:32.780 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.793363ms
[DEBUG] 2024-04-23 23:07:32.780 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:07:32.780 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:07:32.780 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:32.781 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:32.781 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:07:32.782 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:07:32.782 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:32.783 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:32.783 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:07:32.783 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:07:32.783 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:32.784 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:32.784 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:07:32.784 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:07:32.784 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:32.785 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:32.785 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:32.785 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:32.785 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.004701ms
[DEBUG] 2024-04-23 23:07:32.785 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:32.786 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:32.786 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:32.786 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.49973ms
[DEBUG] 2024-04-23 23:07:32.786 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:32.786 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:32.787 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:32.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:32.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:32.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.889715ms
[DEBUG] 2024-04-23 23:07:32.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:07:32.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:07:32.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:32.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:32.788 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:32.788 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:07:32.789 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:07:32.790 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:32.790 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:07:32.790 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:32.790 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:32.790 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:32.790 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:32.790 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:32.790 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:32.790 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:32.790 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:07:32.790 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:32.791 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:32.792 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:32.792 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:07:32.792 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:07:34.793 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:07:34.793 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:07:34.793 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:34.793 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:34.795 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:34.796 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:34.796 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:34.796 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 2.467468ms
[DEBUG] 2024-04-23 23:07:34.796 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:07:34.796 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:07:34.796 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:34.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:34.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:34.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.183805ms
[DEBUG] 2024-04-23 23:07:34.797 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:07:34.797 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:07:34.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:34.801 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:34.801 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:07:34.801 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:07:34.801 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:34.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:34.804 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:07:34.804 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:07:34.804 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:34.806 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:34.807 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:07:34.807 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:07:34.807 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:34.809 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:34.810 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:34.810 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:34.811 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 3.258542ms
[DEBUG] 2024-04-23 23:07:34.811 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:34.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:34.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:34.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 1.720588ms
[DEBUG] 2024-04-23 23:07:34.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:34.815 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:34.817 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:34.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:34.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:34.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 3.382951ms
[DEBUG] 2024-04-23 23:07:34.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:07:34.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:07:34.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:34.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:34.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:34.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:07:34.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:07:34.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:34.823 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:07:34.823 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:34.823 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:34.823 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:34.823 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:34.823 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:34.823 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:34.824 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:34.824 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:07:34.824 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:34.824 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:34.825 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:34.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:07:34.825 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:07:36.826 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:07:36.826 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:07:36.826 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:36.826 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:36.828 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:36.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:36.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:36.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 2.886698ms
[DEBUG] 2024-04-23 23:07:36.829 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:07:36.829 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:07:36.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:36.831 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:36.831 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:36.831 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.173049ms
[DEBUG] 2024-04-23 23:07:36.831 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:07:36.831 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:07:36.831 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:36.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:36.833 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:07:36.833 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:07:36.833 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:36.833 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:36.834 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:07:36.834 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:07:36.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:36.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:36.835 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:07:36.835 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:07:36.835 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:36.836 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:36.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:36.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:36.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.292936ms
[DEBUG] 2024-04-23 23:07:36.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:36.837 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:36.837 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:36.837 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.657913ms
[DEBUG] 2024-04-23 23:07:36.837 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:36.837 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:36.838 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:36.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:36.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:36.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.835665ms
[DEBUG] 2024-04-23 23:07:36.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:07:36.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:07:36.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:36.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:36.839 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:36.840 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:07:36.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:07:36.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:36.841 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:07:36.842 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:36.842 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:36.842 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:36.842 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:36.842 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:36.842 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:36.842 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:36.842 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:07:36.842 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:36.842 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:36.844 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:36.844 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:07:36.844 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:07:38.845 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:07:38.845 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:07:38.845 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:38.846 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:38.848 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:38.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:38.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:38.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 3.455506ms
[DEBUG] 2024-04-23 23:07:38.849 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:07:38.849 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:07:38.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:38.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:38.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:38.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.343571ms
[DEBUG] 2024-04-23 23:07:38.851 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:07:38.851 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:07:38.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:38.852 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:38.852 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:07:38.852 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:07:38.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:38.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:38.853 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:07:38.853 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:07:38.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:38.854 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:38.854 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:07:38.854 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:07:38.854 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:38.855 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:38.855 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:38.855 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:38.855 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.999021ms
[DEBUG] 2024-04-23 23:07:38.855 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:38.856 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:38.856 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:38.856 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.529589ms
[DEBUG] 2024-04-23 23:07:38.856 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:38.857 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:38.858 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:38.858 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:38.858 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:38.858 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.983122ms
[DEBUG] 2024-04-23 23:07:38.858 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:07:38.858 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:07:38.858 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:38.858 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:38.859 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:38.859 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:07:38.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:07:38.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:38.860 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:07:38.860 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:38.860 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:38.860 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:38.861 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:38.861 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:38.861 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:38.861 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:38.861 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:07:38.861 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:38.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:38.862 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:38.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:07:38.862 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:07:38.999 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:07:40.863 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:07:40.863 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:07:40.863 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:40.863 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:40.867 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:40.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:40.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:40.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 3.864795ms
[DEBUG] 2024-04-23 23:07:40.867 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:07:40.867 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:07:40.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:40.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:40.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:40.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.549214ms
[DEBUG] 2024-04-23 23:07:40.868 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:07:40.868 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:07:40.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:40.869 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:40.869 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:07:40.870 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:07:40.870 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:40.870 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:40.870 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:07:40.870 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:07:40.870 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:40.871 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:40.871 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:07:40.871 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:07:40.871 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:40.872 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:40.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:40.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:40.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.077383ms
[DEBUG] 2024-04-23 23:07:40.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:40.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:40.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:40.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.478383ms
[DEBUG] 2024-04-23 23:07:40.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:40.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:40.874 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:40.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:40.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:40.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.775297ms
[DEBUG] 2024-04-23 23:07:40.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:07:40.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:07:40.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:40.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:40.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:40.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:07:40.876 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:07:40.876 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:40.876 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:07:40.876 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:40.876 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:40.877 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:40.877 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:40.877 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:40.877 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:40.877 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:40.877 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:07:40.877 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:40.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:40.879 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:40.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:07:40.879 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:07:42.880 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:07:42.880 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:07:42.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:42.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:42.883 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:42.884 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:42.884 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:42.884 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 3.464756ms
[DEBUG] 2024-04-23 23:07:42.884 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:07:42.884 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:07:42.884 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:42.885 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:42.885 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:42.885 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.31589ms
[DEBUG] 2024-04-23 23:07:42.886 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:07:42.886 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:07:42.886 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:42.887 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:42.887 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:07:42.887 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:07:42.887 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:42.888 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:42.888 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:07:42.888 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:07:42.888 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:42.888 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:42.889 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:07:42.889 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:07:42.889 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:42.889 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:42.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:42.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:42.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.827113ms
[DEBUG] 2024-04-23 23:07:42.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:42.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:42.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:42.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.441677ms
[DEBUG] 2024-04-23 23:07:42.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:42.891 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:42.891 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:42.891 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:42.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:42.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.814452ms
[DEBUG] 2024-04-23 23:07:42.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:07:42.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:07:42.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:42.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:42.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:42.893 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:07:42.893 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:07:42.894 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:42.894 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:07:42.894 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:42.894 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:42.894 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:42.894 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:42.894 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:42.894 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:42.894 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:42.895 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:07:42.895 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:42.895 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:42.896 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:42.896 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:07:42.896 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:07:44.460 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:07:44.897 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:07:44.897 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:07:44.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:44.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:44.900 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:44.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:44.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:44.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 3.328487ms
[DEBUG] 2024-04-23 23:07:44.901 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:07:44.901 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:07:44.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:44.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:44.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:44.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.520879ms
[DEBUG] 2024-04-23 23:07:44.901 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:07:44.901 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:07:44.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:44.903 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:44.903 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:07:44.903 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:07:44.903 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:44.904 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:44.904 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:07:44.904 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:07:44.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:44.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:44.906 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:07:44.906 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:07:44.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:44.907 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:44.907 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:44.907 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:44.907 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.326775ms
[DEBUG] 2024-04-23 23:07:44.907 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:44.908 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:44.908 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:44.908 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.503741ms
[DEBUG] 2024-04-23 23:07:44.908 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:44.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:44.909 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:44.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:44.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:44.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.841462ms
[DEBUG] 2024-04-23 23:07:44.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:07:44.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:07:44.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:44.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:44.910 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:44.910 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:07:44.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:07:44.912 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:44.912 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:07:44.912 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:44.912 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:44.912 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:44.912 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:44.912 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:44.912 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:44.912 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:07:44.912 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:07:44.912 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:44.912 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:44.913 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1571277491 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:44.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:07:44.914 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:07:44.914 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713910044616 end=1713910064914 duration=20298 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=-1 error=true>
[INFO ] 2024-04-23 23:07:44.915 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:07:44.915 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:07:44.915 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:07:44.915 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:07:44.922 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:07:44.922 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:07:44.922 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:07:44.922 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:07:44.924 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:07:44.955 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493;create=true
[INFO ] 2024-04-23 23:07:45.327 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:07:45.327 [MetaStoreThread-39493] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:07:45.327 [MetaStoreThread-39493] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] HMSHandler - 15: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493;create=true
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493;create=true
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45693;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493;create=true
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:07:45.328 [MetaStoreThread-39493] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:07:45.329 [MetaStoreThread-39493] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:07:45.329 [MetaStoreThread-39493] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:07:45.329 [MetaStoreThread-39493] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 120
[DEBUG] 2024-04-23 23:07:45.329 [MetaStoreThread-39493] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:07:45.329 [MetaStoreThread-39493] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:07:45.329 [MetaStoreThread-39493] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:07:45.329 [MetaStoreThread-39493] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:07:45.329 [MetaStoreThread-39493] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:07:45.329 [MetaStoreThread-39493] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:07:45.329 [MetaStoreThread-39493] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:07:45.329 [MetaStoreThread-39493] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:07:45.329 [MetaStoreThread-39493] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:07:45.329 [MetaStoreThread-39493] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:07:45.329 [MetaStoreThread-39493] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:07:45.329 [MetaStoreThread-39493] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:07:45.329 [MetaStoreThread-39493] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:07:45.329 [MetaStoreThread-39493] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:07:45.329 [MetaStoreThread-39493] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:07:45.329 [MetaStoreThread-39493] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:07:45.330 [MetaStoreThread-39493] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:07:45.330 [MetaStoreThread-39493] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:07:45.330 [MetaStoreThread-39493] HikariConfig - HikariPool-6 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:07:45.330 [MetaStoreThread-39493] HikariConfig - HikariPool-6 - configuration:
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493;create=true"
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - poolName........................"HikariPool-6"
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:07:45.331 [MetaStoreThread-39493] HikariDataSource - HikariPool-6 - Starting...
[INFO ] 2024-04-23 23:07:45.333 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:07:45.334 [MetaStoreThread-39493] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[INFO ] 2024-04-23 23:07:45.334 [MetaStoreThread-39493] HikariDataSource - HikariPool-6 - Start completed.
[DEBUG] 2024-04-23 23:07:45.408 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:07:45.408 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:07:45.408 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:07:45.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4d0a4329, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@32a9b211 will be shutdown
[DEBUG] 2024-04-23 23:07:45.408 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:07:45.408 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:07:45.434 [HikariPool-6 housekeeper] HikariPool - HikariPool-6 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:07:45.435 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@837877506 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:45.437 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1892545849 (XID = 1151), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:45.438 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1098360598 (XID = 1153), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:45.439 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@283249270 (XID = 1155), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:45.440 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1364570651 (XID = 1157), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:45.441 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@346846757 (XID = 1159), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:45.442 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1922342525 (XID = 1161), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:45.444 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2053606320 (XID = 1163), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:45.445 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1268434403 (XID = 1165), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:45.445 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:07:45.563 [MetaStoreThread-39493] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:07:45.563 [MetaStoreThread-39493] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1125985, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:07:45.563 [MetaStoreThread-39493] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:07:45.564 [MetaStoreThread-39493] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1125985, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1c134f0c created in the thread with id: 146
[DEBUG] 2024-04-23 23:07:45.564 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:45.564 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:45.564 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:45.656 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:45.733 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@837877506 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:45.749 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@837877506 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:45.791 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@837877506 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:45.808 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@837877506 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:45.814 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@837877506 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.032 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:07:46.032 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:07:46.032 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:07:46.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@17fd6578, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@b78e885 will be shutdown
[DEBUG] 2024-04-23 23:07:46.032 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:07:46.032 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:07:46.059 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@837877506 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.091 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@837877506 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.100 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@837877506 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.107 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@837877506 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.110 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.112 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.112 [MetaStoreThread-39493] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:07:46.112 [MetaStoreThread-39493] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:07:46.112 [MetaStoreThread-39493] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1125985 from thread id: 146
[DEBUG] 2024-04-23 23:07:46.112 [MetaStoreThread-39493] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:07:46.112 [MetaStoreThread-39493] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.116 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.119 [MetaStoreThread-39493] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.119 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[INFO ] 2024-04-23 23:07:46.119 [MetaStoreThread-39493] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:07:46.119 [MetaStoreThread-39493] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.120 [MetaStoreThread-39493] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.120 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.120 [MetaStoreThread-39493] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.120 [MetaStoreThread-39493] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.123 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.123 [MetaStoreThread-39493] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.126 [MetaStoreThread-39493] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:46.126 [MetaStoreThread-39493] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.126 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.126 [MetaStoreThread-39493] ObjectStore - db details for db default retrieved using SQL in 2.607541ms
[DEBUG] 2024-04-23 23:07:46.126 [MetaStoreThread-39493] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:07:46.126 [MetaStoreThread-39493] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:07:46.126 [MetaStoreThread-39493] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.132 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.134 [MetaStoreThread-39493] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.135 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.137 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[INFO ] 2024-04-23 23:07:46.138 [MetaStoreThread-39493] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:07:46.138 [MetaStoreThread-39493] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.138 [MetaStoreThread-39493] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.141 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.144 [MetaStoreThread-39493] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.147 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@837877506 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.148 [MetaStoreThread-39493] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.149 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[INFO ] 2024-04-23 23:07:46.149 [MetaStoreThread-39493] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:07:46.149 [MetaStoreThread-39493] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.149 [MetaStoreThread-39493] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.150 [MetaStoreThread-39493] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.150 [MetaStoreThread-39493] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.151 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[INFO ] 2024-04-23 23:07:46.151 [MetaStoreThread-39493] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:07:46.151 [MetaStoreThread-39493] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.151 [MetaStoreThread-39493] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.153 [MetaStoreThread-39493] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.153 [MetaStoreThread-39493] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.157 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@837877506 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.161 [MetaStoreThread-39493] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.164 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@837877506 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.166 [MetaStoreThread-39493] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.166 [MetaStoreThread-39493] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[INFO ] 2024-04-23 23:07:46.167 [MetaStoreThread-39493] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:07:46.167 [MetaStoreThread-39493] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:07:46.167 [MetaStoreThread-39493] PerfLogger - </PERFLOG method=init start=1713910065327 end=1713910066167 duration=840 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=15 retryCount=0 error=false>
[INFO ] 2024-04-23 23:07:46.167 [MetaStoreThread-39493] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:07:46.167 [MetaStoreThread-39493] HiveMetaStore - Started the new metaserver on port [39493]...
[INFO ] 2024-04-23 23:07:46.167 [MetaStoreThread-39493] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:07:46.167 [MetaStoreThread-39493] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:07:46.167 [MetaStoreThread-39493] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:07:46.167 [MetaStoreThread-39493] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:07:46.167 [MetaStoreThread-39493] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:07:46.167 [MetaStoreThread-39493] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:07:46.167 [MetaStoreThread-39493] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:07:46.167 [MetaStoreThread-39493] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:07:46.167 [MetaStoreThread-39493] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:07:46.167 [MetaStoreThread-39493] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:07:46.167 [MetaStoreThread-39493] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:07:46.167 [MetaStoreThread-39493] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:07:46.167 [MetaStoreThread-39493] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:07:46.167 [MetaStoreThread-39493] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:07:46.167 [MetaStoreThread-39493] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:07:46.167 [MetaStoreThread-39493] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:07:46.329 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:07:46.329 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 16: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:07:46.329 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:07:46.340 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39493) is created
[INFO ] 2024-04-23 23:07:46.341 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 39493 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39493 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493;create=true
[INFO ] 2024-04-23 23:07:46.341 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:07:46.350 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:07:46.350 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:39493]
[INFO ] 2024-04-23 23:07:46.350 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:39493)
[INFO ] 2024-04-23 23:07:46.351 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:39493) current connections: 3
[DEBUG] 2024-04-23 23:07:46.352 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.352 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910066352 end=1713910066352 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:46.353 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:46.354 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.354 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 create_database: Database(name:db4, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:07:46.354 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db4, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:07:46.356 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:07:46.356 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493;create=true
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493;create=true
[DEBUG] 2024-04-23 23:07:46.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:07:46.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:07:46.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:07:46.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:07:46.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:07:46.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:07:46.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:07:46.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:07:46.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:07:46.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:07:46.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:07:46.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2295224d, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:07:46.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:07:46.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2295224d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@49b61933 created in the thread with id: 163
[DEBUG] 2024-04-23 23:07:46.360 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.361 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.361 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.366 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.367 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.368 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:07:46.368 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:07:46.368 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2295224d from thread id: 163
[DEBUG] 2024-04-23 23:07:46.368 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.370 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:46.370 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.370 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.370 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 2.132461ms
[DEBUG] 2024-04-23 23:07:46.370 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db4, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:07:46.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:07:46.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.374 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.375 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:07:46.375 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:07:46.375 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:07:46.375 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:07:46.375 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:07:46.375 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db
[INFO ] 2024-04-23 23:07:46.375 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db
[INFO ] 2024-04-23 23:07:46.381 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db
[DEBUG] 2024-04-23 23:07:46.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.384 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.384 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.387 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.388 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713910066354 end=1713910066388 duration=34 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:46.389 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:46.389 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.390 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 create_table_req: Table(tableName:tbl4, dbName:db4, owner:alex, createTime:1713910066, lastAccessTime:1713910066, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:b, type:binary, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:d, type:date, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:07:46.390 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl4, dbName:db4, owner:alex, createTime:1713910066, lastAccessTime:1713910066, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:b, type:binary, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:d, type:date, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:07:46.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.400 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:46.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:46.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.401 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 10.644698ms
[DEBUG] 2024-04-23 23:07:46.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:07:46.414 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.415 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.418 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:46.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:46.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.191409ms
[DEBUG] 2024-04-23 23:07:46.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:46.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:07:46.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:46.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.421 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:07:46.421 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:07:46.421 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:07:46.422 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:07:46.422 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39493/db4.db/tbl4
[DEBUG] 2024-04-23 23:07:46.434 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.434 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:46.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:46.455 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@837877506 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.468 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@837877506 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.480 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@837877506 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.492 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@837877506 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.536 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.538 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713910066389 end=1713910066538 duration=149 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:46.539 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:46.539 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.539 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 add_partition : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:07:46.539 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:07:46.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:46.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:07:46.554 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:46.594 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.594 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.601 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.601 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:07:46.601 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:07:46.601 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:07:46.601 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:07:46.602 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39493/db4.db/tbl4/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:07:46.606 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.606 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:46.606 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:07:46.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:46.610 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@837877506 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.624 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.626 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910066539 end=1713910066626 duration=87 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:46.626 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:46.626 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.626 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 add_partition : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:07:46.626 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:07:46.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:46.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:07:46.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:46.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.634 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:07:46.634 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:07:46.634 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:07:46.634 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:07:46.634 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39493/db4.db/tbl4/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:07:46.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:46.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:07:46.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:46.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.648 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.650 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910066626 end=1713910066650 duration=24 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:46.651 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:46.651 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.651 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 add_partition : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:07:46.651 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:07:46.651 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.651 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.651 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:46.651 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:07:46.654 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:46.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.660 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.660 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:07:46.660 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:07:46.660 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:07:46.660 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:07:46.660 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39493/db4.db/tbl4/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:07:46.664 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.664 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:46.664 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:07:46.666 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:46.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.673 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.676 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910066651 end=1713910066676 duration=25 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:46.676 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:46.676 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.676 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713910066676 end=1713910066676 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:46.676 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:46.676 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.676 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_table : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:07:46.676 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:07:46.676 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.678 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:46.678 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:46.678 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.678 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.678 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.867118ms
[DEBUG] 2024-04-23 23:07:46.678 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.678 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.678 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:07:46.681 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.686 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.688 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[INFO ] 2024-04-23 23:07:46.689 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:07:46.689 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713910066676 end=1713910066689 duration=13 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:46.689 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=13, comments=HMS client
[DEBUG] 2024-04-23 23:07:46.689 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:46.690 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.690 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:07:46.690 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:07:46.690 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:07:46.690 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.690 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.696 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 5.855654ms + 0.010919ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:07:46.700 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.956982ms + 0.099651ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:07:46.703 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.922722ms + 0.368626ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:07:46.705 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.862122ms + 0.232643ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:07:46.707 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.926906ms + 0.149899ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:07:46.709 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.765494ms + 0.138407ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:07:46.711 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.615536ms + 0.125792ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:07:46.713 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.80496ms + 0.127673ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:07:46.715 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.871246ms + 0.319018ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:07:46.717 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.134852ms + 0.136826ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:07:46.717 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:46.718 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.718 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 27.770908ms
[DEBUG] 2024-04-23 23:07:46.718 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.718 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.718 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910066690 end=1713910066718 duration=28 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:46.728 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:46.728 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.728 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 alter_table: hive.db4.tbl4 newtbl=tbl4
[INFO ] 2024-04-23 23:07:46.728 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db4.tbl4 newtbl=tbl4	
[DEBUG] 2024-04-23 23:07:46.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.729 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:46.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:46.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.729 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.196527ms
[DEBUG] 2024-04-23 23:07:46.730 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:07:46.730 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:07:46.730 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:07:46.730 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:07:46.730 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.731 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:46.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:46.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.731 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.61633ms
[DEBUG] 2024-04-23 23:07:46.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:07:46.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.739 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.742 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:46.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:46.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.039777ms
[DEBUG] 2024-04-23 23:07:46.743 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.743 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:46.743 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:07:46.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:46.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.749 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db4
[WARN ] 2024-04-23 23:07:46.749 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:07:46.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:46.750 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:46.750 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:46.750 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:07:46.751 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:46.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:07:46.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:46.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:07:46.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:46.761 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.761 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.763 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.764 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713910066728 end=1713910066764 duration=36 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[INFO ] 2024-04-23 23:07:46.765 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:07:46.765 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:39493]
[INFO ] 2024-04-23 23:07:46.765 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:39493)
[INFO ] 2024-04-23 23:07:46.766 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:39493) current connections: 4
[DEBUG] 2024-04-23 23:07:46.766 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.766 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910066766 end=1713910066766 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=18 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:46.767 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:46.767 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.767 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 18: source:127.0.0.1 get_table_metas : tbl=hive.*dbfoo*.*
[INFO ] 2024-04-23 23:07:46.767 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*dbfoo*.*	
[INFO ] 2024-04-23 23:07:46.767 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 18: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493;create=true
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493;create=true
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7d35259a, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7d35259a, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@49d73f80 created in the thread with id: 177
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.768 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.770 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.771 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.771 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:07:46.771 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:07:46.771 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7d35259a from thread id: 177
[DEBUG] 2024-04-23 23:07:46.771 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.771 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (database.name.matches(:param2) ) &&  (tableType == :param3 || tableType == :param4 ) params: hive, (?i).*dbfoo.*, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:07:46.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.780 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.780 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713910066767 end=1713910066780 duration=13 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=18 retryCount=0 error=false>
[INFO ] 2024-04-23 23:07:46.780 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: *dbfoo* tablePattern: * found: 0
[INFO ] 2024-04-23 23:07:46.780 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 3
[DEBUG] 2024-04-23 23:07:46.780 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:46.780 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.780 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:46.780 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 18: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:07:46.780 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:07:46.780 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:07:46.780 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:07:46.780 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7d35259a, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@49d73f80 will be shutdown
[INFO ] 2024-04-23 23:07:46.780 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:07:46.780 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:07:46.780 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 18: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:07:46.780 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.780 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[INFO ] 2024-04-23 23:07:46.780 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:07:46.780 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713910066780 end=1713910066780 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=18 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:46.780 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:07:46.781 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 18: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:07:46.781 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:07:46.781 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.866427ms + 0.006145ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:07:46.782 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.503703ms + 0.07335ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:07:46.783 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.192448ms + 0.285867ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:07:46.783 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.195482ms + 0.171384ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:07:46.783 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.179722ms + 0.108178ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:07:46.784 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.163742ms + 0.107698ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:07:46.784 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.15316ms + 0.199154ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:07:46.784 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.164305ms + 0.105985ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:07:46.785 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.224991ms + 0.271729ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:07:46.785 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.184089ms + 0.10704ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:07:46.785 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:46.785 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.785 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 4.987596ms
[DEBUG] 2024-04-23 23:07:46.785 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.786 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.786 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910066780 end=1713910066786 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[INFO ] 2024-04-23 23:07:46.787 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:07:46.787 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:39493]
[INFO ] 2024-04-23 23:07:46.787 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:39493)
[INFO ] 2024-04-23 23:07:46.788 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:39493) current connections: 4
[DEBUG] 2024-04-23 23:07:46.788 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.788 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910066788 end=1713910066788 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:46.788 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:46.789 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.789 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_table_metas : tbl=hive.*db4*.*
[INFO ] 2024-04-23 23:07:46.789 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*db4*.*	
[INFO ] 2024-04-23 23:07:46.789 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493;create=true
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493;create=true
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4aec159f, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:07:46.790 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:07:46.791 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4aec159f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@32c8ea28 created in the thread with id: 178
[DEBUG] 2024-04-23 23:07:46.791 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.791 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.791 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.793 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.793 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.793 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:07:46.793 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:07:46.794 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4aec159f from thread id: 178
[DEBUG] 2024-04-23 23:07:46.794 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.794 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (database.name.matches(:param2) ) &&  (tableType == :param3 || tableType == :param4 ) params: hive, (?i).*db4.*, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:07:46.800 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.801 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.801 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713910066789 end=1713910066801 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[INFO ] 2024-04-23 23:07:46.801 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: *db4* tablePattern: * found: 0
[INFO ] 2024-04-23 23:07:46.801 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 3
[DEBUG] 2024-04-23 23:07:46.801 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:46.801 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.801 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:07:46.801 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[INFO ] 2024-04-23 23:07:46.801 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:07:46.801 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:07:46.801 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4aec159f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@32c8ea28 will be shutdown
[DEBUG] 2024-04-23 23:07:46.801 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4
[DEBUG] 2024-04-23 23:07:46.801 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:07:46.801 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:07:46.801 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:07:46.801 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713910066801 end=1713910066801 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:46.801 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:07:46.801 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.801 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.801 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:07:46.801 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:07:46.801 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:07:46.802 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.134029ms + 0.00676ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:07:46.803 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.529164ms + 0.098491ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:07:46.804 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.208241ms + 0.260823ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:07:46.805 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.229287ms + 0.201011ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:07:46.805 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.223843ms + 0.173989ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:07:46.805 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.2638ms + 0.165817ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:07:46.806 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.22014ms + 0.159602ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:07:46.806 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.168307ms + 0.106561ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:07:46.807 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.231409ms + 0.293157ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:07:46.807 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.197ms + 0.110443ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:07:46.807 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:46.807 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.807 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 5.868904ms
[DEBUG] 2024-04-23 23:07:46.807 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.807 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.807 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910066801 end=1713910066807 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:46.808 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:46.808 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.808 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:07:46.808 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:07:46.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:07:46.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.810 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.810 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.811 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713910066808 end=1713910066811 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:46.811 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:46.811 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.811 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:07:46.811 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:07:46.811 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.814 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.814 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.815 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713910066811 end=1713910066815 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:46.815 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:46.815 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.815 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_database: db4
[INFO ] 2024-04-23 23:07:46.815 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db4	
[DEBUG] 2024-04-23 23:07:46.815 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.816 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:46.816 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:46.816 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.816 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.817 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.513714ms
[DEBUG] 2024-04-23 23:07:46.817 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713910066815 end=1713910066817 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:46.817 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:07:46.817 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:46.817 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.817 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_tables_by_type: db=@hive#db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:07:46.817 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:07:46.817 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:07:46.817 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:07:46.817 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.818 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:46.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:46.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.819 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.582321ms
[DEBUG] 2024-04-23 23:07:46.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:46.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.822 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 3.358459ms
[DEBUG] 2024-04-23 23:07:46.822 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713910066817 end=1713910066822 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:46.822 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:46.822 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.822 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:07:46.822 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:07:46.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:46.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.825 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.760759ms
[DEBUG] 2024-04-23 23:07:46.825 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713910066822 end=1713910066825 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:46.825 [main] HiveMetaStoreClient - Selecting dropDatabase method for db4 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:07:46.825 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:07:46.826 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:46.826 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.826 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.827 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:46.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:46.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.827 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.439823ms
[DEBUG] 2024-04-23 23:07:46.827 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_multi_table : db=db4 tbls=tbl4
[INFO ] 2024-04-23 23:07:46.827 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db4 tbls=tbl4	
[DEBUG] 2024-04-23 23:07:46.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.832 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:46.833 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:46.833 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.833 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.059733ms
[DEBUG] 2024-04-23 23:07:46.833 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.833 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.833 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713910066826 end=1713910066833 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:07:46.833 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:07:46.833 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:07:46.833 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:07:46.833 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:07:46.833 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:46.833 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.835 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:46.835 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:46.835 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.835 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.616015ms
[DEBUG] 2024-04-23 23:07:46.835 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:07:46.835 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:07:46.835 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:46.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.659673ms
[DEBUG] 2024-04-23 23:07:46.836 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:07:46.836 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:07:46.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.846 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@837877506 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.851 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:07:46.851 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:07:46.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.857 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@837877506 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.861 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:07:46.861 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:07:46.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.885 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@837877506 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.888 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.889 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:07:46.889 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:07:46.889 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:07:46.889 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:07:46.889 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:07:46.889 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:07:46.889 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.890 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:46.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:46.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.959116ms
[DEBUG] 2024-04-23 23:07:46.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:46.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.536785ms
[DEBUG] 2024-04-23 23:07:46.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.891 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:46.892 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:46.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:46.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:46.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.853798ms
[DEBUG] 2024-04-23 23:07:46.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:07:46.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:07:46.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:46.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:46.893 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:46.893 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:07:46.912 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@837877506 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:07:46.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:46.921 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:07:46.921 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.921 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:46.923 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:46.924 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:46.926 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:46.927 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:46.929 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:46.930 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:07:46.930 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.930 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:46.931 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:46.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:07:46.932 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:07:48.035 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:07:48.040 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:07:48.933 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:07:48.933 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:07:48.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:48.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:48.936 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:48.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:48.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:48.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 2.582431ms
[DEBUG] 2024-04-23 23:07:48.936 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:07:48.936 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:07:48.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:48.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:48.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:48.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.469069ms
[DEBUG] 2024-04-23 23:07:48.937 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:07:48.937 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:07:48.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:48.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:48.938 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:07:48.938 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:07:48.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:48.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:48.939 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:07:48.939 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:07:48.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:48.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:48.940 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:07:48.940 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:07:48.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:48.941 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:48.941 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:48.941 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:48.941 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.847088ms
[DEBUG] 2024-04-23 23:07:48.941 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:48.941 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:48.941 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:48.941 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.436075ms
[DEBUG] 2024-04-23 23:07:48.941 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:48.942 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:48.943 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:48.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:48.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:48.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.018741ms
[DEBUG] 2024-04-23 23:07:48.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:07:48.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:07:48.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:48.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:48.944 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:48.944 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:07:48.945 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:07:48.945 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:48.945 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:07:48.945 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:48.945 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:48.945 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:48.945 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:48.945 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:48.946 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:48.946 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:48.946 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:07:48.946 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:48.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:48.946 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:48.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:07:48.947 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:07:50.947 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:07:50.948 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:07:50.948 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:50.948 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:50.950 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:50.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:50.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:50.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.236726ms
[DEBUG] 2024-04-23 23:07:50.951 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:07:50.951 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:07:50.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:50.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:50.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:50.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.394584ms
[DEBUG] 2024-04-23 23:07:50.953 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:07:50.953 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:07:50.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:50.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:50.954 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:07:50.954 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:07:50.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:50.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:50.955 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:07:50.955 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:07:50.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:50.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:50.956 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:07:50.956 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:07:50.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:50.956 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:50.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:50.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:50.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.82333ms
[DEBUG] 2024-04-23 23:07:50.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:50.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:50.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:50.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.452978ms
[DEBUG] 2024-04-23 23:07:50.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:50.958 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:50.958 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:50.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:50.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:50.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.773208ms
[DEBUG] 2024-04-23 23:07:50.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:07:50.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:07:50.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:50.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:50.960 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:50.960 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:07:50.960 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:07:50.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:50.961 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:07:50.961 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:50.961 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:50.961 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:50.961 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:50.961 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:50.961 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:50.961 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:50.961 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:07:50.961 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:50.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:50.962 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:50.962 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:07:50.962 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:07:52.963 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:07:52.963 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:07:52.963 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:52.963 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:52.965 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:52.966 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:52.966 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:52.966 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 2.323443ms
[DEBUG] 2024-04-23 23:07:52.966 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:07:52.966 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:07:52.966 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:52.966 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:52.966 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:52.966 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.476073ms
[DEBUG] 2024-04-23 23:07:52.966 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:07:52.966 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:07:52.966 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:52.968 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:52.968 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:07:52.968 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:07:52.968 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:52.969 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:52.969 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:07:52.969 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:07:52.969 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:52.969 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:52.970 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:07:52.970 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:07:52.970 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:52.970 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:52.970 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:52.970 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:52.970 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.832811ms
[DEBUG] 2024-04-23 23:07:52.970 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:52.971 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:52.971 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:52.971 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.557326ms
[DEBUG] 2024-04-23 23:07:52.971 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:52.972 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:52.972 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:52.972 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:52.972 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:52.972 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.793662ms
[DEBUG] 2024-04-23 23:07:52.972 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:07:52.973 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:07:52.973 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:52.973 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:52.973 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:52.974 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:07:52.974 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:07:52.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:52.975 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:07:52.975 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:52.975 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:52.975 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:52.975 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:52.975 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:52.975 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:52.975 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:52.975 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:07:52.976 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:52.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:52.976 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:52.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:07:52.977 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:07:53.333 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:07:54.977 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:07:54.977 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:07:54.977 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:54.977 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:54.979 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:54.980 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:54.980 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:54.980 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 2.351477ms
[DEBUG] 2024-04-23 23:07:54.980 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:07:54.980 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:07:54.980 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:54.980 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:54.980 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:54.980 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.48358ms
[DEBUG] 2024-04-23 23:07:54.980 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:07:54.980 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:07:54.980 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:54.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:54.982 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:07:54.982 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:07:54.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:54.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:54.983 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:07:54.983 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:07:54.983 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:54.983 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:54.984 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:07:54.984 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:07:54.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:54.984 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:54.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:54.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:54.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.800844ms
[DEBUG] 2024-04-23 23:07:54.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:54.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:54.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:54.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.442395ms
[DEBUG] 2024-04-23 23:07:54.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:54.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:54.986 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:54.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:54.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:54.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.825897ms
[DEBUG] 2024-04-23 23:07:54.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:07:54.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:07:54.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:54.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:54.987 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:54.987 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:07:54.988 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:07:54.989 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:54.989 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:07:54.989 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:54.989 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:54.989 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:54.989 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:54.989 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:54.989 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:54.989 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:54.989 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:07:54.989 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:54.989 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:54.990 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:54.990 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:07:54.990 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:07:56.991 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:07:56.991 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:07:56.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:56.992 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:56.994 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:56.995 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:56.995 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:56.995 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.520076ms
[DEBUG] 2024-04-23 23:07:56.995 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:07:56.995 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:07:56.995 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:56.996 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:56.996 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:56.996 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.082401ms
[DEBUG] 2024-04-23 23:07:56.997 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:07:56.997 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:07:56.997 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:56.998 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:56.998 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:07:56.998 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:07:56.998 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:56.999 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:56.999 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:07:56.999 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:07:56.999 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:57.000 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:57.000 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:07:57.000 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:07:57.000 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:57.001 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:57.001 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:57.001 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:57.001 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.882337ms
[DEBUG] 2024-04-23 23:07:57.001 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:57.002 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:57.002 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:57.002 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.468609ms
[DEBUG] 2024-04-23 23:07:57.002 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:57.002 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:57.003 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:57.003 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:57.003 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:57.003 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.850117ms
[DEBUG] 2024-04-23 23:07:57.003 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:07:57.003 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:07:57.003 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:57.003 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:57.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:57.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:07:57.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:07:57.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:57.006 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:07:57.006 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:57.006 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:57.006 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:57.006 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:57.006 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:57.006 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:57.006 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:57.006 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:07:57.006 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:57.006 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:57.007 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:57.007 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:07:57.007 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:07:59.008 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:07:59.008 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:07:59.009 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:07:59.009 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:59.012 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:59.012 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:59.012 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:59.012 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.590722ms
[DEBUG] 2024-04-23 23:07:59.012 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:07:59.013 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:07:59.013 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:59.013 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:59.013 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:59.013 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.514246ms
[DEBUG] 2024-04-23 23:07:59.013 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:07:59.013 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:07:59.013 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:59.015 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:59.015 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:07:59.015 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:07:59.015 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:59.016 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:59.016 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:07:59.016 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:07:59.016 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:59.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:59.017 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:07:59.017 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:07:59.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:59.018 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:59.018 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:59.018 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:59.018 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.986172ms
[DEBUG] 2024-04-23 23:07:59.018 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:59.019 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:59.019 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:59.019 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.602418ms
[DEBUG] 2024-04-23 23:07:59.019 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:59.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:59.020 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:07:59.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:07:59.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:59.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.869257ms
[DEBUG] 2024-04-23 23:07:59.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:07:59.021 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:07:59.021 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:07:59.021 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:07:59.021 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:07:59.021 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:07:59.022 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:07:59.023 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:07:59.023 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:07:59.023 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:59.023 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:59.023 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:59.023 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:59.023 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:59.023 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:59.023 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:07:59.023 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:07:59.023 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:59.023 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:07:59.024 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:07:59.024 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:07:59.025 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:01.025 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:08:01.025 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:08:01.025 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:01.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:01.028 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:01.029 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:01.029 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:01.029 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.310089ms
[DEBUG] 2024-04-23 23:08:01.029 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:08:01.029 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:08:01.029 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:01.031 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:01.031 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:01.031 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.363189ms
[DEBUG] 2024-04-23 23:08:01.031 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:08:01.031 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:08:01.031 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:01.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:01.032 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:01.032 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:01.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:01.033 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:01.033 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:01.033 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:01.033 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:01.034 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:01.034 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:01.034 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:01.034 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:01.035 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:01.035 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:01.035 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:01.035 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.039352ms
[DEBUG] 2024-04-23 23:08:01.035 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:01.036 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:01.036 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:01.036 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.557755ms
[DEBUG] 2024-04-23 23:08:01.036 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:01.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:01.037 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:01.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:01.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:01.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.765668ms
[DEBUG] 2024-04-23 23:08:01.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:01.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:08:01.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:01.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:01.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:01.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:01.039 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:01.039 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:01.039 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:01.040 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:01.040 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:01.040 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:01.040 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:01.040 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:01.040 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:01.040 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:01.040 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:08:01.040 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:01.040 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:01.041 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:01.041 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:01.041 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:03.042 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:08:03.042 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:08:03.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:03.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:03.045 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:03.046 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:03.046 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:03.046 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.265057ms
[DEBUG] 2024-04-23 23:08:03.046 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:08:03.046 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:08:03.046 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:03.047 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:03.047 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:03.047 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.614383ms
[DEBUG] 2024-04-23 23:08:03.047 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:08:03.047 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:08:03.047 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:03.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:03.049 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:03.049 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:03.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:03.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:03.050 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:03.050 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:03.050 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:03.050 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:03.050 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:03.050 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:03.050 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:03.051 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:03.051 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:03.051 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:03.051 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.838427ms
[DEBUG] 2024-04-23 23:08:03.051 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:03.052 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:03.052 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:03.052 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.472302ms
[DEBUG] 2024-04-23 23:08:03.052 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:03.052 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:03.053 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:03.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:03.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:03.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.846652ms
[DEBUG] 2024-04-23 23:08:03.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:03.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:08:03.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:03.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:03.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:03.055 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:03.055 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:03.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:03.056 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:03.056 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:03.056 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:03.056 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:03.056 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:03.056 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:03.056 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:03.056 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:03.056 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:08:03.057 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:03.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:03.057 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:03.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:03.058 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:05.059 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:08:05.059 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:08:05.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:05.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:05.062 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:05.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:05.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:05.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.448979ms
[DEBUG] 2024-04-23 23:08:05.063 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:08:05.063 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:08:05.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:05.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:05.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:05.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.094885ms
[DEBUG] 2024-04-23 23:08:05.064 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:08:05.064 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:08:05.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:05.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:05.066 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:05.066 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:05.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:05.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:05.067 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:05.067 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:05.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:05.068 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:05.068 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:05.068 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:05.068 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:05.069 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:05.069 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:05.069 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:05.069 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.021449ms
[DEBUG] 2024-04-23 23:08:05.069 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:05.070 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:05.070 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:05.070 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.606595ms
[DEBUG] 2024-04-23 23:08:05.070 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:05.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:05.071 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:05.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:05.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:05.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.902559ms
[DEBUG] 2024-04-23 23:08:05.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:05.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:08:05.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:05.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:05.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:05.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:05.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:05.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:05.074 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:05.074 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:05.074 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:05.074 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:05.074 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:05.074 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:05.074 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:05.075 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:05.075 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:08:05.075 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:05.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:05.076 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:05.076 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:05.076 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:07.077 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:08:07.077 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:08:07.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:07.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:07.080 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:07.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:07.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:07.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.582301ms
[DEBUG] 2024-04-23 23:08:07.081 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:08:07.081 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:08:07.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:07.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:07.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:07.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.833877ms
[DEBUG] 2024-04-23 23:08:07.082 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:08:07.082 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:08:07.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:07.083 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:07.084 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:07.084 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:07.084 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:07.084 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:07.085 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:07.085 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:07.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:07.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:07.086 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:07.086 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:07.086 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:07.086 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:07.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:07.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:07.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.940966ms
[DEBUG] 2024-04-23 23:08:07.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:07.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:07.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:07.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.463846ms
[DEBUG] 2024-04-23 23:08:07.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:07.088 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:07.088 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:07.088 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:07.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:07.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.737606ms
[DEBUG] 2024-04-23 23:08:07.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:07.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:08:07.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:07.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:07.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:07.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:07.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:07.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:07.091 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:07.091 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:07.091 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:07.091 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:07.091 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:07.091 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:07.091 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:07.091 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:08:07.091 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:08:07.091 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:07.091 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:07.092 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1286047530 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:07.092 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:07.093 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:07.093 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713910066833 end=1713910087093 duration=20260 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=-1 error=true>
[INFO ] 2024-04-23 23:08:07.094 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:08:07.094 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:08:07.094 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:08:07.094 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:08:07.101 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:08:07.101 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:08:07.101 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:08:07.101 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:08:07.102 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:08:07.133 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173;create=true
[INFO ] 2024-04-23 23:08:07.561 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:08:07.561 [MetaStoreThread-39173] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] HMSHandler - 20: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173;create=true
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173;create=true
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:08:07.562 [MetaStoreThread-39173] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39493;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173;create=true
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 120
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:08:07.563 [MetaStoreThread-39173] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:07.564 [MetaStoreThread-39173] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:08:07.565 [MetaStoreThread-39173] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:08:07.565 [MetaStoreThread-39173] HikariConfig - HikariPool-7 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:08:07.565 [MetaStoreThread-39173] HikariConfig - HikariPool-7 - configuration:
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173;create=true"
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - poolName........................"HikariPool-7"
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:08:07.566 [MetaStoreThread-39173] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:08:07.567 [MetaStoreThread-39173] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:08:07.567 [MetaStoreThread-39173] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:08:07.567 [MetaStoreThread-39173] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:08:07.567 [MetaStoreThread-39173] HikariDataSource - HikariPool-7 - Starting...
[INFO ] 2024-04-23 23:08:07.568 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:08:07.569 [MetaStoreThread-39173] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[INFO ] 2024-04-23 23:08:07.569 [MetaStoreThread-39173] HikariDataSource - HikariPool-7 - Start completed.
[DEBUG] 2024-04-23 23:08:07.669 [HikariPool-7 housekeeper] HikariPool - HikariPool-7 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:08:07.671 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1336306339 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:07.672 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@245063832 (XID = 1157), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:07.673 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1071614587 (XID = 1159), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:07.674 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1857331159 (XID = 1161), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:07.675 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1861653596 (XID = 1163), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:07.676 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1794770394 (XID = 1165), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:07.678 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1465131291 (XID = 1167), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:07.679 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@508715400 (XID = 1169), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:07.680 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@897270146 (XID = 1171), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:07.680 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:08:07.814 [MetaStoreThread-39173] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:08:07.814 [MetaStoreThread-39173] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@ffdb762, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:08:07.814 [MetaStoreThread-39173] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:08:07.815 [MetaStoreThread-39173] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@ffdb762, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@407e640c created in the thread with id: 181
[DEBUG] 2024-04-23 23:08:07.815 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:07.815 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:07.815 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:07.952 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.044 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1336306339 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.068 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1336306339 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.129 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1336306339 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.152 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1336306339 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.158 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1336306339 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.301 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1336306339 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.329 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1336306339 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.336 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1336306339 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.344 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1336306339 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.347 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.349 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.350 [MetaStoreThread-39173] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:08:08.350 [MetaStoreThread-39173] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:08:08.350 [MetaStoreThread-39173] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@ffdb762 from thread id: 181
[DEBUG] 2024-04-23 23:08:08.350 [MetaStoreThread-39173] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:08:08.350 [MetaStoreThread-39173] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.355 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.359 [MetaStoreThread-39173] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.359 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[INFO ] 2024-04-23 23:08:08.359 [MetaStoreThread-39173] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:08:08.359 [MetaStoreThread-39173] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.360 [MetaStoreThread-39173] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.360 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.360 [MetaStoreThread-39173] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.360 [MetaStoreThread-39173] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.364 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.364 [MetaStoreThread-39173] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.366 [MetaStoreThread-39173] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:08.366 [MetaStoreThread-39173] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.366 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.366 [MetaStoreThread-39173] ObjectStore - db details for db default retrieved using SQL in 2.380733ms
[DEBUG] 2024-04-23 23:08:08.366 [MetaStoreThread-39173] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:08:08.366 [MetaStoreThread-39173] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:08:08.367 [MetaStoreThread-39173] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.374 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.376 [MetaStoreThread-39173] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.377 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.379 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[INFO ] 2024-04-23 23:08:08.379 [MetaStoreThread-39173] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:08:08.380 [MetaStoreThread-39173] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.380 [MetaStoreThread-39173] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.383 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.385 [MetaStoreThread-39173] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.387 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1336306339 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.388 [MetaStoreThread-39173] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.389 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[INFO ] 2024-04-23 23:08:08.389 [MetaStoreThread-39173] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:08:08.389 [MetaStoreThread-39173] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.389 [MetaStoreThread-39173] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.389 [MetaStoreThread-39173] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.390 [MetaStoreThread-39173] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.390 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[INFO ] 2024-04-23 23:08:08.390 [MetaStoreThread-39173] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:08:08.390 [MetaStoreThread-39173] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.390 [MetaStoreThread-39173] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.391 [MetaStoreThread-39173] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.391 [MetaStoreThread-39173] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.395 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1336306339 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.399 [MetaStoreThread-39173] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.401 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1336306339 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.402 [MetaStoreThread-39173] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.403 [MetaStoreThread-39173] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[INFO ] 2024-04-23 23:08:08.403 [MetaStoreThread-39173] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:08:08.403 [MetaStoreThread-39173] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:08:08.403 [MetaStoreThread-39173] PerfLogger - </PERFLOG method=init start=1713910087562 end=1713910088403 duration=841 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=20 retryCount=0 error=false>
[INFO ] 2024-04-23 23:08:08.403 [MetaStoreThread-39173] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:08:08.404 [MetaStoreThread-39173] HiveMetaStore - Started the new metaserver on port [39173]...
[INFO ] 2024-04-23 23:08:08.404 [MetaStoreThread-39173] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:08:08.404 [MetaStoreThread-39173] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:08:08.404 [MetaStoreThread-39173] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:08:08.404 [MetaStoreThread-39173] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:08:08.404 [MetaStoreThread-39173] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:08:08.404 [MetaStoreThread-39173] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:08:08.404 [MetaStoreThread-39173] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:08:08.404 [MetaStoreThread-39173] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:08:08.404 [MetaStoreThread-39173] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:08:08.404 [MetaStoreThread-39173] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:08:08.404 [MetaStoreThread-39173] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:08:08.404 [MetaStoreThread-39173] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:08:08.404 [MetaStoreThread-39173] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:08:08.404 [MetaStoreThread-39173] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:08:08.404 [MetaStoreThread-39173] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:08:08.404 [MetaStoreThread-39173] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:08:08.563 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:08:08.564 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 21: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:08:08.564 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:08:08.575 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39173) is created
[INFO ] 2024-04-23 23:08:08.575 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 39173 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39173 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173;create=true
[INFO ] 2024-04-23 23:08:08.575 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:08:08.583 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:08:08.583 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:39173]
[INFO ] 2024-04-23 23:08:08.583 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:39173)
[INFO ] 2024-04-23 23:08:08.584 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:39173) current connections: 4
[DEBUG] 2024-04-23 23:08:08.585 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:08.585 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910088585 end=1713910088585 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:08.586 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:08.586 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:08.586 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 create_database: Database(name:db7, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:08:08.586 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db7, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:08:08.588 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:08:08.588 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:08:08.588 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:08.588 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:08.588 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:08:08.588 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:08:08.588 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173;create=true
[DEBUG] 2024-04-23 23:08:08.588 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:08:08.588 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:08:08.588 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:08.588 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:08:08.588 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:08:08.588 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:08:08.588 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:08:08.588 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:08.588 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173;create=true
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@723a5fab, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:08:08.589 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:08:08.591 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@723a5fab, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@32f26616 created in the thread with id: 198
[DEBUG] 2024-04-23 23:08:08.591 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.592 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.592 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.596 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.598 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.598 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:08:08.598 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:08:08.598 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@723a5fab from thread id: 198
[DEBUG] 2024-04-23 23:08:08.598 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:08.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.600 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.742074ms
[DEBUG] 2024-04-23 23:08:08.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db7, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:08:08.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:08:08.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.602 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.603 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.603 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:08:08.603 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:08:08.603 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:08:08.603 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:08:08.603 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:08:08.604 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db
[INFO ] 2024-04-23 23:08:08.604 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db
[INFO ] 2024-04-23 23:08:08.609 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db
[DEBUG] 2024-04-23 23:08:08.610 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.610 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.612 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.612 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.614 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.615 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713910088586 end=1713910088615 duration=29 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:08.616 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:08.616 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:08.616 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 create_table_req: Table(tableName:tbl7, dbName:db7, owner:alex, createTime:1713910088, lastAccessTime:1713910088, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:l, type:bigint, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:08:08.616 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl7, dbName:db7, owner:alex, createTime:1713910088, lastAccessTime:1713910088, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:l, type:bigint, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:08:08.616 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.624 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:08.624 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:08.624 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.625 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.625 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 8.335521ms
[DEBUG] 2024-04-23 23:08:08.625 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.625 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.625 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:08:08.636 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.637 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.637 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.637 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.637 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.640 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:08.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:08.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.050344ms
[DEBUG] 2024-04-23 23:08:08.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:08.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:08:08.642 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:08.642 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.643 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:08:08.643 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:08:08.643 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:08:08.643 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:08:08.643 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39173/db7.db/tbl7
[DEBUG] 2024-04-23 23:08:08.654 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:08.665 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:08.674 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1336306339 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.684 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1336306339 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.692 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1336306339 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.698 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1336306339 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.714 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.714 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.715 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.716 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713910088616 end=1713910088716 duration=100 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:08.717 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:08.717 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:08.717 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 add_partition : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:08:08.717 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:08:08.717 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.717 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.717 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:08.717 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:08:08.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:08.753 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.753 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.759 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.760 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:08:08.760 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:08:08.760 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:08:08.760 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:08:08.760 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39173/db7.db/tbl7/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:08:08.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:08.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:08:08.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:08.769 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1336306339 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.778 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.778 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.782 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.783 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910088717 end=1713910088783 duration=66 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:08.783 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:08.783 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:08.783 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 add_partition : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:08:08.783 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:08:08.784 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.784 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.784 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:08.784 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:08:08.785 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:08.788 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.788 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.789 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.789 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:08:08.789 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:08:08.789 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:08:08.789 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:08:08.789 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39173/db7.db/tbl7/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:08:08.793 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.793 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:08.793 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:08:08.794 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:08.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.800 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.802 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910088783 end=1713910088802 duration=19 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:08.802 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:08.803 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:08.803 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 add_partition : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:08:08.803 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:08:08.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:08.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:08:08.804 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:08.807 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.807 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.807 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.808 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:08:08.808 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:08:08.808 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:08:08.808 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:08:08.808 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39173/db7.db/tbl7/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:08:08.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:08.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:08:08.813 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:08.816 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.816 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.820 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.821 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910088803 end=1713910088821 duration=18 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:08.822 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:08.822 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:08.822 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713910088822 end=1713910088822 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:08.822 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:08.822 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:08.822 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_table : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:08:08.822 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:08:08.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.824 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:08.824 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:08.824 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.824 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.824 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.743467ms
[DEBUG] 2024-04-23 23:08:08.824 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.824 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.824 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:08:08.826 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.830 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[INFO ] 2024-04-23 23:08:08.831 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:08:08.831 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713910088822 end=1713910088831 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:08.832 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=10, comments=HMS client
[DEBUG] 2024-04-23 23:08:08.832 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:08.832 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:08.832 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_partitions : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:08:08.832 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:08:08.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:08:08.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.835 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.23531ms + 0.006198ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:08:08.839 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.106769ms + 0.07786ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:08:08.841 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.511995ms + 0.256888ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:08:08.842 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.458862ms + 0.176349ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:08.844 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.547241ms + 0.114709ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:08:08.846 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.478139ms + 0.163316ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:08.848 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.514427ms + 0.116791ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:08.849 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.341479ms + 0.106878ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:08.851 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.483022ms + 0.249355ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:08.853 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.630991ms + 0.11717ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:08:08.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:08.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 20.566902ms
[DEBUG] 2024-04-23 23:08:08.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.853 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.853 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910088832 end=1713910088853 duration=21 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:08.863 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:08.863 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:08.863 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 alter_table: hive.db7.tbl7 newtbl=tbl7
[INFO ] 2024-04-23 23:08:08.863 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db7.tbl7 newtbl=tbl7	
[DEBUG] 2024-04-23 23:08:08.863 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.864 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:08.864 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:08.864 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.864 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.864 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.206392ms
[DEBUG] 2024-04-23 23:08:08.864 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:08:08.864 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:08:08.864 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:08:08.864 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:08:08.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.866 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:08.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:08.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.866 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.614902ms
[DEBUG] 2024-04-23 23:08:08.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:08:08.869 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.874 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.876 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:08.876 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:08.876 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.876 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.926374ms
[DEBUG] 2024-04-23 23:08:08.876 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.876 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:08.876 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:08:08.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:08.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.881 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db7
[WARN ] 2024-04-23 23:08:08.881 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:08:08.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:08.882 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:08.882 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:08.882 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:08:08.883 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:08.884 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:08:08.884 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:08.884 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:08:08.889 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:08.891 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.891 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.893 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.894 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713910088863 end=1713910088894 duration=31 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[INFO ] 2024-04-23 23:08:08.895 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:08:08.895 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:39173]
[INFO ] 2024-04-23 23:08:08.895 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:39173)
[INFO ] 2024-04-23 23:08:08.895 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:39173) current connections: 5
[DEBUG] 2024-04-23 23:08:08.896 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:08.896 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910088896 end=1713910088896 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=23 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:08.896 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:08.896 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:08.896 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 23: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 23: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173;create=true
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173;create=true
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:08:08.897 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:08:08.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4dd2698d, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:08:08.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:08:08.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4dd2698d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@733d0729 created in the thread with id: 212
[DEBUG] 2024-04-23 23:08:08.898 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.898 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.898 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.900 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.900 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.900 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:08:08.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:08:08.900 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4dd2698d from thread id: 212
[DEBUG] 2024-04-23 23:08:08.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:08:08.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.905 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.905 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713910088896 end=1713910088905 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=23 retryCount=0 error=false>
[INFO ] 2024-04-23 23:08:08.906 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:08:08.906 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 4
[DEBUG] 2024-04-23 23:08:08.906 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:08.906 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:08.906 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 23: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:08:08.906 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[INFO ] 2024-04-23 23:08:08.906 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:08:08.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4dd2698d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@733d0729 will be shutdown
[DEBUG] 2024-04-23 23:08:08.906 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:08.906 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 23: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:08:08.906 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_partitions : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:08:08.906 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:08:08.906 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713910088906 end=1713910088906 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=23 retryCount=0 error=false>
[INFO ] 2024-04-23 23:08:08.906 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:08:08.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:08:08.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.906 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:08:08.906 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 23: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:08:08.906 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:08:08.907 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.026042ms + 0.005507ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:08:08.908 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.591236ms + 0.094108ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:08:08.909 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.154091ms + 0.36655ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:08:08.909 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.161745ms + 0.147089ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:08.909 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.183943ms + 0.100524ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:08:08.910 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.179788ms + 0.129545ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:08.910 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.198896ms + 0.126004ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:08.911 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.196941ms + 0.157269ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:08.911 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.231814ms + 0.256706ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:08.911 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.193971ms + 0.099576ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:08:08.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:08.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 5.414606ms
[DEBUG] 2024-04-23 23:08:08.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.912 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.912 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910088906 end=1713910088912 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:08.912 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:08.912 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:08.913 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:08:08.913 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:08:08.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:08:08.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.915 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.915 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.916 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713910088912 end=1713910088916 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:08.916 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:08.916 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:08.916 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:08:08.916 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:08:08.916 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.919 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.919 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713910088916 end=1713910088919 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:08.919 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:08.920 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:08.920 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_database: db7
[INFO ] 2024-04-23 23:08:08.920 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db7	
[DEBUG] 2024-04-23 23:08:08.920 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.920 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:08.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:08.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.921 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.26069ms
[DEBUG] 2024-04-23 23:08:08.921 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713910088920 end=1713910088921 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:08.921 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:08:08.921 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:08.921 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:08.921 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_tables_by_type: db=@hive#db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:08.921 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:08.921 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:08.921 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:08.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.922 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:08.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:08.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.923 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.378059ms
[DEBUG] 2024-04-23 23:08:08.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.925 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:08.925 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.926 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.846802ms
[DEBUG] 2024-04-23 23:08:08.926 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713910088921 end=1713910088926 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:08.926 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:08.926 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:08.926 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:08:08.926 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:08:08.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:08.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.929 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 3.323921ms
[DEBUG] 2024-04-23 23:08:08.929 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713910088926 end=1713910088929 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:08.930 [main] HiveMetaStoreClient - Selecting dropDatabase method for db7 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:08:08.930 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:08:08.930 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:08.930 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:08.930 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.931 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:08.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:08.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.931 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.37937ms
[DEBUG] 2024-04-23 23:08:08.931 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_multi_table : db=db7 tbls=tbl7
[INFO ] 2024-04-23 23:08:08.931 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db7 tbls=tbl7	
[DEBUG] 2024-04-23 23:08:08.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.937 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:08.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:08.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.09691ms
[DEBUG] 2024-04-23 23:08:08.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:08.937 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.937 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713910088930 end=1713910088937 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:08.937 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:08.938 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:08.938 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:08:08.938 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:08:08.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:08.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.939 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:08.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:08.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.153119ms
[DEBUG] 2024-04-23 23:08:08.939 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:08:08.939 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:08:08.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:08.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.544737ms
[DEBUG] 2024-04-23 23:08:08.940 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:08:08.940 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:08:08.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.949 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1336306339 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.952 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.952 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:08.953 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:08.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.956 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1336306339 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.960 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:08.960 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:08.960 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.979 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1336306339 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:08.983 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.983 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:08:08.983 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:08:08.983 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:08:08.983 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:08:08.983 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:08.983 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:08.983 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.984 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:08.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:08.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.037ms
[DEBUG] 2024-04-23 23:08:08.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:08.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:08.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.587607ms
[DEBUG] 2024-04-23 23:08:08.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:08.986 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:08.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:08.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:08.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.868941ms
[DEBUG] 2024-04-23 23:08:08.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:08.987 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:08:08.987 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:08.987 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:08.988 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:08.988 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:08.999 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:08:09.004 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1336306339 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:09.007 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:09.011 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:09.011 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:09.011 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:09.012 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:09.013 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:09.014 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:09.015 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:09.016 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:09.017 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:09.018 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:08:09.018 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:09.019 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:09.019 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:09.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:09.020 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:11.021 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:08:11.021 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:08:11.021 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:11.021 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:11.024 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:11.025 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:11.025 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:11.025 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.791839ms
[DEBUG] 2024-04-23 23:08:11.025 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:08:11.025 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:08:11.025 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:11.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:11.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:11.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.04063ms
[DEBUG] 2024-04-23 23:08:11.026 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:08:11.026 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:08:11.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:11.027 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:11.027 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:11.028 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:11.028 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:11.028 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:11.028 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:11.028 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:11.028 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:11.029 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:11.029 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:11.029 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:11.029 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:11.030 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:11.030 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:11.030 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:11.030 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.811855ms
[DEBUG] 2024-04-23 23:08:11.030 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:11.030 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:11.030 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:11.030 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.449529ms
[DEBUG] 2024-04-23 23:08:11.030 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:11.031 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:11.032 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:11.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:11.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:11.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.978218ms
[DEBUG] 2024-04-23 23:08:11.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:11.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:08:11.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:11.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:11.033 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:11.033 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:11.034 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:11.034 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:11.034 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:11.034 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:11.034 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:11.034 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:11.034 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:11.034 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:11.035 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:11.035 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:11.035 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:08:11.035 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:11.035 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:11.035 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:11.035 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:11.036 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:13.036 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:08:13.036 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:08:13.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:13.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:13.039 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:13.039 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:13.039 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:13.039 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 2.350055ms
[DEBUG] 2024-04-23 23:08:13.039 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:08:13.039 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:08:13.039 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:13.040 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:13.040 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:13.040 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.494451ms
[DEBUG] 2024-04-23 23:08:13.040 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:08:13.040 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:08:13.040 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:13.041 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:13.041 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:13.041 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:13.041 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:13.041 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:13.042 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:13.042 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:13.042 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:13.042 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:13.043 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:13.043 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:13.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:13.043 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:13.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:13.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:13.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.827902ms
[DEBUG] 2024-04-23 23:08:13.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:13.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:13.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:13.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.469476ms
[DEBUG] 2024-04-23 23:08:13.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:13.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:13.045 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:13.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:13.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:13.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.792153ms
[DEBUG] 2024-04-23 23:08:13.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:13.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:08:13.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:13.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:13.046 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:13.046 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:13.047 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:13.047 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:13.047 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:13.047 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:13.048 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:13.048 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:13.048 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:13.048 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:13.048 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:13.048 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:13.048 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:08:13.048 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:13.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:13.049 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:13.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:13.049 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:14.460 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:08:15.049 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:08:15.049 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:08:15.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:15.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:15.050 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:15.051 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:15.051 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:15.051 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.112848ms
[DEBUG] 2024-04-23 23:08:15.051 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:08:15.051 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:08:15.051 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:15.051 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:15.051 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:15.051 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.532382ms
[DEBUG] 2024-04-23 23:08:15.051 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:08:15.051 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:08:15.051 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:15.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:15.053 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:15.053 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:15.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:15.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:15.054 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:15.054 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:15.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:15.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:15.055 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:15.055 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:15.055 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:15.055 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:15.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:15.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:15.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.894037ms
[DEBUG] 2024-04-23 23:08:15.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:15.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:15.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:15.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.60954ms
[DEBUG] 2024-04-23 23:08:15.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:15.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:15.058 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:15.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:15.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:15.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.958948ms
[DEBUG] 2024-04-23 23:08:15.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:15.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:08:15.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:15.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:15.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:15.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:15.060 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:15.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:15.061 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:15.061 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:15.061 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:15.061 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:15.061 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:15.061 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:15.061 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:15.061 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:15.062 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:08:15.062 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:15.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:15.062 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:15.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:15.063 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:15.435 [HikariPool-6 housekeeper] HikariPool - HikariPool-6 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:08:17.063 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:08:17.063 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:08:17.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:17.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:17.066 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:17.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:17.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:17.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.172656ms
[DEBUG] 2024-04-23 23:08:17.067 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:08:17.067 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:08:17.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:17.068 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:17.069 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:17.069 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.648504ms
[DEBUG] 2024-04-23 23:08:17.069 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:08:17.069 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:08:17.069 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:17.070 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:17.070 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:17.070 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:17.070 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:17.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:17.071 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:17.071 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:17.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:17.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:17.072 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:17.072 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:17.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:17.072 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:17.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:17.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:17.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.807934ms
[DEBUG] 2024-04-23 23:08:17.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:17.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:17.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:17.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.452841ms
[DEBUG] 2024-04-23 23:08:17.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:17.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:17.074 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:17.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:17.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:17.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.703595ms
[DEBUG] 2024-04-23 23:08:17.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:17.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:08:17.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:17.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:17.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:17.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:17.076 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:17.076 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:17.076 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:17.076 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:17.076 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:17.076 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:17.076 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:17.077 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:17.077 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:17.077 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:17.077 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:08:17.077 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:17.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:17.077 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:17.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:17.078 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:18.036 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:08:18.040 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:08:19.078 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:08:19.079 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:08:19.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:19.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:19.081 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:19.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:19.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:19.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.1915ms
[DEBUG] 2024-04-23 23:08:19.082 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:08:19.082 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:08:19.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:19.084 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:19.084 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:19.084 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.421119ms
[DEBUG] 2024-04-23 23:08:19.084 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:08:19.084 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:08:19.084 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:19.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:19.085 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:19.085 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:19.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:19.086 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:19.086 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:19.086 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:19.086 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:19.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:19.087 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:19.087 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:19.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:19.088 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:19.088 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:19.088 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:19.088 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.849243ms
[DEBUG] 2024-04-23 23:08:19.088 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:19.088 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:19.088 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:19.088 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.452957ms
[DEBUG] 2024-04-23 23:08:19.088 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:19.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:19.089 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:19.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:19.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:19.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.784023ms
[DEBUG] 2024-04-23 23:08:19.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:19.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:08:19.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:19.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:19.091 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:19.091 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:19.091 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:19.092 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:19.092 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:19.092 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:19.092 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:19.092 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:19.092 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:19.092 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:19.092 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:19.092 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:19.092 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:08:19.092 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:19.092 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:19.093 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:19.093 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:19.093 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:21.094 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:08:21.094 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:08:21.094 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:21.094 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:21.097 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:21.097 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:21.097 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:21.097 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.193282ms
[DEBUG] 2024-04-23 23:08:21.098 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:08:21.098 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:08:21.098 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:21.098 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:21.098 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:21.098 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.495316ms
[DEBUG] 2024-04-23 23:08:21.098 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:08:21.098 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:08:21.098 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:21.099 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:21.099 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:21.100 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:21.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:21.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:21.100 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:21.100 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:21.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:21.101 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:21.101 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:21.101 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:21.101 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:21.102 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:21.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:21.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:21.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.782262ms
[DEBUG] 2024-04-23 23:08:21.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:21.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:21.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:21.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.444082ms
[DEBUG] 2024-04-23 23:08:21.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:21.103 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:21.104 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:21.104 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:21.104 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:21.104 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.773977ms
[DEBUG] 2024-04-23 23:08:21.104 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:21.104 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:08:21.104 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:21.104 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:21.105 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:21.105 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:21.105 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:21.106 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:21.106 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:21.106 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:21.106 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:21.106 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:21.106 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:21.106 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:21.106 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:21.106 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:21.106 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:08:21.106 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:21.106 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:21.107 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:21.107 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:21.107 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:23.108 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:08:23.108 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:08:23.108 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:23.108 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:23.112 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:23.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:23.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:23.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 4.936196ms
[DEBUG] 2024-04-23 23:08:23.113 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:08:23.113 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:08:23.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:23.114 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:23.114 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:23.114 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.769285ms
[DEBUG] 2024-04-23 23:08:23.114 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:08:23.114 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:08:23.114 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:23.116 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:23.116 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:23.116 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:23.116 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:23.118 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:23.118 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:23.118 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:23.118 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:23.119 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:23.119 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:23.119 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:23.119 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:23.120 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:23.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:23.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:23.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.314175ms
[DEBUG] 2024-04-23 23:08:23.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:23.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:23.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:23.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.755673ms
[DEBUG] 2024-04-23 23:08:23.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:23.122 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:23.123 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:23.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:23.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:23.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.268175ms
[DEBUG] 2024-04-23 23:08:23.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:23.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:08:23.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:23.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:23.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:23.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:23.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:23.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:23.126 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:23.126 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:23.126 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:23.126 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:23.126 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:23.126 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:23.127 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:23.127 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:23.127 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:08:23.127 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:23.127 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:23.127 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:23.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:23.128 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:23.334 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:08:25.128 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:08:25.128 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:08:25.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:25.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:25.131 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:25.131 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:25.131 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:25.131 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 2.623562ms
[DEBUG] 2024-04-23 23:08:25.131 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:08:25.131 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:08:25.131 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:25.132 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:25.132 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:25.132 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.470652ms
[DEBUG] 2024-04-23 23:08:25.132 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:08:25.132 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:08:25.132 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:25.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:25.133 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:25.133 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:25.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:25.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:25.134 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:25.134 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:25.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:25.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:25.134 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:25.134 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:25.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:25.135 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:25.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:25.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:25.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.738522ms
[DEBUG] 2024-04-23 23:08:25.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:25.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:25.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:25.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.413502ms
[DEBUG] 2024-04-23 23:08:25.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:25.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:25.137 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:25.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:25.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:25.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.727106ms
[DEBUG] 2024-04-23 23:08:25.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:25.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:08:25.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:25.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:25.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:25.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:25.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:25.139 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:25.139 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:25.139 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:25.139 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:25.139 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:25.139 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:25.139 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:25.139 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:25.139 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:25.139 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:08:25.139 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:25.139 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:25.140 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:25.140 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:25.140 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:27.141 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:08:27.141 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:08:27.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:27.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:27.144 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:27.144 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:27.144 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:27.144 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.163936ms
[DEBUG] 2024-04-23 23:08:27.145 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:08:27.145 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:08:27.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:27.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:27.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:27.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.519591ms
[DEBUG] 2024-04-23 23:08:27.145 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:08:27.145 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:08:27.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:27.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:27.147 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:27.147 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:27.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:27.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:27.147 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:27.147 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:27.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:27.148 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:27.148 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:27.148 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:27.148 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:27.149 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:27.149 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:27.149 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:27.149 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.891853ms
[DEBUG] 2024-04-23 23:08:27.149 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:27.150 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:27.150 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:27.150 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.683771ms
[DEBUG] 2024-04-23 23:08:27.150 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:27.151 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:27.151 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:27.151 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:27.151 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:27.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.828865ms
[DEBUG] 2024-04-23 23:08:27.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:27.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:08:27.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:27.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:27.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:27.153 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:27.153 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:27.154 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:27.154 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:27.154 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:27.154 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:27.154 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:27.154 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:27.154 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:27.154 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:27.154 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:27.154 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:08:27.155 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:27.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:27.155 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:27.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:27.156 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:29.156 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:08:29.156 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:08:29.156 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:29.156 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:29.159 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:29.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:29.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:29.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.369088ms
[DEBUG] 2024-04-23 23:08:29.160 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:08:29.160 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:08:29.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:29.161 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:29.161 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:29.161 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.14705ms
[DEBUG] 2024-04-23 23:08:29.161 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:08:29.161 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:08:29.161 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:29.162 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:29.162 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:29.162 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:29.162 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:29.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:29.163 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:29.163 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:29.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:29.164 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:29.164 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:29.164 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:29.164 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:29.165 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:29.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:29.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:29.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.227592ms
[DEBUG] 2024-04-23 23:08:29.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:29.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:29.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:29.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.792484ms
[DEBUG] 2024-04-23 23:08:29.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:29.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:29.168 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:29.168 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:29.168 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:29.168 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.250596ms
[DEBUG] 2024-04-23 23:08:29.168 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:29.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:08:29.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:29.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:29.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:29.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:29.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:29.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:29.172 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:29.172 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:29.172 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:29.172 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:29.172 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:29.172 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:29.172 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:29.172 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:08:29.172 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:08:29.172 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:29.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:29.174 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1370759172 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:29.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:29.174 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:29.174 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713910088938 end=1713910109174 duration=20236 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=-1 error=true>
[INFO ] 2024-04-23 23:08:29.175 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:08:29.175 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:08:29.176 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:08:29.176 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:08:29.183 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:08:29.183 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:08:29.183 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:08:29.183 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:08:29.184 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:08:29.220 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761;create=true
[INFO ] 2024-04-23 23:08:29.678 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:08:29.678 [MetaStoreThread-40761] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] HMSHandler - 24: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761;create=true
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761;create=true
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:08:29.679 [MetaStoreThread-40761] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39173;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761;create=true
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 120
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:08:29.680 [MetaStoreThread-40761] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:29.681 [MetaStoreThread-40761] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:08:29.681 [MetaStoreThread-40761] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - HikariPool-8 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - HikariPool-8 - configuration:
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761;create=true"
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - poolName........................"HikariPool-8"
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:08:29.682 [MetaStoreThread-40761] HikariDataSource - HikariPool-8 - Starting...
[INFO ] 2024-04-23 23:08:29.684 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:08:29.684 [MetaStoreThread-40761] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[INFO ] 2024-04-23 23:08:29.684 [MetaStoreThread-40761] HikariDataSource - HikariPool-8 - Start completed.
[DEBUG] 2024-04-23 23:08:29.784 [HikariPool-8 housekeeper] HikariPool - HikariPool-8 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:08:29.786 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1371206468 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:29.787 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@277346687 (XID = 1154), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:29.789 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@568133890 (XID = 1156), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:29.790 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1890059824 (XID = 1158), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:29.791 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1090794353 (XID = 1160), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:29.792 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1961269793 (XID = 1162), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:29.794 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1509931536 (XID = 1164), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:29.795 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@555205203 (XID = 1166), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:29.796 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@955176548 (XID = 1168), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:29.796 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:08:29.819 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:08:29.819 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:08:29.819 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:08:29.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@723a5fab, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@32f26616 will be shutdown
[DEBUG] 2024-04-23 23:08:29.819 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:08:29.819 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:08:29.963 [MetaStoreThread-40761] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:08:29.963 [MetaStoreThread-40761] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@70a84c4e, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:08:29.963 [MetaStoreThread-40761] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:08:29.963 [MetaStoreThread-40761] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@70a84c4e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2c8887fa created in the thread with id: 215
[DEBUG] 2024-04-23 23:08:29.963 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:29.964 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:29.964 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.065 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.130 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1371206468 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.145 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1371206468 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.183 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1371206468 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.199 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1371206468 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.204 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1371206468 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.313 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1371206468 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.339 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1371206468 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.345 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1371206468 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.351 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1371206468 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.354 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.355 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.355 [MetaStoreThread-40761] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:08:30.355 [MetaStoreThread-40761] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:08:30.355 [MetaStoreThread-40761] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@70a84c4e from thread id: 215
[DEBUG] 2024-04-23 23:08:30.355 [MetaStoreThread-40761] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:08:30.355 [MetaStoreThread-40761] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.358 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.360 [MetaStoreThread-40761] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.361 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[INFO ] 2024-04-23 23:08:30.361 [MetaStoreThread-40761] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:08:30.361 [MetaStoreThread-40761] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.361 [MetaStoreThread-40761] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.361 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.361 [MetaStoreThread-40761] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.362 [MetaStoreThread-40761] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.364 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.364 [MetaStoreThread-40761] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.366 [MetaStoreThread-40761] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:30.366 [MetaStoreThread-40761] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.366 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.366 [MetaStoreThread-40761] ObjectStore - db details for db default retrieved using SQL in 1.813048ms
[DEBUG] 2024-04-23 23:08:30.366 [MetaStoreThread-40761] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:08:30.366 [MetaStoreThread-40761] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:08:30.366 [MetaStoreThread-40761] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.371 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.373 [MetaStoreThread-40761] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.373 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.376 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[INFO ] 2024-04-23 23:08:30.376 [MetaStoreThread-40761] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:08:30.376 [MetaStoreThread-40761] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.376 [MetaStoreThread-40761] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.379 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.381 [MetaStoreThread-40761] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.383 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1371206468 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.385 [MetaStoreThread-40761] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.385 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[INFO ] 2024-04-23 23:08:30.385 [MetaStoreThread-40761] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:08:30.385 [MetaStoreThread-40761] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.385 [MetaStoreThread-40761] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.386 [MetaStoreThread-40761] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.386 [MetaStoreThread-40761] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.387 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[INFO ] 2024-04-23 23:08:30.387 [MetaStoreThread-40761] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:08:30.387 [MetaStoreThread-40761] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.387 [MetaStoreThread-40761] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.387 [MetaStoreThread-40761] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.388 [MetaStoreThread-40761] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.391 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1371206468 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.393 [MetaStoreThread-40761] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.396 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1371206468 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.397 [MetaStoreThread-40761] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.398 [MetaStoreThread-40761] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[INFO ] 2024-04-23 23:08:30.398 [MetaStoreThread-40761] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:08:30.398 [MetaStoreThread-40761] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:08:30.398 [MetaStoreThread-40761] PerfLogger - </PERFLOG method=init start=1713910109679 end=1713910110398 duration=719 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[INFO ] 2024-04-23 23:08:30.398 [MetaStoreThread-40761] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:08:30.398 [MetaStoreThread-40761] HiveMetaStore - Started the new metaserver on port [40761]...
[INFO ] 2024-04-23 23:08:30.398 [MetaStoreThread-40761] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:08:30.398 [MetaStoreThread-40761] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:08:30.398 [MetaStoreThread-40761] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:08:30.398 [MetaStoreThread-40761] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:08:30.398 [MetaStoreThread-40761] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:08:30.398 [MetaStoreThread-40761] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:08:30.398 [MetaStoreThread-40761] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:08:30.398 [MetaStoreThread-40761] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:08:30.398 [MetaStoreThread-40761] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:08:30.398 [MetaStoreThread-40761] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:08:30.398 [MetaStoreThread-40761] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:08:30.398 [MetaStoreThread-40761] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:08:30.398 [MetaStoreThread-40761] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:08:30.398 [MetaStoreThread-40761] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:08:30.398 [MetaStoreThread-40761] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:08:30.398 [MetaStoreThread-40761] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:08:30.679 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:08:30.679 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 25: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:08:30.679 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:08:30.683 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/40761) is created
[INFO ] 2024-04-23 23:08:30.683 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 40761 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/40761 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761;create=true
[INFO ] 2024-04-23 23:08:30.683 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:08:30.687 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:08:30.687 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:40761]
[INFO ] 2024-04-23 23:08:30.687 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:40761)
[INFO ] 2024-04-23 23:08:30.687 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:40761) current connections: 5
[DEBUG] 2024-04-23 23:08:30.688 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:30.688 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910110688 end=1713910110688 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:30.691 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:30.693 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_catalog from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:30.693 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 create_catalog: Catalog(name:cat3, locationUri:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3)
[INFO ] 2024-04-23 23:08:30.693 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_catalog: Catalog(name:cat3, locationUri:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3)	
[INFO ] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761;create=true
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761;create=true
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4b792b31, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:08:30.694 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:08:30.695 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4b792b31, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@29f452d2 created in the thread with id: 232
[DEBUG] 2024-04-23 23:08:30.695 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.695 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.695 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.696 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.697 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.697 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:08:30.697 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:08:30.697 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4b792b31 from thread id: 232
[DEBUG] 2024-04-23 23:08:30.697 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog cat3
[DEBUG] 2024-04-23 23:08:30.698 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.698 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.698 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.698 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:08:30.698 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:08:30.698 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:08:30.698 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:08:30.698 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: /home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3
[DEBUG] 2024-04-23 23:08:30.700 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.701 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Creating catalog Catalog(name:cat3, locationUri:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3, createTime:1713910110)
[DEBUG] 2024-04-23 23:08:30.701 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.704 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.705 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.705 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog cat3
[DEBUG] 2024-04-23 23:08:30.705 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.707 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.707 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.707 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:30.708 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:30.708 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.708 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.709 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.709 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_catalog start=1713910110693 end=1713910110709 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:30.710 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:30.710 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:30.710 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 create_database: Database(name:db3, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:cat3, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:08:30.710 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db3, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:cat3, createTime:0, type:NATIVE)	
[DEBUG] 2024-04-23 23:08:30.710 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.711 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:30.712 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.712 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.712 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.431107ms
[DEBUG] 2024-04-23 23:08:30.712 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database cat3.db3, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:08:30.712 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog cat3
[DEBUG] 2024-04-23 23:08:30.712 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.712 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.712 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.713 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:08:30.713 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:08:30.713 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:08:30.713 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:08:30.713 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Creating database path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db
[INFO ] 2024-04-23 23:08:30.713 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db
[DEBUG] 2024-04-23 23:08:30.716 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.716 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.716 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.716 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.717 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.717 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713910110710 end=1713910110717 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:30.718 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:30.718 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:30.718 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 create_table_req: Table(tableName:tbl3, dbName:db3, owner:alex, createTime:1713910110, lastAccessTime:1713910110, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:s, type:string, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:d, type:date, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:cat3, ownerType:USER)
[INFO ] 2024-04-23 23:08:30.718 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl3, dbName:db3, owner:alex, createTime:1713910110, lastAccessTime:1713910110, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:s, type:string, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:d, type:date, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:cat3, ownerType:USER)	
[DEBUG] 2024-04-23 23:08:30.718 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.721 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:30.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:30.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.722 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.828808ms
[DEBUG] 2024-04-23 23:08:30.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:08:30.726 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.726 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.726 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.726 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.726 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.727 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:30.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:30.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.174374ms
[DEBUG] 2024-04-23 23:08:30.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:30.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:08:30.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:30.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.728 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:08:30.728 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:08:30.728 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:08:30.729 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:08:30.729 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db/tbl3
[DEBUG] 2024-04-23 23:08:30.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:30.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:30.737 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1371206468 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.742 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1371206468 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.747 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1371206468 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.752 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1371206468 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.763 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.763 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.765 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.766 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713910110718 end=1713910110766 duration=48 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:30.766 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:30.767 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:30.767 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:08:30.767 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:08:30.767 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.767 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.767 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:30.767 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:08:30.776 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:30.799 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.799 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.805 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:08:30.805 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:08:30.805 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:08:30.805 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:08:30.805 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db/tbl3/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:08:30.810 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.810 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:30.810 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:08:30.811 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:30.815 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1371206468 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.828 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.829 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910110767 end=1713910110829 duration=62 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:30.829 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:30.829 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:30.829 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:08:30.829 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:08:30.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:30.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:08:30.831 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:30.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.835 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.835 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:08:30.835 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:08:30.835 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:08:30.835 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:08:30.835 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db/tbl3/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:08:30.839 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.839 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:30.839 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:08:30.840 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:30.843 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.843 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.845 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.847 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910110829 end=1713910110847 duration=18 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:30.847 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:30.847 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:30.847 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:08:30.847 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:08:30.847 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.847 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.847 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:30.847 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:08:30.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:30.852 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.852 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.853 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:08:30.853 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:08:30.853 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:08:30.853 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:08:30.853 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db/tbl3/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:08:30.857 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.857 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:30.857 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:08:30.858 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:30.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.863 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.865 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910110847 end=1713910110865 duration=18 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:30.866 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:30.866 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:30.866 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713910110866 end=1713910110866 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:30.866 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:30.866 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:30.866 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_table : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:08:30.866 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:08:30.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.867 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:30.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:30.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.868 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.78636ms
[DEBUG] 2024-04-23 23:08:30.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:08:30.871 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.877 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[INFO ] 2024-04-23 23:08:30.878 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:08:30.878 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713910110866 end=1713910110878 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:30.878 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=12, comments=HMS client
[DEBUG] 2024-04-23 23:08:30.879 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:30.879 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:30.879 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:08:30.880 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:08:30.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:08:30.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.885 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 5.340649ms + 0.008891ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:08:30.890 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.277339ms + 0.122083ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:08:30.893 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.498977ms + 0.419083ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:08:30.896 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.318763ms + 0.300781ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:30.899 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.465869ms + 0.238438ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:08:30.902 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.677502ms + 0.211698ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:30.905 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.391311ms + 0.20675ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:30.907 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.312506ms + 0.213801ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:30.910 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.565423ms + 0.493702ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:30.913 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.438397ms + 0.207116ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:08:30.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:30.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 33.07666ms
[DEBUG] 2024-04-23 23:08:30.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.913 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.914 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910110879 end=1713910110914 duration=35 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:30.924 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:30.924 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:30.924 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 alter_table: cat3.db3.tbl3 newtbl=tbl3
[INFO ] 2024-04-23 23:08:30.924 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: cat3.db3.tbl3 newtbl=tbl3	
[DEBUG] 2024-04-23 23:08:30.924 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.925 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:30.925 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:30.925 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.926 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.688271ms
[DEBUG] 2024-04-23 23:08:30.926 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:08:30.926 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:08:30.926 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:08:30.926 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:08:30.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.927 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:30.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:30.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.927 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.928 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.561323ms
[DEBUG] 2024-04-23 23:08:30.928 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.928 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.928 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:08:30.930 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.936 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.939 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:30.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:30.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.545503ms
[DEBUG] 2024-04-23 23:08:30.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:30.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:08:30.942 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:30.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.946 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db3
[WARN ] 2024-04-23 23:08:30.946 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:08:30.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:30.947 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:30.948 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:30.948 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:08:30.949 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:30.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:08:30.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:30.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:08:30.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:30.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.961 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.962 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713910110924 end=1713910110962 duration=38 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[INFO ] 2024-04-23 23:08:30.964 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:08:30.964 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:40761]
[INFO ] 2024-04-23 23:08:30.964 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:40761)
[INFO ] 2024-04-23 23:08:30.964 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:40761) current connections: 6
[DEBUG] 2024-04-23 23:08:30.965 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:30.965 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910110965 end=1713910110965 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=27 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:30.965 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:30.965 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:30.965 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 27: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:08:30.965 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 27: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761;create=true
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761;create=true
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:08:30.966 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:08:30.967 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:30.967 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:08:30.967 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:08:30.967 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1fcd872f, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:08:30.967 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:08:30.967 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1fcd872f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@50af17fa created in the thread with id: 246
[DEBUG] 2024-04-23 23:08:30.967 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.967 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.967 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.968 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.968 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.968 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:08:30.968 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:08:30.969 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1fcd872f from thread id: 246
[DEBUG] 2024-04-23 23:08:30.969 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.969 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:08:30.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.975 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.975 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713910110965 end=1713910110975 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=27 retryCount=0 error=false>
[INFO ] 2024-04-23 23:08:30.976 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:08:30.976 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 5
[DEBUG] 2024-04-23 23:08:30.976 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:30.976 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:30.976 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:30.976 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 27: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:08:30.976 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:08:30.976 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:08:30.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1fcd872f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@50af17fa will be shutdown
[DEBUG] 2024-04-23 23:08:30.976 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3
[DEBUG] 2024-04-23 23:08:30.976 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 27: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:08:30.976 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:08:30.976 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:08:30.976 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713910110976 end=1713910110976 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=27 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:30.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:08:30.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.976 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:08:30.977 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 27: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:08:30.977 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:08:30.978 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.315202ms + 0.007556ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:08:30.979 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.729656ms + 0.093254ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:08:30.980 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.218309ms + 0.36141ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:08:30.980 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.25765ms + 0.259252ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:30.981 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.251417ms + 0.192589ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:08:30.981 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.263364ms + 0.164823ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:30.982 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.231711ms + 0.161915ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:30.982 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.228016ms + 0.160697ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:30.983 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.286056ms + 0.430301ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:30.983 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.237252ms + 0.160242ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:08:30.983 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:30.983 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.983 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 7.185225ms
[DEBUG] 2024-04-23 23:08:30.983 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.984 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.984 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910110976 end=1713910110984 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[INFO ] 2024-04-23 23:08:30.985 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:08:30.985 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:40761]
[INFO ] 2024-04-23 23:08:30.985 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:40761)
[INFO ] 2024-04-23 23:08:30.985 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:40761) current connections: 6
[DEBUG] 2024-04-23 23:08:30.986 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:30.986 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910110986 end=1713910110986 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:30.986 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:30.986 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:30.986 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_table_metas : tbl=cat3.*.*
[INFO ] 2024-04-23 23:08:30.986 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=cat3.*.*	
[INFO ] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761;create=true
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761;create=true
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@12f33f20, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:08:30.987 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:08:30.988 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@12f33f20, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@232b29ef created in the thread with id: 247
[DEBUG] 2024-04-23 23:08:30.988 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.988 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.988 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.989 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.989 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.989 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:08:30.989 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:08:30.989 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@12f33f20 from thread id: 247
[DEBUG] 2024-04-23 23:08:30.989 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.989 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: cat3, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:08:30.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.991 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.991 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713910110986 end=1713910110991 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[INFO ] 2024-04-23 23:08:30.991 [main] PartitionManagementTask - Looking for tables using catalog: cat3 dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:08:30.991 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 5
[DEBUG] 2024-04-23 23:08:30.991 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:30.991 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:30.991 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:08:30.991 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[INFO ] 2024-04-23 23:08:30.991 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:08:30.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@12f33f20, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@232b29ef will be shutdown
[DEBUG] 2024-04-23 23:08:30.991 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:30.992 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3
[DEBUG] 2024-04-23 23:08:30.992 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:08:30.992 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:08:30.992 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:08:30.992 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713910110991 end=1713910110992 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:30.992 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:08:30.992 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:30.992 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:30.992 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:08:30.992 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:08:30.992 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:08:30.993 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.022878ms + 0.00697ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:08:30.994 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.58409ms + 0.090994ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:08:30.995 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.212278ms + 0.364157ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:08:30.995 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.22376ms + 0.222993ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:30.996 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.232457ms + 0.159316ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:08:30.996 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.220516ms + 0.154717ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:30.996 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.217716ms + 0.153534ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:30.997 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.216594ms + 0.157951ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:30.997 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.276353ms + 0.336434ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:30.998 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.231149ms + 0.160915ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:08:30.998 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:30.998 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:30.998 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 6.194072ms
[DEBUG] 2024-04-23 23:08:30.998 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:30.998 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:30.998 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910110991 end=1713910110998 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:30.999 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:30.999 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:30.999 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:08:30.999 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:08:30.999 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:08:30.999 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:31.001 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:31.002 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:31.002 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713910110999 end=1713910111002 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:31.002 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:31.002 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:31.002 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_databases: @cat3#
[INFO ] 2024-04-23 23:08:31.002 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @cat3#	
[DEBUG] 2024-04-23 23:08:31.002 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:31.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:31.005 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:31.006 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713910111002 end=1713910111006 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:31.006 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:31.006 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:31.006 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_database: db3
[INFO ] 2024-04-23 23:08:31.006 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db3	
[DEBUG] 2024-04-23 23:08:31.006 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:31.007 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:31.007 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:31.007 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:31.007 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:31.007 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.302676ms
[DEBUG] 2024-04-23 23:08:31.007 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713910111006 end=1713910111007 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:31.008 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:08:31.008 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:31.008 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:31.008 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_tables_by_type: db=@hive#db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:31.008 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:31.008 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:31.008 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:31.008 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:31.008 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:31.008 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:31.008 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:31.008 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.533611ms
[DEBUG] 2024-04-23 23:08:31.008 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db3, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:08:31.008 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:31.011 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:31.011 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:31.011 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:31.011 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.258718ms
[DEBUG] 2024-04-23 23:08:31.011 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713910111008 end=1713910111011 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:31.011 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:31.011 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:31.011 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@hive#db3
[INFO ] 2024-04-23 23:08:31.011 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db3	
[DEBUG] 2024-04-23 23:08:31.011 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:31.013 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:31.013 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:31.013 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:31.013 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.168504ms
[DEBUG] 2024-04-23 23:08:31.013 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713910111011 end=1713910111013 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:31.013 [main] HiveMetaStoreClient - Selecting dropDatabase method for db3 (0 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:08:31.013 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:08:31.014 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:31.014 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:31.014 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:31.014 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:31.014 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:31.014 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:31.014 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.576569ms
[DEBUG] 2024-04-23 23:08:31.014 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db3, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:08:31.014 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_multi_table : db=db3 tbls=
[INFO ] 2024-04-23 23:08:31.014 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db3 tbls=	
[DEBUG] 2024-04-23 23:08:31.014 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713910111014 end=1713910111014 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:31.014 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:31.015 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:31.015 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:08:31.015 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:08:31.015 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:31.015 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:31.015 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:31.015 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:31.015 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:31.015 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.781282ms
[DEBUG] 2024-04-23 23:08:31.015 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:08:31.016 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:08:31.016 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:31.016 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:31.016 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:31.016 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.552068ms
[DEBUG] 2024-04-23 23:08:31.016 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:08:31.016 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:08:31.016 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:31.023 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1371206468 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:31.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:31.026 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:31.026 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:31.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:31.030 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1371206468 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:31.033 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:31.033 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:31.033 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:31.033 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:31.051 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1371206468 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:31.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:31.055 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:08:31.055 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:08:31.055 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:08:31.055 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:08:31.055 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:31.055 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:31.055 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:31.056 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:31.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:31.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:31.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.394619ms
[DEBUG] 2024-04-23 23:08:31.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:31.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:31.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:31.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.769909ms
[DEBUG] 2024-04-23 23:08:31.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:31.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:31.064 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:31.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:31.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:31.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.340772ms
[DEBUG] 2024-04-23 23:08:31.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:31.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:08:31.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:31.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:31.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:31.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:31.087 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1371206468 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:31.091 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:31.097 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:31.097 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:31.097 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:31.097 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:08:31.097 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:31.097 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:31.098 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:31.098 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:31.099 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:33.100 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:08:33.100 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:08:33.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:33.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:33.103 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:33.103 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:33.103 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:33.103 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.032651ms
[DEBUG] 2024-04-23 23:08:33.103 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:08:33.103 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:08:33.103 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:33.105 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:33.105 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:33.105 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.600501ms
[DEBUG] 2024-04-23 23:08:33.105 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:08:33.105 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:08:33.105 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:33.107 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:33.107 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:33.107 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:33.107 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:33.107 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:33.108 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:33.108 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:33.108 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:33.108 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:33.108 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:33.108 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:33.108 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:33.109 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:33.109 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:33.109 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:33.109 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.982703ms
[DEBUG] 2024-04-23 23:08:33.109 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:33.110 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:33.110 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:33.110 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.408614ms
[DEBUG] 2024-04-23 23:08:33.110 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:33.110 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:33.111 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:33.111 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:33.111 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:33.111 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.75025ms
[DEBUG] 2024-04-23 23:08:33.111 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:33.111 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:08:33.111 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:33.111 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:33.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:33.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:33.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:33.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:33.113 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:33.113 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:33.113 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:08:33.113 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:33.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:33.115 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:33.115 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:33.116 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:35.117 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:08:35.117 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:08:35.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:35.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:35.120 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:35.120 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:35.120 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:35.120 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.114852ms
[DEBUG] 2024-04-23 23:08:35.120 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:08:35.120 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:08:35.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:35.122 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:35.122 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:35.122 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.306335ms
[DEBUG] 2024-04-23 23:08:35.122 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:08:35.122 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:08:35.122 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:35.123 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:35.123 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:35.123 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:35.123 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:35.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:35.124 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:35.124 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:35.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:35.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:35.125 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:35.125 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:35.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:35.125 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:35.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:35.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:35.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.761947ms
[DEBUG] 2024-04-23 23:08:35.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:35.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:35.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:35.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.418537ms
[DEBUG] 2024-04-23 23:08:35.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:35.127 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:35.127 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:35.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:35.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:35.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.974368ms
[DEBUG] 2024-04-23 23:08:35.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:35.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:08:35.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:35.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:35.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:35.129 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:35.129 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:35.130 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:35.130 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:35.130 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:35.130 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:08:35.130 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:35.130 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:35.131 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:35.131 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:35.131 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:37.132 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:08:37.132 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:08:37.132 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:37.132 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:37.134 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:37.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:37.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:37.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 2.527342ms
[DEBUG] 2024-04-23 23:08:37.135 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:08:37.135 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:08:37.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:37.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:37.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:37.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.512127ms
[DEBUG] 2024-04-23 23:08:37.135 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:08:37.135 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:08:37.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:37.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:37.137 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:37.137 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:37.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:37.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:37.137 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:37.137 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:37.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:37.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:37.138 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:37.138 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:37.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:37.139 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:37.139 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:37.139 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:37.139 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.788531ms
[DEBUG] 2024-04-23 23:08:37.139 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:37.139 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:37.139 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:37.139 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.459474ms
[DEBUG] 2024-04-23 23:08:37.139 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:37.140 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:37.140 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:37.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:37.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:37.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.756021ms
[DEBUG] 2024-04-23 23:08:37.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:37.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:08:37.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:37.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:37.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:37.142 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:37.142 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:37.143 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:37.143 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:37.143 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:37.143 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:08:37.143 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:37.143 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:37.144 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:37.144 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:37.144 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:37.670 [HikariPool-7 housekeeper] HikariPool - HikariPool-7 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:08:39.000 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:08:39.144 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:08:39.145 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:08:39.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:39.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:39.147 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:39.148 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:39.148 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:39.148 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.230489ms
[DEBUG] 2024-04-23 23:08:39.148 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:08:39.148 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:08:39.148 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:39.149 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:39.149 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:39.149 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.458512ms
[DEBUG] 2024-04-23 23:08:39.149 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:08:39.149 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:08:39.149 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:39.150 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:39.150 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:39.150 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:39.150 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:39.151 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:39.151 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:39.151 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:39.151 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:39.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:39.152 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:39.152 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:39.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:39.152 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:39.153 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:39.153 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:39.153 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.769781ms
[DEBUG] 2024-04-23 23:08:39.153 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:39.153 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:39.153 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:39.153 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.447175ms
[DEBUG] 2024-04-23 23:08:39.153 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:39.154 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:39.154 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:39.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:39.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:39.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.819768ms
[DEBUG] 2024-04-23 23:08:39.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:39.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:08:39.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:39.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:39.156 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:39.156 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:39.156 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:39.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:39.157 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:39.157 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:39.157 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:08:39.157 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:39.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:39.158 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:39.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:39.158 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:41.159 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:08:41.159 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:08:41.159 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:41.159 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:41.162 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:41.162 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:41.162 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:41.162 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 2.694761ms
[DEBUG] 2024-04-23 23:08:41.162 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:08:41.162 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:08:41.162 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:41.162 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:41.162 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:41.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.451413ms
[DEBUG] 2024-04-23 23:08:41.163 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:08:41.163 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:08:41.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:41.164 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:41.164 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:41.164 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:41.164 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:41.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:41.165 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:41.165 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:41.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:41.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:41.166 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:41.166 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:41.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:41.167 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:41.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:41.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:41.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.871518ms
[DEBUG] 2024-04-23 23:08:41.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:41.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:41.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:41.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.468673ms
[DEBUG] 2024-04-23 23:08:41.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:41.168 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:41.169 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:41.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:41.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:41.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.779843ms
[DEBUG] 2024-04-23 23:08:41.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:41.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:08:41.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:41.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:41.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:41.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:41.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:41.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:41.171 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:41.171 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:41.171 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:08:41.171 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:41.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:41.172 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:41.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:41.172 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:43.173 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:08:43.173 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:08:43.173 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:43.173 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:43.175 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:43.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:43.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:43.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.214243ms
[DEBUG] 2024-04-23 23:08:43.176 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:08:43.176 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:08:43.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:43.177 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:43.177 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:43.177 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.495047ms
[DEBUG] 2024-04-23 23:08:43.177 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:08:43.177 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:08:43.177 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:43.178 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:43.178 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:43.179 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:43.179 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:43.179 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:43.179 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:43.179 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:43.179 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:43.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:43.180 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:43.180 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:43.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:43.181 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:43.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:43.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:43.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.729351ms
[DEBUG] 2024-04-23 23:08:43.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:43.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:43.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:43.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.422096ms
[DEBUG] 2024-04-23 23:08:43.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:43.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:43.182 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:43.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:43.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:43.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.742227ms
[DEBUG] 2024-04-23 23:08:43.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:43.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:08:43.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:43.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:43.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:43.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:43.184 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:43.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:43.185 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:43.185 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:43.185 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:08:43.185 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:43.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:43.186 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:43.186 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:43.186 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:44.461 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:08:45.187 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:08:45.187 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:08:45.187 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:45.187 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:45.190 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:45.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:45.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:45.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.369041ms
[DEBUG] 2024-04-23 23:08:45.191 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:08:45.191 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:08:45.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:45.192 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:45.192 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:45.192 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.497357ms
[DEBUG] 2024-04-23 23:08:45.192 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:08:45.192 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:08:45.192 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:45.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:45.193 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:45.193 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:45.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:45.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:45.194 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:45.194 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:45.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:45.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:45.195 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:45.195 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:45.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:45.195 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:45.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:45.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:45.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.796018ms
[DEBUG] 2024-04-23 23:08:45.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:45.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:45.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:45.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.474187ms
[DEBUG] 2024-04-23 23:08:45.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:45.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:45.197 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:45.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:45.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:45.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.773637ms
[DEBUG] 2024-04-23 23:08:45.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:45.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:08:45.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:45.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:45.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:45.199 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:45.199 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:45.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:45.200 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:45.200 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:45.200 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:08:45.200 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:45.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:45.201 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:45.201 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:45.201 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:45.435 [HikariPool-6 housekeeper] HikariPool - HikariPool-6 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:08:47.202 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:08:47.202 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:08:47.202 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:47.202 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:47.204 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:47.204 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:47.204 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:47.204 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 2.300324ms
[DEBUG] 2024-04-23 23:08:47.204 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:08:47.204 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:08:47.204 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:47.205 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:47.205 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:47.205 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.440055ms
[DEBUG] 2024-04-23 23:08:47.205 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:08:47.205 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:08:47.205 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:47.206 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:47.207 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:47.207 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:47.207 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:47.207 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:47.207 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:47.207 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:47.207 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:47.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:47.208 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:47.208 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:47.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:47.209 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:47.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:47.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:47.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.795946ms
[DEBUG] 2024-04-23 23:08:47.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:47.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:47.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:47.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.45943ms
[DEBUG] 2024-04-23 23:08:47.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:47.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:47.211 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:47.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:47.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:47.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.781483ms
[DEBUG] 2024-04-23 23:08:47.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:47.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:08:47.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:47.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:47.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:47.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:47.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:47.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:47.213 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:47.213 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:47.213 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:08:47.213 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:47.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:47.214 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:47.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:47.214 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:48.037 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:08:48.041 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:08:49.215 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:08:49.215 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:08:49.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:49.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:49.217 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:49.218 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:49.218 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:49.218 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.1404ms
[DEBUG] 2024-04-23 23:08:49.218 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:08:49.218 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:08:49.219 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:49.220 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:49.220 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:49.220 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.681854ms
[DEBUG] 2024-04-23 23:08:49.220 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:08:49.220 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:08:49.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:49.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:49.222 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:49.222 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:49.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:49.223 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:49.223 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:49.223 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:49.223 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:49.223 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:49.224 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:49.224 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:49.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:49.224 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:49.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:49.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:49.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.764004ms
[DEBUG] 2024-04-23 23:08:49.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:49.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:49.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:49.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.438948ms
[DEBUG] 2024-04-23 23:08:49.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:49.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:49.226 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:49.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:49.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:49.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.835154ms
[DEBUG] 2024-04-23 23:08:49.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:49.227 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:08:49.227 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:49.227 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:49.227 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:49.227 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:49.228 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:49.228 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:49.229 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:49.229 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:49.229 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:08:49.229 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:49.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:49.229 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:49.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:49.230 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:51.230 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:08:51.231 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:08:51.231 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:51.231 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:51.233 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:51.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:51.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:51.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.122859ms
[DEBUG] 2024-04-23 23:08:51.234 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:08:51.234 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:08:51.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:51.236 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:51.236 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:51.236 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.789235ms
[DEBUG] 2024-04-23 23:08:51.236 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:08:51.236 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:08:51.236 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:51.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:51.237 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:51.238 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:51.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:51.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:51.238 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:51.238 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:51.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:51.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:51.239 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:51.239 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:51.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:51.240 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:51.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:51.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:51.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.826282ms
[DEBUG] 2024-04-23 23:08:51.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:51.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:51.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:51.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.470517ms
[DEBUG] 2024-04-23 23:08:51.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:51.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:51.242 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:51.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:51.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:51.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.771102ms
[DEBUG] 2024-04-23 23:08:51.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:51.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:08:51.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:51.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:51.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:51.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:51.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:51.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:51.244 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:51.244 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:51.244 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:08:51.244 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:51.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:51.245 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@521001133 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:51.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:51.245 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:51.245 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713910111015 end=1713910131245 duration=20230 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=-1 error=true>
[INFO ] 2024-04-23 23:08:51.246 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:08:51.246 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:08:51.246 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:08:51.246 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:08:51.253 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:08:51.254 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:08:51.254 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:08:51.254 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:08:51.256 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:08:51.291 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183;create=true
[INFO ] 2024-04-23 23:08:51.731 [MetaStoreThread-34183] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:08:51.732 [MetaStoreThread-34183] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:08:51.731 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:08:51.732 [MetaStoreThread-34183] HMSHandler - 29: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183;create=true
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183;create=true
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_40761;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183;create=true
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 120
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:51.733 [MetaStoreThread-34183] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:51.734 [MetaStoreThread-34183] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:51.734 [MetaStoreThread-34183] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:08:51.734 [MetaStoreThread-34183] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:08:51.734 [MetaStoreThread-34183] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:51.735 [MetaStoreThread-34183] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:08:51.735 [MetaStoreThread-34183] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:08:51.735 [MetaStoreThread-34183] HikariConfig - HikariPool-9 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:08:51.735 [MetaStoreThread-34183] HikariConfig - HikariPool-9 - configuration:
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183;create=true"
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - poolName........................"HikariPool-9"
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:08:51.736 [MetaStoreThread-34183] HikariDataSource - HikariPool-9 - Starting...
[INFO ] 2024-04-23 23:08:51.738 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:08:51.738 [MetaStoreThread-34183] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[INFO ] 2024-04-23 23:08:51.738 [MetaStoreThread-34183] HikariDataSource - HikariPool-9 - Start completed.
[DEBUG] 2024-04-23 23:08:51.838 [HikariPool-9 housekeeper] HikariPool - HikariPool-9 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:08:51.840 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@574685483 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:51.841 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1669073680 (XID = 1163), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:51.843 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1381329778 (XID = 1165), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:51.855 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@55833695 (XID = 1167), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:51.861 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@964183022 (XID = 1169), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:51.863 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@119344061 (XID = 1171), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:51.864 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1103145504 (XID = 1173), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:51.865 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@850342659 (XID = 1175), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:51.867 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@724978511 (XID = 1177), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:51.867 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:08:52.054 [MetaStoreThread-34183] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:08:52.054 [MetaStoreThread-34183] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@c3e4c17, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:08:52.054 [MetaStoreThread-34183] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:08:52.054 [MetaStoreThread-34183] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@c3e4c17, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3c1c3692 created in the thread with id: 250
[DEBUG] 2024-04-23 23:08:52.054 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.054 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.054 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.131 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.193 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@574685483 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.206 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@574685483 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.240 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@574685483 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.255 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@574685483 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.259 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@574685483 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.366 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@574685483 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.390 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@574685483 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.395 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@574685483 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.400 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@574685483 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.402 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.404 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.404 [MetaStoreThread-34183] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:08:52.404 [MetaStoreThread-34183] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:08:52.404 [MetaStoreThread-34183] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@c3e4c17 from thread id: 250
[DEBUG] 2024-04-23 23:08:52.404 [MetaStoreThread-34183] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:08:52.404 [MetaStoreThread-34183] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.407 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.409 [MetaStoreThread-34183] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.409 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[INFO ] 2024-04-23 23:08:52.409 [MetaStoreThread-34183] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:08:52.410 [MetaStoreThread-34183] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.410 [MetaStoreThread-34183] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.410 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.410 [MetaStoreThread-34183] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.411 [MetaStoreThread-34183] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.413 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.413 [MetaStoreThread-34183] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.416 [MetaStoreThread-34183] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:52.416 [MetaStoreThread-34183] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.416 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.416 [MetaStoreThread-34183] ObjectStore - db details for db default retrieved using SQL in 2.438395ms
[DEBUG] 2024-04-23 23:08:52.416 [MetaStoreThread-34183] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:08:52.416 [MetaStoreThread-34183] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:08:52.416 [MetaStoreThread-34183] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.421 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.423 [MetaStoreThread-34183] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.424 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.426 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[INFO ] 2024-04-23 23:08:52.426 [MetaStoreThread-34183] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:08:52.426 [MetaStoreThread-34183] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.426 [MetaStoreThread-34183] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.429 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.431 [MetaStoreThread-34183] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.434 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@574685483 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.435 [MetaStoreThread-34183] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.435 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[INFO ] 2024-04-23 23:08:52.435 [MetaStoreThread-34183] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:08:52.436 [MetaStoreThread-34183] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.436 [MetaStoreThread-34183] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.436 [MetaStoreThread-34183] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.436 [MetaStoreThread-34183] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.437 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[INFO ] 2024-04-23 23:08:52.437 [MetaStoreThread-34183] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:08:52.437 [MetaStoreThread-34183] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.437 [MetaStoreThread-34183] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.437 [MetaStoreThread-34183] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.437 [MetaStoreThread-34183] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.440 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@574685483 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.443 [MetaStoreThread-34183] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.445 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@574685483 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.447 [MetaStoreThread-34183] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.447 [MetaStoreThread-34183] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[INFO ] 2024-04-23 23:08:52.447 [MetaStoreThread-34183] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:08:52.447 [MetaStoreThread-34183] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:08:52.447 [MetaStoreThread-34183] PerfLogger - </PERFLOG method=init start=1713910131732 end=1713910132447 duration=715 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=29 retryCount=0 error=false>
[INFO ] 2024-04-23 23:08:52.447 [MetaStoreThread-34183] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:08:52.448 [MetaStoreThread-34183] HiveMetaStore - Started the new metaserver on port [34183]...
[INFO ] 2024-04-23 23:08:52.448 [MetaStoreThread-34183] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:08:52.448 [MetaStoreThread-34183] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:08:52.448 [MetaStoreThread-34183] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:08:52.448 [MetaStoreThread-34183] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:08:52.448 [MetaStoreThread-34183] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:08:52.448 [MetaStoreThread-34183] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:08:52.448 [MetaStoreThread-34183] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:08:52.448 [MetaStoreThread-34183] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:08:52.448 [MetaStoreThread-34183] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:08:52.448 [MetaStoreThread-34183] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:08:52.448 [MetaStoreThread-34183] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:08:52.448 [MetaStoreThread-34183] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:08:52.448 [MetaStoreThread-34183] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:08:52.448 [MetaStoreThread-34183] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:08:52.448 [MetaStoreThread-34183] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:08:52.448 [MetaStoreThread-34183] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:08:52.735 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:08:52.735 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 30: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:08:52.735 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:08:52.741 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34183) is created
[INFO ] 2024-04-23 23:08:52.741 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 34183 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34183 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183;create=true
[INFO ] 2024-04-23 23:08:52.741 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:08:52.744 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:08:52.744 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34183]
[INFO ] 2024-04-23 23:08:52.745 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34183)
[INFO ] 2024-04-23 23:08:52.745 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34183) current connections: 6
[DEBUG] 2024-04-23 23:08:52.745 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:52.745 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910132745 end=1713910132745 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:52.746 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:52.746 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:52.746 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 create_database: Database(name:db6, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:08:52.746 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db6, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:08:52.746 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183;create=true
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183;create=true
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@298c02cf, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:08:52.747 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:08:52.748 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@298c02cf, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@700d3b created in the thread with id: 267
[DEBUG] 2024-04-23 23:08:52.748 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.748 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.748 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.750 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.751 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.751 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:08:52.751 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:08:52.751 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@298c02cf from thread id: 267
[DEBUG] 2024-04-23 23:08:52.751 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.751 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:52.751 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.751 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.751 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.515434ms
[DEBUG] 2024-04-23 23:08:52.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db6, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:08:52.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:08:52.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.753 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.753 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:08:52.753 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:08:52.753 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:08:52.753 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:08:52.753 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:08:52.753 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db
[INFO ] 2024-04-23 23:08:52.753 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db
[INFO ] 2024-04-23 23:08:52.755 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db
[DEBUG] 2024-04-23 23:08:52.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.758 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.758 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713910132746 end=1713910132758 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:52.759 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:52.759 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:52.759 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 create_table_req: Table(tableName:tbl6, dbName:db6, owner:alex, createTime:1713910132, lastAccessTime:1713910132, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:d, type:date, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:l, type:bigint, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:08:52.759 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl6, dbName:db6, owner:alex, createTime:1713910132, lastAccessTime:1713910132, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:d, type:date, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:l, type:bigint, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:08:52.759 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.763 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:52.763 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:52.763 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.763 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.763 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.80303ms
[DEBUG] 2024-04-23 23:08:52.763 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.763 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.763 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:08:52.768 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.768 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.768 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.768 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.768 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.769 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:52.769 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:52.769 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.769 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.098688ms
[DEBUG] 2024-04-23 23:08:52.769 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.769 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:52.769 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:08:52.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:52.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.770 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:08:52.770 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:08:52.770 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:08:52.770 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:08:52.770 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34183/db6.db/tbl6
[DEBUG] 2024-04-23 23:08:52.775 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.775 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:52.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:52.783 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@574685483 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.788 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@574685483 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.793 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@574685483 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.798 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@574685483 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.810 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.810 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.812 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.812 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713910132759 end=1713910132812 duration=53 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:52.813 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:52.813 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:52.813 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 add_partition : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:08:52.813 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:08:52.813 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.813 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.813 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:52.813 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:08:52.820 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:52.842 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.842 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.846 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.846 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:08:52.846 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:08:52.846 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:08:52.846 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:08:52.846 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34183/db6.db/tbl6/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:08:52.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:52.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:08:52.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:52.854 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@574685483 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.863 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.865 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910132813 end=1713910132864 duration=51 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:52.865 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:52.865 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:52.865 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 add_partition : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:08:52.865 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:08:52.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:52.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:08:52.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:52.869 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.869 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.870 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.870 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:08:52.870 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:08:52.870 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:08:52.870 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:08:52.870 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34183/db6.db/tbl6/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:08:52.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:52.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:08:52.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:52.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.880 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.881 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910132865 end=1713910132881 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:52.881 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:52.881 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:52.881 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 add_partition : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:08:52.881 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:08:52.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:52.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:08:52.883 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:52.885 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.885 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.886 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.886 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:08:52.886 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:08:52.886 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:08:52.886 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:08:52.886 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34183/db6.db/tbl6/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:08:52.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:52.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:08:52.891 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:52.893 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.893 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.895 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.896 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910132881 end=1713910132896 duration=15 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:52.897 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:52.897 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:52.897 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713910132897 end=1713910132897 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:52.897 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:52.897 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:52.897 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_table : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:08:52.897 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:08:52.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.898 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:52.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:52.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.898 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.169216ms
[DEBUG] 2024-04-23 23:08:52.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:08:52.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.903 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.904 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[INFO ] 2024-04-23 23:08:52.905 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:08:52.905 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713910132897 end=1713910132905 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:52.905 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=8, comments=HMS client
[DEBUG] 2024-04-23 23:08:52.905 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:52.905 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:52.905 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_partitions : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:08:52.906 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:08:52.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:08:52.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.910 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.337598ms + 0.008647ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:08:52.913 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.465241ms + 0.076392ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:08:52.915 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.411302ms + 0.307073ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:08:52.916 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.443735ms + 0.16298ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:52.918 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.531029ms + 0.110914ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:08:52.920 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.483274ms + 0.104749ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:52.922 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.767237ms + 0.112585ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:52.924 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.870511ms + 0.107948ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:52.925 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.420627ms + 0.354159ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:52.927 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.554441ms + 0.106559ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:08:52.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:52.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 21.599724ms
[DEBUG] 2024-04-23 23:08:52.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.927 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.927 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910132905 end=1713910132927 duration=22 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:52.936 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:52.937 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:52.937 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 alter_table: hive.db6.tbl6 newtbl=tbl6
[INFO ] 2024-04-23 23:08:52.937 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db6.tbl6 newtbl=tbl6	
[DEBUG] 2024-04-23 23:08:52.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.937 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:52.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:52.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.938 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.090683ms
[DEBUG] 2024-04-23 23:08:52.938 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:08:52.938 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:08:52.938 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:08:52.938 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:08:52.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.939 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:52.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:52.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.939 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.941006ms
[DEBUG] 2024-04-23 23:08:52.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:08:52.941 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.944 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.946 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:52.947 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:52.947 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.947 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.045041ms
[DEBUG] 2024-04-23 23:08:52.947 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.947 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:52.947 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:08:52.948 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:52.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.951 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db6
[WARN ] 2024-04-23 23:08:52.951 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:08:52.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:52.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:52.952 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:52.952 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:52.952 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:08:52.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:52.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:08:52.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:52.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:08:52.958 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:52.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.963 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.964 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713910132937 end=1713910132964 duration=27 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[INFO ] 2024-04-23 23:08:52.965 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:08:52.965 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34183]
[INFO ] 2024-04-23 23:08:52.965 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34183)
[INFO ] 2024-04-23 23:08:52.966 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34183) current connections: 7
[DEBUG] 2024-04-23 23:08:52.966 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:52.966 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910132966 end=1713910132966 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=32 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 32: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 32: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183;create=true
[DEBUG] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:52.967 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183;create=true
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@10231779, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@10231779, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@781cb093 created in the thread with id: 281
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.968 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.969 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.970 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.970 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:08:52.970 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:08:52.970 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@10231779 from thread id: 281
[DEBUG] 2024-04-23 23:08:52.970 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.970 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:08:52.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.976 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.976 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713910132967 end=1713910132976 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=32 retryCount=0 error=false>
[INFO ] 2024-04-23 23:08:52.976 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:08:52.976 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 6
[DEBUG] 2024-04-23 23:08:52.976 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:52.976 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:52.976 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:52.977 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 32: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:08:52.977 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:08:52.977 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:08:52.977 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_partitions : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:08:52.977 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:08:52.977 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:08:52.977 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.977 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[INFO ] 2024-04-23 23:08:52.977 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@10231779, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@781cb093 will be shutdown
[DEBUG] 2024-04-23 23:08:52.977 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 32: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:08:52.977 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:08:52.977 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713910132976 end=1713910132977 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=32 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:52.977 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:08:52.977 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 32: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:08:52.977 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:08:52.978 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.041756ms + 0.005903ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:08:52.979 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.499851ms + 0.072009ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:08:52.979 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.16989ms + 0.240436ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:08:52.980 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.141801ms + 0.136605ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:52.980 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.138807ms + 0.092985ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:08:52.980 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.135665ms + 0.092861ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:52.980 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.128412ms + 0.09217ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:52.981 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.152892ms + 0.120482ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:52.981 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.204778ms + 0.324047ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:08:52.981 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.161403ms + 0.121565ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:08:52.981 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:52.981 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:52.981 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 4.731388ms
[DEBUG] 2024-04-23 23:08:52.981 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.982 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.982 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910132977 end=1713910132982 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:52.982 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:52.982 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:52.982 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:08:52.982 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:08:52.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:08:52.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.985 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.985 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713910132982 end=1713910132985 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:52.985 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:52.985 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:52.985 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:08:52.985 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:08:52.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.988 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.988 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.989 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713910132985 end=1713910132989 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:52.989 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:52.989 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:52.989 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_database: db6
[INFO ] 2024-04-23 23:08:52.989 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db6	
[DEBUG] 2024-04-23 23:08:52.989 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.990 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:52.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:52.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.991 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.553676ms
[DEBUG] 2024-04-23 23:08:52.991 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713910132989 end=1713910132991 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:52.991 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:08:52.991 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:52.991 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:52.991 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_tables_by_type: db=@hive#db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:52.991 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:52.991 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:52.991 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:52.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.992 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:52.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:52.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.993 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.425105ms
[DEBUG] 2024-04-23 23:08:52.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:52.996 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:52.996 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:52.996 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:52.997 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 3.575867ms
[DEBUG] 2024-04-23 23:08:52.997 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713910132991 end=1713910132997 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:52.997 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:52.997 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:52.997 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:08:52.997 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:08:52.997 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:53.000 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:53.000 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:53.000 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:53.000 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 3.347273ms
[DEBUG] 2024-04-23 23:08:53.000 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713910132997 end=1713910133000 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:53.001 [main] HiveMetaStoreClient - Selecting dropDatabase method for db6 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:08:53.001 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:08:53.001 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:53.001 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:53.001 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:53.002 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:53.002 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:53.002 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:53.002 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:53.002 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.450091ms
[DEBUG] 2024-04-23 23:08:53.003 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_multi_table : db=db6 tbls=tbl6
[INFO ] 2024-04-23 23:08:53.003 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db6 tbls=tbl6	
[DEBUG] 2024-04-23 23:08:53.003 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:53.007 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:53.009 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:53.009 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:53.009 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:53.009 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.620438ms
[DEBUG] 2024-04-23 23:08:53.009 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:53.009 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:53.010 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713910133001 end=1713910133010 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:08:53.010 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:08:53.010 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:08:53.010 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:08:53.010 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:08:53.010 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:53.010 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:53.011 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:53.012 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:53.012 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:53.012 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.456912ms
[DEBUG] 2024-04-23 23:08:53.012 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:08:53.012 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:08:53.012 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:53.013 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:53.013 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:53.013 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.819144ms
[DEBUG] 2024-04-23 23:08:53.013 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:08:53.013 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:08:53.013 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:53.024 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@574685483 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:53.028 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:53.029 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:53.029 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:53.029 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:53.034 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@574685483 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:53.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:53.038 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:53.038 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:53.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:53.058 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@574685483 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:53.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:53.061 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:08:53.061 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:08:53.061 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:08:53.061 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:08:53.061 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:53.061 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:53.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:53.062 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:53.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:53.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:53.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.828383ms
[DEBUG] 2024-04-23 23:08:53.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:53.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:53.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:53.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.486719ms
[DEBUG] 2024-04-23 23:08:53.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:53.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:53.064 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:53.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:53.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:53.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.731748ms
[DEBUG] 2024-04-23 23:08:53.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:53.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:08:53.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:53.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:53.065 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:53.065 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:53.078 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@574685483 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:53.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:53.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:53.086 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:53.086 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:53.086 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:53.087 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:53.088 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:53.089 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:53.091 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:53.092 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:53.093 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:08:53.094 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:53.094 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:53.094 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:53.094 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:53.095 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:53.334 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:08:55.096 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:08:55.096 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:08:55.096 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:55.096 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:55.100 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:55.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:55.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:55.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.967683ms
[DEBUG] 2024-04-23 23:08:55.100 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:08:55.100 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:08:55.101 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:55.103 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:55.103 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:55.103 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.610597ms
[DEBUG] 2024-04-23 23:08:55.103 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:08:55.103 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:08:55.103 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:55.106 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:55.106 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:55.106 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:55.106 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:55.107 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:55.107 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:55.107 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:55.107 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:55.108 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:55.108 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:55.108 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:55.108 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:55.109 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:55.109 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:55.109 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:55.109 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.879821ms
[DEBUG] 2024-04-23 23:08:55.109 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:55.110 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:55.110 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:55.110 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.517396ms
[DEBUG] 2024-04-23 23:08:55.110 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:55.110 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:55.111 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:55.111 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:55.111 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:55.111 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.073844ms
[DEBUG] 2024-04-23 23:08:55.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:55.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:08:55.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:55.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:55.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:55.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:55.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:55.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:55.114 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:55.114 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:55.114 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:55.114 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:55.114 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:55.114 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:55.114 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:55.114 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:55.114 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:08:55.114 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:55.114 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:55.115 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:55.115 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:55.115 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:57.116 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:08:57.116 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:08:57.116 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:57.116 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:57.119 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:57.119 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:57.119 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:57.119 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.086533ms
[DEBUG] 2024-04-23 23:08:57.119 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:08:57.119 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:08:57.120 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:57.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:57.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:57.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.588426ms
[DEBUG] 2024-04-23 23:08:57.121 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:08:57.121 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:08:57.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:57.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:57.125 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:57.126 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:57.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:57.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:57.128 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:57.128 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:57.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:57.130 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:57.131 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:57.131 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:57.131 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:57.133 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:57.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:57.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:57.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 2.591826ms
[DEBUG] 2024-04-23 23:08:57.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:57.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:57.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:57.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 1.573041ms
[DEBUG] 2024-04-23 23:08:57.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:57.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:57.139 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:57.139 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:57.139 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:57.139 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 2.584076ms
[DEBUG] 2024-04-23 23:08:57.139 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:57.140 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:08:57.140 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:57.140 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:57.142 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:57.143 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:57.144 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:57.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:57.146 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:57.146 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:57.146 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:57.146 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:57.147 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:57.147 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:57.147 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:57.147 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:57.147 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:08:57.147 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:57.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:57.150 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:57.150 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:57.150 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:59.151 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:08:59.152 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:08:59.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:08:59.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:59.154 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:59.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:59.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:59.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.081115ms
[DEBUG] 2024-04-23 23:08:59.155 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:08:59.155 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:08:59.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:59.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:59.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:59.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.596351ms
[DEBUG] 2024-04-23 23:08:59.157 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:08:59.157 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:08:59.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:59.161 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:59.161 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:08:59.161 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:08:59.161 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:59.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:59.163 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:08:59.163 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:08:59.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:59.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:59.166 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:08:59.166 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:08:59.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:59.168 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:59.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:59.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:59.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 2.661945ms
[DEBUG] 2024-04-23 23:08:59.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:59.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:59.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:59.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 1.546502ms
[DEBUG] 2024-04-23 23:08:59.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:59.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:59.174 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:08:59.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:08:59.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:59.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 2.641283ms
[DEBUG] 2024-04-23 23:08:59.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:08:59.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:08:59.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:08:59.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:08:59.178 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:08:59.178 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:08:59.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:08:59.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:08:59.182 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:08:59.182 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:59.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:59.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:59.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:59.183 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:59.183 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:59.183 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:08:59.183 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:08:59.183 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:59.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:08:59.185 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:08:59.186 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:08:59.186 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:08:59.785 [HikariPool-8 housekeeper] HikariPool - HikariPool-8 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:09:01.187 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:09:01.187 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:09:01.187 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:01.187 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:01.189 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:01.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:01.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:01.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.000467ms
[DEBUG] 2024-04-23 23:09:01.190 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:09:01.190 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:09:01.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:01.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:01.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:01.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.019619ms
[DEBUG] 2024-04-23 23:09:01.191 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:09:01.191 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:09:01.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:01.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:01.193 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:01.193 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:01.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:01.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:01.194 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:01.194 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:01.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:01.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:01.195 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:01.195 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:01.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:01.195 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:01.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:01.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:01.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.821819ms
[DEBUG] 2024-04-23 23:09:01.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:01.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:01.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:01.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.441406ms
[DEBUG] 2024-04-23 23:09:01.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:01.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:01.197 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:01.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:01.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:01.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.757692ms
[DEBUG] 2024-04-23 23:09:01.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:01.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:09:01.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:01.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:01.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:01.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:01.199 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:01.199 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:01.199 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:01.199 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:01.199 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:01.199 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:01.199 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:01.200 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:01.200 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:01.200 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:01.200 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:01.200 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:01.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:01.200 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:01.201 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:01.201 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:03.201 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:09:03.202 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:09:03.202 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:03.202 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:03.204 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:03.205 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:03.205 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:03.205 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.231363ms
[DEBUG] 2024-04-23 23:09:03.205 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:09:03.205 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:09:03.205 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:03.207 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:03.207 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:03.207 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.557661ms
[DEBUG] 2024-04-23 23:09:03.207 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:09:03.207 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:09:03.207 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:03.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:03.208 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:03.208 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:03.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:03.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:03.209 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:03.209 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:03.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:03.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:03.210 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:03.210 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:03.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:03.211 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:03.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:03.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:03.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.974275ms
[DEBUG] 2024-04-23 23:09:03.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:03.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:03.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:03.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.456294ms
[DEBUG] 2024-04-23 23:09:03.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:03.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:03.212 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:03.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:03.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:03.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.715533ms
[DEBUG] 2024-04-23 23:09:03.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:03.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:09:03.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:03.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:03.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:03.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:03.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:03.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:03.215 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:03.215 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:03.215 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:03.215 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:03.215 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:03.215 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:03.215 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:03.215 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:03.215 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:03.215 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:03.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:03.216 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:03.216 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:03.216 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:05.217 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:09:05.217 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:09:05.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:05.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:05.219 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:05.220 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:05.220 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:05.220 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 2.468968ms
[DEBUG] 2024-04-23 23:09:05.220 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:09:05.220 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:09:05.220 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:05.220 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:05.220 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:05.220 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.466275ms
[DEBUG] 2024-04-23 23:09:05.220 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:09:05.220 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:09:05.220 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:05.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:05.221 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:05.221 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:05.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:05.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:05.222 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:05.222 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:05.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:05.223 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:05.223 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:05.223 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:05.223 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:05.224 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:05.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:05.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:05.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.792875ms
[DEBUG] 2024-04-23 23:09:05.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:05.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:05.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:05.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.440727ms
[DEBUG] 2024-04-23 23:09:05.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:05.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:05.225 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:05.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:05.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:05.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.740458ms
[DEBUG] 2024-04-23 23:09:05.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:05.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:09:05.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:05.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:05.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:05.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:05.227 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:05.227 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:05.228 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:05.228 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:05.228 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:05.228 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:05.228 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:05.228 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:05.228 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:05.228 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:05.228 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:05.228 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:05.228 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:05.229 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:05.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:05.229 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:07.230 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:09:07.230 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:09:07.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:07.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:07.233 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:07.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:07.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:07.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.539532ms
[DEBUG] 2024-04-23 23:09:07.234 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:09:07.234 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:09:07.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:07.235 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:07.235 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:07.235 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.022845ms
[DEBUG] 2024-04-23 23:09:07.235 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:09:07.235 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:09:07.235 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:07.236 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:07.236 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:07.237 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:07.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:07.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:07.237 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:07.237 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:07.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:07.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:07.238 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:07.238 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:07.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:07.239 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:07.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:07.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:07.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.849677ms
[DEBUG] 2024-04-23 23:09:07.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:07.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:07.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:07.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.42854ms
[DEBUG] 2024-04-23 23:09:07.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:07.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:07.240 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:07.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:07.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:07.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.719164ms
[DEBUG] 2024-04-23 23:09:07.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:07.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:09:07.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:07.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:07.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:07.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:07.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:07.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:07.243 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:07.243 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:07.243 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:07.243 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:07.243 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:07.243 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:07.243 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:07.243 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:07.243 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:07.243 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:07.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:07.244 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:07.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:07.244 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:07.670 [HikariPool-7 housekeeper] HikariPool - HikariPool-7 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:09:09.000 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:09:09.245 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:09:09.245 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:09:09.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:09.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:09.247 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:09.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:09.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:09.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.160344ms
[DEBUG] 2024-04-23 23:09:09.248 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:09:09.248 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:09:09.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:09.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:09.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:09.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.019167ms
[DEBUG] 2024-04-23 23:09:09.249 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:09:09.249 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:09:09.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:09.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:09.251 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:09.251 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:09.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:09.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:09.251 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:09.251 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:09.252 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:09.252 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:09.252 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:09.252 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:09.252 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:09.253 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:09.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:09.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:09.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.712903ms
[DEBUG] 2024-04-23 23:09:09.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:09.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:09.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:09.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.408154ms
[DEBUG] 2024-04-23 23:09:09.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:09.254 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:09.254 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:09.255 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:09.255 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:09.255 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.700051ms
[DEBUG] 2024-04-23 23:09:09.255 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:09.255 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:09:09.255 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:09.255 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:09.255 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:09.255 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:09.256 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:09.256 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:09.256 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:09.256 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:09.256 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:09.257 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:09.257 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:09.257 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:09.257 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:09.257 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:09.257 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:09.257 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:09.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:09.257 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:09.258 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:09.258 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:11.258 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:09:11.259 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:09:11.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:11.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:11.261 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:11.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:11.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:11.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 2.683776ms
[DEBUG] 2024-04-23 23:09:11.261 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:09:11.262 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:09:11.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:11.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:11.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:11.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.483481ms
[DEBUG] 2024-04-23 23:09:11.262 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:09:11.262 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:09:11.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:11.264 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:11.264 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:11.264 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:11.264 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:11.264 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:11.264 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:11.264 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:11.264 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:11.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:11.265 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:11.265 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:11.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:11.266 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:11.266 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:11.266 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:11.266 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.787374ms
[DEBUG] 2024-04-23 23:09:11.266 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:11.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:11.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:11.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.451347ms
[DEBUG] 2024-04-23 23:09:11.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:11.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:11.268 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:11.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:11.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:11.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.733745ms
[DEBUG] 2024-04-23 23:09:11.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:11.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:09:11.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:11.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:11.269 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:11.269 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:11.269 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:11.270 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:11.270 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:11.270 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:11.270 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:11.270 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:11.270 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:11.270 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:11.270 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:11.270 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:11.270 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:11.270 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:11.270 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:11.271 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:11.271 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:11.271 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:13.271 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:09:13.272 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:09:13.272 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:13.272 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:13.274 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:13.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:13.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:13.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.040137ms
[DEBUG] 2024-04-23 23:09:13.275 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:09:13.275 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:09:13.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:13.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:13.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:13.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.569324ms
[DEBUG] 2024-04-23 23:09:13.277 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:09:13.277 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:09:13.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:13.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:13.279 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:13.279 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:13.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:13.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:13.279 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:13.279 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:13.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:13.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:13.280 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:13.280 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:13.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:13.281 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:13.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:13.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:13.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.766858ms
[DEBUG] 2024-04-23 23:09:13.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:13.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:13.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:13.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.428885ms
[DEBUG] 2024-04-23 23:09:13.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:13.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:13.282 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:13.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:13.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:13.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.704819ms
[DEBUG] 2024-04-23 23:09:13.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:13.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:09:13.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:13.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:13.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:13.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:13.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:13.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:13.284 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:13.284 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:13.285 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:13.285 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:13.285 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:13.285 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:13.285 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:13.285 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:09:13.285 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:13.285 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:13.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:13.286 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1847290297 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:13.286 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:13.286 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:13.286 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713910133010 end=1713910153286 duration=20276 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=-1 error=true>
[INFO ] 2024-04-23 23:09:13.287 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:09:13.287 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:09:13.287 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:09:13.287 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:09:13.294 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:09:13.294 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:09:13.294 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:09:13.294 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:09:13.295 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:09:13.327 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431;create=true
[INFO ] 2024-04-23 23:09:13.679 [MetaStoreThread-35431] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[INFO ] 2024-04-23 23:09:13.679 [main] MetaStoreTestUtils - Waiting the HMS to start.
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] HMSHandler - 33: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431;create=true
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:09:13.680 [MetaStoreThread-35431] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431;create=true
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34183;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431;create=true
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 10
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 119
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:09:13.681 [MetaStoreThread-35431] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:13.682 [MetaStoreThread-35431] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:09:13.682 [MetaStoreThread-35431] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:09:13.683 [MetaStoreThread-35431] HikariConfig - HikariPool-10 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:09:13.683 [MetaStoreThread-35431] HikariConfig - HikariPool-10 - configuration:
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431;create=true"
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - poolName........................"HikariPool-10"
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:09:13.684 [MetaStoreThread-35431] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:09:13.685 [MetaStoreThread-35431] HikariDataSource - HikariPool-10 - Starting...
[INFO ] 2024-04-23 23:09:13.686 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:09:13.686 [MetaStoreThread-35431] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[INFO ] 2024-04-23 23:09:13.686 [MetaStoreThread-35431] HikariDataSource - HikariPool-10 - Start completed.
[DEBUG] 2024-04-23 23:09:13.786 [HikariPool-10 housekeeper] HikariPool - HikariPool-10 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:09:13.788 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@728034245 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:13.790 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1784275454 (XID = 1163), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:13.791 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1543056706 (XID = 1165), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:13.792 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@175513265 (XID = 1167), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:13.793 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@837040631 (XID = 1169), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:13.795 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@238575742 (XID = 1171), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:13.796 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@292946481 (XID = 1173), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:13.797 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1671465545 (XID = 1175), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:13.799 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@772062408 (XID = 1177), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:13.799 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:09:13.938 [MetaStoreThread-35431] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:09:13.938 [MetaStoreThread-35431] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@39fcf26, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:09:13.938 [MetaStoreThread-35431] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:09:13.939 [MetaStoreThread-35431] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@39fcf26, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@283f30fa created in the thread with id: 284
[DEBUG] 2024-04-23 23:09:13.939 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:13.939 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:13.939 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.033 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.105 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@728034245 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.118 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@728034245 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.151 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@728034245 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.164 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@728034245 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.168 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@728034245 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.271 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@728034245 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.295 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@728034245 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.300 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@728034245 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.306 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@728034245 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.308 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.309 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.309 [MetaStoreThread-35431] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:09:14.309 [MetaStoreThread-35431] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:09:14.309 [MetaStoreThread-35431] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@39fcf26 from thread id: 284
[DEBUG] 2024-04-23 23:09:14.309 [MetaStoreThread-35431] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:09:14.309 [MetaStoreThread-35431] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.312 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.314 [MetaStoreThread-35431] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.314 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[INFO ] 2024-04-23 23:09:14.314 [MetaStoreThread-35431] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:09:14.315 [MetaStoreThread-35431] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.315 [MetaStoreThread-35431] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.315 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.315 [MetaStoreThread-35431] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.316 [MetaStoreThread-35431] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.318 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.318 [MetaStoreThread-35431] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.319 [MetaStoreThread-35431] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:14.319 [MetaStoreThread-35431] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.319 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.319 [MetaStoreThread-35431] ObjectStore - db details for db default retrieved using SQL in 1.633055ms
[DEBUG] 2024-04-23 23:09:14.319 [MetaStoreThread-35431] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:09:14.319 [MetaStoreThread-35431] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:09:14.320 [MetaStoreThread-35431] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.324 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.325 [MetaStoreThread-35431] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.326 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.327 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[INFO ] 2024-04-23 23:09:14.327 [MetaStoreThread-35431] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:09:14.328 [MetaStoreThread-35431] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.328 [MetaStoreThread-35431] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.330 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.333 [MetaStoreThread-35431] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.335 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@728034245 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.336 [MetaStoreThread-35431] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.337 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[INFO ] 2024-04-23 23:09:14.337 [MetaStoreThread-35431] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:09:14.337 [MetaStoreThread-35431] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.337 [MetaStoreThread-35431] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.338 [MetaStoreThread-35431] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.338 [MetaStoreThread-35431] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.339 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[INFO ] 2024-04-23 23:09:14.339 [MetaStoreThread-35431] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:09:14.339 [MetaStoreThread-35431] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.339 [MetaStoreThread-35431] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.339 [MetaStoreThread-35431] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.340 [MetaStoreThread-35431] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.343 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@728034245 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.345 [MetaStoreThread-35431] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.348 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@728034245 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.349 [MetaStoreThread-35431] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.350 [MetaStoreThread-35431] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[INFO ] 2024-04-23 23:09:14.350 [MetaStoreThread-35431] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:09:14.350 [MetaStoreThread-35431] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:09:14.350 [MetaStoreThread-35431] PerfLogger - </PERFLOG method=init start=1713910153680 end=1713910154350 duration=670 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[INFO ] 2024-04-23 23:09:14.350 [MetaStoreThread-35431] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:09:14.350 [MetaStoreThread-35431] HiveMetaStore - Started the new metaserver on port [35431]...
[INFO ] 2024-04-23 23:09:14.350 [MetaStoreThread-35431] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:09:14.350 [MetaStoreThread-35431] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:09:14.350 [MetaStoreThread-35431] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:09:14.350 [MetaStoreThread-35431] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:09:14.350 [MetaStoreThread-35431] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:09:14.350 [MetaStoreThread-35431] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:09:14.350 [MetaStoreThread-35431] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:09:14.350 [MetaStoreThread-35431] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:09:14.350 [MetaStoreThread-35431] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:09:14.350 [MetaStoreThread-35431] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:09:14.350 [MetaStoreThread-35431] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:09:14.350 [MetaStoreThread-35431] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:09:14.350 [MetaStoreThread-35431] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:09:14.350 [MetaStoreThread-35431] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:09:14.350 [MetaStoreThread-35431] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:09:14.350 [MetaStoreThread-35431] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:09:14.461 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:09:14.680 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:09:14.680 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 34: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:09:14.680 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:09:14.684 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/35431) is created
[INFO ] 2024-04-23 23:09:14.684 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 35431 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/35431 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431;create=true
[INFO ] 2024-04-23 23:09:14.684 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:09:14.687 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:09:14.687 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:35431]
[INFO ] 2024-04-23 23:09:14.687 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:35431)
[INFO ] 2024-04-23 23:09:14.688 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:35431) current connections: 7
[DEBUG] 2024-04-23 23:09:14.688 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.688 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910154688 end=1713910154688 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:14.689 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.689 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.689 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 create_database: Database(name:db1, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:09:14.689 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db1, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:09:14.689 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:09:14.689 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:09:14.689 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:14.689 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:14.689 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:09:14.689 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:09:14.689 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431;create=true
[DEBUG] 2024-04-23 23:09:14.689 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:09:14.689 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:09:14.689 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:14.689 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431;create=true
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3acc93e1, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:09:14.690 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3acc93e1, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@46eb459 created in the thread with id: 301
[DEBUG] 2024-04-23 23:09:14.691 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.691 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.691 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.692 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.692 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.692 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:09:14.692 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:09:14.692 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3acc93e1 from thread id: 301
[DEBUG] 2024-04-23 23:09:14.692 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.693 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:14.693 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.693 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.693 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.537502ms
[DEBUG] 2024-04-23 23:09:14.693 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db1, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:09:14.693 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:09:14.693 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.694 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.694 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.694 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:09:14.694 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:09:14.694 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:09:14.694 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:09:14.694 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:09:14.694 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db
[INFO ] 2024-04-23 23:09:14.694 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db
[INFO ] 2024-04-23 23:09:14.697 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db
[DEBUG] 2024-04-23 23:09:14.697 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.697 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.697 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.697 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.699 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.699 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713910154689 end=1713910154699 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:14.699 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.699 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.699 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 create_table_req: Table(tableName:tbl1, dbName:db1, owner:alex, createTime:1713910154, lastAccessTime:1713910154, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:d, type:date, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:09:14.699 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl1, dbName:db1, owner:alex, createTime:1713910154, lastAccessTime:1713910154, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:d, type:date, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:09:14.699 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.702 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:14.702 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:14.702 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.702 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.702 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 2.965705ms
[DEBUG] 2024-04-23 23:09:14.702 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.703 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.703 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:09:14.706 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.706 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.706 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.706 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.706 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.707 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:14.707 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:14.707 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.707 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.964066ms
[DEBUG] 2024-04-23 23:09:14.707 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.707 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:14.707 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:09:14.708 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:14.708 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.708 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:09:14.708 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:09:14.708 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:09:14.708 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:09:14.708 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/35431/db1.db/tbl1
[DEBUG] 2024-04-23 23:09:14.712 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.712 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:14.716 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:14.719 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@728034245 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.724 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@728034245 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.728 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@728034245 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.732 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@728034245 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.743 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.743 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.744 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.745 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713910154699 end=1713910154745 duration=46 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:14.745 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.746 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.746 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 add_partition : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:09:14.746 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:09:14.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:14.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:09:14.753 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:14.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.784 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.784 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:09:14.784 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:09:14.784 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:09:14.784 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:09:14.784 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/35431/db1.db/tbl1/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:09:14.788 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.788 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:14.788 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:09:14.789 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:14.791 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@728034245 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.799 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.799 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.802 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.803 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910154746 end=1713910154803 duration=57 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:14.803 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.803 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.803 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 add_partition : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:09:14.803 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:09:14.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:14.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:09:14.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:14.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.808 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:09:14.808 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:09:14.808 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:09:14.809 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:09:14.809 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/35431/db1.db/tbl1/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:09:14.813 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.813 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:14.813 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:09:14.813 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:14.816 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.816 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.819 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.820 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910154803 end=1713910154820 duration=17 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:14.820 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.820 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.820 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 add_partition : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:09:14.820 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:09:14.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:14.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:09:14.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:14.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.825 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:09:14.826 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:09:14.826 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:09:14.826 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:09:14.826 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/35431/db1.db/tbl1/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:09:14.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:14.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:09:14.831 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:14.833 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.833 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.835 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.836 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910154820 end=1713910154836 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:14.836 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.836 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.836 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713910154836 end=1713910154836 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:14.837 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.837 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.837 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_table : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:09:14.837 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:09:14.837 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.837 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:14.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:14.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.838 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 1.020846ms
[DEBUG] 2024-04-23 23:09:14.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:09:14.840 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.843 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.845 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[INFO ] 2024-04-23 23:09:14.846 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:09:14.846 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713910154837 end=1713910154846 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:14.846 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=10, comments=HMS client
[DEBUG] 2024-04-23 23:09:14.846 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.846 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.846 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:09:14.846 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:09:14.846 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:09:14.847 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.847 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.851 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.995933ms + 0.007192ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:09:14.853 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.382039ms + 0.102801ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:09:14.855 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.51801ms + 0.254153ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:09:14.857 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.329919ms + 0.175634ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:14.858 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.418512ms + 0.109857ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:09:14.860 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.395504ms + 0.110484ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:14.862 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.586422ms + 0.151988ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:14.864 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.521184ms + 0.1117ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:14.865 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.421852ms + 0.249028ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:14.867 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.890413ms + 0.118635ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:09:14.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:14.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 20.809137ms
[DEBUG] 2024-04-23 23:09:14.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.868 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.868 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910154846 end=1713910154868 duration=22 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:14.877 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.877 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.877 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:09:14.877 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:09:14.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:09:14.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.878 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.581783ms + 0.004739ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:09:14.878 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.373859ms + 0.115985ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:09:14.879 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.220742ms + 0.37886ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:09:14.879 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.156446ms + 0.137791ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:14.880 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.144421ms + 0.09297ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:09:14.880 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.138213ms + 0.113428ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:14.880 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.179745ms + 0.110082ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:14.881 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.156845ms + 0.094205ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:14.881 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.206375ms + 0.300589ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:14.881 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.179865ms + 0.09694ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:09:14.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:14.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 4.482285ms
[DEBUG] 2024-04-23 23:09:14.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.882 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.882 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910154877 end=1713910154882 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[INFO ] 2024-04-23 23:09:14.883 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:09:14.883 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:35431]
[INFO ] 2024-04-23 23:09:14.883 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:35431)
[INFO ] 2024-04-23 23:09:14.883 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:35431) current connections: 8
[DEBUG] 2024-04-23 23:09:14.883 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.883 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910154883 end=1713910154883 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=36 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:14.884 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.884 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.884 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 36: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:09:14.884 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 36: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431;create=true
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431;create=true
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4571cee3, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4571cee3, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6e13ec5b created in the thread with id: 315
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.885 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.887 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.887 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.887 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:09:14.887 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:09:14.887 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4571cee3 from thread id: 315
[DEBUG] 2024-04-23 23:09:14.887 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.887 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:09:14.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.892 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.892 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713910154884 end=1713910154892 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=36 retryCount=0 error=false>
[INFO ] 2024-04-23 23:09:14.892 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:09:14.893 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 7
[DEBUG] 2024-04-23 23:09:14.893 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.893 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.893 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.893 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 36: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:09:14.893 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:09:14.893 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:09:14.893 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:09:14.893 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4571cee3, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6e13ec5b will be shutdown
[INFO ] 2024-04-23 23:09:14.893 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:09:14.893 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:09:14.893 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.893 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 36: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:09:14.893 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[INFO ] 2024-04-23 23:09:14.893 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:09:14.893 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713910154893 end=1713910154893 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=36 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:14.893 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:09:14.893 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 36: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:09:14.893 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:09:14.894 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.928286ms + 0.005846ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:09:14.895 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.610976ms + 0.079736ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:09:14.895 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.174761ms + 0.323994ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:09:14.896 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.173043ms + 0.15337ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:14.896 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.184014ms + 0.09839ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:09:14.896 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.162246ms + 0.112354ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:14.897 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.126177ms + 0.093953ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:14.897 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.119151ms + 0.093611ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:14.897 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.170417ms + 0.228625ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:14.898 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.133287ms + 0.095497ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:09:14.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:14.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 4.709443ms
[DEBUG] 2024-04-23 23:09:14.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.898 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.898 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910154893 end=1713910154898 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:14.898 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.898 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.898 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 alter_table: hive.db1.tbl1 newtbl=tbl1
[INFO ] 2024-04-23 23:09:14.898 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db1.tbl1 newtbl=tbl1	
[DEBUG] 2024-04-23 23:09:14.899 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.899 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:14.899 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:14.899 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.899 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 1.05384ms
[DEBUG] 2024-04-23 23:09:14.900 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:09:14.900 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:09:14.900 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:09:14.900 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:09:14.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.901 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:14.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:14.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.901 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 1.223886ms
[DEBUG] 2024-04-23 23:09:14.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:09:14.903 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.907 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.908 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.908 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.909 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:14.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:14.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.90195ms
[DEBUG] 2024-04-23 23:09:14.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:14.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:09:14.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:14.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.913 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db1
[WARN ] 2024-04-23 23:09:14.913 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:09:14.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.914 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:14.914 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:14.914 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:14.915 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:09:14.915 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:14.916 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:09:14.916 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:14.916 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:09:14.920 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:14.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.924 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.926 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713910154898 end=1713910154926 duration=28 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[INFO ] 2024-04-23 23:09:14.927 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:09:14.927 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:35431]
[INFO ] 2024-04-23 23:09:14.927 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:35431)
[INFO ] 2024-04-23 23:09:14.927 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:35431) current connections: 8
[DEBUG] 2024-04-23 23:09:14.927 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.927 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910154927 end=1713910154927 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:14.928 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.928 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.928 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:09:14.928 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:09:14.928 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431;create=true
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431;create=true
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@750d6899, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@750d6899, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@44b2ffeb created in the thread with id: 316
[DEBUG] 2024-04-23 23:09:14.929 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.930 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.930 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.931 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.931 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.931 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:09:14.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:09:14.931 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@750d6899 from thread id: 316
[DEBUG] 2024-04-23 23:09:14.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:09:14.932 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.932 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.933 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713910154928 end=1713910154933 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[INFO ] 2024-04-23 23:09:14.933 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:09:14.933 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 7
[DEBUG] 2024-04-23 23:09:14.933 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.933 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.933 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.933 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:09:14.933 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:09:14.933 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:09:14.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@750d6899, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@44b2ffeb will be shutdown
[DEBUG] 2024-04-23 23:09:14.933 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:09:14.933 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:09:14.933 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:09:14.933 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:09:14.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:09:14.933 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713910154933 end=1713910154933 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:14.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.933 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:09:14.933 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:09:14.933 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:09:14.934 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.848968ms + 0.005545ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:09:14.935 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.435036ms + 0.060894ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:09:14.935 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.157482ms + 0.221465ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:09:14.936 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.153587ms + 0.140497ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:14.936 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.171434ms + 0.095669ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:09:14.936 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.162985ms + 0.096275ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:14.936 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.15586ms + 0.093606ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:14.937 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.150517ms + 0.092616ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:14.937 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.202048ms + 0.229211ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:14.937 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.164841ms + 0.0949ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:09:14.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:14.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 4.412063ms
[DEBUG] 2024-04-23 23:09:14.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.938 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.938 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910154933 end=1713910154938 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:14.938 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.938 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.938 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:09:14.938 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:09:14.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:09:14.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.941 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.941 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713910154938 end=1713910154941 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:14.941 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.941 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.941 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:09:14.941 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:09:14.941 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.943 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.944 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713910154941 end=1713910154944 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:14.944 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.944 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.944 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_database: db1
[INFO ] 2024-04-23 23:09:14.944 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db1	
[DEBUG] 2024-04-23 23:09:14.944 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.945 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:14.945 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:14.945 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.945 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.945 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.986964ms
[DEBUG] 2024-04-23 23:09:14.945 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713910154944 end=1713910154945 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:14.945 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=1, comments=HMS client
[DEBUG] 2024-04-23 23:09:14.945 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.945 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.945 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_tables_by_type: db=@hive#db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:14.945 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:14.945 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:14.945 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:14.945 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.946 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:14.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:14.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.946 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 1.185402ms
[DEBUG] 2024-04-23 23:09:14.947 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.949 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:14.949 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.949 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.949 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.609618ms
[DEBUG] 2024-04-23 23:09:14.949 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713910154945 end=1713910154949 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:14.949 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.950 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.950 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:09:14.950 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:09:14.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:14.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.954 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 3.999567ms
[DEBUG] 2024-04-23 23:09:14.954 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713910154950 end=1713910154954 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:14.954 [main] HiveMetaStoreClient - Selecting dropDatabase method for db1 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:09:14.954 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:09:14.954 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.954 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.955 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:14.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:14.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.955 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 1.225661ms
[DEBUG] 2024-04-23 23:09:14.955 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_multi_table : db=db1 tbls=tbl1
[INFO ] 2024-04-23 23:09:14.955 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db1 tbls=tbl1	
[DEBUG] 2024-04-23 23:09:14.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.960 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:14.960 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:14.960 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.960 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.908442ms
[DEBUG] 2024-04-23 23:09:14.960 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:14.960 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.960 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713910154954 end=1713910154960 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:14.960 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:14.960 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:14.960 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:09:14.961 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:09:14.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:14.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.961 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:14.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:14.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.821906ms
[DEBUG] 2024-04-23 23:09:14.961 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:09:14.961 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:09:14.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.962 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:14.962 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.962 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.546979ms
[DEBUG] 2024-04-23 23:09:14.962 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:09:14.962 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:09:14.962 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.969 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@728034245 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.972 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.972 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:14.972 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:14.972 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:14.976 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@728034245 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:14.979 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:14.979 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:14.979 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:14.979 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:15.001 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@728034245 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:15.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:15.004 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:09:15.004 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:09:15.004 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:09:15.004 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:09:15.004 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:15.004 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:15.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:15.005 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:15.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:15.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:15.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.891679ms
[DEBUG] 2024-04-23 23:09:15.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:15.006 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:15.006 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:15.006 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.462959ms
[DEBUG] 2024-04-23 23:09:15.006 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:15.006 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:15.007 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:15.007 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:15.007 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:15.007 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.779207ms
[DEBUG] 2024-04-23 23:09:15.007 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:15.007 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:09:15.007 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:15.007 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:15.008 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:15.008 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:15.023 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@728034245 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:15.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:15.033 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:15.033 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:15.033 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:15.033 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:15.035 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:15.037 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:15.039 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:15.041 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:15.043 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:15.045 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:15.045 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:15.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:15.046 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:15.046 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:15.046 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:15.435 [HikariPool-6 housekeeper] HikariPool - HikariPool-6 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:09:17.049 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:09:17.049 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:09:17.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:17.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:17.052 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:17.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:17.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:17.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 3.635974ms
[DEBUG] 2024-04-23 23:09:17.053 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:09:17.053 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:09:17.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:17.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:17.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:17.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.429568ms
[DEBUG] 2024-04-23 23:09:17.054 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:09:17.054 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:09:17.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:17.055 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:17.056 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:17.056 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:17.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:17.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:17.056 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:17.056 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:17.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:17.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:17.057 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:17.057 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:17.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:17.058 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:17.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:17.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:17.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.74781ms
[DEBUG] 2024-04-23 23:09:17.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:17.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:17.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:17.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.451294ms
[DEBUG] 2024-04-23 23:09:17.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:17.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:17.060 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:17.060 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:17.060 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:17.060 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.947901ms
[DEBUG] 2024-04-23 23:09:17.060 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:17.060 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:09:17.060 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:17.060 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:17.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:17.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:17.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:17.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:17.062 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:17.062 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:17.062 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:17.062 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:17.062 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:17.062 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:17.062 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:17.062 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:17.062 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:17.063 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:17.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:17.063 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:17.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:17.063 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:18.038 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:09:18.042 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:09:19.064 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:09:19.064 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:09:19.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:19.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:19.066 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:19.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:19.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:19.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 3.130619ms
[DEBUG] 2024-04-23 23:09:19.067 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:09:19.067 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:09:19.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:19.068 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:19.068 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:19.068 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.542995ms
[DEBUG] 2024-04-23 23:09:19.068 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:09:19.068 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:09:19.068 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:19.069 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:19.069 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:19.069 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:19.069 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:19.070 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:19.070 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:19.070 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:19.070 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:19.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:19.071 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:19.071 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:19.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:19.071 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:19.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:19.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:19.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.808741ms
[DEBUG] 2024-04-23 23:09:19.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:19.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:19.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:19.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.459972ms
[DEBUG] 2024-04-23 23:09:19.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:19.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:19.073 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:19.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:19.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:19.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.796173ms
[DEBUG] 2024-04-23 23:09:19.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:19.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:09:19.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:19.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:19.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:19.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:19.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:19.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:19.076 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:19.076 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:19.076 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:19.076 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:19.076 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:19.076 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:19.076 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:19.076 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:19.076 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:19.076 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:19.076 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:19.077 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:19.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:19.077 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:21.078 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:09:21.078 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:09:21.078 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:21.078 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:21.081 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:21.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:21.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:21.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 3.620445ms
[DEBUG] 2024-04-23 23:09:21.082 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:09:21.082 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:09:21.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:21.083 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:21.083 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:21.083 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.205649ms
[DEBUG] 2024-04-23 23:09:21.083 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:09:21.084 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:09:21.084 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:21.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:21.085 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:21.085 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:21.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:21.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:21.085 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:21.085 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:21.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:21.086 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:21.086 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:21.086 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:21.086 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:21.087 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:21.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:21.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:21.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.774601ms
[DEBUG] 2024-04-23 23:09:21.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:21.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:21.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:21.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.417471ms
[DEBUG] 2024-04-23 23:09:21.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:21.088 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:21.089 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:21.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:21.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:21.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.762078ms
[DEBUG] 2024-04-23 23:09:21.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:21.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:09:21.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:21.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:21.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:21.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:21.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:21.091 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:21.091 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:21.091 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:21.091 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:21.091 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:21.091 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:21.091 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:21.091 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:21.091 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:21.092 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:21.092 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:21.092 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:21.092 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:21.092 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:21.093 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:21.839 [HikariPool-9 housekeeper] HikariPool - HikariPool-9 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:09:23.093 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:09:23.093 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:09:23.094 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:23.094 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:23.096 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:23.097 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:23.097 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:23.097 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 3.245334ms
[DEBUG] 2024-04-23 23:09:23.097 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:09:23.097 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:09:23.097 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:23.098 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:23.098 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:23.098 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.164778ms
[DEBUG] 2024-04-23 23:09:23.098 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:09:23.098 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:09:23.098 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:23.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:23.100 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:23.100 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:23.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:23.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:23.100 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:23.100 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:23.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:23.101 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:23.101 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:23.101 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:23.101 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:23.102 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:23.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:23.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:23.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.764564ms
[DEBUG] 2024-04-23 23:09:23.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:23.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:23.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:23.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.483701ms
[DEBUG] 2024-04-23 23:09:23.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:23.103 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:23.103 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:23.104 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:23.104 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:23.104 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.713243ms
[DEBUG] 2024-04-23 23:09:23.104 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:23.104 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:09:23.104 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:23.104 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:23.105 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:23.105 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:23.105 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:23.106 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:23.106 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:23.106 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:23.106 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:23.106 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:23.106 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:23.106 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:23.106 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:23.106 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:23.106 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:23.106 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:23.106 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:23.107 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:23.107 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:23.107 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:23.335 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:09:25.107 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:09:25.108 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:09:25.108 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:25.108 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:25.110 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:25.111 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:25.111 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:25.111 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 3.164282ms
[DEBUG] 2024-04-23 23:09:25.111 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:09:25.111 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:09:25.111 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:25.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:25.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:25.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.635819ms
[DEBUG] 2024-04-23 23:09:25.113 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:09:25.113 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:09:25.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:25.114 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:25.114 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:25.114 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:25.114 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:25.115 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:25.115 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:25.115 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:25.115 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:25.116 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:25.116 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:25.116 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:25.116 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:25.116 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:25.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:25.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:25.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.752361ms
[DEBUG] 2024-04-23 23:09:25.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:25.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:25.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:25.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.459713ms
[DEBUG] 2024-04-23 23:09:25.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:25.118 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:25.118 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:25.118 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:25.118 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:25.118 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.818379ms
[DEBUG] 2024-04-23 23:09:25.118 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:25.119 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:09:25.119 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:25.119 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:25.119 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:25.119 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:25.120 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:25.120 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:25.120 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:25.120 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:25.120 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:25.121 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:25.121 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:25.121 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:25.121 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:25.121 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:25.121 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:25.121 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:25.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:25.122 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:25.122 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:25.122 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:27.123 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:09:27.123 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:09:27.123 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:27.123 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:27.125 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:27.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:27.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:27.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 3.039655ms
[DEBUG] 2024-04-23 23:09:27.126 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:09:27.126 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:09:27.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:27.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:27.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:27.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.619592ms
[DEBUG] 2024-04-23 23:09:27.128 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:09:27.128 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:09:27.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:27.129 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:27.129 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:27.129 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:27.129 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:27.130 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:27.130 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:27.130 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:27.130 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:27.130 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:27.131 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:27.131 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:27.131 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:27.131 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:27.131 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:27.131 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:27.131 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.729103ms
[DEBUG] 2024-04-23 23:09:27.131 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:27.132 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:27.132 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:27.132 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.416591ms
[DEBUG] 2024-04-23 23:09:27.132 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:27.132 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:27.133 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:27.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:27.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:27.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.706448ms
[DEBUG] 2024-04-23 23:09:27.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:27.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:09:27.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:27.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:27.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:27.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:27.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:27.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:27.135 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:27.135 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:27.135 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:27.135 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:27.135 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:27.135 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:27.135 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:27.135 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:27.135 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:27.135 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:27.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:27.136 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:27.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:27.136 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:29.137 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:09:29.137 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:09:29.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:29.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:29.140 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:29.140 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:29.140 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:29.140 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 3.434481ms
[DEBUG] 2024-04-23 23:09:29.141 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:09:29.141 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:09:29.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:29.142 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:29.142 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:29.142 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.242176ms
[DEBUG] 2024-04-23 23:09:29.142 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:09:29.142 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:09:29.142 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:29.143 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:29.143 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:29.143 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:29.143 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:29.144 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:29.144 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:29.144 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:29.144 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:29.144 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:29.145 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:29.145 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:29.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:29.145 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:29.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:29.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:29.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.785859ms
[DEBUG] 2024-04-23 23:09:29.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:29.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:29.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:29.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.450556ms
[DEBUG] 2024-04-23 23:09:29.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:29.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:29.147 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:29.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:29.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:29.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.729468ms
[DEBUG] 2024-04-23 23:09:29.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:29.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:09:29.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:29.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:29.148 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:29.148 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:29.149 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:29.149 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:29.149 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:29.149 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:29.149 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:29.149 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:29.149 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:29.149 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:29.150 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:29.150 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:29.150 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:29.150 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:29.150 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:29.150 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:29.151 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:29.151 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:29.786 [HikariPool-8 housekeeper] HikariPool - HikariPool-8 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:09:31.151 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:09:31.152 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:09:31.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:31.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:31.154 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:31.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:31.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:31.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 3.358477ms
[DEBUG] 2024-04-23 23:09:31.155 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:09:31.155 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:09:31.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:31.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:31.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:31.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.633292ms
[DEBUG] 2024-04-23 23:09:31.157 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:09:31.157 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:09:31.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:31.161 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:31.161 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:31.161 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:31.161 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:31.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:31.164 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:31.164 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:31.164 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:31.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:31.167 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:31.167 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:31.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:31.169 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:31.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:31.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:31.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 2.751968ms
[DEBUG] 2024-04-23 23:09:31.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:31.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:31.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:31.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 1.636219ms
[DEBUG] 2024-04-23 23:09:31.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:31.173 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:31.175 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:31.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:31.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:31.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 2.65396ms
[DEBUG] 2024-04-23 23:09:31.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:31.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:09:31.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:31.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:31.179 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:31.179 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:31.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:31.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:31.182 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:31.183 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:31.183 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:31.183 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:31.183 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:31.183 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:31.184 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:31.184 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:31.184 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:31.184 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:31.184 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:31.187 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:31.187 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:31.187 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:33.188 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:09:33.188 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:09:33.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:33.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:33.191 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:33.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:33.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:33.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 3.136688ms
[DEBUG] 2024-04-23 23:09:33.192 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:09:33.192 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:09:33.192 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:33.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:33.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:33.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.610982ms
[DEBUG] 2024-04-23 23:09:33.193 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:09:33.193 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:09:33.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:33.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:33.195 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:33.195 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:33.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:33.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:33.195 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:33.195 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:33.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:33.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:33.196 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:33.196 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:33.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:33.197 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:33.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:33.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:33.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.708599ms
[DEBUG] 2024-04-23 23:09:33.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:33.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:33.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:33.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.411903ms
[DEBUG] 2024-04-23 23:09:33.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:33.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:33.198 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:33.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:33.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:33.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.720351ms
[DEBUG] 2024-04-23 23:09:33.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:33.199 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:09:33.199 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:33.199 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:33.199 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:33.199 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:33.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:33.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:33.200 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:33.200 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:33.200 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:33.200 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:33.200 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:33.200 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:33.201 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:33.201 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:33.201 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:33.201 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:33.201 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:33.201 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:33.201 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:33.202 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:35.202 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:09:35.203 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:09:35.203 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:35.203 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:35.205 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:35.206 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:35.206 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:35.206 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 3.263715ms
[DEBUG] 2024-04-23 23:09:35.206 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:09:35.206 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:09:35.206 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:35.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:35.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:35.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.464974ms
[DEBUG] 2024-04-23 23:09:35.208 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:09:35.208 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:09:35.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:35.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:35.209 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:35.209 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:35.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:35.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:35.210 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:35.210 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:35.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:35.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:35.211 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:35.211 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:35.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:35.211 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:35.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:35.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:35.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.743224ms
[DEBUG] 2024-04-23 23:09:35.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:35.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:35.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:35.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.413459ms
[DEBUG] 2024-04-23 23:09:35.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:35.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:35.213 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:35.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:35.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:35.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.681058ms
[DEBUG] 2024-04-23 23:09:35.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:35.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:09:35.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:35.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:35.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:35.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:35.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:35.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:35.215 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:35.215 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:35.215 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:35.215 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:35.215 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:35.215 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:35.215 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:35.215 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:09:35.215 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:35.215 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:35.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:35.216 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@914825540 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:35.216 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:35.216 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:35.217 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713910154960 end=1713910175217 duration=20257 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=-1 error=true>
[INFO ] 2024-04-23 23:09:35.217 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:09:35.218 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:09:35.218 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:09:35.218 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:09:35.224 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:09:35.224 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:09:35.224 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:09:35.224 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:09:35.226 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:09:35.257 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519;create=true
[INFO ] 2024-04-23 23:09:35.601 [MetaStoreThread-44519] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[INFO ] 2024-04-23 23:09:35.601 [main] MetaStoreTestUtils - Waiting the HMS to start.
[DEBUG] 2024-04-23 23:09:35.601 [MetaStoreThread-44519] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:09:35.601 [MetaStoreThread-44519] HMSHandler - 38: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519;create=true
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519;create=true
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35431;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519;create=true
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:09:35.602 [MetaStoreThread-44519] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 120
[DEBUG] 2024-04-23 23:09:35.603 [MetaStoreThread-44519] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:35.603 [MetaStoreThread-44519] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:35.603 [MetaStoreThread-44519] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:35.603 [MetaStoreThread-44519] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:35.603 [MetaStoreThread-44519] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:35.603 [MetaStoreThread-44519] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:35.603 [MetaStoreThread-44519] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:35.603 [MetaStoreThread-44519] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:35.603 [MetaStoreThread-44519] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:35.603 [MetaStoreThread-44519] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:35.603 [MetaStoreThread-44519] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:35.603 [MetaStoreThread-44519] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:35.603 [MetaStoreThread-44519] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:35.603 [MetaStoreThread-44519] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:35.603 [MetaStoreThread-44519] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:09:35.603 [MetaStoreThread-44519] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:35.604 [MetaStoreThread-44519] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:09:35.604 [MetaStoreThread-44519] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:09:35.605 [MetaStoreThread-44519] HikariConfig - HikariPool-11 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:09:35.605 [MetaStoreThread-44519] HikariConfig - HikariPool-11 - configuration:
[DEBUG] 2024-04-23 23:09:35.605 [MetaStoreThread-44519] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:09:35.605 [MetaStoreThread-44519] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:09:35.605 [MetaStoreThread-44519] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:09:35.605 [MetaStoreThread-44519] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519;create=true"
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - poolName........................"HikariPool-11"
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:09:35.606 [MetaStoreThread-44519] HikariDataSource - HikariPool-11 - Starting...
[INFO ] 2024-04-23 23:09:35.609 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:09:35.610 [MetaStoreThread-44519] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[INFO ] 2024-04-23 23:09:35.610 [MetaStoreThread-44519] HikariDataSource - HikariPool-11 - Start completed.
[DEBUG] 2024-04-23 23:09:35.680 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:09:35.681 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:09:35.681 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:09:35.681 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3acc93e1, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@46eb459 will be shutdown
[DEBUG] 2024-04-23 23:09:35.681 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:09:35.681 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:09:35.710 [HikariPool-11 housekeeper] HikariPool - HikariPool-11 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:09:35.712 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@502523339 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:35.714 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1557065712 (XID = 1148), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:35.715 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1834521283 (XID = 1150), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:35.716 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1021382847 (XID = 1152), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:35.718 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1168897121 (XID = 1154), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:35.719 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@951011559 (XID = 1156), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:35.720 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@722840027 (XID = 1158), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:35.722 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@454804618 (XID = 1160), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:35.725 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@378656967 (XID = 1162), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:35.725 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:09:35.897 [MetaStoreThread-44519] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:09:35.897 [MetaStoreThread-44519] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7ec0fc75, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:09:35.897 [MetaStoreThread-44519] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:09:35.897 [MetaStoreThread-44519] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7ec0fc75, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@62edeb43 created in the thread with id: 319
[DEBUG] 2024-04-23 23:09:35.898 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:35.898 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:35.898 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:35.971 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.033 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@502523339 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.046 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@502523339 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.079 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@502523339 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.092 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@502523339 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.096 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@502523339 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.196 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@502523339 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.221 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@502523339 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.227 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@502523339 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.232 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@502523339 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.234 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.236 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.236 [MetaStoreThread-44519] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:09:36.236 [MetaStoreThread-44519] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:09:36.236 [MetaStoreThread-44519] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7ec0fc75 from thread id: 319
[DEBUG] 2024-04-23 23:09:36.236 [MetaStoreThread-44519] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:09:36.236 [MetaStoreThread-44519] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.239 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.241 [MetaStoreThread-44519] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.242 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[INFO ] 2024-04-23 23:09:36.242 [MetaStoreThread-44519] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:09:36.242 [MetaStoreThread-44519] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.242 [MetaStoreThread-44519] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.242 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.242 [MetaStoreThread-44519] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.242 [MetaStoreThread-44519] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.245 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.245 [MetaStoreThread-44519] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.246 [MetaStoreThread-44519] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:36.246 [MetaStoreThread-44519] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.246 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.246 [MetaStoreThread-44519] ObjectStore - db details for db default retrieved using SQL in 1.615202ms
[DEBUG] 2024-04-23 23:09:36.246 [MetaStoreThread-44519] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:09:36.246 [MetaStoreThread-44519] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:09:36.247 [MetaStoreThread-44519] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.251 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.253 [MetaStoreThread-44519] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.253 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.255 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[INFO ] 2024-04-23 23:09:36.256 [MetaStoreThread-44519] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:09:36.256 [MetaStoreThread-44519] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.256 [MetaStoreThread-44519] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.259 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.261 [MetaStoreThread-44519] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.263 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@502523339 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.264 [MetaStoreThread-44519] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.265 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[INFO ] 2024-04-23 23:09:36.265 [MetaStoreThread-44519] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:09:36.265 [MetaStoreThread-44519] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.265 [MetaStoreThread-44519] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.265 [MetaStoreThread-44519] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.265 [MetaStoreThread-44519] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.266 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[INFO ] 2024-04-23 23:09:36.266 [MetaStoreThread-44519] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:09:36.266 [MetaStoreThread-44519] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.266 [MetaStoreThread-44519] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.266 [MetaStoreThread-44519] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.266 [MetaStoreThread-44519] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.269 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@502523339 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.272 [MetaStoreThread-44519] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.274 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@502523339 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.275 [MetaStoreThread-44519] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.276 [MetaStoreThread-44519] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[INFO ] 2024-04-23 23:09:36.276 [MetaStoreThread-44519] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:09:36.276 [MetaStoreThread-44519] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:09:36.276 [MetaStoreThread-44519] PerfLogger - </PERFLOG method=init start=1713910175601 end=1713910176276 duration=675 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=38 retryCount=0 error=false>
[INFO ] 2024-04-23 23:09:36.276 [MetaStoreThread-44519] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:09:36.276 [MetaStoreThread-44519] HiveMetaStore - Started the new metaserver on port [44519]...
[INFO ] 2024-04-23 23:09:36.276 [MetaStoreThread-44519] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:09:36.276 [MetaStoreThread-44519] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:09:36.276 [MetaStoreThread-44519] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:09:36.276 [MetaStoreThread-44519] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:09:36.276 [MetaStoreThread-44519] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:09:36.276 [MetaStoreThread-44519] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:09:36.276 [MetaStoreThread-44519] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:09:36.276 [MetaStoreThread-44519] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:09:36.276 [MetaStoreThread-44519] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:09:36.276 [MetaStoreThread-44519] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:09:36.276 [MetaStoreThread-44519] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:09:36.276 [MetaStoreThread-44519] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:09:36.276 [MetaStoreThread-44519] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:09:36.276 [MetaStoreThread-44519] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:09:36.276 [MetaStoreThread-44519] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:09:36.276 [MetaStoreThread-44519] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:09:36.603 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:09:36.603 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 39: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:09:36.603 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:09:36.608 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44519) is created
[INFO ] 2024-04-23 23:09:36.608 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 44519 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44519 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519;create=true
[INFO ] 2024-04-23 23:09:36.608 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:09:36.611 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:09:36.611 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:44519]
[INFO ] 2024-04-23 23:09:36.611 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:44519)
[INFO ] 2024-04-23 23:09:36.612 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:44519) current connections: 8
[DEBUG] 2024-04-23 23:09:36.612 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:36.612 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910176612 end=1713910176612 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:36.612 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:36.612 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:36.612 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 create_database: Database(name:db8, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:09:36.612 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db8, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519;create=true
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519;create=true
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:09:36.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:09:36.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@63163938, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:09:36.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:09:36.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@63163938, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5134ea90 created in the thread with id: 336
[DEBUG] 2024-04-23 23:09:36.614 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.614 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.615 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.616 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.616 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.616 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:09:36.616 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:09:36.616 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@63163938 from thread id: 336
[DEBUG] 2024-04-23 23:09:36.616 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:36.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.617 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.716675ms
[DEBUG] 2024-04-23 23:09:36.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db8, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:09:36.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:09:36.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.618 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.618 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:09:36.618 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:09:36.618 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:09:36.618 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:09:36.618 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:09:36.618 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db
[INFO ] 2024-04-23 23:09:36.618 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db
[INFO ] 2024-04-23 23:09:36.621 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db
[DEBUG] 2024-04-23 23:09:36.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.623 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.623 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713910176612 end=1713910176623 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:36.623 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:36.623 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:36.623 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 create_table_req: Table(tableName:tbl8, dbName:db8, owner:alex, createTime:1713910176, lastAccessTime:1713910176, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:do, type:double, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:s, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:09:36.623 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl8, dbName:db8, owner:alex, createTime:1713910176, lastAccessTime:1713910176, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:do, type:double, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:s, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:09:36.624 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.627 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:36.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:36.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.627 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.623259ms
[DEBUG] 2024-04-23 23:09:36.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:09:36.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.632 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.633 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:36.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:36.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.027754ms
[DEBUG] 2024-04-23 23:09:36.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:36.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:09:36.634 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:36.634 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.634 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:09:36.634 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:09:36.634 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:09:36.634 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:09:36.634 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44519/db8.db/tbl8
[DEBUG] 2024-04-23 23:09:36.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:36.642 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:36.645 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@502523339 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.649 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@502523339 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.653 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@502523339 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.657 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@502523339 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.670 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.671 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713910176623 end=1713910176671 duration=48 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:36.671 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:36.672 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:36.672 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 add_partition : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:09:36.672 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:09:36.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:36.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:09:36.680 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:36.700 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.701 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.705 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.705 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:09:36.705 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:09:36.705 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:09:36.705 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:09:36.705 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44519/db8.db/tbl8/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:09:36.709 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.710 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:36.710 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:09:36.710 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:36.713 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@502523339 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.720 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.720 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.722 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.724 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910176672 end=1713910176724 duration=52 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:36.724 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:36.724 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:36.724 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 add_partition : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:09:36.724 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:09:36.724 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.724 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.724 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:36.724 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:09:36.726 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:36.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.729 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:09:36.729 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:09:36.729 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:09:36.729 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:09:36.730 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44519/db8.db/tbl8/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:09:36.733 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.733 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:36.733 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:09:36.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:36.736 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.736 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.738 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.740 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910176724 end=1713910176740 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:36.740 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:36.740 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:36.740 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 add_partition : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:09:36.740 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:09:36.740 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.740 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.740 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:36.740 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:09:36.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:36.744 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.744 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.744 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.745 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:09:36.745 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:09:36.745 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:09:36.745 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:09:36.745 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44519/db8.db/tbl8/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:09:36.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:36.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:09:36.750 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:36.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.754 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.755 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910176740 end=1713910176755 duration=15 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:36.756 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:36.756 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:36.756 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713910176756 end=1713910176756 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:36.756 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:36.756 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:36.756 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_table : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:09:36.756 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:09:36.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.757 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:36.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:36.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.757 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.236571ms
[DEBUG] 2024-04-23 23:09:36.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:09:36.759 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.761 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.762 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[INFO ] 2024-04-23 23:09:36.763 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:09:36.763 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713910176756 end=1713910176763 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:36.763 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=7, comments=HMS client
[DEBUG] 2024-04-23 23:09:36.764 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:36.764 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:36.764 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_partitions : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:09:36.764 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:09:36.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:09:36.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.768 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.874741ms + 0.007061ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:09:36.772 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.644173ms + 0.080778ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:09:36.774 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.80776ms + 0.252845ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:09:36.776 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.565735ms + 0.162245ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:36.778 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.481606ms + 0.111875ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:09:36.779 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.467619ms + 0.11142ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:36.781 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.700983ms + 0.124598ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:36.783 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.30137ms + 0.168843ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:36.784 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.37908ms + 0.245084ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:36.786 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.459278ms + 0.112891ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:09:36.786 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:36.786 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.786 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 22.114399ms
[DEBUG] 2024-04-23 23:09:36.786 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.786 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.786 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910176764 end=1713910176786 duration=22 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:36.795 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:36.795 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:36.796 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 alter_table: hive.db8.tbl8 newtbl=tbl8
[INFO ] 2024-04-23 23:09:36.796 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db8.tbl8 newtbl=tbl8	
[DEBUG] 2024-04-23 23:09:36.796 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.796 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:36.796 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:36.796 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.797 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.070103ms
[DEBUG] 2024-04-23 23:09:36.797 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:09:36.797 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:09:36.797 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:09:36.797 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:09:36.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.797 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:36.798 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:36.798 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.798 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.798 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.774265ms
[DEBUG] 2024-04-23 23:09:36.798 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.798 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.798 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:09:36.799 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.801 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.802 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.804 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:36.804 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:36.804 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.804 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.853081ms
[DEBUG] 2024-04-23 23:09:36.804 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.804 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:36.804 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:09:36.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:36.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.808 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db8
[WARN ] 2024-04-23 23:09:36.808 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:09:36.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:36.810 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:36.810 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:36.810 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:09:36.811 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:36.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:09:36.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:36.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:09:36.816 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:36.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.819 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.820 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713910176795 end=1713910176820 duration=25 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[INFO ] 2024-04-23 23:09:36.821 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:09:36.821 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:44519]
[INFO ] 2024-04-23 23:09:36.821 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:44519)
[INFO ] 2024-04-23 23:09:36.821 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:44519) current connections: 9
[DEBUG] 2024-04-23 23:09:36.822 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:36.822 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910176822 end=1713910176822 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=41 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:36.822 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:36.822 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:36.822 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 41: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 41: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519;create=true
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:09:36.823 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:09:36.824 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:09:36.824 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:09:36.824 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:09:36.824 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519;create=true
[DEBUG] 2024-04-23 23:09:36.824 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:09:36.824 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:09:36.824 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:09:36.824 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:36.824 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:09:36.824 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:09:36.824 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:09:36.824 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:09:36.824 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:36.824 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:09:36.824 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:09:36.824 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4143e4e9, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:09:36.824 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:09:36.824 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4143e4e9, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7f56cc09 created in the thread with id: 350
[DEBUG] 2024-04-23 23:09:36.824 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.824 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.824 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.825 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.825 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.825 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:09:36.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:09:36.825 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4143e4e9 from thread id: 350
[DEBUG] 2024-04-23 23:09:36.826 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.826 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:09:36.831 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.831 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.832 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713910176822 end=1713910176832 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=41 retryCount=0 error=false>
[INFO ] 2024-04-23 23:09:36.832 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:09:36.832 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 8
[DEBUG] 2024-04-23 23:09:36.832 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:36.832 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:36.832 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:36.832 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:36.832 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_partitions : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:09:36.832 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:09:36.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:09:36.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.832 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 41: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:09:36.832 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:09:36.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4143e4e9, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7f56cc09 will be shutdown
[DEBUG] 2024-04-23 23:09:36.832 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 41: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:09:36.832 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:09:36.832 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713910176832 end=1713910176832 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=41 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:36.833 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:09:36.833 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 41: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:09:36.833 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:09:36.833 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.098022ms + 0.005648ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:09:36.834 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.50899ms + 0.06543ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:09:36.835 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.216803ms + 0.220838ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:09:36.835 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.156837ms + 0.140799ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:36.835 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.146311ms + 0.095994ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:09:36.836 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.147844ms + 0.132814ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:36.836 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.226522ms + 0.129586ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:36.837 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.196877ms + 0.123899ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:36.837 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.255022ms + 0.34478ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:36.837 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.198385ms + 0.120516ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:09:36.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:36.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 5.309139ms
[DEBUG] 2024-04-23 23:09:36.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.838 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.838 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910176832 end=1713910176838 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:36.838 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:36.839 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:36.839 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:09:36.839 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:09:36.839 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:09:36.839 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.841 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.841 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713910176839 end=1713910176841 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:36.841 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:36.841 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:36.841 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:09:36.841 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:09:36.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.844 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.844 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.844 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713910176841 end=1713910176844 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:36.844 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:36.844 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:36.844 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_database: db8
[INFO ] 2024-04-23 23:09:36.844 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db8	
[DEBUG] 2024-04-23 23:09:36.844 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.845 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:36.845 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:36.845 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.845 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.845 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.106324ms
[DEBUG] 2024-04-23 23:09:36.845 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713910176844 end=1713910176845 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:36.845 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=1, comments=HMS client
[DEBUG] 2024-04-23 23:09:36.846 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:36.846 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:36.846 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_tables_by_type: db=@hive#db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:36.846 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:36.846 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:36.846 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:36.846 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.847 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:36.847 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:36.847 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.847 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.847 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.140486ms
[DEBUG] 2024-04-23 23:09:36.847 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:36.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.850 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.938192ms
[DEBUG] 2024-04-23 23:09:36.850 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713910176846 end=1713910176850 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:36.850 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:36.850 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:36.850 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:09:36.850 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:09:36.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:36.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.853 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.790183ms
[DEBUG] 2024-04-23 23:09:36.853 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713910176850 end=1713910176853 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:36.853 [main] HiveMetaStoreClient - Selecting dropDatabase method for db8 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:09:36.853 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:09:36.853 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:36.853 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:36.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.854 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:36.854 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:36.854 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.855 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.855 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.125008ms
[DEBUG] 2024-04-23 23:09:36.855 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_multi_table : db=db8 tbls=tbl8
[INFO ] 2024-04-23 23:09:36.855 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db8 tbls=tbl8	
[DEBUG] 2024-04-23 23:09:36.855 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.859 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.859 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:36.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:36.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.002377ms
[DEBUG] 2024-04-23 23:09:36.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.860 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.860 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713910176853 end=1713910176860 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:36.860 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:36.860 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:36.860 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:09:36.860 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:09:36.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:36.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.861 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:36.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:36.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.969056ms
[DEBUG] 2024-04-23 23:09:36.861 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:09:36.861 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:09:36.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:36.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.535041ms
[DEBUG] 2024-04-23 23:09:36.862 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:09:36.862 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:09:36.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.870 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@502523339 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.873 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:36.873 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:36.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.876 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@502523339 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.879 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:36.879 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:36.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.898 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@502523339 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.901 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:09:36.901 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:09:36.901 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:09:36.901 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:09:36.901 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:36.901 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:36.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.902 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:36.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:36.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.827194ms
[DEBUG] 2024-04-23 23:09:36.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.903 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:36.903 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.903 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.505823ms
[DEBUG] 2024-04-23 23:09:36.903 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.903 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:36.904 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:36.904 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:36.904 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:36.904 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.736438ms
[DEBUG] 2024-04-23 23:09:36.904 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:36.904 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:09:36.904 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:36.904 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:36.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:36.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:36.918 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@502523339 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.922 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:36.925 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:36.926 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:36.926 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.926 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:36.927 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:36.929 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:36.930 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:36.932 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:36.933 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:36.934 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:36.935 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:36.937 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:36.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:36.938 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:37.671 [HikariPool-7 housekeeper] HikariPool - HikariPool-7 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:09:38.940 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:09:38.940 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:09:38.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:38.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:38.943 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:38.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:38.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:38.944 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.704881ms
[DEBUG] 2024-04-23 23:09:38.944 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:09:38.944 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:09:38.944 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:38.945 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:38.945 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:38.945 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.545186ms
[DEBUG] 2024-04-23 23:09:38.945 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:09:38.945 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:09:38.945 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:38.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:38.947 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:38.947 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:38.947 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:38.947 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:38.947 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:38.947 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:38.947 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:38.948 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:38.948 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:38.948 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:38.948 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:38.949 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:38.949 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:38.949 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:38.949 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.773408ms
[DEBUG] 2024-04-23 23:09:38.949 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:38.949 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:38.949 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:38.949 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.396559ms
[DEBUG] 2024-04-23 23:09:38.949 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:38.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:38.950 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:38.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:38.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:38.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.86187ms
[DEBUG] 2024-04-23 23:09:38.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:38.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:09:38.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:38.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:38.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:38.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:38.952 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:38.952 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:38.952 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:38.953 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:38.953 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:38.953 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:38.953 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:38.953 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:38.953 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:38.953 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:38.953 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:38.953 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:38.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:38.954 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:38.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:38.954 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:39.001 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:09:40.955 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:09:40.955 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:09:40.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:40.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:40.958 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:40.958 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:40.958 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:40.958 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.256885ms
[DEBUG] 2024-04-23 23:09:40.958 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:09:40.958 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:09:40.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:40.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:40.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:40.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.442387ms
[DEBUG] 2024-04-23 23:09:40.959 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:09:40.959 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:09:40.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:40.960 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:40.960 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:40.960 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:40.960 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:40.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:40.961 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:40.961 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:40.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:40.962 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:40.962 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:40.962 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:40.962 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:40.962 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:40.963 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:40.963 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:40.963 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.710736ms
[DEBUG] 2024-04-23 23:09:40.963 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:40.963 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:40.963 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:40.963 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.410257ms
[DEBUG] 2024-04-23 23:09:40.963 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:40.963 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:40.964 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:40.964 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:40.964 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:40.964 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.672704ms
[DEBUG] 2024-04-23 23:09:40.964 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:40.964 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:09:40.964 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:40.964 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:40.965 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:40.965 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:40.966 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:40.966 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:40.966 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:40.966 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:40.966 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:40.966 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:40.966 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:40.966 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:40.966 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:40.966 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:40.966 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:40.966 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:40.966 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:40.967 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:40.967 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:40.967 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:42.968 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:09:42.968 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:09:42.968 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:42.969 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:42.971 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:42.971 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:42.971 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:42.971 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 2.945677ms
[DEBUG] 2024-04-23 23:09:42.972 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:09:42.972 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:09:42.972 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:42.973 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:42.973 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:42.973 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.987528ms
[DEBUG] 2024-04-23 23:09:42.973 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:09:42.973 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:09:42.973 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:42.974 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:42.974 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:42.974 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:42.974 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:42.974 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:42.975 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:42.975 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:42.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:42.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:42.975 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:42.975 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:42.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:42.976 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:42.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:42.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:42.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.717128ms
[DEBUG] 2024-04-23 23:09:42.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:42.977 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:42.977 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:42.977 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.429899ms
[DEBUG] 2024-04-23 23:09:42.977 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:42.977 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:42.978 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:42.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:42.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:42.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.694122ms
[DEBUG] 2024-04-23 23:09:42.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:42.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:09:42.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:42.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:42.979 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:42.979 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:42.979 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:42.980 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:42.980 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:42.980 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:42.980 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:42.980 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:42.980 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:42.980 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:42.980 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:42.980 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:42.980 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:42.980 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:42.980 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:42.981 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:42.981 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:42.981 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:43.787 [HikariPool-10 housekeeper] HikariPool - HikariPool-10 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:09:44.462 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:09:44.982 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:09:44.982 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:09:44.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:44.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:44.985 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:44.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:44.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:44.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.120213ms
[DEBUG] 2024-04-23 23:09:44.985 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:09:44.985 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:09:44.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:44.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:44.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:44.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.481725ms
[DEBUG] 2024-04-23 23:09:44.986 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:09:44.986 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:09:44.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:44.987 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:44.987 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:44.987 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:44.987 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:44.988 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:44.988 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:44.988 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:44.988 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:44.988 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:44.988 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:44.988 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:44.988 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:44.989 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:44.989 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:44.989 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:44.989 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.780371ms
[DEBUG] 2024-04-23 23:09:44.989 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:44.990 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:44.990 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:44.990 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.442461ms
[DEBUG] 2024-04-23 23:09:44.990 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:44.990 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:44.991 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:44.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:44.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:44.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.822638ms
[DEBUG] 2024-04-23 23:09:44.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:44.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:09:44.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:44.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:44.992 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:44.992 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:44.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:44.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:44.993 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:44.993 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:44.993 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:44.993 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:44.993 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:44.993 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:44.993 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:44.993 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:44.994 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:44.994 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:44.994 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:44.994 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:44.995 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:44.995 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:45.436 [HikariPool-6 housekeeper] HikariPool - HikariPool-6 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:09:46.995 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:09:46.995 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:09:46.996 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:46.996 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:46.999 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:46.999 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:46.999 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:46.999 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.892381ms
[DEBUG] 2024-04-23 23:09:47.000 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:09:47.000 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:09:47.000 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:47.001 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:47.001 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:47.001 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.923067ms
[DEBUG] 2024-04-23 23:09:47.001 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:09:47.001 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:09:47.001 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:47.002 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:47.002 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:47.002 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:47.002 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:47.003 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:47.003 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:47.003 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:47.003 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:47.003 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:47.004 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:47.004 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:47.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:47.004 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:47.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:47.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:47.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.798762ms
[DEBUG] 2024-04-23 23:09:47.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:47.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:47.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:47.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.46337ms
[DEBUG] 2024-04-23 23:09:47.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:47.006 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:47.006 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:47.006 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:47.006 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:47.006 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.704542ms
[DEBUG] 2024-04-23 23:09:47.006 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:47.007 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:09:47.007 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:47.007 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:47.007 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:47.007 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:47.008 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:47.008 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:47.008 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:47.008 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:47.008 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:47.008 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:47.009 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:47.009 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:47.009 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:47.009 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:47.009 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:47.009 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:47.009 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:47.010 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:47.010 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:47.010 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:48.038 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:09:48.042 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:09:49.011 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:09:49.011 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:09:49.011 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:49.011 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:49.013 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:49.014 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:49.014 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:49.014 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.029688ms
[DEBUG] 2024-04-23 23:09:49.014 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:09:49.014 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:09:49.014 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:49.016 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:49.016 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:49.016 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.576266ms
[DEBUG] 2024-04-23 23:09:49.016 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:09:49.016 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:09:49.016 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:49.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:49.017 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:49.018 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:49.018 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:49.018 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:49.018 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:49.018 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:49.018 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:49.019 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:49.019 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:49.019 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:49.019 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:49.020 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:49.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:49.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:49.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.765379ms
[DEBUG] 2024-04-23 23:09:49.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:49.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:49.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:49.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.416436ms
[DEBUG] 2024-04-23 23:09:49.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:49.021 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:49.022 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:49.022 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:49.022 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:49.022 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.720818ms
[DEBUG] 2024-04-23 23:09:49.022 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:49.022 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:09:49.022 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:49.022 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:49.023 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:49.023 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:49.023 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:49.023 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:49.024 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:49.024 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:49.024 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:49.024 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:49.024 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:49.024 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:49.024 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:49.024 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:49.024 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:49.024 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:49.024 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:49.025 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:49.025 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:49.025 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:51.026 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:09:51.026 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:09:51.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:51.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:51.029 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:51.029 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:51.029 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:51.029 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.087084ms
[DEBUG] 2024-04-23 23:09:51.029 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:09:51.030 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:09:51.030 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:51.031 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:51.031 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:51.031 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.5206ms
[DEBUG] 2024-04-23 23:09:51.031 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:09:51.031 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:09:51.031 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:51.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:51.033 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:51.033 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:51.033 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:51.033 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:51.033 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:51.033 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:51.033 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:51.034 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:51.034 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:51.034 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:51.034 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:51.035 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:51.035 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:51.035 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:51.035 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.776248ms
[DEBUG] 2024-04-23 23:09:51.035 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:51.036 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:51.036 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:51.036 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.701142ms
[DEBUG] 2024-04-23 23:09:51.036 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:51.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:51.037 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:51.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:51.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:51.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.81137ms
[DEBUG] 2024-04-23 23:09:51.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:51.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:09:51.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:51.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:51.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:51.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:51.039 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:51.040 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:51.040 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:51.040 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:51.040 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:51.040 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:51.040 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:51.040 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:51.040 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:51.040 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:51.040 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:51.040 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:51.040 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:51.041 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:51.041 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:51.041 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:51.840 [HikariPool-9 housekeeper] HikariPool - HikariPool-9 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:09:53.042 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:09:53.042 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:09:53.042 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:53.042 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:53.043 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:53.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:53.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:53.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.106209ms
[DEBUG] 2024-04-23 23:09:53.044 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:09:53.044 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:09:53.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:53.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:53.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:53.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.447576ms
[DEBUG] 2024-04-23 23:09:53.044 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:09:53.044 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:09:53.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:53.046 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:53.046 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:53.046 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:53.046 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:53.046 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:53.046 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:53.046 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:53.046 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:53.047 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:53.047 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:53.047 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:53.047 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:53.048 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:53.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:53.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:53.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.695924ms
[DEBUG] 2024-04-23 23:09:53.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:53.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:53.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:53.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.406976ms
[DEBUG] 2024-04-23 23:09:53.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:53.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:53.049 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:53.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:53.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:53.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.658508ms
[DEBUG] 2024-04-23 23:09:53.050 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:53.050 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:09:53.050 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:53.050 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:53.050 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:53.051 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:53.051 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:53.051 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:53.051 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:53.051 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:53.052 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:53.052 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:53.052 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:53.052 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:53.052 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:53.052 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:53.052 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:53.052 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:53.052 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:53.053 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:53.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:53.053 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:53.335 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:09:55.054 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:09:55.054 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:09:55.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:55.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:55.056 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:55.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:55.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:55.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 2.419022ms
[DEBUG] 2024-04-23 23:09:55.057 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:09:55.057 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:09:55.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:55.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:55.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:55.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.494658ms
[DEBUG] 2024-04-23 23:09:55.057 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:09:55.057 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:09:55.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:55.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:55.059 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:55.059 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:55.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:55.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:55.059 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:55.059 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:55.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:55.060 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:55.060 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:55.060 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:55.060 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:55.061 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:55.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:55.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:55.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.889003ms
[DEBUG] 2024-04-23 23:09:55.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:55.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:55.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:55.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.53087ms
[DEBUG] 2024-04-23 23:09:55.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:55.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:55.063 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:55.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:55.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:55.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.7605ms
[DEBUG] 2024-04-23 23:09:55.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:55.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:09:55.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:55.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:55.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:55.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:55.065 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:55.065 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:55.065 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:55.065 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:55.065 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:55.065 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:55.065 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:55.066 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:55.066 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:55.066 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:55.066 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:55.066 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:55.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:55.067 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:55.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:55.067 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:57.068 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:09:57.068 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:09:57.068 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:57.068 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:57.070 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:57.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:57.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:57.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.148067ms
[DEBUG] 2024-04-23 23:09:57.071 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:09:57.071 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:09:57.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:57.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:57.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:57.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.460786ms
[DEBUG] 2024-04-23 23:09:57.073 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:09:57.073 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:09:57.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:57.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:57.075 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:57.075 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:57.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:57.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:57.076 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:57.076 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:57.076 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:57.076 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:57.076 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:57.076 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:57.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:57.077 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:57.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:57.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:57.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.766472ms
[DEBUG] 2024-04-23 23:09:57.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:57.078 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:57.078 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:57.078 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.503045ms
[DEBUG] 2024-04-23 23:09:57.078 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:57.078 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:57.079 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:57.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:57.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:57.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.819904ms
[DEBUG] 2024-04-23 23:09:57.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:57.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:09:57.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:57.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:57.080 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:57.080 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:57.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:57.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:57.081 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:57.081 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:57.081 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:57.081 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:57.082 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:57.082 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:57.082 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:57.082 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:09:57.082 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:57.082 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:57.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:57.083 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@684157827 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:57.083 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:57.083 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:57.083 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713910176860 end=1713910197083 duration=20223 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=-1 error=true>
[INFO ] 2024-04-23 23:09:57.084 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:09:57.085 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:09:57.085 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:09:57.085 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:09:57.093 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:09:57.093 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:09:57.093 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:09:57.094 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:09:57.095 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:09:57.124 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725;create=true
[INFO ] 2024-04-23 23:09:57.480 [MetaStoreThread-34725] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[INFO ] 2024-04-23 23:09:57.480 [main] MetaStoreTestUtils - Waiting the HMS to start.
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] HMSHandler - 42: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725;create=true
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:09:57.481 [MetaStoreThread-34725] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725;create=true
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44519;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725;create=true
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 120
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:57.482 [MetaStoreThread-34725] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:57.483 [MetaStoreThread-34725] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:57.483 [MetaStoreThread-34725] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:57.483 [MetaStoreThread-34725] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:57.483 [MetaStoreThread-34725] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:57.483 [MetaStoreThread-34725] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:57.483 [MetaStoreThread-34725] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:57.483 [MetaStoreThread-34725] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:57.483 [MetaStoreThread-34725] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:57.483 [MetaStoreThread-34725] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:57.483 [MetaStoreThread-34725] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:57.483 [MetaStoreThread-34725] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:09:57.483 [MetaStoreThread-34725] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:09:57.483 [MetaStoreThread-34725] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:57.484 [MetaStoreThread-34725] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:09:57.484 [MetaStoreThread-34725] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:09:57.484 [MetaStoreThread-34725] HikariConfig - HikariPool-12 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:09:57.484 [MetaStoreThread-34725] HikariConfig - HikariPool-12 - configuration:
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725;create=true"
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:09:57.485 [MetaStoreThread-34725] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:09:57.486 [MetaStoreThread-34725] HikariConfig - poolName........................"HikariPool-12"
[DEBUG] 2024-04-23 23:09:57.486 [MetaStoreThread-34725] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:09:57.486 [MetaStoreThread-34725] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:09:57.486 [MetaStoreThread-34725] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:09:57.486 [MetaStoreThread-34725] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:09:57.486 [MetaStoreThread-34725] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:09:57.486 [MetaStoreThread-34725] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:09:57.486 [MetaStoreThread-34725] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:09:57.486 [MetaStoreThread-34725] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:09:57.486 [MetaStoreThread-34725] HikariDataSource - HikariPool-12 - Starting...
[INFO ] 2024-04-23 23:09:57.487 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:09:57.488 [MetaStoreThread-34725] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[INFO ] 2024-04-23 23:09:57.488 [MetaStoreThread-34725] HikariDataSource - HikariPool-12 - Start completed.
[DEBUG] 2024-04-23 23:09:57.561 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:09:57.562 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:09:57.562 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:09:57.562 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@63163938, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5134ea90 will be shutdown
[DEBUG] 2024-04-23 23:09:57.562 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:09:57.562 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:09:57.588 [HikariPool-12 housekeeper] HikariPool - HikariPool-12 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:09:57.590 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1493867517 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:57.591 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@406294982 (XID = 1157), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:57.592 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@702892386 (XID = 1159), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:57.594 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2014867081 (XID = 1161), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:57.595 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@815322511 (XID = 1163), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:57.597 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2086040112 (XID = 1165), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:57.598 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@270360357 (XID = 1167), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:57.599 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@299444489 (XID = 1169), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:57.600 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1935018671 (XID = 1171), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:57.600 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:09:57.735 [MetaStoreThread-34725] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:09:57.735 [MetaStoreThread-34725] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@64f08486, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:09:57.735 [MetaStoreThread-34725] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:09:57.736 [MetaStoreThread-34725] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@64f08486, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1b5533df created in the thread with id: 353
[DEBUG] 2024-04-23 23:09:57.736 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:57.736 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:57.736 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:57.832 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:57.908 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1493867517 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:57.920 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1493867517 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:57.962 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1493867517 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:57.976 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1493867517 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:57.980 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1493867517 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.076 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1493867517 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.099 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1493867517 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.104 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1493867517 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.109 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1493867517 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.111 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.113 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.113 [MetaStoreThread-34725] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:09:58.113 [MetaStoreThread-34725] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:09:58.113 [MetaStoreThread-34725] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@64f08486 from thread id: 353
[DEBUG] 2024-04-23 23:09:58.113 [MetaStoreThread-34725] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:09:58.113 [MetaStoreThread-34725] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.116 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.118 [MetaStoreThread-34725] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.118 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[INFO ] 2024-04-23 23:09:58.118 [MetaStoreThread-34725] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:09:58.119 [MetaStoreThread-34725] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.119 [MetaStoreThread-34725] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.119 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.119 [MetaStoreThread-34725] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.119 [MetaStoreThread-34725] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.121 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.121 [MetaStoreThread-34725] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.123 [MetaStoreThread-34725] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:58.123 [MetaStoreThread-34725] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.123 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.123 [MetaStoreThread-34725] ObjectStore - db details for db default retrieved using SQL in 1.657681ms
[DEBUG] 2024-04-23 23:09:58.123 [MetaStoreThread-34725] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:09:58.123 [MetaStoreThread-34725] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:09:58.123 [MetaStoreThread-34725] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.128 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.129 [MetaStoreThread-34725] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.130 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.132 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[INFO ] 2024-04-23 23:09:58.132 [MetaStoreThread-34725] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:09:58.132 [MetaStoreThread-34725] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.132 [MetaStoreThread-34725] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.135 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.137 [MetaStoreThread-34725] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.140 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1493867517 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.141 [MetaStoreThread-34725] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.142 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[INFO ] 2024-04-23 23:09:58.142 [MetaStoreThread-34725] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:09:58.142 [MetaStoreThread-34725] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.142 [MetaStoreThread-34725] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.142 [MetaStoreThread-34725] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.142 [MetaStoreThread-34725] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.143 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[INFO ] 2024-04-23 23:09:58.143 [MetaStoreThread-34725] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:09:58.143 [MetaStoreThread-34725] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.143 [MetaStoreThread-34725] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.143 [MetaStoreThread-34725] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.143 [MetaStoreThread-34725] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.146 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1493867517 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.148 [MetaStoreThread-34725] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.151 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1493867517 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.152 [MetaStoreThread-34725] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.153 [MetaStoreThread-34725] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[INFO ] 2024-04-23 23:09:58.153 [MetaStoreThread-34725] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:09:58.153 [MetaStoreThread-34725] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:09:58.153 [MetaStoreThread-34725] PerfLogger - </PERFLOG method=init start=1713910197481 end=1713910198153 duration=672 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[INFO ] 2024-04-23 23:09:58.154 [MetaStoreThread-34725] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:09:58.154 [MetaStoreThread-34725] HiveMetaStore - Started the new metaserver on port [34725]...
[INFO ] 2024-04-23 23:09:58.154 [MetaStoreThread-34725] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:09:58.154 [MetaStoreThread-34725] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:09:58.154 [MetaStoreThread-34725] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:09:58.154 [MetaStoreThread-34725] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:09:58.154 [MetaStoreThread-34725] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:09:58.154 [MetaStoreThread-34725] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:09:58.154 [MetaStoreThread-34725] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:09:58.154 [MetaStoreThread-34725] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:09:58.154 [MetaStoreThread-34725] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:09:58.154 [MetaStoreThread-34725] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:09:58.154 [MetaStoreThread-34725] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:09:58.154 [MetaStoreThread-34725] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:09:58.154 [MetaStoreThread-34725] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:09:58.154 [MetaStoreThread-34725] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:09:58.154 [MetaStoreThread-34725] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:09:58.154 [MetaStoreThread-34725] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:09:58.483 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:09:58.483 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 43: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:09:58.483 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:09:58.494 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34725) is created
[INFO ] 2024-04-23 23:09:58.494 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 34725 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34725 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725;create=true
[INFO ] 2024-04-23 23:09:58.494 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:09:58.503 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:09:58.503 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34725]
[INFO ] 2024-04-23 23:09:58.503 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34725)
[INFO ] 2024-04-23 23:09:58.503 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34725) current connections: 9
[DEBUG] 2024-04-23 23:09:58.504 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:58.504 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910198504 end=1713910198504 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=44 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:58.504 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:58.504 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:58.504 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 create_database: Database(name:db2, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:09:58.504 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db2, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725;create=true
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725;create=true
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@76c237cb, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:09:58.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:09:58.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@76c237cb, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@71f6c51e created in the thread with id: 370
[DEBUG] 2024-04-23 23:09:58.506 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.506 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.507 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.507 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.508 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.508 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:09:58.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:09:58.508 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@76c237cb from thread id: 370
[DEBUG] 2024-04-23 23:09:58.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:58.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.509 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.652235ms
[DEBUG] 2024-04-23 23:09:58.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db2, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:09:58.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:09:58.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.510 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.510 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:09:58.510 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:09:58.510 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:09:58.510 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:09:58.510 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:09:58.510 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db
[INFO ] 2024-04-23 23:09:58.511 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db
[INFO ] 2024-04-23 23:09:58.513 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db
[DEBUG] 2024-04-23 23:09:58.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.515 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.515 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713910198504 end=1713910198515 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=44 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:58.515 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:58.515 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:58.515 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 create_table_req: Table(tableName:tbl2, dbName:db2, owner:alex, createTime:1713910198, lastAccessTime:1713910198, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:s, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:09:58.515 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl2, dbName:db2, owner:alex, createTime:1713910198, lastAccessTime:1713910198, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:s, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:09:58.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.518 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:58.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:58.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.518 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.011768ms
[DEBUG] 2024-04-23 23:09:58.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:09:58.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.523 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.524 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:58.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:58.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.968254ms
[DEBUG] 2024-04-23 23:09:58.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:58.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:09:58.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:58.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.525 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:09:58.525 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:09:58.525 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:09:58.525 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:09:58.525 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34725/db2.db/tbl2
[DEBUG] 2024-04-23 23:09:58.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:58.532 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:58.536 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1493867517 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.540 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1493867517 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.544 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1493867517 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.548 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1493867517 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.560 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.561 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713910198515 end=1713910198561 duration=46 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=44 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:58.561 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:58.562 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:58.562 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 add_partition : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:09:58.562 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:09:58.562 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.562 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.562 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:58.562 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:09:58.569 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:58.589 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.589 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.593 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:09:58.593 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:09:58.593 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:09:58.593 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:09:58.593 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34725/db2.db/tbl2/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:09:58.598 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.598 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:58.598 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:09:58.599 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:58.601 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1493867517 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.608 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.608 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.610 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.611 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910198562 end=1713910198611 duration=49 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=44 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:58.611 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:58.611 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:58.611 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 add_partition : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:09:58.611 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:09:58.611 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.611 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.611 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:58.611 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:09:58.613 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:58.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.616 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.616 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:09:58.616 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:09:58.616 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:09:58.616 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:09:58.616 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34725/db2.db/tbl2/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:09:58.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:58.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:09:58.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:58.623 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.623 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.625 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.627 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910198611 end=1713910198627 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=44 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:58.627 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:58.627 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:58.627 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 add_partition : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:09:58.627 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:09:58.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:58.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:09:58.630 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:58.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.634 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.634 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:09:58.634 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:09:58.634 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:09:58.634 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:09:58.634 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34725/db2.db/tbl2/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:09:58.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:58.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:09:58.639 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:58.641 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.642 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.643 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.645 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910198627 end=1713910198645 duration=18 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=44 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:58.645 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:58.645 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:58.645 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713910198645 end=1713910198645 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=44 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:58.645 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:58.645 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:58.645 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_table : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:09:58.645 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:09:58.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.646 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:58.646 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:58.646 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.646 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.647 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.068874ms
[DEBUG] 2024-04-23 23:09:58.647 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.647 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.647 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:09:58.648 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.650 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.651 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[INFO ] 2024-04-23 23:09:58.652 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:09:58.652 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713910198645 end=1713910198652 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=44 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:58.652 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=7, comments=HMS client
[DEBUG] 2024-04-23 23:09:58.652 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:58.652 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:58.652 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:09:58.652 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:09:58.652 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:09:58.652 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.652 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.655 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.93528ms + 0.00579ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:09:58.658 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.320494ms + 0.063017ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:09:58.660 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.591878ms + 0.244974ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:09:58.662 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.330253ms + 0.152351ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:58.663 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.437255ms + 0.109859ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:09:58.665 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.276618ms + 0.107767ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:58.666 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.204653ms + 0.106929ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:58.667 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.278433ms + 0.107199ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:58.669 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.38767ms + 0.2417ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:58.670 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.36124ms + 0.102554ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:09:58.671 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:58.671 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.671 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 18.155942ms
[DEBUG] 2024-04-23 23:09:58.671 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.671 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.671 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910198652 end=1713910198671 duration=19 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=44 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:58.680 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:58.680 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:58.680 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:09:58.680 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:09:58.680 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:09:58.680 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.680 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.680 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.565769ms + 0.005183ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:09:58.681 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.36432ms + 0.056204ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:09:58.682 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.153362ms + 0.232361ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:09:58.682 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.161666ms + 0.130107ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:58.682 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.138537ms + 0.092281ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:09:58.683 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.136539ms + 0.15458ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:58.683 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.145959ms + 0.092395ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:58.683 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.141646ms + 0.089474ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:58.683 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.17993ms + 0.209787ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:58.684 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.153048ms + 0.091512ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:09:58.684 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:58.684 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.684 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 3.910967ms
[DEBUG] 2024-04-23 23:09:58.684 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.684 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.684 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910198680 end=1713910198684 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=44 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:58.685 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:58.685 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:58.685 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 alter_table: hive.db2.tbl2 newtbl=tbl2
[INFO ] 2024-04-23 23:09:58.685 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db2.tbl2 newtbl=tbl2	
[DEBUG] 2024-04-23 23:09:58.685 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.686 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:58.686 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:58.686 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.686 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.686 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.905766ms
[DEBUG] 2024-04-23 23:09:58.686 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:09:58.686 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:09:58.686 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:09:58.686 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:09:58.686 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.687 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:58.687 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:58.687 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.687 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.687 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.868197ms
[DEBUG] 2024-04-23 23:09:58.687 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.687 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.687 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:09:58.689 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.691 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.692 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.693 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.693 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.693 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:58.694 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:58.694 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.694 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.837096ms
[DEBUG] 2024-04-23 23:09:58.694 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.694 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:58.694 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:09:58.695 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:58.697 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.697 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db2
[WARN ] 2024-04-23 23:09:58.697 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:09:58.697 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.697 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:58.698 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:58.698 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:58.698 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:09:58.699 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:58.700 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:09:58.700 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:58.700 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:09:58.704 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:58.706 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.706 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.707 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.708 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713910198685 end=1713910198708 duration=23 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=44 retryCount=0 error=false>
[INFO ] 2024-04-23 23:09:58.709 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:09:58.709 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34725]
[INFO ] 2024-04-23 23:09:58.709 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34725)
[INFO ] 2024-04-23 23:09:58.709 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34725) current connections: 10
[DEBUG] 2024-04-23 23:09:58.709 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:58.709 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910198709 end=1713910198709 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=45 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:58.710 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:58.710 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:58.710 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:09:58.710 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725;create=true
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725;create=true
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@36dc2ad1, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@36dc2ad1, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@587a20f9 created in the thread with id: 384
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.711 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.713 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.713 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.713 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:09:58.713 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:09:58.713 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@36dc2ad1 from thread id: 384
[DEBUG] 2024-04-23 23:09:58.713 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.713 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:09:58.718 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.718 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.718 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713910198710 end=1713910198718 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=45 retryCount=0 error=false>
[INFO ] 2024-04-23 23:09:58.719 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:09:58.719 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 9
[DEBUG] 2024-04-23 23:09:58.719 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:58.719 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:58.719 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:09:58.719 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[INFO ] 2024-04-23 23:09:58.719 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:09:58.719 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@36dc2ad1, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@587a20f9 will be shutdown
[DEBUG] 2024-04-23 23:09:58.719 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:58.719 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:09:58.719 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:09:58.719 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2
[DEBUG] 2024-04-23 23:09:58.719 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713910198719 end=1713910198719 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=45 retryCount=0 error=false>
[INFO ] 2024-04-23 23:09:58.719 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:09:58.719 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:09:58.719 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.719 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.719 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:09:58.719 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:09:58.719 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:09:58.720 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.853198ms + 0.005269ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:09:58.721 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.496077ms + 0.131582ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:09:58.721 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.171368ms + 0.293316ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:09:58.722 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.146751ms + 0.130008ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:58.722 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.165446ms + 0.092129ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:09:58.722 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.122136ms + 0.090961ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:58.723 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.225144ms + 0.107805ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:58.723 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.124357ms + 0.091128ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:58.723 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.161496ms + 0.301068ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:09:58.724 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.169193ms + 0.093469ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:09:58.724 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:58.724 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.724 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 4.698068ms
[DEBUG] 2024-04-23 23:09:58.724 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.724 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.724 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910198719 end=1713910198724 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=44 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:58.724 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:58.725 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:58.725 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:09:58.725 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:09:58.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:09:58.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.727 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.727 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713910198725 end=1713910198727 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=44 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:58.727 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:58.727 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:58.727 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:09:58.727 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:09:58.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.729 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.730 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713910198727 end=1713910198730 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=44 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:58.730 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:58.730 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:58.730 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_database: db2
[INFO ] 2024-04-23 23:09:58.730 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db2	
[DEBUG] 2024-04-23 23:09:58.730 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.730 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:58.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:58.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.731 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.913836ms
[DEBUG] 2024-04-23 23:09:58.731 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713910198730 end=1713910198731 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=44 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:58.731 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=1, comments=HMS client
[DEBUG] 2024-04-23 23:09:58.731 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:58.731 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:58.731 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_tables_by_type: db=@hive#db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:58.731 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:58.731 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:58.731 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:58.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.732 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:58.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:58.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.732 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.036236ms
[DEBUG] 2024-04-23 23:09:58.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:58.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.735 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.801104ms
[DEBUG] 2024-04-23 23:09:58.735 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713910198731 end=1713910198735 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=44 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:58.735 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:58.735 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:58.735 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:09:58.735 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:09:58.736 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:58.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.738 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.599341ms
[DEBUG] 2024-04-23 23:09:58.738 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713910198735 end=1713910198738 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=44 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:58.738 [main] HiveMetaStoreClient - Selecting dropDatabase method for db2 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:09:58.738 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:09:58.738 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:58.738 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:58.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.739 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:58.739 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:58.739 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.739 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.739 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.899089ms
[DEBUG] 2024-04-23 23:09:58.739 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_multi_table : db=db2 tbls=tbl2
[INFO ] 2024-04-23 23:09:58.739 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db2 tbls=tbl2	
[DEBUG] 2024-04-23 23:09:58.739 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.743 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.744 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:58.744 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:58.744 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.744 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.812089ms
[DEBUG] 2024-04-23 23:09:58.744 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.744 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.744 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713910198738 end=1713910198744 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=44 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:09:58.744 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:09:58.744 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:09:58.745 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:09:58.745 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:09:58.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:09:58.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.745 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:58.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:58.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.749532ms
[DEBUG] 2024-04-23 23:09:58.745 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:09:58.745 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:09:58.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:58.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.540018ms
[DEBUG] 2024-04-23 23:09:58.746 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:09:58.746 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:09:58.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.753 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1493867517 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.756 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:09:58.756 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:09:58.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.759 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1493867517 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.762 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.762 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:09:58.762 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:09:58.762 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.781 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1493867517 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.784 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.784 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:09:58.784 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:09:58.784 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:09:58.784 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:09:58.784 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:09:58.784 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:09:58.784 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.785 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:58.785 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:58.785 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.785 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.850457ms
[DEBUG] 2024-04-23 23:09:58.785 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.786 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:58.786 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.786 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.472719ms
[DEBUG] 2024-04-23 23:09:58.786 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.786 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:58.787 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:09:58.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:09:58.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:58.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.81264ms
[DEBUG] 2024-04-23 23:09:58.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:09:58.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:09:58.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:09:58.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:09:58.788 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:09:58.788 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:09:58.802 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1493867517 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:09:58.809 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:09:58.809 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:09:58.809 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.809 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:09:58.811 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:09:58.812 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:09:58.813 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:09:58.814 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:09:58.816 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:09:58.817 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:09:58.817 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.817 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:09:58.818 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:09:58.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:09:58.818 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:09:59.787 [HikariPool-8 housekeeper] HikariPool - HikariPool-8 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:10:00.819 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:10:00.820 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:10:00.820 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:00.820 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:00.821 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:00.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:00.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:00.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.391888ms
[DEBUG] 2024-04-23 23:10:00.821 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:10:00.821 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:10:00.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:00.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:00.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:00.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.709182ms
[DEBUG] 2024-04-23 23:10:00.822 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:10:00.822 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:10:00.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:00.824 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:00.824 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:10:00.824 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:10:00.824 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:00.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:00.825 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:10:00.825 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:10:00.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:00.826 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:00.826 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:10:00.826 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:10:00.826 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:00.826 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:00.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:00.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:00.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.89377ms
[DEBUG] 2024-04-23 23:10:00.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:00.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:00.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:00.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.434677ms
[DEBUG] 2024-04-23 23:10:00.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:00.828 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:00.828 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:00.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:00.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:00.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.888401ms
[DEBUG] 2024-04-23 23:10:00.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:10:00.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:10:00.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:00.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:00.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:00.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:10:00.831 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:10:00.831 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:00.832 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:10:00.832 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:00.832 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:00.832 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:00.832 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:00.832 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:00.832 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:00.832 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:00.832 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:10:00.832 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:00.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:00.833 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:00.833 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:10:00.833 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:10:02.834 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:10:02.834 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:10:02.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:02.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:02.835 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:02.835 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:02.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:02.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.429051ms
[DEBUG] 2024-04-23 23:10:02.836 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:10:02.836 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:10:02.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:02.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:02.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:02.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.653538ms
[DEBUG] 2024-04-23 23:10:02.836 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:10:02.836 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:10:02.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:02.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:02.839 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:10:02.839 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:10:02.839 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:02.839 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:02.839 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:10:02.839 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:10:02.840 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:02.840 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:02.840 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:10:02.840 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:10:02.840 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:02.841 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:02.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:02.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:02.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.72699ms
[DEBUG] 2024-04-23 23:10:02.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:02.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:02.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:02.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.394846ms
[DEBUG] 2024-04-23 23:10:02.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:02.842 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:02.842 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:02.843 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:02.843 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:02.843 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.688738ms
[DEBUG] 2024-04-23 23:10:02.843 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:10:02.843 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:10:02.843 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:02.843 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:02.843 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:02.844 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:10:02.844 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:10:02.844 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:02.844 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:10:02.844 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:02.845 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:02.845 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:02.845 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:02.845 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:02.845 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:02.845 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:02.845 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:10:02.845 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:02.845 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:02.846 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:02.846 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:10:02.846 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:10:04.847 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:10:04.847 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:10:04.847 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:04.847 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:04.849 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:04.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:04.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:04.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.238358ms
[DEBUG] 2024-04-23 23:10:04.850 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:10:04.851 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:10:04.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:04.852 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:04.852 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:04.852 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.331029ms
[DEBUG] 2024-04-23 23:10:04.852 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:10:04.852 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:10:04.852 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:04.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:04.853 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:10:04.853 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:10:04.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:04.854 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:04.854 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:10:04.854 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:10:04.854 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:04.855 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:04.855 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:10:04.855 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:10:04.855 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:04.856 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:04.856 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:04.856 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:04.856 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.723431ms
[DEBUG] 2024-04-23 23:10:04.856 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:04.856 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:04.856 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:04.856 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.400101ms
[DEBUG] 2024-04-23 23:10:04.856 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:04.857 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:04.857 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:04.857 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:04.857 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:04.857 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.666763ms
[DEBUG] 2024-04-23 23:10:04.857 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:10:04.858 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:10:04.858 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:04.858 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:04.858 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:04.858 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:10:04.859 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:10:04.859 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:04.859 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:10:04.859 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:04.860 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:04.860 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:04.860 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:04.860 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:04.860 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:04.860 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:04.860 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:10:04.860 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:04.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:04.861 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:04.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:10:04.861 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:10:05.711 [HikariPool-11 housekeeper] HikariPool - HikariPool-11 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:10:06.862 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:10:06.862 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:10:06.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:06.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:06.864 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:06.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:06.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:06.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.018919ms
[DEBUG] 2024-04-23 23:10:06.865 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:10:06.865 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:10:06.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:06.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:06.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:06.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.863928ms
[DEBUG] 2024-04-23 23:10:06.867 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:10:06.867 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:10:06.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:06.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:06.872 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:10:06.872 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:10:06.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:06.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:06.875 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:10:06.875 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:10:06.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:06.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:06.878 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:10:06.878 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:10:06.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:06.880 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:06.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:06.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:06.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 2.752876ms
[DEBUG] 2024-04-23 23:10:06.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:06.882 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:06.882 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:06.882 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 1.602471ms
[DEBUG] 2024-04-23 23:10:06.882 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:06.884 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:06.886 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:06.887 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:06.887 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:06.887 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 2.686275ms
[DEBUG] 2024-04-23 23:10:06.887 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:10:06.887 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:10:06.888 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:06.888 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:06.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:06.891 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:10:06.893 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:10:06.893 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:06.894 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:10:06.894 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:06.894 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:06.894 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:06.894 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:06.894 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:06.894 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:06.895 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:06.895 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:10:06.895 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:06.895 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:06.897 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:06.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:10:06.897 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:10:07.671 [HikariPool-7 housekeeper] HikariPool - HikariPool-7 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:10:08.898 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:10:08.898 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:10:08.899 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:08.899 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:08.901 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:08.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:08.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:08.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 2.891041ms
[DEBUG] 2024-04-23 23:10:08.902 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:10:08.902 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:10:08.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:08.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:08.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:08.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.447382ms
[DEBUG] 2024-04-23 23:10:08.902 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:10:08.902 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:10:08.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:08.903 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:08.904 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:10:08.904 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:10:08.904 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:08.904 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:08.904 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:10:08.904 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:10:08.904 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:08.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:08.905 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:10:08.905 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:10:08.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:08.906 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:08.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:08.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:08.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.713068ms
[DEBUG] 2024-04-23 23:10:08.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:08.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:08.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:08.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.391889ms
[DEBUG] 2024-04-23 23:10:08.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:08.907 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:08.907 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:08.907 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:08.907 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:08.907 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.631025ms
[DEBUG] 2024-04-23 23:10:08.907 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:10:08.908 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:10:08.908 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:08.908 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:08.908 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:08.908 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:10:08.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:10:08.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:08.909 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:10:08.909 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:08.910 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:08.910 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:08.910 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:08.910 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:08.910 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:08.910 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:08.910 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:10:08.910 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:08.910 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:08.910 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:08.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:10:08.911 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:10:09.002 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:10:10.911 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:10:10.911 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:10:10.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:10.912 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:10.914 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:10.914 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:10.914 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:10.914 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 2.915166ms
[DEBUG] 2024-04-23 23:10:10.915 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:10:10.915 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:10:10.915 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:10.915 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:10.916 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:10.916 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.771961ms
[DEBUG] 2024-04-23 23:10:10.916 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:10:10.916 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:10:10.916 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:10.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:10.917 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:10:10.917 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:10:10.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:10.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:10.917 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:10:10.917 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:10:10.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:10.918 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:10.918 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:10:10.918 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:10:10.918 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:10.919 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:10.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:10.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:10.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.750474ms
[DEBUG] 2024-04-23 23:10:10.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:10.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:10.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:10.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.435472ms
[DEBUG] 2024-04-23 23:10:10.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:10.920 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:10.920 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:10.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:10.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:10.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.692764ms
[DEBUG] 2024-04-23 23:10:10.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:10:10.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:10:10.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:10.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:10.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:10.922 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:10:10.922 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:10:10.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:10.923 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:10:10.923 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:10.923 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:10.923 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:10.923 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:10.923 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:10.923 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:10.923 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:10.923 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:10:10.923 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:10.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:10.924 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:10.924 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:10:10.924 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:10:12.925 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:10:12.925 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:10:12.925 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:12.925 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:12.928 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:12.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:12.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:12.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.556095ms
[DEBUG] 2024-04-23 23:10:12.929 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:10:12.929 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:10:12.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:12.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:12.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:12.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.24182ms
[DEBUG] 2024-04-23 23:10:12.931 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:10:12.931 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:10:12.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:12.932 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:12.932 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:10:12.932 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:10:12.932 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:12.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:12.933 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:10:12.933 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:10:12.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:12.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:12.934 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:10:12.934 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:10:12.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:12.934 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:12.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:12.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:12.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.86201ms
[DEBUG] 2024-04-23 23:10:12.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:12.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:12.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:12.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.526879ms
[DEBUG] 2024-04-23 23:10:12.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:12.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:12.936 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:12.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:12.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:12.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.744677ms
[DEBUG] 2024-04-23 23:10:12.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:10:12.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:10:12.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:12.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:12.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:12.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:10:12.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:10:12.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:12.938 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:10:12.939 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:12.939 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:12.939 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:12.939 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:12.939 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:12.939 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:12.939 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:12.939 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:10:12.939 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:12.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:12.940 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:12.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:10:12.940 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:10:13.788 [HikariPool-10 housekeeper] HikariPool - HikariPool-10 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:10:14.462 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:10:14.940 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:10:14.940 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:10:14.941 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:14.941 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:14.942 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:14.942 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:14.942 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:14.942 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.617657ms
[DEBUG] 2024-04-23 23:10:14.942 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:10:14.942 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:10:14.942 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:14.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:14.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:14.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.87922ms
[DEBUG] 2024-04-23 23:10:14.943 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:10:14.943 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:10:14.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:14.945 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:14.945 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:10:14.945 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:10:14.945 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:14.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:14.947 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:10:14.947 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:10:14.947 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:14.948 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:14.948 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:10:14.948 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:10:14.948 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:14.949 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:14.949 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:14.949 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:14.949 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.302192ms
[DEBUG] 2024-04-23 23:10:14.949 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:14.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:14.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:14.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.804419ms
[DEBUG] 2024-04-23 23:10:14.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:14.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:14.952 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:14.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:14.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:14.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.350495ms
[DEBUG] 2024-04-23 23:10:14.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:10:14.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:10:14.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:14.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:14.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:14.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:10:14.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:10:14.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:14.956 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:10:14.956 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:14.956 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:14.956 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:14.956 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:14.956 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:14.957 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:14.957 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:14.957 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:10:14.957 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:14.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:14.958 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:14.958 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:10:14.958 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:10:15.436 [HikariPool-6 housekeeper] HikariPool - HikariPool-6 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:10:16.959 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:10:16.959 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:10:16.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:16.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:16.961 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:16.962 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:16.962 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:16.962 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 2.916464ms
[DEBUG] 2024-04-23 23:10:16.962 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:10:16.962 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:10:16.962 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:16.964 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:16.964 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:16.964 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.604312ms
[DEBUG] 2024-04-23 23:10:16.964 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:10:16.964 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:10:16.964 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:16.965 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:16.965 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:10:16.965 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:10:16.965 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:16.966 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:16.966 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:10:16.966 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:10:16.966 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:16.967 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:16.967 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:10:16.967 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:10:16.967 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:16.968 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:16.968 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:16.968 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:16.968 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.776624ms
[DEBUG] 2024-04-23 23:10:16.968 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:16.968 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:16.968 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:16.968 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.459197ms
[DEBUG] 2024-04-23 23:10:16.968 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:16.969 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:16.969 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:16.970 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:16.970 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:16.970 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.746318ms
[DEBUG] 2024-04-23 23:10:16.970 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:10:16.970 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:10:16.970 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:16.970 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:16.971 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:16.971 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:10:16.971 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:10:16.972 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:16.972 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:10:16.972 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:16.972 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:16.972 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:16.972 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:16.972 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:16.972 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:16.972 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:16.972 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:10:16.972 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:16.972 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:16.973 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:16.973 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:10:16.973 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:10:18.039 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:10:18.043 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:10:18.974 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:10:18.974 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:10:18.974 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:18.974 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:18.977 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:18.977 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:18.977 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:18.977 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.191173ms
[DEBUG] 2024-04-23 23:10:18.977 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:10:18.977 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:10:18.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:18.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:18.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:18.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.606997ms
[DEBUG] 2024-04-23 23:10:18.978 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:10:18.978 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:10:18.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:18.979 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:18.979 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:10:18.979 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:10:18.979 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:18.980 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:18.980 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:10:18.980 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:10:18.980 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:18.981 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:18.981 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:10:18.981 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:10:18.981 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:18.981 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:18.981 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:18.981 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:18.981 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.655859ms
[DEBUG] 2024-04-23 23:10:18.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:18.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:18.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:18.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.392757ms
[DEBUG] 2024-04-23 23:10:18.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:18.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:18.983 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:18.983 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:18.983 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:18.983 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.644124ms
[DEBUG] 2024-04-23 23:10:18.983 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:10:18.983 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:10:18.983 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:18.983 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:18.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:18.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:10:18.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:10:18.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:18.985 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:10:18.985 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:18.985 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:18.985 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:18.985 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:18.985 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:18.985 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:18.985 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:10:18.985 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:10:18.985 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:18.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:18.986 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1120520881 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:18.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:10:18.986 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:10:18.987 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713910198744 end=1713910218987 duration=20243 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=44 retryCount=-1 error=true>
[INFO ] 2024-04-23 23:10:18.987 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:10:18.988 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:10:18.988 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:10:18.988 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:10:18.995 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:10:18.995 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:10:18.995 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:10:18.995 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:10:18.996 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:10:19.026 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821;create=true
[INFO ] 2024-04-23 23:10:19.344 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:10:19.344 [MetaStoreThread-44821] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:10:19.344 [MetaStoreThread-44821] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:10:19.344 [MetaStoreThread-44821] HMSHandler - 46: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:10:19.344 [MetaStoreThread-44821] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:10:19.344 [MetaStoreThread-44821] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:10:19.344 [MetaStoreThread-44821] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:10:19.344 [MetaStoreThread-44821] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:10:19.344 [MetaStoreThread-44821] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:10:19.344 [MetaStoreThread-44821] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821;create=true
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821;create=true
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34725;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821;create=true
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 120
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:10:19.345 [MetaStoreThread-44821] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - HikariPool-13 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - HikariPool-13 - configuration:
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821;create=true"
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:10:19.347 [MetaStoreThread-44821] HikariConfig - poolName........................"HikariPool-13"
[DEBUG] 2024-04-23 23:10:19.348 [MetaStoreThread-44821] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:10:19.348 [MetaStoreThread-44821] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:10:19.348 [MetaStoreThread-44821] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:10:19.348 [MetaStoreThread-44821] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:10:19.348 [MetaStoreThread-44821] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:10:19.348 [MetaStoreThread-44821] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:10:19.348 [MetaStoreThread-44821] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:10:19.348 [MetaStoreThread-44821] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:10:19.348 [MetaStoreThread-44821] HikariDataSource - HikariPool-13 - Starting...
[INFO ] 2024-04-23 23:10:19.349 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:10:19.349 [MetaStoreThread-44821] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[INFO ] 2024-04-23 23:10:19.349 [MetaStoreThread-44821] HikariDataSource - HikariPool-13 - Start completed.
[DEBUG] 2024-04-23 23:10:19.450 [HikariPool-13 housekeeper] HikariPool - HikariPool-13 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:10:19.452 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:10:19.452 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:10:19.452 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:10:19.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@76c237cb, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@71f6c51e will be shutdown
[DEBUG] 2024-04-23 23:10:19.452 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:10:19.452 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:10:19.453 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.454 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@617728142 (XID = 1154), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.456 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@364857986 (XID = 1156), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.457 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1157511105 (XID = 1158), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.458 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@333179899 (XID = 1160), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.459 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1085312902 (XID = 1162), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.461 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@177000253 (XID = 1164), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.462 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@351107703 (XID = 1166), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.463 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@492075500 (XID = 1168), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.463 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:10:19.593 [MetaStoreThread-44821] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:10:19.593 [MetaStoreThread-44821] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@43a87ba9, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:10:19.593 [MetaStoreThread-44821] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:10:19.593 [MetaStoreThread-44821] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@43a87ba9, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6ecf6d03 created in the thread with id: 387
[DEBUG] 2024-04-23 23:10:19.593 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.594 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.594 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.679 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.739 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.751 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.784 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.799 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.803 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.904 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.926 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.931 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.936 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.938 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.939 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.939 [MetaStoreThread-44821] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:10:19.939 [MetaStoreThread-44821] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:10:19.939 [MetaStoreThread-44821] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@43a87ba9 from thread id: 387
[DEBUG] 2024-04-23 23:10:19.939 [MetaStoreThread-44821] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:10:19.939 [MetaStoreThread-44821] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:19.942 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.944 [MetaStoreThread-44821] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:19.944 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[INFO ] 2024-04-23 23:10:19.945 [MetaStoreThread-44821] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:10:19.945 [MetaStoreThread-44821] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:19.945 [MetaStoreThread-44821] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:19.945 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.945 [MetaStoreThread-44821] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:19.945 [MetaStoreThread-44821] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:19.948 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.948 [MetaStoreThread-44821] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:19.949 [MetaStoreThread-44821] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:19.949 [MetaStoreThread-44821] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:19.949 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.950 [MetaStoreThread-44821] ObjectStore - db details for db default retrieved using SQL in 1.592829ms
[DEBUG] 2024-04-23 23:10:19.950 [MetaStoreThread-44821] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:10:19.950 [MetaStoreThread-44821] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:10:19.950 [MetaStoreThread-44821] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:19.954 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.955 [MetaStoreThread-44821] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:19.956 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.958 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[INFO ] 2024-04-23 23:10:19.958 [MetaStoreThread-44821] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:10:19.958 [MetaStoreThread-44821] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:19.958 [MetaStoreThread-44821] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:19.961 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.963 [MetaStoreThread-44821] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:19.965 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.966 [MetaStoreThread-44821] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:19.967 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[INFO ] 2024-04-23 23:10:19.967 [MetaStoreThread-44821] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:10:19.967 [MetaStoreThread-44821] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:19.967 [MetaStoreThread-44821] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:19.968 [MetaStoreThread-44821] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:19.968 [MetaStoreThread-44821] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:19.968 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[INFO ] 2024-04-23 23:10:19.968 [MetaStoreThread-44821] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:10:19.969 [MetaStoreThread-44821] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:19.969 [MetaStoreThread-44821] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:19.969 [MetaStoreThread-44821] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:19.969 [MetaStoreThread-44821] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:19.972 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.975 [MetaStoreThread-44821] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:19.977 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:19.978 [MetaStoreThread-44821] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:19.979 [MetaStoreThread-44821] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[INFO ] 2024-04-23 23:10:19.979 [MetaStoreThread-44821] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:10:19.979 [MetaStoreThread-44821] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:10:19.979 [MetaStoreThread-44821] PerfLogger - </PERFLOG method=init start=1713910219344 end=1713910219979 duration=635 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[INFO ] 2024-04-23 23:10:19.980 [MetaStoreThread-44821] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:10:19.980 [MetaStoreThread-44821] HiveMetaStore - Started the new metaserver on port [44821]...
[INFO ] 2024-04-23 23:10:19.980 [MetaStoreThread-44821] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:10:19.980 [MetaStoreThread-44821] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:10:19.980 [MetaStoreThread-44821] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:10:19.980 [MetaStoreThread-44821] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:10:19.980 [MetaStoreThread-44821] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:10:19.980 [MetaStoreThread-44821] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:10:19.980 [MetaStoreThread-44821] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:10:19.980 [MetaStoreThread-44821] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:10:19.980 [MetaStoreThread-44821] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:10:19.980 [MetaStoreThread-44821] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:10:19.980 [MetaStoreThread-44821] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:10:19.980 [MetaStoreThread-44821] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:10:19.980 [MetaStoreThread-44821] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:10:19.980 [MetaStoreThread-44821] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:10:19.980 [MetaStoreThread-44821] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:10:19.980 [MetaStoreThread-44821] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:10:20.346 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:10:20.346 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 47: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:10:20.346 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:10:20.357 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44821) is created
[INFO ] 2024-04-23 23:10:20.357 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 44821 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44821 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821;create=true
[INFO ] 2024-04-23 23:10:20.357 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:10:20.365 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:10:20.365 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:44821]
[INFO ] 2024-04-23 23:10:20.366 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:44821)
[INFO ] 2024-04-23 23:10:20.366 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:44821) current connections: 10
[DEBUG] 2024-04-23 23:10:20.367 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:10:20.367 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910220367 end=1713910220367 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:10:20.368 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:10:20.369 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:10:20.369 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 create_database: Database(name:db10, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:10:20.369 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db10, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821;create=true
[DEBUG] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:10:20.371 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:10:20.372 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:10:20.372 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:10:20.372 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:10:20.372 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:10:20.372 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:10:20.372 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:10:20.372 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:10:20.372 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:10:20.372 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:10:20.372 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:10:20.372 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821;create=true
[DEBUG] 2024-04-23 23:10:20.372 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:10:20.372 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:10:20.372 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:10:20.372 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:10:20.372 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:10:20.372 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:10:20.372 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:10:20.372 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:10:20.372 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:10:20.372 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:10:20.372 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:10:20.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4904418e, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:10:20.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:10:20.374 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4904418e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@42c89f27 created in the thread with id: 404
[DEBUG] 2024-04-23 23:10:20.375 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.375 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.376 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.379 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.380 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.380 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:10:20.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:10:20.381 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4904418e from thread id: 404
[DEBUG] 2024-04-23 23:10:20.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:20.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.382 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.658395ms
[DEBUG] 2024-04-23 23:10:20.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db10, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:10:20.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:10:20.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.384 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.385 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.385 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:10:20.385 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:10:20.385 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:10:20.385 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:10:20.385 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:10:20.386 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db
[INFO ] 2024-04-23 23:10:20.386 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db
[INFO ] 2024-04-23 23:10:20.392 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db
[DEBUG] 2024-04-23 23:10:20.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.394 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.394 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.399 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.399 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713910220369 end=1713910220399 duration=30 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:10:20.400 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:10:20.400 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:10:20.400 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 create_table_req: Table(tableName:tbl10, dbName:db10, owner:alex, createTime:1713910220, lastAccessTime:1713910220, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:b, type:binary, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:s, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:), FieldSchema(name:modts, type:timestamp, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:10:20.401 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl10, dbName:db10, owner:alex, createTime:1713910220, lastAccessTime:1713910220, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:b, type:binary, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:s, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:), FieldSchema(name:modts, type:timestamp, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:10:20.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.408 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:20.409 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:20.409 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.409 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 8.750922ms
[DEBUG] 2024-04-23 23:10:20.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:10:20.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.418 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.420 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:20.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:20.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.464679ms
[DEBUG] 2024-04-23 23:10:20.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:20.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:10:20.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:20.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.421 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:10:20.421 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:10:20.421 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:10:20.421 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:10:20.422 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44821/db10.db/tbl10
[DEBUG] 2024-04-23 23:10:20.427 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.427 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:20.431 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:20.434 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.439 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.442 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.446 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.458 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.459 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713910220400 end=1713910220459 duration=59 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:10:20.459 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:10:20.459 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:10:20.459 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 add_partition : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:10:20.459 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:10:20.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:20.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:10:20.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:20.488 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.488 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.492 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.492 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:10:20.492 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:10:20.492 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:10:20.492 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:10:20.493 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44821/db10.db/tbl10/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01/modts=__HIVE_DEFAULT_PARTITION__
[DEBUG] 2024-04-23 23:10:20.499 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.499 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:20.499 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:10:20.500 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:20.502 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.514 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.516 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910220459 end=1713910220516 duration=57 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:10:20.516 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:10:20.516 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:10:20.517 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 add_partition : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:10:20.517 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:10:20.517 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.517 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.517 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:20.517 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:10:20.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:20.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.523 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:10:20.523 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:10:20.523 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:10:20.523 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:10:20.523 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44821/db10.db/tbl10/state=CA/dt=1986-04-28/modts=2020-02-21 08%3A30%3A01
[DEBUG] 2024-04-23 23:10:20.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:20.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:10:20.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:20.532 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.532 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.534 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.535 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910220516 end=1713910220535 duration=19 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:10:20.535 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:10:20.535 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:10:20.536 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 add_partition : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:10:20.536 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:10:20.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:20.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:10:20.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:20.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.540 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:10:20.540 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:10:20.540 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:10:20.540 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:10:20.540 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44821/db10.db/tbl10/state=MN/dt=2018-11-31/modts=2020-02-21 08%3A19%3A01
[DEBUG] 2024-04-23 23:10:20.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:20.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:10:20.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:20.549 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.551 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.553 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910220535 end=1713910220553 duration=18 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:10:20.553 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:10:20.553 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:10:20.553 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713910220553 end=1713910220553 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:10:20.553 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:10:20.553 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:10:20.553 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_table : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:10:20.553 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:10:20.553 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.554 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:20.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:20.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.555 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.537951ms
[DEBUG] 2024-04-23 23:10:20.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:10:20.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.560 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[INFO ] 2024-04-23 23:10:20.561 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:10:20.561 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713910220553 end=1713910220561 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:10:20.562 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=9, comments=HMS client
[DEBUG] 2024-04-23 23:10:20.562 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:10:20.562 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:10:20.562 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 alter_table: hive.db10.tbl10 newtbl=tbl10
[INFO ] 2024-04-23 23:10:20.562 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db10.tbl10 newtbl=tbl10	
[DEBUG] 2024-04-23 23:10:20.562 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.563 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:20.563 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:20.563 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.563 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.563 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.947111ms
[DEBUG] 2024-04-23 23:10:20.563 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:10:20.563 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:10:20.563 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:10:20.563 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:10:20.563 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.564 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:20.564 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:20.564 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.564 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.564 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.747968ms
[DEBUG] 2024-04-23 23:10:20.564 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.564 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.564 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:10:20.565 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.569 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.572 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:20.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:20.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.260514ms
[DEBUG] 2024-04-23 23:10:20.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:20.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:10:20.574 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:20.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.577 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db10
[WARN ] 2024-04-23 23:10:20.577 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:10:20.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:20.578 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:20.578 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:20.578 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:10:20.579 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:20.580 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:10:20.580 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:20.580 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:10:20.584 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:20.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.589 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.591 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713910220562 end=1713910220591 duration=29 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:10:20.591 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:10:20.591 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:10:20.591 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_partitions : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:10:20.591 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:10:20.591 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:10:20.591 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.591 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.594 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.784365ms + 0.006005ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:10:20.597 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.411003ms + 0.062306ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:10:20.599 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.306979ms + 0.334623ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:10:20.600 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.285607ms + 0.151518ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:10:20.602 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.265354ms + 0.10158ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:10:20.603 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.280925ms + 0.102073ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:10:20.604 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.204462ms + 0.104315ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:10:20.606 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.191093ms + 0.102897ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:10:20.608 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.608465ms + 0.231259ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:10:20.609 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.548261ms + 0.113127ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:10:20.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:20.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 18.017846ms
[DEBUG] 2024-04-23 23:10:20.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.609 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.610 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910220591 end=1713910220610 duration=19 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[INFO ] 2024-04-23 23:10:20.611 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:10:20.611 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:44821]
[INFO ] 2024-04-23 23:10:20.611 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:44821)
[INFO ] 2024-04-23 23:10:20.611 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:44821) current connections: 11
[DEBUG] 2024-04-23 23:10:20.612 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:10:20.612 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910220612 end=1713910220612 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=49 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:10:20.612 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:10:20.612 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:10:20.612 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 49: source:127.0.0.1 get_table_metas : tbl=hive.*db10*.*
[INFO ] 2024-04-23 23:10:20.612 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*db10*.*	
[INFO ] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 49: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821;create=true
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821;create=true
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@19d7b7f6, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@19d7b7f6, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5d342cee created in the thread with id: 417
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.613 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.614 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.615 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.615 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.615 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@11ce069
[DEBUG] 2024-04-23 23:10:20.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:10:20.615 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@19d7b7f6 from thread id: 417
[DEBUG] 2024-04-23 23:10:20.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (database.name.matches(:param2) ) &&  (tableType == :param3 ) params: hive, (?i).*db10.*, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:10:20.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.620 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.620 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713910220612 end=1713910220620 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=49 retryCount=0 error=false>
[INFO ] 2024-04-23 23:10:20.620 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: *db10* tablePattern: * found: 0
[INFO ] 2024-04-23 23:10:20.620 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 10
[DEBUG] 2024-04-23 23:10:20.620 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:10:20.620 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:10:20.620 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:10:20.620 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:10:20.620 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 49: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:10:20.620 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_partitions : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:10:20.620 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:10:20.620 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db10.tbl10	
[INFO ] 2024-04-23 23:10:20.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@19d7b7f6, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5d342cee will be shutdown
[DEBUG] 2024-04-23 23:10:20.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:10:20.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.620 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 49: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:10:20.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[INFO ] 2024-04-23 23:10:20.620 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:10:20.620 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713910220620 end=1713910220620 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=49 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:10:20.620 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:10:20.620 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 49: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:10:20.620 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:10:20.621 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.838699ms + 0.00476ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:10:20.622 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.442738ms + 0.074685ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:10:20.622 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.151805ms + 0.273747ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:10:20.623 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.219009ms + 0.139514ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:10:20.623 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.149557ms + 0.092089ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:10:20.623 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.22008ms + 0.103486ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:10:20.624 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.147423ms + 0.093791ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:10:20.624 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.128343ms + 0.091709ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:10:20.624 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.167922ms + 0.314049ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:10:20.625 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.175117ms + 0.092716ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:10:20.625 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:20.625 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.625 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 4.722771ms
[DEBUG] 2024-04-23 23:10:20.625 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.625 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.625 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910220620 end=1713910220625 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:10:20.626 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:10:20.626 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:10:20.626 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:10:20.626 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:10:20.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:10:20.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.628 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.628 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.628 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713910220626 end=1713910220628 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:10:20.628 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:10:20.628 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:10:20.628 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:10:20.628 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:10:20.628 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.630 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.630 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.631 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713910220628 end=1713910220631 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:10:20.631 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:10:20.631 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:10:20.631 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_database: db10
[INFO ] 2024-04-23 23:10:20.631 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db10	
[DEBUG] 2024-04-23 23:10:20.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.631 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:20.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:20.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.632 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.834463ms
[DEBUG] 2024-04-23 23:10:20.632 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713910220631 end=1713910220632 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:10:20.632 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=1, comments=HMS client
[DEBUG] 2024-04-23 23:10:20.632 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:10:20.632 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:10:20.632 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_tables_by_type: db=@hive#db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:10:20.632 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:10:20.632 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:10:20.632 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:10:20.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.633 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:20.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:20.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.633 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.932059ms
[DEBUG] 2024-04-23 23:10:20.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.636 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:20.636 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.636 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.636 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.570343ms
[DEBUG] 2024-04-23 23:10:20.636 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713910220632 end=1713910220636 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:10:20.636 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:10:20.636 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:10:20.636 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:10:20.636 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:10:20.636 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:20.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.638 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.188296ms
[DEBUG] 2024-04-23 23:10:20.638 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713910220636 end=1713910220638 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:10:20.638 [main] HiveMetaStoreClient - Selecting dropDatabase method for db10 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:10:20.638 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:10:20.638 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:10:20.638 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:10:20.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.639 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:20.639 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:20.639 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.639 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.639 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.995978ms
[DEBUG] 2024-04-23 23:10:20.639 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_multi_table : db=db10 tbls=tbl10
[INFO ] 2024-04-23 23:10:20.640 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db10 tbls=tbl10	
[DEBUG] 2024-04-23 23:10:20.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.643 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:20.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:20.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.821257ms
[DEBUG] 2024-04-23 23:10:20.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.644 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.644 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713910220638 end=1713910220644 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:10:20.644 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:10:20.644 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:10:20.644 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:10:20.644 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:10:20.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:20.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.645 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:20.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:20.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.777513ms
[DEBUG] 2024-04-23 23:10:20.645 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:10:20.645 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:10:20.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.646 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:20.646 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.646 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.623256ms
[DEBUG] 2024-04-23 23:10:20.646 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:10:20.646 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:10:20.646 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.652 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.655 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:10:20.655 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:10:20.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.659 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.664 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:10:20.664 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:10:20.664 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.691 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.694 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.694 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:10:20.694 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:10:20.694 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:10:20.694 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:10:20.695 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:10:20.695 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:10:20.695 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.695 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:20.696 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:20.696 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.696 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.915467ms
[DEBUG] 2024-04-23 23:10:20.696 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.696 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:20.696 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.696 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.790263ms
[DEBUG] 2024-04-23 23:10:20.696 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.697 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:20.698 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:20.698 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:20.698 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:20.698 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.913781ms
[DEBUG] 2024-04-23 23:10:20.698 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:10:20.698 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:10:20.698 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:20.698 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:20.699 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:20.699 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:10:20.713 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.716 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:10:20.720 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:20.720 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:10:20.720 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.720 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:20.722 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:20.723 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:20.724 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:20.725 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:20.726 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:20.727 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:10:20.727 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:20.728 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:20.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:10:20.728 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:10:21.841 [HikariPool-9 housekeeper] HikariPool - HikariPool-9 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:10:22.730 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:10:22.731 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:10:22.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:22.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:22.734 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:22.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:22.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:22.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.470846ms
[DEBUG] 2024-04-23 23:10:22.734 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:10:22.734 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:10:22.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:22.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:22.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:22.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.534668ms
[DEBUG] 2024-04-23 23:10:22.735 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:10:22.735 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:10:22.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:22.736 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:22.736 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:10:22.736 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:10:22.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:22.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:22.737 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:10:22.737 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:10:22.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:22.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:22.738 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:10:22.738 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:10:22.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:22.738 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:22.739 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:22.739 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:22.739 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.765963ms
[DEBUG] 2024-04-23 23:10:22.739 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:22.739 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:22.739 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:22.739 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.413126ms
[DEBUG] 2024-04-23 23:10:22.739 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:22.740 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:22.740 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:22.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:22.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:22.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.946139ms
[DEBUG] 2024-04-23 23:10:22.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:10:22.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:10:22.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:22.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:22.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:22.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:10:22.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:10:22.743 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:22.743 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:10:22.743 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:22.743 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:22.743 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:22.743 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:22.743 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:22.743 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:22.743 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:22.743 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:10:22.743 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:22.743 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:22.744 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:22.744 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:10:22.745 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:10:23.336 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:10:24.745 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:10:24.745 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:10:24.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:24.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:24.748 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:24.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:24.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:24.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.26962ms
[DEBUG] 2024-04-23 23:10:24.749 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:10:24.749 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:10:24.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:24.750 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:24.750 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:24.750 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.613322ms
[DEBUG] 2024-04-23 23:10:24.750 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:10:24.750 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:10:24.750 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:24.751 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:24.751 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:10:24.751 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:10:24.751 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:24.751 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:24.752 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:10:24.752 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:10:24.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:24.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:24.753 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:10:24.753 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:10:24.753 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:24.753 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:24.753 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:24.753 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:24.753 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.772638ms
[DEBUG] 2024-04-23 23:10:24.753 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:24.754 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:24.754 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:24.754 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.432793ms
[DEBUG] 2024-04-23 23:10:24.754 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:24.754 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:24.755 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:24.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:24.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:24.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.644713ms
[DEBUG] 2024-04-23 23:10:24.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:10:24.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:10:24.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:24.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:24.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:24.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:10:24.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:10:24.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:24.757 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:10:24.757 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:24.757 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:24.757 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:24.757 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:24.757 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:24.757 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:24.757 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:24.757 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:10:24.757 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:24.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:24.758 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:24.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:10:24.758 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:10:26.759 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:10:26.759 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:10:26.759 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:10:26.759 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:26.761 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:26.762 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:26.762 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:26.762 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 2.928967ms
[DEBUG] 2024-04-23 23:10:26.762 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:10:26.762 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:10:26.762 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:26.762 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:26.762 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:26.762 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.437797ms
[DEBUG] 2024-04-23 23:10:26.762 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:10:26.762 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:10:26.762 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:26.763 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:26.764 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:10:26.764 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:10:26.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:26.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:26.764 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:10:26.764 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:10:26.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:26.765 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:26.765 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:10:26.765 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:10:26.765 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:26.766 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:26.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:26.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:26.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.663042ms
[DEBUG] 2024-04-23 23:10:26.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:26.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:26.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:26.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.397924ms
[DEBUG] 2024-04-23 23:10:26.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:26.778 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:26.778 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:26.778 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:10:26.784 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:10:26.784 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:26.784 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:26.787 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.983315ms + 0.006904ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  and "PARTITIONS"."PART_NAME" in (?,?,?)]
[DEBUG] 2024-04-23 23:10:26.792 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.314273ms + 0.007838ms, the query is [delete from "PART_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:10:26.794 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.915255ms + 0.007044ms, the query is [delete from "PART_COL_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:10:26.796 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.027509ms + 0.006676ms, the query is [delete from "PART_COL_STATS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:10:26.798 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.73868ms + 0.005563ms, the query is [delete from "PARTITION_PARAMS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:10:26.800 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.839971ms + 0.007612ms, the query is [delete from "PARTITION_KEY_VALS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:10:26.802 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.91077ms + 0.006281ms, the query is [delete from "PARTITIONS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:10:26.806 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.350543ms + 0.005126ms, the query is [delete from "SD_PARAMS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:10:26.807 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.397543ms + 0.022228ms, the query is [delete from "SORT_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:10:26.809 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.949579ms + 0.005993ms, the query is [delete from "BUCKETING_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:10:26.811 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.540489ms + 0.005674ms, the query is [delete from "SKEWED_COL_NAMES" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:10:26.813 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.25074ms + 0.006823ms, the query is [delete from "SDS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:10:26.815 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.750857ms + 0.005594ms, the query is [delete from "SERDE_PARAMS" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:10:26.817 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.734411ms + 0.006093ms, the query is [delete from "SERDES" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:10:26.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:26.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:26.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 34.663577ms
[DEBUG] 2024-04-23 23:10:26.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:26.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:10:26.820 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:10:26.820 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:26.820 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 drop_table : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:10:26.820 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_table : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:10:26.820 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:26.820 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:26.820 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:26.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:26.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:26.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.812928ms
[DEBUG] 2024-04-23 23:10:26.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:26.821 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:10:26.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:10:26.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:26.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.733497ms
[DEBUG] 2024-04-23 23:10:26.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:26.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:10:26.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:10:26.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:10:26.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:26.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:26.824 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:26.824 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:26.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:26.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:26.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:10:26.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:10:26.833 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:10:26.833 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:10:26.833 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:10:26.838 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:26.842 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:10:26.842 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:10:26.842 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:10:26.842 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:10:26.842 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:10:26.846 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1710015157 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:26.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:10:26.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:10:26.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:10:26.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:10:26.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:10:26.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:10:26.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:10:26.855 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:10:26.855 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:10:26.855 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:10:26.855 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:10:26.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:10:26.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:10:26.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:10:26.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 23:10:26.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:10:26.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 23:10:26.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:10:26.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:10:26.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:10:26.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:10:26.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:10:26.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:10:26.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:26.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:10:26.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:10:26.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:10:26.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:10:26.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:10:26.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:10:26.907 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:10:26.908 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:10:26.908 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:10:26.908 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:26.908 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:26.908 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:26.908 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:26.908 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:26.908 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:26.908 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:10:26.908 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:10:26.908 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1983694118 (XID = 1719), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_43411), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:26.908 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:10:26.909 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1567263028 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44821), (DRDAID = null) 
[DEBUG] 2024-04-23 23:10:26.910 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:10:26.910 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db10
[DEBUG] 2024-04-23 23:10:26.910 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44821/db10.db
[INFO ] 2024-04-23 23:10:26.910 [TThreadPoolServer WorkerProcess-%d] deprecation - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
[DEBUG] 2024-04-23 23:10:26.911 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:10:26.911 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db10
[DEBUG] 2024-04-23 23:10:26.912 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db
[DEBUG] 2024-04-23 23:10:26.912 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713910220644 end=1713910226912 duration=6268 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=3 error=false>
[DEBUG] 2024-04-23 23:10:26.912 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[INFO ] 2024-04-23 23:10:26.912 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 9
[DEBUG] 2024-04-23 23:10:26.912 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:10:26.912 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:10:26.912 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:10:26.912 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4904418e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@42c89f27 will be shutdown
[DEBUG] 2024-04-23 23:10:26.912 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:10:26.912 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:10:26.912 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713910226912 end=1713910226912 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:10:26.912 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:10:26.912 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:10:26.912 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:10:26.976 [Thread-15] ShutdownHookManager - ShutdownHookManger complete shutdown.
