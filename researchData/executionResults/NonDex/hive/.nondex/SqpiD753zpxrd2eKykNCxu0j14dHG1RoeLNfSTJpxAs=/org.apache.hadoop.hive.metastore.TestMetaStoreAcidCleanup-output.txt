[DEBUG] 2024-04-23 23:05:52.790 [main] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:05:52.790 [main] HMSHandler - 0: create_table_req: Table(tableName:tableDropDatabase, dbName:db, owner:alex, createTime:1713909952, lastAccessTime:1713909952, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:foo, type:string, comment:), FieldSchema(name:bar, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=true, transactional_properties=insert_only}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:05:52.790 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:tableDropDatabase, dbName:db, owner:alex, createTime:1713909952, lastAccessTime:1713909952, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:foo, type:string, comment:), FieldSchema(name:bar, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=true, transactional_properties=insert_only}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:05:52.791 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:52.791 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:52.791 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:52.794 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:52.795 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:52.800 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:52.800 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:52.800 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:52.801 [main] ObjectStore - db details for db db retrieved using ORM in 9.940138ms
[DEBUG] 2024-04-23 23:05:52.801 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:52.801 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:52.801 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 23:05:53.201 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.216 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:53.216 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:53.217 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:05:53.217 [main] MetastoreDefaultTransformer - Starting translation for CreateTable for processor HMSClient-@Lenovo-Bot with [HIVEMANAGEDINSERTWRITE, HIVEMANAGESTATS, HIVECACHEINVALIDATE, CONNECTORWRITE] on table tableDropDatabase
[DEBUG] 2024-04-23 23:05:53.217 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:53.217 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:53.217 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:53.225 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:53.225 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:53.225 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:53.225 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:53.225 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.226 [main] ObjectStore - db details for db db retrieved using ORM in 8.269922ms
[DEBUG] 2024-04-23 23:05:53.226 [main] MetastoreDefaultTransformer - Table is a MANAGED_TABLE
[DEBUG] 2024-04-23 23:05:53.226 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:53.226 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:53.226 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:53.228 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:53.228 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:53.228 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:53.228 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:53.229 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.229 [main] ObjectStore - db details for db db retrieved using ORM in 3.167396ms
[DEBUG] 2024-04-23 23:05:53.229 [main] MetastoreDefaultTransformer - Processor has required capabilities to be able to create INSERT-only tables
[WARN ] 2024-04-23 23:05:53.231 [main] TransactionalValidationListener - Could not verify InputFormat=org.apache.hadoop.hive.ql.io.HiveInputFormat or OutputFormat=org.apache.hadoop.hive.ql.io.HiveOutputFormat  for db.tableDropDatabase
[DEBUG] 2024-04-23 23:05:53.232 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:53.232 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:53.232 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:53.232 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:53.234 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:53.235 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:53.235 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:53.235 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:53.235 [main] ObjectStore - db details for db db retrieved using ORM in 2.746168ms
[DEBUG] 2024-04-23 23:05:53.235 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:53.235 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:53.235 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 23:05:53.236 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:53.237 [main] ObjectStore - Commit transaction: count = 1, isactive true
[WARN ] 2024-04-23 23:05:53.237 [main] HMSHandler - Location: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db.db/tabledropdatabase specified for non-external table:tableDropDatabase
[INFO ] 2024-04-23 23:05:53.237 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db.db/tabledropdatabase
[DEBUG] 2024-04-23 23:05:53.243 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:53.243 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:53.245 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:53.255 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1038480108 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.267 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1038480108 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.277 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1038480108 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.284 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1038480108 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.309 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:53.309 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:53.314 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.316 [main] PerfLogger - </PERFLOG method=create_table_req start=1713909952790 end=1713909953316 duration=526 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:05:53.328 [main] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:05:53.329 [main] HMSHandler - 0: get_database: db
[INFO ] 2024-04-23 23:05:53.329 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_database: db	
[DEBUG] 2024-04-23 23:05:53.329 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:53.329 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:53.329 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:53.331 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:53.331 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:53.332 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:53.332 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:53.332 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.332 [main] ObjectStore - db details for db db retrieved using ORM in 3.3313ms
[INFO ] 2024-04-23 23:05:53.332 [main] MetastoreDefaultTransformer - Starting translation for transformDatabase for processor HMSClient-@Lenovo-Bot with [HIVEMANAGEDINSERTWRITE, HIVEMANAGESTATS, HIVECACHEINVALIDATE, CONNECTORWRITE] on database db locationUri=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db.db managedLocationUri=null
[DEBUG] 2024-04-23 23:05:53.333 [main] MetastoreDefaultTransformer - Comparing DB and warehouse paths warehouse=/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse db.getLocationUri=/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db.db
[INFO ] 2024-04-23 23:05:53.333 [main] MetastoreDefaultTransformer - Transformer returning database:Database(name:db, description:null, locationUri:file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db.db, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:1713909952, type:NATIVE)
[DEBUG] 2024-04-23 23:05:53.333 [main] PerfLogger - </PERFLOG method=get_database_req start=1713909953328 end=1713909953333 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:05:53.334 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=6, comments=HMS client
[DEBUG] 2024-04-23 23:05:53.334 [main] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:05:53.334 [main] HMSHandler - 0: get_tables_by_type: db=@hive#db pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:05:53.334 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#db pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:05:53.334 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:05:53.334 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:05:53.334 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:53.334 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:53.335 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:53.336 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:53.337 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:53.337 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:53.337 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:53.337 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.337 [main] ObjectStore - db details for db db retrieved using ORM in 2.784242ms
[DEBUG] 2024-04-23 23:05:53.338 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:53.338 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:53.355 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:53.356 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:53.356 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:53.356 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.356 [main] ObjectStore - 0 entries retrieved using ORM in 18.280143ms
[DEBUG] 2024-04-23 23:05:53.356 [main] PerfLogger - </PERFLOG method=get_tables_by_type start=1713909953334 end=1713909953356 duration=22 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:05:53.356 [main] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:05:53.356 [main] HMSHandler - 0: get_all_tables: db=@hive#db
[INFO ] 2024-04-23 23:05:53.356 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db	
[DEBUG] 2024-04-23 23:05:53.357 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:53.357 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:53.365 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:53.365 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:53.365 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:53.365 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.365 [main] ObjectStore - 0 entries retrieved using ORM in 8.764977ms
[DEBUG] 2024-04-23 23:05:53.365 [main] PerfLogger - </PERFLOG method=get_all_tables start=1713909953356 end=1713909953365 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:05:53.365 [main] HiveMetaStoreClient - Selecting dropDatabase method for db (0 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:05:53.365 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:05:53.365 [main] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:05:53.366 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:53.366 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:53.366 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:53.367 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:53.368 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:53.368 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:53.368 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:53.368 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.368 [main] ObjectStore - db details for db db retrieved using ORM in 2.715159ms
[DEBUG] 2024-04-23 23:05:53.369 [main] HMSHandler - 0: get_multi_table : db=db tbls=
[INFO ] 2024-04-23 23:05:53.369 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=db tbls=	
[DEBUG] 2024-04-23 23:05:53.369 [main] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713909953365 end=1713909953369 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:05:53.370 [main] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:05:53.370 [main] HMSHandler - 0: drop_database: @hive#db
[INFO ] 2024-04-23 23:05:53.370 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db	
[DEBUG] 2024-04-23 23:05:53.370 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:53.370 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:53.370 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:53.370 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:53.372 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:53.372 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:53.372 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:53.372 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:53.372 [main] ObjectStore - db details for db db retrieved using ORM in 2.400839ms
[DEBUG] 2024-04-23 23:05:53.372 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 23:05:53.372 [main] HMSHandler - 0: get_all_tables: db=@hive#db
[INFO ] 2024-04-23 23:05:53.372 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db	
[DEBUG] 2024-04-23 23:05:53.373 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:53.373 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:53.375 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:53.376 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:53.376 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:53.376 [main] ObjectStore - 1 entries retrieved using ORM in 3.202964ms
[DEBUG] 2024-04-23 23:05:53.376 [main] HMSHandler - 0: get_functions: db=@hive#db pat=*
[INFO ] 2024-04-23 23:05:53.376 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db pat=*	
[DEBUG] 2024-04-23 23:05:53.376 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:53.417 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1038480108 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.425 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:53.425 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:05:53.425 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:05:53.425 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:53.450 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1038480108 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.457 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:53.457 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:05:53.457 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:05:53.457 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:53.480 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1038480108 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.488 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:53.488 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:05:53.488 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:05:53.488 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:53.488 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:53.488 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:53.493 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:53.493 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:53.493 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:53.493 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:53.493 [main] ObjectStore - db details for db db retrieved using ORM in 4.840936ms
[DEBUG] 2024-04-23 23:05:53.493 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:53.493 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:53.503 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:53.504 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:53.504 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:53.504 [main] ObjectStore - 0 entries retrieved using ORM in 10.467772ms
[DEBUG] 2024-04-23 23:05:53.504 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:53.614 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:53.615 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:53.615 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:05:53.694 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1038480108 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.706 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:05:53.706 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:53.706 [main] HMSHandler - 0: drop_table : tbl=hive.db.tabledropdatabase
[INFO ] 2024-04-23 23:05:53.706 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.db.tabledropdatabase	
[DEBUG] 2024-04-23 23:05:53.706 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:53.706 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:53.706 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:53.706 [main] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 23:05:53.708 [main] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 23:05:53.709 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:53.709 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:53.709 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:53.709 [main] ObjectStore - db details for db db retrieved using ORM in 2.465109ms
[DEBUG] 2024-04-23 23:05:53.709 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:53.709 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:53.709 [main] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 23:05:53.711 [main] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 23:05:53.711 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:53.711 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:53.711 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:53.711 [main] ObjectStore - db details for db db retrieved using ORM in 2.35316ms
[DEBUG] 2024-04-23 23:05:53.711 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:53.711 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:53.712 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 23:05:53.720 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:53.720 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:53.720 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:53.768 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1038480108 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.771 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:53.771 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:53.811 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1038480108 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.830 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:53.830 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:53.830 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:53.830 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 23:05:53.836 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:53.836 [main] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:05:53.836 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:53.862 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1038480108 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.875 [main] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:05:53.875 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:53.875 [main] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:05:53.875 [main] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:05:53.875 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:53.910 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1038480108 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.920 [main] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:05:53.920 [main] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:05:53.920 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:53.920 [main] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:05:53.920 [main] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:05:53.920 [main] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:05:53.920 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:53.941 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1038480108 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.953 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:53.953 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:05:53.953 [main] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:05:53.953 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:53.977 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1038480108 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:53.989 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:53.989 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:05:53.989 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:53.989 [main] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 23:05:53.990 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 23:05:53.995 [main] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 23:05:54.019 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1038480108 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.027 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:54.039 [main] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:05:54.039 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:54.039 [main] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:05:54.077 [main] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:05:54.077 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:54.140 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.140 [main] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:05:54.141 [main] HikariConfig - HikariPool-2 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:05:54.141 [main] HikariConfig - HikariPool-2 - configuration:
[DEBUG] 2024-04-23 23:05:54.142 [main] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:05:54.142 [main] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:05:54.142 [main] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:05:54.142 [main] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:05:54.142 [main] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:05:54.142 [main] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:05:54.142 [main] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:05:54.142 [main] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:05:54.142 [main] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:05:54.143 [main] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:05:54.143 [main] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:05:54.143 [main] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:05:54.143 [main] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:05:54.143 [main] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:05:54.143 [main] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:05:54.143 [main] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:05:54.143 [main] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:05:54.143 [main] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:05:54.143 [main] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true"
[DEBUG] 2024-04-23 23:05:54.143 [main] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:05:54.143 [main] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:05:54.143 [main] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:05:54.143 [main] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:05:54.143 [main] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:05:54.144 [main] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:05:54.144 [main] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:05:54.144 [main] HikariConfig - poolName........................"HikariPool-2"
[DEBUG] 2024-04-23 23:05:54.144 [main] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:05:54.144 [main] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:05:54.144 [main] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:05:54.144 [main] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:05:54.144 [main] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:05:54.144 [main] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:05:54.144 [main] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:05:54.144 [main] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:05:54.144 [main] HikariDataSource - HikariPool-2 - Starting...
[INFO ] 2024-04-23 23:05:54.156 [main] PoolBase - HikariPool-2 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:05:54.156 [main] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1241976048 (XID = 922), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:05:54.156 [main] HikariDataSource - HikariPool-2 - Start completed.
[DEBUG] 2024-04-23 23:05:54.157 [main] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:05:54.157 [main] HikariConfig - HikariPool-3 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:05:54.157 [main] HikariConfig - HikariPool-3 - configuration:
[DEBUG] 2024-04-23 23:05:54.158 [main] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:05:54.158 [main] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:05:54.158 [main] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:05:54.158 [main] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:05:54.158 [main] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:05:54.158 [main] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:05:54.158 [main] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:05:54.158 [main] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:05:54.158 [main] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:05:54.159 [main] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:05:54.159 [main] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:05:54.159 [main] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:05:54.159 [main] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:05:54.159 [main] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:05:54.159 [main] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:05:54.159 [main] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:05:54.159 [main] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:05:54.159 [main] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:05:54.159 [main] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true"
[DEBUG] 2024-04-23 23:05:54.159 [main] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:05:54.159 [main] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:05:54.159 [main] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:05:54.159 [main] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:05:54.159 [main] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:05:54.159 [main] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:05:54.160 [main] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:05:54.160 [main] HikariConfig - poolName........................"HikariPool-3"
[DEBUG] 2024-04-23 23:05:54.160 [main] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:05:54.160 [main] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:05:54.160 [main] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:05:54.160 [main] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:05:54.160 [main] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:05:54.160 [main] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:05:54.160 [main] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:05:54.160 [main] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:05:54.160 [main] HikariDataSource - HikariPool-3 - Starting...
[INFO ] 2024-04-23 23:05:54.162 [main] PoolBase - HikariPool-3 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:05:54.162 [main] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@527969285 (XID = 924), (SESSIONID = 23), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:05:54.162 [main] HikariDataSource - HikariPool-3 - Start completed.
[DEBUG] 2024-04-23 23:05:54.162 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1241976048 (XID = 922), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.163 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.setConf(ThrowingTxnHandler.java:31) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropTable(AcidEventListener.java:64) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$22.notify(MetaStoreListenerNotifier.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:401) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_core(HMSHandler.java:3020) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3256) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1773) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 70 more
[DEBUG] 2024-04-23 23:05:54.164 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1241976048 (XID = 922), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:05:54.164 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1241976048 (XID = 922), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.164 [main] ObjectStore - Rollback transaction, isActive: true
[DEBUG] 2024-04-23 23:05:54.171 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.172 [main] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:05:54.173 [main] RetryingHMSHandler - MetaException(message:java.lang.RuntimeException: during transactional cleanup)
	at org.apache.hadoop.hive.metastore.ExceptionHandler.newMetaException(ExceptionHandler.java:152)
	at org.apache.hadoop.hive.metastore.ExceptionHandler.defaultMetaException(ExceptionHandler.java:168)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3260)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1773)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: java.lang.RuntimeException: during transactional cleanup
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.cleanupRecords(ThrowingTxnHandler.java:39)
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropTable(AcidEventListener.java:65)
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$22.notify(MetaStoreListenerNotifier.java:124)
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339)
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:401)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_core(HMSHandler.java:3020)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3256)
	... 55 more

[DEBUG] 2024-04-23 23:05:54.174 [main] PerfLogger - </PERFLOG method=drop_database start=1713909953370 end=1713909954174 duration=804 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 23:05:54.174 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:05:54.175 [main] HMSHandler - 0: get_table : tbl=hive.db.tableDropDatabase
[INFO ] 2024-04-23 23:05:54.175 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.db.tableDropDatabase	
[DEBUG] 2024-04-23 23:05:54.175 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:54.175 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.175 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.178 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.178 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.178 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:54.178 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:54.179 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.179 [main] ObjectStore - db details for db db retrieved using ORM in 3.659554ms
[DEBUG] 2024-04-23 23:05:54.179 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:54.179 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.179 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 23:05:54.191 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.202 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:54.205 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:05:54.208 [main] MetastoreDefaultTransformer - Starting translation for processor HMSClient-@Lenovo-Bot on list 1
[INFO ] 2024-04-23 23:05:54.208 [main] MetastoreDefaultTransformer - Table tabledropdatabase,#bucket=0,isBucketed:false,tableType=MANAGED_TABLE,tableCapabilities=null
[DEBUG] 2024-04-23 23:05:54.208 [main] MetastoreDefaultTransformer - Table has no specific required capabilities
[DEBUG] 2024-04-23 23:05:54.208 [main] MetastoreDefaultTransformer - Managed acid table with INSERTWRITE or CONNECTORWRITE capability:RW
[INFO ] 2024-04-23 23:05:54.208 [main] MetastoreDefaultTransformer - Processor has one of the write capabilities on insert-only, granting RW
[INFO ] 2024-04-23 23:05:54.210 [main] MetastoreDefaultTransformer - Transformer return list of 1
[DEBUG] 2024-04-23 23:05:54.210 [main] PerfLogger - </PERFLOG method=get_table_req start=1713909954174 end=1713909954210 duration=36 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:05:54.210 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=36, comments=HMS client
[DEBUG] 2024-04-23 23:05:54.212 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:05:54.212 [main] HMSHandler - 0: get_table : tbl=hive.db.tableDropDatabase
[INFO ] 2024-04-23 23:05:54.212 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.db.tableDropDatabase	
[DEBUG] 2024-04-23 23:05:54.212 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:54.212 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.212 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.215 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.216 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.216 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:54.216 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:54.216 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.217 [main] ObjectStore - db details for db db retrieved using ORM in 4.442987ms
[DEBUG] 2024-04-23 23:05:54.217 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:54.217 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.217 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 23:05:54.222 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.227 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:54.229 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:05:54.231 [main] MetastoreDefaultTransformer - Starting translation for processor HMSClient-@Lenovo-Bot on list 1
[INFO ] 2024-04-23 23:05:54.231 [main] MetastoreDefaultTransformer - Table tabledropdatabase,#bucket=0,isBucketed:false,tableType=MANAGED_TABLE,tableCapabilities=null
[DEBUG] 2024-04-23 23:05:54.231 [main] MetastoreDefaultTransformer - Table has no specific required capabilities
[DEBUG] 2024-04-23 23:05:54.231 [main] MetastoreDefaultTransformer - Managed acid table with INSERTWRITE or CONNECTORWRITE capability:RW
[INFO ] 2024-04-23 23:05:54.231 [main] MetastoreDefaultTransformer - Processor has one of the write capabilities on insert-only, granting RW
[INFO ] 2024-04-23 23:05:54.231 [main] MetastoreDefaultTransformer - Transformer return list of 1
[DEBUG] 2024-04-23 23:05:54.231 [main] PerfLogger - </PERFLOG method=get_table_req start=1713909954212 end=1713909954231 duration=19 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:05:54.231 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=19, comments=HMS client
[DEBUG] 2024-04-23 23:05:54.232 [main] PerfLogger - <PERFLOG method=drop_table_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:05:54.232 [main] HMSHandler - 0: drop_table : tbl=hive.db.tableDropDatabase
[INFO ] 2024-04-23 23:05:54.232 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.db.tableDropDatabase	
[DEBUG] 2024-04-23 23:05:54.232 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:54.232 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.232 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.232 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:54.234 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:54.234 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.234 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:54.234 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.234 [main] ObjectStore - db details for db db retrieved using ORM in 2.324247ms
[DEBUG] 2024-04-23 23:05:54.234 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.234 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.234 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:54.236 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:54.236 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.236 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:54.236 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.236 [main] ObjectStore - db details for db db retrieved using ORM in 1.645345ms
[DEBUG] 2024-04-23 23:05:54.236 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.236 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.236 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 23:05:54.239 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.245 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.245 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.245 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.246 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.246 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:05:54.252 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:05:54.252 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.252 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.255 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.255 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.255 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.256 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 23:05:54.256 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:05:54.258 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.258 [main] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:05:54.258 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@805451042 (XID = 935), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.258 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.259 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1899970329 (XID = 937), (SESSIONID = 27), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.261 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1074007566 (XID = 940), (SESSIONID = 29), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.262 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@286310486 (XID = 942), (SESSIONID = 31), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.262 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:05:54.263 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1686039549 (XID = 944), (SESSIONID = 33), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.265 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2093157908 (XID = 946), (SESSIONID = 35), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.266 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@358497767 (XID = 948), (SESSIONID = 37), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.267 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1040057391 (XID = 950), (SESSIONID = 39), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.267 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1440585246 (XID = 952), (SESSIONID = 41), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.268 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@201930971 (XID = 956), (SESSIONID = 44), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.269 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1777832310 (XID = 955), (SESSIONID = 45), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.270 [main] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:05:54.270 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.270 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1796654849 (XID = 959), (SESSIONID = 48), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.270 [main] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:05:54.270 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:05:54.270 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1574042464 (XID = 960), (SESSIONID = 49), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.270 [main] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:05:54.271 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.271 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@31400553 (XID = 962), (SESSIONID = 51), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.273 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1503642136 (XID = 964), (SESSIONID = 53), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.274 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1295828884 (XID = 967), (SESSIONID = 55), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.275 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1484191315 (XID = 969), (SESSIONID = 57), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.277 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@85621129 (XID = 971), (SESSIONID = 59), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.277 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:05:54.281 [main] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:05:54.281 [main] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:05:54.281 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.281 [main] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:05:54.281 [main] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:05:54.282 [main] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:05:54.282 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.294 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.294 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:05:54.295 [main] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:05:54.295 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.306 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.306 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:05:54.307 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.307 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:54.307 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 23:05:54.308 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:54.310 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.313 [main] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:05:54.313 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.313 [main] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:05:54.317 [main] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:05:54.317 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.326 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.327 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.setConf(ThrowingTxnHandler.java:31) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropTable(AcidEventListener.java:64) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$22.notify(MetaStoreListenerNotifier.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:401) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_core(HMSHandler.java:3020) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3256) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3244) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy36.drop_table_with_environment_context(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.drop_table_with_environment_context(HiveMetaStoreClient.java:4413) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1830) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1777) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.afterTest(TestMetaStoreAcidCleanup.java:81) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 69 more
[DEBUG] 2024-04-23 23:05:54.329 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1241976048 (XID = 922), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:05:54.329 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1241976048 (XID = 922), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.329 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db' AND "TC_TABLE"='tabledropdatabase'>
[DEBUG] 2024-04-23 23:05:54.330 [main] TxnHandler - Going to rollback: 
java.sql.SQLSyntaxErrorException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeUpdate(ProxyStatement.java:117) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeUpdate(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.cleanupRecords(TxnHandler.java:4190) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.cleanupRecords(ThrowingTxnHandler.java:41) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropTable(AcidEventListener.java:65) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$22.notify(MetaStoreListenerNotifier.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:401) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_core(HMSHandler.java:3020) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3256) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3244) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy36.drop_table_with_environment_context(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.drop_table_with_environment_context(HiveMetaStoreClient.java:4413) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1830) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1777) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.afterTest(TestMetaStoreAcidCleanup.java:81) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DeleteNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 67 more
[INFO ] 2024-04-23 23:05:54.332 [main] TxnHandler - Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
[WARN ] 2024-04-23 23:05:54.332 [main] TxnHandler - Cannot perform cleanup since metastore table does not exist
[DEBUG] 2024-04-23 23:05:54.332 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1241976048 (XID = 922), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.332 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:54.334 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.335 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 23:05:54.335 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 23:05:54.336 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db.db/tabledropdatabase
[INFO ] 2024-04-23 23:05:54.339 [main] deprecation - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
[DEBUG] 2024-04-23 23:05:54.341 [main] PerfLogger - </PERFLOG method=drop_table_with_environment_context start=1713909954232 end=1713909954341 duration=109 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:05:54.343 [main] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:05:54.344 [main] HMSHandler - 0: create_table_req: Table(tableName:tableDropTable, dbName:db, owner:alex, createTime:1713909954, lastAccessTime:1713909954, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:foo, type:string, comment:), FieldSchema(name:bar, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=true, transactional_properties=insert_only}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:05:54.344 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:tableDropTable, dbName:db, owner:alex, createTime:1713909954, lastAccessTime:1713909954, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:foo, type:string, comment:), FieldSchema(name:bar, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=true, transactional_properties=insert_only}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:05:54.344 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:54.344 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.344 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.347 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.347 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.348 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:54.348 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:54.348 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.348 [main] ObjectStore - db details for db db retrieved using ORM in 4.039133ms
[DEBUG] 2024-04-23 23:05:54.348 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:54.348 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.349 [main] ObjectStore - Executing getMTable for hive.db.tabledroptable
[DEBUG] 2024-04-23 23:05:54.350 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.351 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:54.351 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:05:54.351 [main] MetastoreDefaultTransformer - Starting translation for CreateTable for processor HMSClient-@Lenovo-Bot with [HIVEMANAGEDINSERTWRITE, HIVEMANAGESTATS, HIVECACHEINVALIDATE, CONNECTORWRITE] on table tableDropTable
[DEBUG] 2024-04-23 23:05:54.351 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:54.351 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.351 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.354 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.355 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.355 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:54.355 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:54.355 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.355 [main] ObjectStore - db details for db db retrieved using ORM in 3.857192ms
[DEBUG] 2024-04-23 23:05:54.355 [main] MetastoreDefaultTransformer - Table is a MANAGED_TABLE
[DEBUG] 2024-04-23 23:05:54.355 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:54.355 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.355 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.358 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.358 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.358 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:54.358 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:54.358 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.358 [main] ObjectStore - db details for db db retrieved using ORM in 3.115427ms
[DEBUG] 2024-04-23 23:05:54.359 [main] MetastoreDefaultTransformer - Processor has required capabilities to be able to create INSERT-only tables
[WARN ] 2024-04-23 23:05:54.359 [main] TransactionalValidationListener - Could not verify InputFormat=org.apache.hadoop.hive.ql.io.HiveInputFormat or OutputFormat=org.apache.hadoop.hive.ql.io.HiveOutputFormat  for db.tableDropTable
[DEBUG] 2024-04-23 23:05:54.359 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:54.359 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.360 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.360 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:54.362 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:54.362 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.362 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:54.362 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.362 [main] ObjectStore - db details for db db retrieved using ORM in 2.409054ms
[DEBUG] 2024-04-23 23:05:54.362 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.362 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.362 [main] ObjectStore - Executing getMTable for hive.db.tabledroptable
[DEBUG] 2024-04-23 23:05:54.363 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.363 [main] ObjectStore - Commit transaction: count = 1, isactive true
[WARN ] 2024-04-23 23:05:54.363 [main] HMSHandler - Location: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db.db/tabledroptable specified for non-external table:tableDropTable
[INFO ] 2024-04-23 23:05:54.364 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db.db/tabledroptable
[DEBUG] 2024-04-23 23:05:54.366 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.366 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.368 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.383 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.383 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:54.385 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.387 [main] PerfLogger - </PERFLOG method=create_table_req start=1713909954343 end=1713909954387 duration=44 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:05:54.387 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:05:54.387 [main] HMSHandler - 0: get_table : tbl=hive.db.tableDropTable
[INFO ] 2024-04-23 23:05:54.387 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.db.tableDropTable	
[DEBUG] 2024-04-23 23:05:54.387 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:54.387 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.387 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.389 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.389 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.389 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:54.389 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:54.390 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.390 [main] ObjectStore - db details for db db retrieved using ORM in 2.656868ms
[DEBUG] 2024-04-23 23:05:54.390 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:54.390 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.390 [main] ObjectStore - Executing getMTable for hive.db.tabledroptable
[DEBUG] 2024-04-23 23:05:54.394 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.399 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:54.401 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:05:54.402 [main] MetastoreDefaultTransformer - Starting translation for processor HMSClient-@Lenovo-Bot on list 1
[INFO ] 2024-04-23 23:05:54.402 [main] MetastoreDefaultTransformer - Table tabledroptable,#bucket=0,isBucketed:false,tableType=MANAGED_TABLE,tableCapabilities=null
[DEBUG] 2024-04-23 23:05:54.402 [main] MetastoreDefaultTransformer - Table has no specific required capabilities
[DEBUG] 2024-04-23 23:05:54.403 [main] MetastoreDefaultTransformer - Managed acid table with INSERTWRITE or CONNECTORWRITE capability:RW
[INFO ] 2024-04-23 23:05:54.403 [main] MetastoreDefaultTransformer - Processor has one of the write capabilities on insert-only, granting RW
[INFO ] 2024-04-23 23:05:54.403 [main] MetastoreDefaultTransformer - Transformer return list of 1
[DEBUG] 2024-04-23 23:05:54.403 [main] PerfLogger - </PERFLOG method=get_table_req start=1713909954387 end=1713909954403 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:05:54.403 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=16, comments=HMS client
[DEBUG] 2024-04-23 23:05:54.403 [main] PerfLogger - <PERFLOG method=drop_table_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:05:54.403 [main] HMSHandler - 0: drop_table : tbl=hive.db.tableDropTable
[INFO ] 2024-04-23 23:05:54.403 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.db.tableDropTable	
[DEBUG] 2024-04-23 23:05:54.403 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:54.403 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.403 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.403 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:54.405 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:54.405 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.405 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:54.405 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.406 [main] ObjectStore - db details for db db retrieved using ORM in 2.353586ms
[DEBUG] 2024-04-23 23:05:54.406 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.406 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.406 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:54.407 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:54.407 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.407 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:54.407 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.407 [main] ObjectStore - db details for db db retrieved using ORM in 1.655037ms
[DEBUG] 2024-04-23 23:05:54.407 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.407 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.407 [main] ObjectStore - Executing getMTable for hive.db.tabledroptable
[DEBUG] 2024-04-23 23:05:54.410 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.416 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.416 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.416 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.417 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.417 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:05:54.418 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:05:54.418 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.418 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.421 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.421 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.421 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.421 [main] ObjectStore - Executing getMTable for hive.db.tabledroptable
[DEBUG] 2024-04-23 23:05:54.423 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.423 [main] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:05:54.423 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.424 [main] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:05:54.424 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.424 [main] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:05:54.424 [main] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:05:54.425 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.426 [main] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:05:54.426 [main] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:05:54.426 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.426 [main] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:05:54.426 [main] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:05:54.426 [main] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:05:54.426 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.427 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.427 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:05:54.427 [main] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:05:54.427 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.429 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.429 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:05:54.429 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.429 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:54.429 [main] ObjectStore - Executing getMTable for hive.db.tabledroptable
[DEBUG] 2024-04-23 23:05:54.430 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:54.432 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.435 [main] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:05:54.435 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.435 [main] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:05:54.437 [main] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:05:54.437 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.443 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.444 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.setConf(ThrowingTxnHandler.java:31) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropTable(AcidEventListener.java:64) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$22.notify(MetaStoreListenerNotifier.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:401) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_core(HMSHandler.java:3020) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3256) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3244) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy36.drop_table_with_environment_context(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.drop_table_with_environment_context(HiveMetaStoreClient.java:4413) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1830) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1777) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropTableShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:93) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 69 more
[DEBUG] 2024-04-23 23:05:54.445 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1241976048 (XID = 922), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:05:54.445 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1241976048 (XID = 922), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.445 [main] ObjectStore - Rollback transaction, isActive: true
[DEBUG] 2024-04-23 23:05:54.447 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 23:05:54.448 [main] RetryingHMSHandler - MetaException(message:java.lang.RuntimeException: during transactional cleanup)
	at org.apache.hadoop.hive.metastore.ExceptionHandler.newMetaException(ExceptionHandler.java:152)
	at org.apache.hadoop.hive.metastore.ExceptionHandler.defaultMetaException(ExceptionHandler.java:168)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3260)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3244)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_table_with_environment_context(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.drop_table_with_environment_context(HiveMetaStoreClient.java:4413)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1830)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1777)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropTableShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:93)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: java.lang.RuntimeException: during transactional cleanup
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.cleanupRecords(ThrowingTxnHandler.java:39)
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropTable(AcidEventListener.java:65)
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$22.notify(MetaStoreListenerNotifier.java:124)
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339)
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:401)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_core(HMSHandler.java:3020)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3256)
	... 54 more

[DEBUG] 2024-04-23 23:05:54.448 [main] PerfLogger - </PERFLOG method=drop_table_with_environment_context start=1713909954403 end=1713909954448 duration=45 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 23:05:54.448 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:05:54.448 [main] HMSHandler - 0: get_table : tbl=hive.db.tableDropTable
[INFO ] 2024-04-23 23:05:54.448 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.db.tableDropTable	
[DEBUG] 2024-04-23 23:05:54.448 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:54.448 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.448 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.451 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.451 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.451 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:54.451 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:54.451 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.451 [main] ObjectStore - db details for db db retrieved using ORM in 3.092039ms
[DEBUG] 2024-04-23 23:05:54.451 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:54.451 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.452 [main] ObjectStore - Executing getMTable for hive.db.tabledroptable
[DEBUG] 2024-04-23 23:05:54.455 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.460 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:54.462 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:05:54.463 [main] MetastoreDefaultTransformer - Starting translation for processor HMSClient-@Lenovo-Bot on list 1
[INFO ] 2024-04-23 23:05:54.463 [main] MetastoreDefaultTransformer - Table tabledroptable,#bucket=0,isBucketed:false,tableType=MANAGED_TABLE,tableCapabilities=null
[DEBUG] 2024-04-23 23:05:54.463 [main] MetastoreDefaultTransformer - Table has no specific required capabilities
[DEBUG] 2024-04-23 23:05:54.463 [main] MetastoreDefaultTransformer - Managed acid table with INSERTWRITE or CONNECTORWRITE capability:RW
[INFO ] 2024-04-23 23:05:54.463 [main] MetastoreDefaultTransformer - Processor has one of the write capabilities on insert-only, granting RW
[INFO ] 2024-04-23 23:05:54.463 [main] MetastoreDefaultTransformer - Transformer return list of 1
[DEBUG] 2024-04-23 23:05:54.464 [main] PerfLogger - </PERFLOG method=get_table_req start=1713909954448 end=1713909954464 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:05:54.464 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=16, comments=HMS client
[DEBUG] 2024-04-23 23:05:54.464 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:05:54.464 [main] HMSHandler - 0: get_table : tbl=hive.db.tableDropTable
[INFO ] 2024-04-23 23:05:54.464 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.db.tableDropTable	
[DEBUG] 2024-04-23 23:05:54.464 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:54.464 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.464 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.465 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.466 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.466 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:54.466 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:54.466 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.466 [main] ObjectStore - db details for db db retrieved using ORM in 2.15332ms
[DEBUG] 2024-04-23 23:05:54.466 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:54.466 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.466 [main] ObjectStore - Executing getMTable for hive.db.tabledroptable
[DEBUG] 2024-04-23 23:05:54.469 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.474 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:54.476 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:05:54.477 [main] MetastoreDefaultTransformer - Starting translation for processor HMSClient-@Lenovo-Bot on list 1
[INFO ] 2024-04-23 23:05:54.477 [main] MetastoreDefaultTransformer - Table tabledroptable,#bucket=0,isBucketed:false,tableType=MANAGED_TABLE,tableCapabilities=null
[DEBUG] 2024-04-23 23:05:54.477 [main] MetastoreDefaultTransformer - Table has no specific required capabilities
[DEBUG] 2024-04-23 23:05:54.477 [main] MetastoreDefaultTransformer - Managed acid table with INSERTWRITE or CONNECTORWRITE capability:RW
[INFO ] 2024-04-23 23:05:54.477 [main] MetastoreDefaultTransformer - Processor has one of the write capabilities on insert-only, granting RW
[INFO ] 2024-04-23 23:05:54.478 [main] MetastoreDefaultTransformer - Transformer return list of 1
[DEBUG] 2024-04-23 23:05:54.478 [main] PerfLogger - </PERFLOG method=get_table_req start=1713909954464 end=1713909954478 duration=14 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:05:54.478 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=14, comments=HMS client
[DEBUG] 2024-04-23 23:05:54.478 [main] PerfLogger - <PERFLOG method=drop_table_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:05:54.478 [main] HMSHandler - 0: drop_table : tbl=hive.db.tableDropTable
[INFO ] 2024-04-23 23:05:54.478 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.db.tableDropTable	
[DEBUG] 2024-04-23 23:05:54.478 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:54.478 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.478 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.478 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:54.480 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:54.480 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.480 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:54.480 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.480 [main] ObjectStore - db details for db db retrieved using ORM in 2.130787ms
[DEBUG] 2024-04-23 23:05:54.480 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.480 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.480 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:54.481 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:54.482 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.482 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:54.482 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.482 [main] ObjectStore - db details for db db retrieved using ORM in 1.482128ms
[DEBUG] 2024-04-23 23:05:54.482 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.482 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.482 [main] ObjectStore - Executing getMTable for hive.db.tabledroptable
[DEBUG] 2024-04-23 23:05:54.485 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.490 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.490 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.491 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.491 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.491 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:05:54.492 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:05:54.492 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.493 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.495 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.495 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.495 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.495 [main] ObjectStore - Executing getMTable for hive.db.tabledroptable
[DEBUG] 2024-04-23 23:05:54.497 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.497 [main] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:05:54.497 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.498 [main] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:05:54.498 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.498 [main] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:05:54.498 [main] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:05:54.498 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.499 [main] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:05:54.500 [main] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:05:54.500 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.500 [main] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:05:54.500 [main] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:05:54.500 [main] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:05:54.500 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.501 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.501 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:05:54.501 [main] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:05:54.501 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.503 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.503 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:05:54.503 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.503 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:54.503 [main] ObjectStore - Executing getMTable for hive.db.tabledroptable
[DEBUG] 2024-04-23 23:05:54.505 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:54.506 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.509 [main] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:05:54.509 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.509 [main] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:05:54.512 [main] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:05:54.512 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.518 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.519 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.setConf(ThrowingTxnHandler.java:31) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropTable(AcidEventListener.java:64) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$22.notify(MetaStoreListenerNotifier.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:401) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_core(HMSHandler.java:3020) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3256) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3244) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy36.drop_table_with_environment_context(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.drop_table_with_environment_context(HiveMetaStoreClient.java:4413) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1830) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1777) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.afterTest(TestMetaStoreAcidCleanup.java:81) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 69 more
[DEBUG] 2024-04-23 23:05:54.519 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1241976048 (XID = 922), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:05:54.519 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1241976048 (XID = 922), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.519 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db' AND "TC_TABLE"='tabledroptable'>
[DEBUG] 2024-04-23 23:05:54.520 [main] TxnHandler - Going to rollback: 
java.sql.SQLSyntaxErrorException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeUpdate(ProxyStatement.java:117) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeUpdate(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.cleanupRecords(TxnHandler.java:4190) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.cleanupRecords(ThrowingTxnHandler.java:41) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropTable(AcidEventListener.java:65) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$22.notify(MetaStoreListenerNotifier.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:401) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_core(HMSHandler.java:3020) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3256) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3244) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy36.drop_table_with_environment_context(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.drop_table_with_environment_context(HiveMetaStoreClient.java:4413) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1830) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1777) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.afterTest(TestMetaStoreAcidCleanup.java:81) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DeleteNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 67 more
[INFO ] 2024-04-23 23:05:54.521 [main] TxnHandler - Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
[WARN ] 2024-04-23 23:05:54.521 [main] TxnHandler - Cannot perform cleanup since metastore table does not exist
[DEBUG] 2024-04-23 23:05:54.521 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1241976048 (XID = 922), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.521 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:54.522 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.522 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 23:05:54.522 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 23:05:54.523 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db.db/tabledroptable
[DEBUG] 2024-04-23 23:05:54.523 [main] PerfLogger - </PERFLOG method=drop_table_with_environment_context start=1713909954478 end=1713909954523 duration=45 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:05:54.523 [main] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:05:54.523 [main] HMSHandler - 0: get_database: db
[INFO ] 2024-04-23 23:05:54.523 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_database: db	
[DEBUG] 2024-04-23 23:05:54.524 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:54.524 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.524 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.526 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.526 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.526 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:54.526 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:54.526 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.526 [main] ObjectStore - db details for db db retrieved using ORM in 2.854798ms
[INFO ] 2024-04-23 23:05:54.526 [main] MetastoreDefaultTransformer - Starting translation for transformDatabase for processor HMSClient-@Lenovo-Bot with [HIVEMANAGEDINSERTWRITE, HIVEMANAGESTATS, HIVECACHEINVALIDATE, CONNECTORWRITE] on database db locationUri=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db.db managedLocationUri=null
[DEBUG] 2024-04-23 23:05:54.527 [main] MetastoreDefaultTransformer - Comparing DB and warehouse paths warehouse=/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse db.getLocationUri=/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db.db
[INFO ] 2024-04-23 23:05:54.527 [main] MetastoreDefaultTransformer - Transformer returning database:Database(name:db, description:null, locationUri:file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db.db, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:1713909952, type:NATIVE)
[DEBUG] 2024-04-23 23:05:54.527 [main] PerfLogger - </PERFLOG method=get_database_req start=1713909954523 end=1713909954527 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:05:54.527 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=4, comments=HMS client
[DEBUG] 2024-04-23 23:05:54.527 [main] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:05:54.527 [main] HMSHandler - 0: drop_database: @hive#db
[INFO ] 2024-04-23 23:05:54.527 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db	
[DEBUG] 2024-04-23 23:05:54.527 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:05:54.527 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.527 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.527 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:54.529 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:54.529 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.529 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:54.529 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.529 [main] ObjectStore - db details for db db retrieved using ORM in 2.277521ms
[DEBUG] 2024-04-23 23:05:54.529 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 23:05:54.529 [main] HMSHandler - 0: get_all_tables: db=@hive#db
[INFO ] 2024-04-23 23:05:54.529 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db	
[DEBUG] 2024-04-23 23:05:54.529 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.530 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.536 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.536 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:54.536 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.536 [main] ObjectStore - 0 entries retrieved using ORM in 6.822421ms
[DEBUG] 2024-04-23 23:05:54.536 [main] HMSHandler - 0: get_functions: db=@hive#db pat=*
[INFO ] 2024-04-23 23:05:54.536 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db pat=*	
[DEBUG] 2024-04-23 23:05:54.537 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.541 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.542 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:05:54.542 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:05:54.542 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.546 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.546 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:05:54.546 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:05:54.546 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.547 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.548 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:05:54.548 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:05:54.548 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.548 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.548 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:05:54.549 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:05:54.549 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.550 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:54.550 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.550 [main] ObjectStore - db details for db db retrieved using ORM in 1.498176ms
[DEBUG] 2024-04-23 23:05:54.550 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.550 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.556 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.557 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:05:54.557 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.557 [main] ObjectStore - 0 entries retrieved using ORM in 6.9055ms
[INFO ] 2024-04-23 23:05:54.557 [main] ObjectStore - Dropping database hive.db along with all tables
[DEBUG] 2024-04-23 23:05:54.557 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:05:54.557 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:05:54.558 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:05:54.558 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:05:54.581 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1038480108 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.586 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:05:54.592 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:05:54.593 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.setConf(ThrowingTxnHandler.java:31) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1536) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1473) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.tearDown(TestMetaStoreAcidCleanup.java:70) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 54 more
[DEBUG] 2024-04-23 23:05:54.593 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1241976048 (XID = 922), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:05:54.593 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1241976048 (XID = 922), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.593 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db'>
[DEBUG] 2024-04-23 23:05:54.594 [main] TxnHandler - Going to rollback: 
java.sql.SQLSyntaxErrorException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeUpdate(ProxyStatement.java:117) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeUpdate(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.cleanupRecords(TxnHandler.java:4190) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.cleanupRecords(ThrowingTxnHandler.java:41) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:58) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1536) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1473) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.tearDown(TestMetaStoreAcidCleanup.java:70) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DeleteNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 52 more
[INFO ] 2024-04-23 23:05:54.594 [main] TxnHandler - Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
[WARN ] 2024-04-23 23:05:54.594 [main] TxnHandler - Cannot perform cleanup since metastore table does not exist
[DEBUG] 2024-04-23 23:05:54.595 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1241976048 (XID = 922), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.595 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:05:54.596 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:05:54.596 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:05:54.596 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 23:05:54.597 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db.db
[DEBUG] 2024-04-23 23:05:54.598 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:05:54.598 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 23:05:54.598 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db.db
[DEBUG] 2024-04-23 23:05:54.599 [main] PerfLogger - </PERFLOG method=drop_database start=1713909954527 end=1713909954599 duration=72 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:05:54.599 [main] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:05:54.599 [main] HMSHandler - 0: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:05:54.599 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:05:54.599 [main] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@69e308c6, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@29f0802c will be shutdown
[DEBUG] 2024-04-23 23:05:54.599 [main] HMSHandler - 0: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:05:54.600 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:05:54.600 [main] PerfLogger - </PERFLOG method=shutdown start=1713909954599 end=1713909954600 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:05:54.600 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: -1
[DEBUG] 2024-04-23 23:05:54.608 [Thread-15] ShutdownHookManager - ShutdownHookManger complete shutdown.
