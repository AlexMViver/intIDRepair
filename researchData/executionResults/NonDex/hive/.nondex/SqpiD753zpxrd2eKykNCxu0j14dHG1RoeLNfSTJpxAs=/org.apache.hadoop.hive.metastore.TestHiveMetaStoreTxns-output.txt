[DEBUG] 2024-04-23 23:06:09.020 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:09.035 [main] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:06:09.036 [main] HikariConfig - HikariPool-2 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:06:09.036 [main] HikariConfig - HikariPool-2 - configuration:
[DEBUG] 2024-04-23 23:06:09.036 [main] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:06:09.037 [main] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:06:09.037 [main] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:06:09.037 [main] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:06:09.037 [main] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:06:09.037 [main] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:06:09.037 [main] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:06:09.037 [main] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:06:09.037 [main] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:06:09.037 [main] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:06:09.037 [main] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:06:09.037 [main] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:06:09.038 [main] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:06:09.038 [main] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:06:09.038 [main] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:06:09.038 [main] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:06:09.038 [main] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:06:09.038 [main] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:06:09.038 [main] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true"
[DEBUG] 2024-04-23 23:06:09.038 [main] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:06:09.038 [main] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:06:09.038 [main] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:06:09.038 [main] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:06:09.039 [main] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:06:09.039 [main] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:06:09.039 [main] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:06:09.039 [main] HikariConfig - poolName........................"HikariPool-2"
[DEBUG] 2024-04-23 23:06:09.039 [main] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:06:09.039 [main] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:06:09.039 [main] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:06:09.039 [main] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:06:09.039 [main] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:06:09.039 [main] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:06:09.039 [main] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:06:09.039 [main] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:06:09.040 [main] HikariDataSource - HikariPool-2 - Starting...
[INFO ] 2024-04-23 23:06:09.041 [main] PoolBase - HikariPool-2 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:06:09.041 [main] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:09.041 [main] HikariDataSource - HikariPool-2 - Start completed.
[DEBUG] 2024-04-23 23:06:09.042 [main] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:06:09.043 [main] HikariConfig - HikariPool-3 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:06:09.043 [main] HikariConfig - HikariPool-3 - configuration:
[DEBUG] 2024-04-23 23:06:09.043 [main] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:06:09.043 [main] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:06:09.043 [main] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:06:09.044 [main] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:06:09.044 [main] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:06:09.044 [main] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:06:09.044 [main] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:06:09.044 [main] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:06:09.044 [main] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:06:09.044 [main] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:06:09.044 [main] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:06:09.044 [main] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:06:09.044 [main] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:06:09.044 [main] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:06:09.044 [main] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:06:09.044 [main] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:06:09.044 [main] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:06:09.045 [main] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:06:09.045 [main] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true"
[DEBUG] 2024-04-23 23:06:09.045 [main] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:06:09.045 [main] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:06:09.045 [main] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:06:09.045 [main] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:06:09.045 [main] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:06:09.045 [main] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:06:09.045 [main] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:06:09.045 [main] HikariConfig - poolName........................"HikariPool-3"
[DEBUG] 2024-04-23 23:06:09.045 [main] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:06:09.045 [main] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:06:09.045 [main] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:06:09.045 [main] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:06:09.045 [main] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:06:09.045 [main] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:06:09.046 [main] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:06:09.046 [main] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:06:09.046 [main] HikariDataSource - HikariPool-3 - Starting...
[INFO ] 2024-04-23 23:06:09.047 [main] PoolBase - HikariPool-3 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:06:09.047 [main] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@332139408 (XID = 1566), (SESSIONID = 27), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:09.048 [main] HikariDataSource - HikariPool-3 - Start completed.
[DEBUG] 2024-04-23 23:06:09.048 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.050 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:09.050 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.052 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:06:09.056 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:06:09.060 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:06:09.060 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:06:09.068 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:06:09.069 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:06:09.077 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:09.078 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.078 [main] PerfLogger - </PERFLOG method=open_txns start=1713909969020 end=1713909969078 duration=58 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:09.079 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:09.086 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:06:09.090 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
[DEBUG] 2024-04-23 23:06:09.090 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1>
[DEBUG] 2024-04-23 23:06:09.090 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 1>
[DEBUG] 2024-04-23 23:06:09.090 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 1>
[DEBUG] 2024-04-23 23:06:09.090 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:06:09.103 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:06:09.103 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:06:09.106 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:06:09.106 [main] TxnHandler - Going to execute update <UPDATE "TABLE_PARAMS" SET "PARAM_VALUE" = 'myvalue' WHERE "TBL_ID" = 10 AND "PARAM_KEY" = '_metamykey'>
[WARN ] 2024-04-23 23:06:09.109 [main] TxnHandler - Error updating key/value in the sql backend with txnId=1, tableId=10, key=_metamykey, value=myvalue. Only one row should have been affected but 0 rows where affected.
[DEBUG] 2024-04-23 23:06:09.112 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:09.112 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 23:06:09.113 [main] RetryingHMSHandler - java.lang.IllegalStateException: Error updating key/value in the sql backend with txnId=1, tableId=10, key=_metamykey, value=myvalue. Only one row should have been affected but 0 rows where affected.
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.updateKeyValueAssociatedWithTxn(TxnHandler.java:1773)
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.commitTxn(TxnHandler.java:1575)
	at org.apache.hadoop.hive.metastore.HMSHandler.commit_txn(HMSHandler.java:8741)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.commit_txn(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.commitTxnWithKeyValue(HiveMetaStoreClient.java:3964)
	at org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.testTxNWithKeyValueNoTableId(TestHiveMetaStoreTxns.java:177)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

[DEBUG] 2024-04-23 23:06:09.113 [main] PerfLogger - </PERFLOG method=commit_txn start=1713909969079 end=1713909969113 duration=34 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 23:06:09.113 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:09.113 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:06:09.117 [main] TxnHandler - Got OpenTxnList with hwm: 1 and openTxnList size 1.
[DEBUG] 2024-04-23 23:06:09.117 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:09.117 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.120 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713909969113 end=1713909969120 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:09.121 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:06:09.126 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:09.128 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:09.131 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:06:09.133 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:06:09.135 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:06:09.137 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:06:09.139 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:06:09.141 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:06:09.141 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:06:09.143 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@689249801 (XID = 1615), (SESSIONID = 31), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.144 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:06:09.145 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1747457074 (XID = 1620), (SESSIONID = 33), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.146 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1502264090 (XID = 1623), (SESSIONID = 35), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.147 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@134736765 (XID = 1625), (SESSIONID = 37), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.148 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:06:09.148 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:06:09.149 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@738582540 (XID = 1630), (SESSIONID = 40), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.150 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@960414361 (XID = 1631), (SESSIONID = 41), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.152 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@206149587 (XID = 1634), (SESSIONID = 44), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.152 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2013513890 (XID = 1635), (SESSIONID = 45), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.153 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:06:09.154 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1228002407 (XID = 1639), (SESSIONID = 48), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.154 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1895944333 (XID = 1640), (SESSIONID = 49), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.155 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@405551085 (XID = 1644), (SESSIONID = 52), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.155 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@474445473 (XID = 1645), (SESSIONID = 53), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.157 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:06:09.157 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@724094100 (XID = 1649), (SESSIONID = 57), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.157 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:06:09.157 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2116922614 (XID = 1648), (SESSIONID = 56), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.159 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@476236656 (XID = 1653), (SESSIONID = 59), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.160 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1888884200 (XID = 1655), (SESSIONID = 61), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.161 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:06:09.161 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1607705373 (XID = 1658), (SESSIONID = 63), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.163 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@101150569 (XID = 1661), (SESSIONID = 65), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.163 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:06:09.164 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:06:09.167 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:06:09.188 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:09.188 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:06:09.191 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:06:09.194 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:06:09.194 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:06:09.199 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:06:09.199 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:06:09.199 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:09.199 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.200 [main] PerfLogger - </PERFLOG method=open_txns start=1713909969188 end=1713909969200 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:09.200 [main] PerfLogger - <PERFLOG method=allocate_table_write_ids from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:09.200 [main] TxnHandler - Going to execute query <SELECT COUNT(*) FROM "TXNS" WHERE "TXN_STATE" = 'o' AND "TXN_TYPE" != 2 AND "TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:06:09.203 [main] TxnHandler - Going to execute query <SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE" FROM "TXNS" WHERE "TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:06:09.206 [main] TxnHandler - Going to execute query <SELECT "CTC_TXNID" FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_TXNID" in (1)>
[ERROR] 2024-04-23 23:06:09.208 [main] TxnHandler - Write ID allocation on db.tbl failed for input txns: {1,read-only}
[DEBUG] 2024-04-23 23:06:09.208 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:09.209 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 23:06:09.209 [main] RetryingHMSHandler - java.lang.IllegalStateException: Write ID allocation failed on db.tbl as not all input txns in open state or read-only
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.allocateTableWriteIds(TxnHandler.java:2140)
	at org.apache.hadoop.hive.metastore.HMSHandler.allocate_table_write_ids(HMSHandler.java:8821)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.allocate_table_write_ids(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.allocateTableWriteIdsBatchIntr(HiveMetaStoreClient.java:4033)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.allocateTableWriteIdsBatch(HiveMetaStoreClient.java:4020)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.allocateTableWriteId(HiveMetaStoreClient.java:4012)
	at org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.testAllocateTableWriteIdForReadOnlyTxn(TestHiveMetaStoreTxns.java:360)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

[DEBUG] 2024-04-23 23:06:09.209 [main] PerfLogger - </PERFLOG method=allocate_table_write_ids start=1713909969200 end=1713909969209 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[INFO ] 2024-04-23 23:06:09.209 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:06:09.212 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:09.212 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:09.215 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:06:09.215 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:06:09.216 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:06:09.216 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:06:09.216 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:06:09.217 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:06:09.217 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:06:09.217 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:06:09.217 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:06:09.217 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:06:09.218 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:06:09.218 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:06:09.219 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:06:09.230 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:09.230 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:06:09.233 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:06:09.237 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:06:09.237 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:06:09.241 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:06:09.241 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:06:09.241 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:09.242 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.242 [main] PerfLogger - </PERFLOG method=open_txns start=1713909969230 end=1713909969242 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:09.243 [main] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:09.244 [main] HMSHandler - 0: create_database: Database(name:mydbKeyValueWrongPrefix, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:06:09.244 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:mydbKeyValueWrongPrefix, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[DEBUG] 2024-04-23 23:06:09.244 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:09.245 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:09.245 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:09.246 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.246 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 1.81523ms
[DEBUG] 2024-04-23 23:06:09.246 [main] ObjectStore - Failed to get database hive.mydbKeyValueWrongPrefix, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:06:09.246 [main] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:06:09.247 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:09.248 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:09.248 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.250 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[INFO ] 2024-04-23 23:06:09.251 [main] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db
[INFO ] 2024-04-23 23:06:09.254 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db
[INFO ] 2024-04-23 23:06:09.263 [main] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db
[DEBUG] 2024-04-23 23:06:09.264 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:09.264 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:09.266 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:09.266 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:09.267 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.268 [main] PerfLogger - </PERFLOG method=create_database start=1713909969243 end=1713909969268 duration=25 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:09.274 [main] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:09.274 [main] HMSHandler - 0: create_table_req: Table(tableName:mytable, dbName:mydbKeyValueWrongPrefix, owner:alex, createTime:1713909969, lastAccessTime:1713909969, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:06:09.274 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:mytable, dbName:mydbKeyValueWrongPrefix, owner:alex, createTime:1713909969, lastAccessTime:1713909969, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:06:09.274 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:09.284 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:09.285 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:09.285 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:09.285 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.285 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 10.932455ms
[DEBUG] 2024-04-23 23:06:09.285 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:09.286 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:09.286 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 23:06:09.294 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:09.294 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:09.294 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.295 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:09.296 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:09.297 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:09.297 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:09.297 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:09.298 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 1.957085ms
[DEBUG] 2024-04-23 23:06:09.298 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:09.298 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:09.298 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 23:06:09.299 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:09.299 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:06:09.300 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvaluewrongprefix.db/mytable
[DEBUG] 2024-04-23 23:06:09.305 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:09.305 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:09.312 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:09.319 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@514540716 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.326 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@514540716 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.332 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@514540716 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.339 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@514540716 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.358 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:09.358 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:09.363 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.365 [main] PerfLogger - </PERFLOG method=create_table_req start=1713909969274 end=1713909969365 duration=91 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:09.365 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:09.367 [main] HMSHandler - 0: get_table : tbl=hive.mydbKeyValueWrongPrefix.mytable
[INFO ] 2024-04-23 23:06:09.367 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.mydbKeyValueWrongPrefix.mytable	
[DEBUG] 2024-04-23 23:06:09.367 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:09.368 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:09.369 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:09.369 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:09.369 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.369 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 2.208428ms
[DEBUG] 2024-04-23 23:06:09.369 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:09.369 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:09.369 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 23:06:09.389 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:09.433 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:09.435 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:09.437 [main] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:06:09.438 [main] PerfLogger - </PERFLOG method=get_table_req start=1713909969365 end=1713909969438 duration=73 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:09.439 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=74, comments=HMS client
[DEBUG] 2024-04-23 23:06:09.439 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:09.442 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:06:09.442 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
[DEBUG] 2024-04-23 23:06:09.442 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1>
[DEBUG] 2024-04-23 23:06:09.442 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 1>
[DEBUG] 2024-04-23 23:06:09.442 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 1>
[DEBUG] 2024-04-23 23:06:09.442 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:06:09.445 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:06:09.445 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:06:09.445 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:06:09.445 [main] TxnHandler - Error updating key/value in the sql backend with txnId=1, tableId=1, key=mykey, value=myvalue. key should start with _meta.
[DEBUG] 2024-04-23 23:06:09.446 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:09.446 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 23:06:09.446 [main] RetryingHMSHandler - java.lang.IllegalArgumentException: Error updating key/value in the sql backend with txnId=1, tableId=1, key=mykey, value=myvalue. key should start with _meta.
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.updateKeyValueAssociatedWithTxn(TxnHandler.java:1756)
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.commitTxn(TxnHandler.java:1575)
	at org.apache.hadoop.hive.metastore.HMSHandler.commit_txn(HMSHandler.java:8741)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.commit_txn(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.commitTxnWithKeyValue(HiveMetaStoreClient.java:3964)
	at org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.testTxNWithKeyWrongPrefix(TestHiveMetaStoreTxns.java:206)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

[DEBUG] 2024-04-23 23:06:09.447 [main] PerfLogger - </PERFLOG method=commit_txn start=1713909969439 end=1713909969447 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 23:06:09.447 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:09.447 [main] HMSHandler - 0: get_table : tbl=hive.mydbKeyValueWrongPrefix.mytable
[INFO ] 2024-04-23 23:06:09.447 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.mydbKeyValueWrongPrefix.mytable	
[DEBUG] 2024-04-23 23:06:09.447 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:09.449 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:09.449 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:09.449 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:09.450 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.450 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 2.856284ms
[DEBUG] 2024-04-23 23:06:09.450 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:09.450 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:09.450 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 23:06:09.455 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:09.460 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:09.462 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:09.464 [main] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:06:09.464 [main] PerfLogger - </PERFLOG method=get_table_req start=1713909969447 end=1713909969464 duration=17 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:09.464 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=17, comments=HMS client
[DEBUG] 2024-04-23 23:06:09.465 [main] PerfLogger - <PERFLOG method=drop_table_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:09.465 [main] HMSHandler - 0: drop_table : tbl=hive.mydbKeyValueWrongPrefix.mytable
[INFO ] 2024-04-23 23:06:09.465 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.mydbKeyValueWrongPrefix.mytable	
[DEBUG] 2024-04-23 23:06:09.465 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:09.465 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:09.466 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:09.467 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:09.467 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:09.467 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 1.897522ms
[DEBUG] 2024-04-23 23:06:09.467 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:09.468 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:09.469 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:09.469 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:09.469 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 1.90121ms
[DEBUG] 2024-04-23 23:06:09.469 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:09.469 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:09.469 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 23:06:09.472 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:09.478 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:09.478 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:09.484 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:09.485 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:09.485 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:06:09.499 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:06:09.499 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:09.499 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:09.518 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:09.518 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:09.518 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:09.518 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 23:06:09.520 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:09.521 [main] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:06:09.521 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:09.560 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@514540716 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.571 [main] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:06:09.571 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:09.572 [main] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:06:09.572 [main] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:06:09.572 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:09.586 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@514540716 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.597 [main] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:06:09.597 [main] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:06:09.597 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:09.597 [main] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:06:09.597 [main] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:06:09.597 [main] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:06:09.597 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:09.613 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:09.613 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:06:09.614 [main] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:06:09.614 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:09.630 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:09.631 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:06:09.631 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:09.631 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:06:09.631 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 23:06:09.633 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:06:09.643 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:09.647 [main] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:06:09.647 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:09.647 [main] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:06:09.672 [main] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:06:09.672 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:09.721 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:09.721 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:09.723 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.724 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvaluewrongprefix
[DEBUG] 2024-04-23 23:06:09.724 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvaluewrongprefix
[DEBUG] 2024-04-23 23:06:09.725 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvaluewrongprefix.db/mytable
[INFO ] 2024-04-23 23:06:09.727 [main] deprecation - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
[DEBUG] 2024-04-23 23:06:09.729 [main] PerfLogger - </PERFLOG method=drop_table_with_environment_context start=1713909969465 end=1713909969729 duration=264 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:09.729 [main] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:09.730 [main] HMSHandler - 0: get_database: mydbKeyValueWrongPrefix
[INFO ] 2024-04-23 23:06:09.730 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_database: mydbKeyValueWrongPrefix	
[DEBUG] 2024-04-23 23:06:09.730 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:09.732 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:09.732 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:09.732 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:09.732 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.732 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 2.690631ms
[DEBUG] 2024-04-23 23:06:09.733 [main] PerfLogger - </PERFLOG method=get_database_req start=1713909969729 end=1713909969733 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:09.733 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=4, comments=HMS client
[DEBUG] 2024-04-23 23:06:09.733 [main] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:09.733 [main] HMSHandler - 0: drop_database: @hive#mydbKeyValueWrongPrefix
[INFO ] 2024-04-23 23:06:09.733 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#mydbKeyValueWrongPrefix	
[DEBUG] 2024-04-23 23:06:09.733 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:09.733 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:09.734 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:09.735 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:09.735 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:09.735 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 1.808933ms
[DEBUG] 2024-04-23 23:06:09.735 [main] HMSHandler - 0: get_all_tables: db=@hive#mydbKeyValueWrongPrefix
[INFO ] 2024-04-23 23:06:09.735 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#mydbKeyValueWrongPrefix	
[DEBUG] 2024-04-23 23:06:09.736 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:09.742 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:09.742 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:09.742 [main] ObjectStore - 0 entries retrieved using SQL in 6.713222ms
[DEBUG] 2024-04-23 23:06:09.743 [main] HMSHandler - 0: get_functions: db=@hive#mydbKeyValueWrongPrefix pat=*
[INFO ] 2024-04-23 23:06:09.743 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#mydbKeyValueWrongPrefix pat=*	
[DEBUG] 2024-04-23 23:06:09.743 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:09.758 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@514540716 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.766 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:09.767 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:06:09.767 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:06:09.767 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:09.774 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@514540716 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.779 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:09.779 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:06:09.779 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:06:09.779 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:09.806 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@514540716 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.812 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:09.813 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=mydbKeyValueWrongPrefix pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:09.813 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=mydbKeyValueWrongPrefix pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:09.813 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:09.814 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:09.815 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:09.815 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:09.815 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 2.062082ms
[DEBUG] 2024-04-23 23:06:09.815 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:09.820 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:09.820 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:09.820 [main] ObjectStore - 0 entries retrieved using SQL in 4.675941ms
[INFO ] 2024-04-23 23:06:09.820 [main] ObjectStore - Dropping database hive.mydbKeyValueWrongPrefix along with all tables
[DEBUG] 2024-04-23 23:06:09.820 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:09.820 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:09.825 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:09.826 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:06:09.845 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@514540716 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.851 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:06:09.857 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:09.860 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:09.860 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.861 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 23:06:09.864 [main] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 23:06:09.867 [main] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 23:06:09.870 [main] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 23:06:09.874 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 23:06:09.877 [main] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 23:06:09.880 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:09.880 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.880 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:09.882 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.883 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:06:09.883 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvaluewrongprefix
[DEBUG] 2024-04-23 23:06:09.883 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvaluewrongprefix.db
[DEBUG] 2024-04-23 23:06:09.885 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:06:09.885 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvaluewrongprefix
[DEBUG] 2024-04-23 23:06:09.886 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db
[DEBUG] 2024-04-23 23:06:09.886 [main] PerfLogger - </PERFLOG method=drop_database start=1713909969733 end=1713909969886 duration=153 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:09.887 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:09.887 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:06:09.891 [main] TxnHandler - Got OpenTxnList with hwm: 1 and openTxnList size 1.
[DEBUG] 2024-04-23 23:06:09.891 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:09.891 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.891 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713909969887 end=1713909969891 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:09.891 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:06:09.896 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:09.899 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:09.901 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:06:09.903 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:06:09.905 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:06:09.908 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:06:09.910 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:06:09.912 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:06:09.915 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:06:09.917 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:06:09.919 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:06:09.922 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:06:09.924 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:06:09.926 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:06:09.928 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:06:09.942 [main] PerfLogger - <PERFLOG method=lock from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:09.953 [main] TxnHandler - Executing a batch of <INSERT INTO "HIVE_LOCKS" ( "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_LAST_HEARTBEAT", "HL_USER", "HL_HOST", "HL_AGENT_INFO") VALUES (?, ?, ?, ?, ?, ?, ?, ?, { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000, ?, ?, ?)> queries. Batch size: 3
[DEBUG] 2024-04-23 23:06:09.955 [main] TxnHandler - Going to execute query <SELECT "NL_NEXT" FROM "NEXT_LOCK_ID">
[DEBUG] 2024-04-23 23:06:09.956 [main] TxnHandler - Going to execute updates in batch: <UPDATE "NEXT_LOCK_ID" SET "NL_NEXT" = 2>, and <UPDATE "HIVE_LOCKS" SET "HL_LOCK_EXT_ID" = 1 WHERE "HL_LOCK_EXT_ID" = -3800449702304627159>
[DEBUG] 2024-04-23 23:06:09.963 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 23:06:09.964 [main] TxnHandler - Found 3 locks for extLockId=1. Locks: [lockid:1 intLockId:1 txnid:0 db:mydb table:mytable partition:mypartition=MyValue state:WAITING type:EXCLUSIVE, lockid:1 intLockId:2 txnid:0 db:mydb table:yourtable partition:null state:WAITING type:SHARED_WRITE, lockid:1 intLockId:3 txnid:0 db:yourdb table:null partition:null state:WAITING type:SHARED_READ]
[DEBUG] 2024-04-23 23:06:09.965 [main] TxnHandler - Going to execute query <(select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='r' AND "EX"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NOT NULL AND "REQ"."HL_TABLE" IS NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NULL AND "EX"."HL_LOCK_TYPE"='r' AND "REQ"."HL_TABLE" IS NOT NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='w' AND "EX"."HL_LOCK_TYPE" IN ('x','e') fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='x' AND "EX"."HL_LOCK_TYPE"!='r' fetch first 1 rows only)>
[DEBUG] 2024-04-23 23:06:09.987 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LOCK_STATE" = 'a', "HL_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_ACQUIRED_AT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_BLOCKEDBY_EXT_ID"=NULL,"HL_BLOCKEDBY_INT_ID"=NULL WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 23:06:09.992 [main] TxnHandler - Successfully acquired locks: [lockid:1 intLockId:1 txnid:0 db:mydb table:mytable partition:mypartition=MyValue state:WAITING type:EXCLUSIVE, lockid:1 intLockId:2 txnid:0 db:mydb table:yourtable partition:null state:WAITING type:SHARED_WRITE, lockid:1 intLockId:3 txnid:0 db:yourdb table:null partition:null state:WAITING type:SHARED_READ]
[DEBUG] 2024-04-23 23:06:09.992 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:09.992 [main] PerfLogger - </PERFLOG method=lock start=1713909969942 end=1713909969992 duration=50 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:09.993 [main] PerfLogger - <PERFLOG method=check_lock from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:09.993 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 23:06:09.993 [main] TxnHandler - getTxnIdFromLockId(1) Return txnid:0
[DEBUG] 2024-04-23 23:06:09.994 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 23:06:09.998 [main] TxnHandler - Successfully heartbeated for extLockId=1
[DEBUG] 2024-04-23 23:06:09.998 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 23:06:09.998 [main] TxnHandler - Found 3 locks for extLockId=1. Locks: [lockid:1 intLockId:1 txnid:0 db:mydb table:mytable partition:mypartition=MyValue state:ACQUIRED type:EXCLUSIVE, lockid:1 intLockId:2 txnid:0 db:mydb table:yourtable partition:null state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:3 txnid:0 db:yourdb table:null partition:null state:ACQUIRED type:SHARED_READ]
[DEBUG] 2024-04-23 23:06:09.999 [main] TxnHandler - Going to execute query <(select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='r' AND "EX"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NOT NULL AND "REQ"."HL_TABLE" IS NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NULL AND "EX"."HL_LOCK_TYPE"='r' AND "REQ"."HL_TABLE" IS NOT NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='w' AND "EX"."HL_LOCK_TYPE" IN ('x','e') fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='x' AND "EX"."HL_LOCK_TYPE"!='r' fetch first 1 rows only)>
[DEBUG] 2024-04-23 23:06:09.999 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LOCK_STATE" = 'a', "HL_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_ACQUIRED_AT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_BLOCKEDBY_EXT_ID"=NULL,"HL_BLOCKEDBY_INT_ID"=NULL WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 23:06:10.000 [main] TxnHandler - Successfully acquired locks: [lockid:1 intLockId:1 txnid:0 db:mydb table:mytable partition:mypartition=MyValue state:ACQUIRED type:EXCLUSIVE, lockid:1 intLockId:2 txnid:0 db:mydb table:yourtable partition:null state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:3 txnid:0 db:yourdb table:null partition:null state:ACQUIRED type:SHARED_READ]
[DEBUG] 2024-04-23 23:06:10.001 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.001 [main] PerfLogger - </PERFLOG method=check_lock start=1713909969993 end=1713909970001 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.001 [main] PerfLogger - <PERFLOG method=heartbeat from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.001 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 23:06:10.002 [main] TxnHandler - Successfully heartbeated for extLockId=1
[DEBUG] 2024-04-23 23:06:10.002 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.002 [main] PerfLogger - </PERFLOG method=heartbeat start=1713909970001 end=1713909970002 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.003 [main] PerfLogger - <PERFLOG method=unlock from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.003 [main] TxnHandler - Going to execute update <DELETE FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1 AND ("HL_TXNID" = 0 OR ("HL_TXNID" <> 0 AND "HL_LOCK_STATE" = 'w'))>
[DEBUG] 2024-04-23 23:06:10.006 [main] TxnHandler - Successfully unlocked at least 1 lock with extLockId=1
[DEBUG] 2024-04-23 23:06:10.007 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.007 [main] PerfLogger - </PERFLOG method=unlock start=1713909970003 end=1713909970007 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:10.007 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:06:10.011 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:10.011 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:10.014 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:06:10.014 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:06:10.014 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:06:10.014 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:06:10.015 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:06:10.015 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:06:10.016 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:06:10.016 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:06:10.017 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:06:10.017 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:06:10.017 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:06:10.017 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:06:10.018 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:06:10.025 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.026 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:06:10.028 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:06:10.031 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:06:10.031 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:06:10.039 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1),(2, 1),(3, 1)>
[INFO ] 2024-04-23 23:06:10.041 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1, 2, 3]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:06:10.041 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.041 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.041 [main] PerfLogger - </PERFLOG method=open_txns start=1713909970025 end=1713909970041 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.041 [main] PerfLogger - <PERFLOG method=abort_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.043 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:06:10.044 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:06:10.046 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:06:10.046 [main] TxnHandler - Going to execute select <SELECT "RTM_REPL_POLICY" FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:06:10.048 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'a' WHERE "TXN_STATE" = 'o' AND ("TXN_ID" in (1))>
[DEBUG] 2024-04-23 23:06:10.048 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:06:10.048 [main] TxnUtils - Adding query to batch: <DELETE FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:06:10.048 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:06:10.054 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.054 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.054 [main] PerfLogger - </PERFLOG method=abort_txn start=1713909970041 end=1713909970054 duration=13 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.054 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.058 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 2 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:06:10.061 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
[DEBUG] 2024-04-23 23:06:10.061 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 2>
[DEBUG] 2024-04-23 23:06:10.061 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 2>
[DEBUG] 2024-04-23 23:06:10.061 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 2>
[DEBUG] 2024-04-23 23:06:10.061 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:06:10.067 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (2)>
[DEBUG] 2024-04-23 23:06:10.067 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:06:10.069 [main] TxnHandler - Removed transactions: ([2]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:06:10.071 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:2
[DEBUG] 2024-04-23 23:06:10.071 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.071 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.072 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:10.072 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.072 [main] PerfLogger - </PERFLOG method=commit_txn start=1713909970054 end=1713909970072 duration=18 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.072 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.072 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:06:10.074 [main] TxnHandler - Got OpenTxnList with hwm: 3 and openTxnList size 2.
[DEBUG] 2024-04-23 23:06:10.074 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:10.074 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.074 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713909970072 end=1713909970074 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:10.075 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:06:10.077 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:10.078 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:10.080 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:06:10.080 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:06:10.080 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:06:10.080 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:06:10.080 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:06:10.081 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:06:10.081 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:06:10.081 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:06:10.081 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:06:10.081 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:06:10.081 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:06:10.082 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:06:10.082 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:06:10.088 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.088 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:06:10.091 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:06:10.094 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:06:10.094 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:06:10.098 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:06:10.099 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:06:10.099 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.099 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.100 [main] PerfLogger - </PERFLOG method=open_txns start=1713909970088 end=1713909970099 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.100 [main] PerfLogger - <PERFLOG method=lock from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.106 [main] TxnHandler - Going to execute query <SELECT "T2W_WRITEID" FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE" = ? AND "T2W_TABLE" = ? AND "T2W_TXNID" = ?>
[DEBUG] 2024-04-23 23:06:10.106 [main] TxnHandler - Going to execute query <SELECT "T2W_WRITEID" FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE" = ? AND "T2W_TABLE" = ? AND "T2W_TXNID" = ?>
[DEBUG] 2024-04-23 23:06:10.106 [main] TxnHandler - Executing a batch of <INSERT INTO "TXN_COMPONENTS" ("TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_OPERATION_TYPE", "TC_WRITEID") VALUES (?, ?, ?, ?, ?, ?)> queries. Batch size: 2
[DEBUG] 2024-04-23 23:06:10.109 [main] TxnHandler - Executing a batch of <INSERT INTO "HIVE_LOCKS" ( "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_LAST_HEARTBEAT", "HL_USER", "HL_HOST", "HL_AGENT_INFO") VALUES (?, ?, ?, ?, ?, ?, ?, ?, 0, ?, ?, ?)> queries. Batch size: 3
[DEBUG] 2024-04-23 23:06:10.109 [main] TxnHandler - Going to execute query <SELECT "NL_NEXT" FROM "NEXT_LOCK_ID">
[DEBUG] 2024-04-23 23:06:10.109 [main] TxnHandler - Going to execute updates in batch: <UPDATE "NEXT_LOCK_ID" SET "NL_NEXT" = 2>, and <UPDATE "HIVE_LOCKS" SET "HL_LOCK_EXT_ID" = 1 WHERE "HL_LOCK_EXT_ID" = 1616711029533972533>
[DEBUG] 2024-04-23 23:06:10.112 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 23:06:10.113 [main] TxnHandler - Found 3 locks for extLockId=1. Locks: [lockid:1 intLockId:1 txnid:1 db:mydb table:mytable partition:mypartition=MyValue state:WAITING type:SHARED_WRITE, lockid:1 intLockId:2 txnid:1 db:mydb table:yourtable partition:null state:WAITING type:SHARED_WRITE, lockid:1 intLockId:3 txnid:1 db:yourdb table:null partition:null state:WAITING type:SHARED_READ]
[DEBUG] 2024-04-23 23:06:10.113 [main] TxnHandler - Going to execute query <(select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='r' AND "EX"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NOT NULL AND "REQ"."HL_TABLE" IS NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NULL AND "EX"."HL_LOCK_TYPE"='r' AND "REQ"."HL_TABLE" IS NOT NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='w' AND "EX"."HL_LOCK_TYPE" IN ('x','e') fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='x' AND "EX"."HL_LOCK_TYPE"!='r' fetch first 1 rows only)>
[DEBUG] 2024-04-23 23:06:10.113 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LOCK_STATE" = 'a', "HL_LAST_HEARTBEAT" = 0,"HL_ACQUIRED_AT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_BLOCKEDBY_EXT_ID"=NULL,"HL_BLOCKEDBY_INT_ID"=NULL WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 23:06:10.117 [main] TxnHandler - Successfully acquired locks: [lockid:1 intLockId:1 txnid:1 db:mydb table:mytable partition:mypartition=MyValue state:WAITING type:SHARED_WRITE, lockid:1 intLockId:2 txnid:1 db:mydb table:yourtable partition:null state:WAITING type:SHARED_WRITE, lockid:1 intLockId:3 txnid:1 db:yourdb table:null partition:null state:WAITING type:SHARED_READ]
[DEBUG] 2024-04-23 23:06:10.117 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.117 [main] PerfLogger - </PERFLOG method=lock start=1713909970100 end=1713909970117 duration=17 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.117 [main] PerfLogger - <PERFLOG method=check_lock from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.117 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 23:06:10.117 [main] TxnHandler - getTxnIdFromLockId(1) Return txnid:1
[DEBUG] 2024-04-23 23:06:10.118 [main] TxnHandler - Going to execute update <UPDATE "TXNS" SET "TXN_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 WHERE "TXN_ID" = 1 AND "TXN_STATE" = 'o'>
[DEBUG] 2024-04-23 23:06:10.120 [main] TxnHandler - Successfully heartbeated for txnId=1
[DEBUG] 2024-04-23 23:06:10.121 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 23:06:10.121 [main] TxnHandler - Found 3 locks for extLockId=1. Locks: [lockid:1 intLockId:1 txnid:1 db:mydb table:mytable partition:mypartition=MyValue state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:2 txnid:1 db:mydb table:yourtable partition:null state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:3 txnid:1 db:yourdb table:null partition:null state:ACQUIRED type:SHARED_READ]
[DEBUG] 2024-04-23 23:06:10.121 [main] TxnHandler - Going to execute query <(select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='r' AND "EX"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NOT NULL AND "REQ"."HL_TABLE" IS NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NULL AND "EX"."HL_LOCK_TYPE"='r' AND "REQ"."HL_TABLE" IS NOT NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='w' AND "EX"."HL_LOCK_TYPE" IN ('x','e') fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='x' AND "EX"."HL_LOCK_TYPE"!='r' fetch first 1 rows only)>
[DEBUG] 2024-04-23 23:06:10.121 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LOCK_STATE" = 'a', "HL_LAST_HEARTBEAT" = 0,"HL_ACQUIRED_AT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_BLOCKEDBY_EXT_ID"=NULL,"HL_BLOCKEDBY_INT_ID"=NULL WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 23:06:10.122 [main] TxnHandler - Successfully acquired locks: [lockid:1 intLockId:1 txnid:1 db:mydb table:mytable partition:mypartition=MyValue state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:2 txnid:1 db:mydb table:yourtable partition:null state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:3 txnid:1 db:yourdb table:null partition:null state:ACQUIRED type:SHARED_READ]
[DEBUG] 2024-04-23 23:06:10.122 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.122 [main] PerfLogger - </PERFLOG method=check_lock start=1713909970117 end=1713909970122 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.122 [main] PerfLogger - <PERFLOG method=heartbeat from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.122 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 23:06:10.123 [main] TxnHandler - Successfully heartbeated for extLockId=1
[DEBUG] 2024-04-23 23:06:10.123 [main] TxnHandler - Going to execute update <UPDATE "TXNS" SET "TXN_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 WHERE "TXN_ID" = 1 AND "TXN_STATE" = 'o'>
[DEBUG] 2024-04-23 23:06:10.123 [main] TxnHandler - Successfully heartbeated for txnId=1
[DEBUG] 2024-04-23 23:06:10.123 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.123 [main] PerfLogger - </PERFLOG method=heartbeat start=1713909970122 end=1713909970123 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.124 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.130 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode false
[DEBUG] 2024-04-23 23:06:10.130 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS">
[DEBUG] 2024-04-23 23:06:10.132 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'Y' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1 AND "TC_OPERATION_TYPE" <> 'c'>
[DEBUG] 2024-04-23 23:06:10.135 [main] TxnUtils - Adding query to batch: <UPDATE "WRITE_SET" SET "WS_COMMIT_ID" = 1 WHERE "WS_COMMIT_ID" = 3335909294589532955 AND "WS_TXNID" = 1>
[DEBUG] 2024-04-23 23:06:10.135 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1>
[DEBUG] 2024-04-23 23:06:10.135 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 1>
[DEBUG] 2024-04-23 23:06:10.135 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 1>
[DEBUG] 2024-04-23 23:06:10.135 [main] TxnUtils - Going to execute queries in batch. Batch size: 4
[DEBUG] 2024-04-23 23:06:10.143 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:06:10.143 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:06:10.143 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:06:10.143 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:1
[DEBUG] 2024-04-23 23:06:10.143 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.143 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.144 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:10.144 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.144 [main] PerfLogger - </PERFLOG method=commit_txn start=1713909970124 end=1713909970144 duration=20 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:10.144 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:06:10.147 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:10.147 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:10.149 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:06:10.149 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:06:10.149 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:06:10.150 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:06:10.150 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:06:10.150 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:06:10.150 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:06:10.150 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:06:10.151 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:06:10.151 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:06:10.151 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:06:10.151 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:06:10.151 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:06:10.157 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.158 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:06:10.160 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:06:10.162 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:06:10.162 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:06:10.170 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1),(2, 1),(3, 1)>
[INFO ] 2024-04-23 23:06:10.170 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1, 2, 3]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:06:10.170 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.170 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.170 [main] PerfLogger - </PERFLOG method=open_txns start=1713909970157 end=1713909970170 duration=13 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.171 [main] PerfLogger - <PERFLOG method=allocate_table_write_ids from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.171 [main] TxnHandler - Going to execute query <SELECT COUNT(*) FROM "TXNS" WHERE "TXN_STATE" = 'o' AND "TXN_TYPE" != 2 AND "TXN_ID" in (1,2,3)>
[DEBUG] 2024-04-23 23:06:10.176 [main] TxnHandler - Going to execute query <SELECT "T2W_TXNID", "T2W_WRITEID" FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE" = 'db' AND "T2W_TABLE" = 'tbl' AND "T2W_TXNID" in (1,2,3)>
[DEBUG] 2024-04-23 23:06:10.178 [main] TxnHandler - Going to execute query <SELECT "NWI_NEXT" FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE" = 'db' AND "NWI_TABLE" = 'tbl'>
[DEBUG] 2024-04-23 23:06:10.179 [main] TxnHandler - Going to execute insert <INSERT INTO "NEXT_WRITE_ID" ("NWI_DATABASE", "NWI_TABLE", "NWI_NEXT") VALUES ('db', 'tbl', 4)>
[INFO ] 2024-04-23 23:06:10.182 [main] TxnHandler - Allocated writeId: 1 for txnId: 1
[INFO ] 2024-04-23 23:06:10.182 [main] TxnHandler - Allocated writeId: 2 for txnId: 2
[INFO ] 2024-04-23 23:06:10.182 [main] TxnHandler - Allocated writeId: 3 for txnId: 3
[DEBUG] 2024-04-23 23:06:10.182 [main] TxnHandler - Executing a batch of <INSERT INTO "TXN_TO_WRITE_ID" ("T2W_TXNID", "T2W_DATABASE", "T2W_TABLE", "T2W_WRITEID") VALUES (?, ?, ?, ?)> queries. Batch size: 3
[INFO ] 2024-04-23 23:06:10.182 [main] TxnHandler - Allocated write ids for dbName=db, tblName=tbl (txnIds: [1, 2, 3])
[DEBUG] 2024-04-23 23:06:10.184 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.184 [main] PerfLogger - </PERFLOG method=allocate_table_write_ids start=1713909970171 end=1713909970184 duration=13 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.184 [main] PerfLogger - <PERFLOG method=abort_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.186 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:06:10.186 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:06:10.186 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:06:10.186 [main] TxnHandler - Going to execute select <SELECT "RTM_REPL_POLICY" FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:06:10.187 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'a' WHERE "TXN_STATE" = 'o' AND ("TXN_ID" in (1))>
[DEBUG] 2024-04-23 23:06:10.187 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:06:10.187 [main] TxnUtils - Adding query to batch: <DELETE FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:06:10.187 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:06:10.189 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.190 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.190 [main] PerfLogger - </PERFLOG method=abort_txn start=1713909970184 end=1713909970190 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.190 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.190 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:06:10.193 [main] TxnHandler - Got OpenTxnList with hwm: 3 and openTxnList size 3.
[DEBUG] 2024-04-23 23:06:10.193 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:10.193 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.193 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713909970190 end=1713909970193 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.193 [main] PerfLogger - <PERFLOG method=get_valid_write_ids from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.195 [main] TxnHandler - Going to execute query<SELECT MAX("T2W_WRITEID") FROM "TXN_TO_WRITE_ID" WHERE "T2W_TXNID" <= 3 AND "T2W_DATABASE" = 'db' AND "T2W_TABLE" = 'tbl'>
[DEBUG] 2024-04-23 23:06:10.198 [main] TxnHandler - Going to execute query<SELECT "T2W_TXNID", "T2W_WRITEID" FROM "TXN_TO_WRITE_ID" WHERE "T2W_WRITEID" <= 3 AND "T2W_DATABASE" = 'db' AND "T2W_TABLE" = 'tbl' ORDER BY "T2W_WRITEID" ASC>
[DEBUG] 2024-04-23 23:06:10.201 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:10.201 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.201 [main] PerfLogger - </PERFLOG method=get_valid_write_ids start=1713909970193 end=1713909970201 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.202 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.206 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 3 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:06:10.208 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
[DEBUG] 2024-04-23 23:06:10.208 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 3>
[DEBUG] 2024-04-23 23:06:10.208 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 3>
[DEBUG] 2024-04-23 23:06:10.208 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 3>
[DEBUG] 2024-04-23 23:06:10.209 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:06:10.215 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (3)>
[DEBUG] 2024-04-23 23:06:10.215 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:06:10.217 [main] TxnHandler - Removed transactions: ([3]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:06:10.217 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:3
[DEBUG] 2024-04-23 23:06:10.217 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.217 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.218 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:10.218 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.218 [main] PerfLogger - </PERFLOG method=commit_txn start=1713909970202 end=1713909970218 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.218 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.218 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:06:10.218 [main] TxnHandler - Got OpenTxnList with hwm: 3 and openTxnList size 2.
[DEBUG] 2024-04-23 23:06:10.218 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:10.218 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.218 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713909970218 end=1713909970218 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.219 [main] PerfLogger - <PERFLOG method=get_valid_write_ids from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.219 [main] TxnHandler - Going to execute query<SELECT MAX("T2W_WRITEID") FROM "TXN_TO_WRITE_ID" WHERE "T2W_TXNID" <= 3 AND "T2W_DATABASE" = 'db' AND "T2W_TABLE" = 'tbl'>
[DEBUG] 2024-04-23 23:06:10.219 [main] TxnHandler - Going to execute query<SELECT "T2W_TXNID", "T2W_WRITEID" FROM "TXN_TO_WRITE_ID" WHERE "T2W_WRITEID" <= 3 AND "T2W_DATABASE" = 'db' AND "T2W_TABLE" = 'tbl' ORDER BY "T2W_WRITEID" ASC>
[DEBUG] 2024-04-23 23:06:10.219 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:10.219 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.219 [main] PerfLogger - </PERFLOG method=get_valid_write_ids start=1713909970219 end=1713909970219 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:10.220 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:06:10.223 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:10.223 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:10.225 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:06:10.225 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:06:10.226 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:06:10.226 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:06:10.226 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:06:10.226 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:06:10.227 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:06:10.227 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:06:10.227 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:06:10.227 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:06:10.227 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:06:10.227 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:06:10.228 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:06:10.234 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.234 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:06:10.236 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:06:10.238 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:06:10.239 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:06:10.246 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1),(2, 1),(3, 1)>
[INFO ] 2024-04-23 23:06:10.246 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1, 2, 3]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:06:10.246 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.246 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.246 [main] PerfLogger - </PERFLOG method=open_txns start=1713909970234 end=1713909970246 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.246 [main] PerfLogger - <PERFLOG method=abort_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.248 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:06:10.248 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:06:10.249 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:06:10.249 [main] TxnHandler - Going to execute select <SELECT "RTM_REPL_POLICY" FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:06:10.249 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'a' WHERE "TXN_STATE" = 'o' AND ("TXN_ID" in (1))>
[DEBUG] 2024-04-23 23:06:10.249 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:06:10.249 [main] TxnUtils - Adding query to batch: <DELETE FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:06:10.249 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:06:10.251 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.252 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.252 [main] PerfLogger - </PERFLOG method=abort_txn start=1713909970246 end=1713909970252 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.252 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.254 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 2 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:06:10.254 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
[DEBUG] 2024-04-23 23:06:10.254 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 2>
[DEBUG] 2024-04-23 23:06:10.254 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 2>
[DEBUG] 2024-04-23 23:06:10.254 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 2>
[DEBUG] 2024-04-23 23:06:10.254 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:06:10.257 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (2)>
[DEBUG] 2024-04-23 23:06:10.257 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:06:10.257 [main] TxnHandler - Removed transactions: ([2]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:06:10.257 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:2
[DEBUG] 2024-04-23 23:06:10.257 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.257 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.257 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:10.257 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.258 [main] PerfLogger - </PERFLOG method=commit_txn start=1713909970252 end=1713909970258 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.258 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.258 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:06:10.260 [main] TxnHandler - Got OpenTxnList with hwm: 3 and openTxnList size 2.
[DEBUG] 2024-04-23 23:06:10.260 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:10.260 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.260 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713909970258 end=1713909970260 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:10.261 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:06:10.263 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:10.264 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:10.265 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:06:10.266 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:06:10.266 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:06:10.266 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:06:10.266 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:06:10.266 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:06:10.267 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:06:10.267 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:06:10.267 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:06:10.267 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:06:10.267 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:06:10.267 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:06:10.267 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:06:10.274 [main] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.274 [main] HMSHandler - 0: create_database: Database(name:mydbKeyValue, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:06:10.274 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:mydbKeyValue, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[DEBUG] 2024-04-23 23:06:10.274 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:10.275 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:10.275 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:10.275 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.275 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.283286ms
[DEBUG] 2024-04-23 23:06:10.275 [main] ObjectStore - Failed to get database hive.mydbKeyValue, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:06:10.276 [main] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:06:10.276 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:10.279 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:10.279 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.279 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[INFO ] 2024-04-23 23:06:10.280 [main] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db
[INFO ] 2024-04-23 23:06:10.280 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db
[INFO ] 2024-04-23 23:06:10.283 [main] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db
[DEBUG] 2024-04-23 23:06:10.283 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:10.283 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.285 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.285 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:10.287 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.287 [main] PerfLogger - </PERFLOG method=create_database start=1713909970274 end=1713909970287 duration=13 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.287 [main] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.287 [main] HMSHandler - 0: create_table_req: Table(tableName:mytable, dbName:mydbKeyValue, owner:alex, createTime:1713909970, lastAccessTime:1713909970, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:06:10.287 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:mytable, dbName:mydbKeyValue, owner:alex, createTime:1713909970, lastAccessTime:1713909970, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:06:10.287 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:10.291 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:10.291 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:10.291 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:10.291 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.291 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 4.045884ms
[DEBUG] 2024-04-23 23:06:10.291 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:10.291 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.291 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 23:06:10.296 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.296 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:10.296 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.296 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:10.296 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.298 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:10.298 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:10.298 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.298 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.675114ms
[DEBUG] 2024-04-23 23:06:10.298 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.298 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:10.298 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 23:06:10.299 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:10.300 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:06:10.300 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvalue.db/mytable
[DEBUG] 2024-04-23 23:06:10.306 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.306 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:10.310 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:10.326 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.326 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:10.328 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.330 [main] PerfLogger - </PERFLOG method=create_table_req start=1713909970287 end=1713909970330 duration=43 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.330 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.330 [main] HMSHandler - 0: get_table : tbl=hive.mydbKeyValue.mytable
[INFO ] 2024-04-23 23:06:10.330 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.mydbKeyValue.mytable	
[DEBUG] 2024-04-23 23:06:10.330 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:10.331 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:10.332 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:10.332 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:10.332 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.332 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.923692ms
[DEBUG] 2024-04-23 23:06:10.332 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:10.332 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.332 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 23:06:10.345 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.388 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:10.392 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:10.394 [main] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:06:10.394 [main] PerfLogger - </PERFLOG method=get_table_req start=1713909970330 end=1713909970394 duration=64 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.394 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=64, comments=HMS client
[DEBUG] 2024-04-23 23:06:10.397 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.397 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:06:10.399 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:06:10.403 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:06:10.403 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:06:10.408 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:06:10.410 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:06:10.410 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.410 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.410 [main] PerfLogger - </PERFLOG method=open_txns start=1713909970397 end=1713909970410 duration=13 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.410 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.413 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:06:10.416 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
[DEBUG] 2024-04-23 23:06:10.416 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1>
[DEBUG] 2024-04-23 23:06:10.416 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 1>
[DEBUG] 2024-04-23 23:06:10.416 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 1>
[DEBUG] 2024-04-23 23:06:10.416 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:06:10.420 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:06:10.420 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:06:10.420 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:06:10.420 [main] TxnHandler - Going to execute update <UPDATE "TABLE_PARAMS" SET "PARAM_VALUE" = 'myvalue' WHERE "TBL_ID" = 2 AND "PARAM_KEY" = '_metamykey'>
[WARN ] 2024-04-23 23:06:10.423 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:1
[DEBUG] 2024-04-23 23:06:10.423 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.423 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.423 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:10.423 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.424 [main] PerfLogger - </PERFLOG method=commit_txn start=1713909970410 end=1713909970423 duration=13 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.424 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.424 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:06:10.426 [main] TxnHandler - Got OpenTxnList with hwm: 1 and openTxnList size 0.
[DEBUG] 2024-04-23 23:06:10.427 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:10.427 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.427 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713909970424 end=1713909970427 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.429 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.429 [main] HMSHandler - 0: get_table : tbl=hive.mydbKeyValue.mytable
[INFO ] 2024-04-23 23:06:10.429 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.mydbKeyValue.mytable	
[DEBUG] 2024-04-23 23:06:10.429 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:10.431 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:10.432 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:10.432 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:10.432 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.432 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 2.938473ms
[DEBUG] 2024-04-23 23:06:10.432 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:10.432 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.432 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 23:06:10.437 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.443 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:10.445 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:10.447 [main] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:06:10.447 [main] PerfLogger - </PERFLOG method=get_table_req start=1713909970429 end=1713909970447 duration=18 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.447 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=18, comments=HMS client
[DEBUG] 2024-04-23 23:06:10.447 [main] PerfLogger - <PERFLOG method=drop_table_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.447 [main] HMSHandler - 0: drop_table : tbl=hive.mydbKeyValue.mytable
[INFO ] 2024-04-23 23:06:10.447 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.mydbKeyValue.mytable	
[DEBUG] 2024-04-23 23:06:10.447 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:10.447 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.448 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:10.449 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:10.449 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.449 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.511986ms
[DEBUG] 2024-04-23 23:06:10.449 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.450 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:10.450 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:10.451 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.451 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.707234ms
[DEBUG] 2024-04-23 23:06:10.451 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.451 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:10.451 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 23:06:10.454 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:10.458 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.458 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.461 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.461 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.461 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:06:10.465 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:06:10.465 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.466 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.475 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.475 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.475 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:10.475 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 23:06:10.477 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:10.477 [main] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:06:10.477 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:10.482 [main] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:06:10.482 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:10.482 [main] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:06:10.483 [main] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:06:10.483 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:10.488 [main] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:06:10.488 [main] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:06:10.488 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:10.488 [main] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:06:10.488 [main] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:06:10.489 [main] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:06:10.489 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:10.495 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:10.495 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:06:10.496 [main] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:06:10.496 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:10.502 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:10.502 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:06:10.503 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:10.503 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:06:10.503 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 23:06:10.504 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:06:10.508 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:10.512 [main] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:06:10.512 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:10.512 [main] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:06:10.524 [main] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:06:10.524 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:10.560 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.560 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:10.562 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.562 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvalue
[DEBUG] 2024-04-23 23:06:10.562 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvalue
[DEBUG] 2024-04-23 23:06:10.563 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvalue.db/mytable
[DEBUG] 2024-04-23 23:06:10.563 [main] PerfLogger - </PERFLOG method=drop_table_with_environment_context start=1713909970447 end=1713909970563 duration=116 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.563 [main] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.563 [main] HMSHandler - 0: get_database: mydbKeyValue
[INFO ] 2024-04-23 23:06:10.563 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_database: mydbKeyValue	
[DEBUG] 2024-04-23 23:06:10.563 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:10.565 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:10.565 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:10.565 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:10.565 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.565 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 2.052281ms
[DEBUG] 2024-04-23 23:06:10.565 [main] PerfLogger - </PERFLOG method=get_database_req start=1713909970563 end=1713909970565 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.565 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:06:10.566 [main] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.566 [main] HMSHandler - 0: drop_database: @hive#mydbKeyValue
[INFO ] 2024-04-23 23:06:10.566 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#mydbKeyValue	
[DEBUG] 2024-04-23 23:06:10.566 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:10.566 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.567 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:10.567 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:10.567 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.567 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.593492ms
[DEBUG] 2024-04-23 23:06:10.567 [main] HMSHandler - 0: get_all_tables: db=@hive#mydbKeyValue
[INFO ] 2024-04-23 23:06:10.567 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#mydbKeyValue	
[DEBUG] 2024-04-23 23:06:10.568 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.570 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:10.570 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.570 [main] ObjectStore - 0 entries retrieved using SQL in 2.848016ms
[DEBUG] 2024-04-23 23:06:10.570 [main] HMSHandler - 0: get_functions: db=@hive#mydbKeyValue pat=*
[INFO ] 2024-04-23 23:06:10.570 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#mydbKeyValue pat=*	
[DEBUG] 2024-04-23 23:06:10.571 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.576 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.576 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:06:10.576 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:06:10.576 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.580 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.580 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:06:10.580 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:06:10.580 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.584 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.584 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=mydbKeyValue pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:06:10.584 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=mydbKeyValue pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:06:10.584 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.586 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:10.586 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:10.586 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.586 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.590697ms
[DEBUG] 2024-04-23 23:06:10.586 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.589 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:10.589 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.589 [main] ObjectStore - 0 entries retrieved using SQL in 3.391128ms
[INFO ] 2024-04-23 23:06:10.590 [main] ObjectStore - Dropping database hive.mydbKeyValue along with all tables
[DEBUG] 2024-04-23 23:06:10.590 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.590 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:10.593 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:10.594 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:06:10.597 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:06:10.601 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.603 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:10.603 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.603 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 23:06:10.605 [main] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 23:06:10.607 [main] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 23:06:10.609 [main] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 23:06:10.611 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 23:06:10.613 [main] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 23:06:10.615 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.615 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.616 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:10.616 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.617 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:06:10.617 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvalue
[DEBUG] 2024-04-23 23:06:10.617 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvalue.db
[DEBUG] 2024-04-23 23:06:10.618 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:06:10.618 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvalue
[DEBUG] 2024-04-23 23:06:10.618 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db
[DEBUG] 2024-04-23 23:06:10.619 [main] PerfLogger - </PERFLOG method=drop_database start=1713909970566 end=1713909970619 duration=53 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:10.621 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:06:10.625 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:10.627 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:10.629 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:06:10.630 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:06:10.632 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:06:10.633 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:06:10.635 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:06:10.636 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:06:10.638 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:06:10.640 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:06:10.641 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:06:10.643 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:06:10.645 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:06:10.646 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:06:10.648 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:06:10.657 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.657 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:06:10.659 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:06:10.662 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:06:10.662 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:06:10.665 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:06:10.665 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:06:10.665 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.665 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.665 [main] PerfLogger - </PERFLOG method=open_txns start=1713909970657 end=1713909970665 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.665 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.669 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:06:10.669 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
[DEBUG] 2024-04-23 23:06:10.669 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1>
[DEBUG] 2024-04-23 23:06:10.669 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 1>
[DEBUG] 2024-04-23 23:06:10.669 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 1>
[DEBUG] 2024-04-23 23:06:10.669 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:06:10.675 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:06:10.675 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:06:10.675 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:06:10.675 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:1
[DEBUG] 2024-04-23 23:06:10.675 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.675 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.675 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:10.676 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.676 [main] PerfLogger - </PERFLOG method=commit_txn start=1713909970665 end=1713909970676 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.676 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.676 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:06:10.678 [main] TxnHandler - Got OpenTxnList with hwm: 1 and openTxnList size 0.
[DEBUG] 2024-04-23 23:06:10.678 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:10.678 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.678 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713909970676 end=1713909970678 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:10.678 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:06:10.694 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:10.694 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:10.696 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:06:10.697 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:06:10.697 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:06:10.697 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:06:10.697 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:06:10.698 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:06:10.698 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:06:10.698 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:06:10.698 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:06:10.698 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:06:10.698 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:06:10.698 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:06:10.699 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:06:10.705 [main] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.705 [main] HMSHandler - 0: create_database: Database(name:mydb, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:06:10.705 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:mydb, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[DEBUG] 2024-04-23 23:06:10.705 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:10.706 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:10.706 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:10.706 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.706 [main] ObjectStore - db details for db mydb retrieved using SQL in 1.270062ms
[DEBUG] 2024-04-23 23:06:10.706 [main] ObjectStore - Failed to get database hive.mydb, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:06:10.706 [main] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:06:10.706 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:10.709 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:10.710 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.710 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[WARN ] 2024-04-23 23:06:10.711 [main] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydb.db for database mydb. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:06:10.711 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:10.711 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.713 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.713 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:10.714 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.715 [main] PerfLogger - </PERFLOG method=create_database start=1713909970705 end=1713909970715 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.715 [main] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.715 [main] HMSHandler - 0: create_table_req: Table(tableName:mytable, dbName:mydb, owner:alex, createTime:1713909970, lastAccessTime:1713909970, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:06:10.715 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:mytable, dbName:mydb, owner:alex, createTime:1713909970, lastAccessTime:1713909970, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:06:10.715 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:10.716 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydb locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydb.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:10.717 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:10.717 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:10.717 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.717 [main] ObjectStore - db details for db mydb retrieved using SQL in 1.976685ms
[DEBUG] 2024-04-23 23:06:10.717 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:10.717 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.717 [main] ObjectStore - Executing getMTable for hive.mydb.mytable
[DEBUG] 2024-04-23 23:06:10.721 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.721 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:10.721 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.721 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:10.721 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.723 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydb locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydb.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:10.723 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:10.723 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.723 [main] ObjectStore - db details for db mydb retrieved using SQL in 1.612265ms
[DEBUG] 2024-04-23 23:06:10.723 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.723 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:10.723 [main] ObjectStore - Executing getMTable for hive.mydb.mytable
[DEBUG] 2024-04-23 23:06:10.724 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:10.724 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:06:10.726 [main] MetaStoreServerUtils - Updating table stats for mytable
[INFO ] 2024-04-23 23:06:10.726 [main] MetaStoreServerUtils - Updated size of table mytable to 0
[DEBUG] 2024-04-23 23:06:10.726 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.726 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:06:10.727 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:06:10.745 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.745 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:10.748 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.750 [main] PerfLogger - </PERFLOG method=create_table_req start=1713909970715 end=1713909970750 duration=35 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.750 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.750 [main] HMSHandler - 0: get_table : tbl=hive.mydb.mytable
[INFO ] 2024-04-23 23:06:10.750 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.mydb.mytable	
[DEBUG] 2024-04-23 23:06:10.750 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:10.751 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydb locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydb.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:06:10.752 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:06:10.752 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:10.752 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.752 [main] ObjectStore - db details for db mydb retrieved using SQL in 1.934312ms
[DEBUG] 2024-04-23 23:06:10.752 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:06:10.752 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:06:10.752 [main] ObjectStore - Executing getMTable for hive.mydb.mytable
[DEBUG] 2024-04-23 23:06:10.762 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:06:10.790 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:06:10.792 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1791014677 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:06:10.793 [main] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:06:10.793 [main] PerfLogger - </PERFLOG method=get_table_req start=1713909970750 end=1713909970793 duration=43 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.793 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=43, comments=HMS client
[DEBUG] 2024-04-23 23:06:10.793 [main] PerfLogger - <PERFLOG method=compact2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.794 [main] TxnHandler - About to execute SQL: SELECT "MT_COMMENT" FROM "AUX_TABLE" WHERE "MT_KEY1"='CompactionScheduler' and "MT_KEY2"=0
[DEBUG] 2024-04-23 23:06:10.797 [main] TxnHandler - 'CompactionScheduler' locked by 'Lenovo-Bot'
[DEBUG] 2024-04-23 23:06:10.797 [main] TxnHandler - going to execute query <SELECT "NCQ_NEXT" FROM "NEXT_COMPACTION_QUEUE_ID">
[DEBUG] 2024-04-23 23:06:10.799 [main] TxnHandler - Going to execute update <UPDATE "NEXT_COMPACTION_QUEUE_ID" SET "NCQ_NEXT" = 2>
[DEBUG] 2024-04-23 23:06:10.803 [main] TxnHandler - Going to execute query <SELECT "CQ_ID", "CQ_STATE" FROM "COMPACTION_QUEUE" WHERE "CQ_STATE" IN('i','w') AND "CQ_DATABASE"=? AND "CQ_TABLE"=? AND "CQ_PARTITION" is null>
[DEBUG] 2024-04-23 23:06:10.806 [main] TxnHandler - Going to execute update <INSERT INTO "COMPACTION_QUEUE" ("CQ_ID", "CQ_DATABASE", "CQ_TABLE", "CQ_STATE", "CQ_TYPE", "CQ_ENQUEUE_TIME", "CQ_TBLPROPERTIES", "CQ_INITIATOR_ID") values (1, ?, ?, 'i', 'i',{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000, ?, ?)>
[DEBUG] 2024-04-23 23:06:10.806 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.808 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.808 [main] PoolBase - HikariPool-3 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@332139408 (XID = 1566), (SESSIONID = 27), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.808 [main] TxnHandler - 'CompactionScheduler' unlocked by 'Lenovo-Bot'
[DEBUG] 2024-04-23 23:06:10.808 [main] PerfLogger - </PERFLOG method=compact2 start=1713909970793 end=1713909970808 duration=15 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.808 [main] PerfLogger - <PERFLOG method=find_next_compact2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.808 [main] CompactionTxnHandler - Going to execute query <SELECT "CQ_ID", "CQ_DATABASE", "CQ_TABLE", "CQ_PARTITION", "CQ_TYPE", "CQ_TBLPROPERTIES" FROM "COMPACTION_QUEUE" WHERE "CQ_STATE" = 'i'>
[DEBUG] 2024-04-23 23:06:10.811 [main] TxnHandler - Going to execute query <values current_timestamp>
[DEBUG] 2024-04-23 23:06:10.812 [main] CompactionTxnHandler - Going to execute update <UPDATE   "COMPACTION_QUEUE" SET  "CQ_WORKER_ID" = 'myworker',  "CQ_WORKER_VERSION" = 'null',  "CQ_START" = 1713909970812,  "CQ_STATE" = 'w' WHERE "CQ_ID" = 1  AND "CQ_STATE"='i'>
[DEBUG] 2024-04-23 23:06:10.814 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.815 [main] PerfLogger - </PERFLOG method=find_next_compact2 start=1713909970808 end=1713909970815 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.815 [main] PerfLogger - <PERFLOG method=mark_cleaned from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.816 [main] CompactionTxnHandler - Running markCleaned with CompactionInfo: id:1,dbname:mydb,tableName:mytable,partName:null,state: ,type:MINOR,enqueueTime:0,start:0,properties:0:,runAs:null,tooManyAborts:false,hasOldAbort:false,highestWriteId:0,errorMessage:null,workerId: null,initiatorId: null
[DEBUG] 2024-04-23 23:06:10.818 [main] CompactionTxnHandler - Going to execute update <INSERT INTO "COMPLETED_COMPACTIONS"("CC_ID", "CC_DATABASE", "CC_TABLE", "CC_PARTITION", "CC_STATE", "CC_TYPE", "CC_TBLPROPERTIES", "CC_WORKER_ID", "CC_START", "CC_END", "CC_RUN_AS", "CC_HIGHEST_WRITE_ID", "CC_META_INFO", "CC_HADOOP_JOB_ID", "CC_ERROR_MESSAGE", "CC_ENQUEUE_TIME", "CC_WORKER_VERSION", "CC_INITIATOR_ID", "CC_INITIATOR_VERSION") SELECT "CQ_ID", "CQ_DATABASE", "CQ_TABLE", "CQ_PARTITION", 's', "CQ_TYPE", "CQ_TBLPROPERTIES", "CQ_WORKER_ID", "CQ_START", { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000, "CQ_RUN_AS", "CQ_HIGHEST_WRITE_ID", "CQ_META_INFO", "CQ_HADOOP_JOB_ID", "CQ_ERROR_MESSAGE", "CQ_ENQUEUE_TIME", "CQ_WORKER_VERSION", "CQ_INITIATOR_ID", "CQ_INITIATOR_VERSION"FROM "COMPACTION_QUEUE" WHERE "CQ_ID" = ?> for CQ_ID=1
[DEBUG] 2024-04-23 23:06:10.820 [main] CompactionTxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_ID" = ?>
[DEBUG] 2024-04-23 23:06:10.822 [main] CompactionTxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE" = ? AND "CTC_TABLE" = ?>
[WARN ] 2024-04-23 23:06:10.822 [main] CompactionTxnHandler - Expected to remove at least one row from completed_txn_components when marking compaction entry as clean!
[DEBUG] 2024-04-23 23:06:10.822 [main] CompactionTxnHandler - Removed 0 records from completed_txn_components
[DEBUG] 2024-04-23 23:06:10.823 [main] CompactionTxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" IN ( SELECT "TXN_ID" FROM "TXNS" WHERE "TXN_STATE" = 'a') AND "TC_DATABASE" = ? AND "TC_TABLE" = ? AND "TC_PARTITION" IS NULL>
[DEBUG] 2024-04-23 23:06:10.825 [main] CompactionTxnHandler - Removed 0 records from txn_components
[DEBUG] 2024-04-23 23:06:10.825 [main] CompactionTxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.826 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.826 [main] PerfLogger - </PERFLOG method=mark_cleaned start=1713909970815 end=1713909970826 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.826 [main] PerfLogger - <PERFLOG method=get_latest_committed_compaction_info from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[ERROR] 2024-04-23 23:06:10.828 [main] RetryingHMSHandler - MetaException(message:Database name and table name cannot be null.)
	at org.apache.hadoop.hive.metastore.HMSHandler.get_latest_committed_compaction_info(HMSHandler.java:8811)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.get_latest_committed_compaction_info(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.getLatestCommittedCompactionInfo(HiveMetaStoreClient.java:4155)
	at org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.lambda$testGetLatestCommittedCompactionInfo$0(TestHiveMetaStoreTxns.java:432)
	at org.junit.Assert.assertThrows(Assert.java:1001)
	at org.junit.Assert.assertThrows(Assert.java:981)
	at org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.testGetLatestCommittedCompactionInfo(TestHiveMetaStoreTxns.java:432)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

[DEBUG] 2024-04-23 23:06:10.828 [main] PerfLogger - </PERFLOG method=get_latest_committed_compaction_info start=1713909970826 end=1713909970828 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 23:06:10.828 [main] PerfLogger - <PERFLOG method=get_latest_committed_compaction_info from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.832 [main] TxnHandler - Going to execute query <SELECT * FROM (   SELECT   "CC_ID", "CC_DATABASE", "CC_TABLE", "CC_PARTITION", "CC_TYPE"   FROM "COMPLETED_COMPACTIONS"     WHERE "CC_STATE" = 's'   UNION ALL   SELECT   "CQ_ID" AS "CC_ID", "CQ_DATABASE" AS "CC_DATABASE"   ,"CQ_TABLE" AS "CC_TABLE", "CQ_PARTITION" AS "CC_PARTITION"   ,"CQ_TYPE" AS "CC_TYPE"   FROM "COMPACTION_QUEUE"     WHERE "CQ_STATE" = 'r') AS compactions  WHERE "CC_DATABASE"=? AND "CC_TABLE"=? AND "CC_PARTITION" IS NULL ORDER BY "CC_ID" DESC>
[DEBUG] 2024-04-23 23:06:10.833 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:10.833 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.833 [main] PerfLogger - </PERFLOG method=get_latest_committed_compaction_info start=1713909970828 end=1713909970833 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.833 [main] PerfLogger - <PERFLOG method=get_latest_committed_compaction_info from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.833 [main] TxnHandler - Going to execute query <SELECT * FROM (   SELECT   "CC_ID", "CC_DATABASE", "CC_TABLE", "CC_PARTITION", "CC_TYPE"   FROM "COMPLETED_COMPACTIONS"     WHERE "CC_STATE" = 's'   UNION ALL   SELECT   "CQ_ID" AS "CC_ID", "CQ_DATABASE" AS "CC_DATABASE"   ,"CQ_TABLE" AS "CC_TABLE", "CQ_PARTITION" AS "CC_PARTITION"   ,"CQ_TYPE" AS "CC_TYPE"   FROM "COMPACTION_QUEUE"     WHERE "CQ_STATE" = 'r') AS compactions  WHERE "CC_DATABASE"=? AND "CC_TABLE"=? AND "CC_PARTITION" IS NULL ORDER BY "CC_ID" DESC>
[DEBUG] 2024-04-23 23:06:10.833 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:10.833 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.833 [main] PerfLogger - </PERFLOG method=get_latest_committed_compaction_info start=1713909970833 end=1713909970833 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:10.833 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:06:10.836 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:10.836 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:10.838 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:06:10.838 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:06:10.839 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:06:10.839 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:06:10.839 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:06:10.839 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:06:10.839 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:06:10.840 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:06:10.840 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:06:10.840 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:06:10.841 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:06:10.841 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:06:10.841 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:06:10.847 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.847 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:06:10.849 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:06:10.851 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:06:10.851 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:06:10.853 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:06:10.853 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:06:10.853 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.854 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.854 [main] PerfLogger - </PERFLOG method=open_txns start=1713909970847 end=1713909970854 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.854 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.854 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:06:10.854 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:06:10.854 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 1, lowWaterMark 0
[DEBUG] 2024-04-23 23:06:10.854 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:06:10.858 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(2, 1),(3, 1),(4, 1)>
[INFO ] 2024-04-23 23:06:10.860 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([2, 3, 4]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:06:10.860 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.860 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.860 [main] PerfLogger - </PERFLOG method=open_txns start=1713909970854 end=1713909970860 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.861 [main] PerfLogger - <PERFLOG method=abort_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.862 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (2)>
[DEBUG] 2024-04-23 23:06:10.862 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:06:10.864 [main] TxnHandler - Removed transactions: ([2]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:06:10.864 [main] TxnHandler - Going to execute select <SELECT "RTM_REPL_POLICY" FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (2)>
[DEBUG] 2024-04-23 23:06:10.866 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'a' WHERE "TXN_STATE" = 'o' AND ("TXN_ID" in (2))>
[DEBUG] 2024-04-23 23:06:10.866 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" in (2)>
[DEBUG] 2024-04-23 23:06:10.866 [main] TxnUtils - Adding query to batch: <DELETE FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (2)>
[DEBUG] 2024-04-23 23:06:10.866 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:06:10.872 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.872 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.872 [main] PerfLogger - </PERFLOG method=abort_txn start=1713909970861 end=1713909970872 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.872 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.876 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 3 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:06:10.878 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
[DEBUG] 2024-04-23 23:06:10.878 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 3>
[DEBUG] 2024-04-23 23:06:10.878 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 3>
[DEBUG] 2024-04-23 23:06:10.878 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 3>
[DEBUG] 2024-04-23 23:06:10.878 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:06:10.884 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (3)>
[DEBUG] 2024-04-23 23:06:10.884 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:06:10.886 [main] TxnHandler - Removed transactions: ([3]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:06:10.886 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:3
[DEBUG] 2024-04-23 23:06:10.886 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.886 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.886 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:10.886 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.886 [main] PerfLogger - </PERFLOG method=commit_txn start=1713909970872 end=1713909970886 duration=14 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:06:10.886 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.887 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:06:10.889 [main] TxnHandler - Got OpenTxnList with hwm: 4 and openTxnList size 3.
[DEBUG] 2024-04-23 23:06:10.889 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:06:10.889 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.889 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713909970886 end=1713909970889 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:10.889 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:06:10.892 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:10.892 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:10.894 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:06:10.894 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:06:10.894 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:06:10.894 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:06:10.894 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:06:10.895 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:06:10.895 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:06:10.895 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:06:10.895 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:06:10.895 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:06:10.895 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:06:10.896 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:06:10.896 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:06:10.901 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:06:10.901 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:06:10.903 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:06:10.905 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:06:10.905 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:06:10.908 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:06:10.908 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:06:10.908 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:06:10.909 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1113666007 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:06:10.909 [main] PerfLogger - </PERFLOG method=open_txns start=1713909970901 end=1713909970909 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:06:10.910 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:06:10.912 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:10.913 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:10.914 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:06:10.915 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:06:10.915 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:06:10.915 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:06:10.915 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:06:10.916 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:06:10.916 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:06:10.916 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:06:10.916 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:06:10.916 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:06:10.917 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:06:10.917 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:06:10.917 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[INFO ] 2024-04-23 23:06:10.925 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:06:10.928 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:10.928 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:06:10.930 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:06:10.930 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:06:10.931 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:06:10.931 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:06:10.931 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:06:10.931 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:06:10.932 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:06:10.932 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:06:10.932 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:06:10.933 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:06:10.933 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:06:10.933 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:06:10.933 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:06:10.947 [Thread-15] ShutdownHookManager - ShutdownHookManger complete shutdown.
