<?xml version="1.0" encoding="UTF-8"?>
<testsuite xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://maven.apache.org/surefire/maven-surefire-plugin/xsd/surefire-test-report-3.0.xsd" version="3.0" name="org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup" time="22.224" tests="2" errors="0" skipped="0" failures="1">
  <properties>
    <property name="sun.desktop" value="gnome"/>
    <property name="awt.toolkit" value="sun.awt.X11.XToolkit"/>
    <property name="java.specification.version" value="1.8"/>
    <property name="file.encoding.pkg" value="sun.io"/>
    <property name="nondexStart" value="0"/>
    <property name="sun.cpu.isalist" value=""/>
    <property name="sun.jnu.encoding" value="UTF-8"/>
    <property name="java.class.path" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/test-classes:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/classes:/home/alex/Repositories/hive/standalone-metastore/metastore-common/target/classes:/home/alex/.m2/repository/org/antlr/ST4/4.0.4/ST4-4.0.4.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper/3.5.5/zookeeper-3.5.5.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.5.5/zookeeper-jute-3.5.5.jar:/home/alex/.m2/repository/org/apache/yetus/audience-annotations/0.5.0/audience-annotations-0.5.0.jar:/home/alex/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.8.4/caffeine-2.8.4.jar:/home/alex/.m2/repository/org/checkerframework/checker-qual/3.4.0/checker-qual-3.4.0.jar:/home/alex/.m2/repository/com/google/errorprone/error_prone_annotations/2.3.4/error_prone_annotations-2.3.4.jar:/home/alex/.m2/repository/org/apache/curator/curator-recipes/4.2.0/curator-recipes-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-framework/4.2.0/curator-framework-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-client/4.2.0/curator-client-4.2.0.jar:/home/alex/.m2/repository/org/slf4j/slf4j-api/1.7.30/slf4j-api-1.7.30.jar:/home/alex/.m2/repository/org/apache/orc/orc-core/1.6.9/orc-core-1.6.9.jar:/home/alex/.m2/repository/org/apache/orc/orc-shims/1.6.9/orc-shims-1.6.9.jar:/home/alex/.m2/repository/io/airlift/aircompressor/0.19/aircompressor-0.19.jar:/home/alex/.m2/repository/javax/xml/bind/jaxb-api/2.2.11/jaxb-api-2.2.11.jar:/home/alex/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/alex/.m2/repository/org/threeten/threeten-extra/1.5.0/threeten-extra-1.5.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.12.0/jackson-databind-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.12.0/jackson-annotations-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.12.0/jackson-core-2.12.0.jar:/home/alex/.m2/repository/com/github/joshelser/dropwizard-metrics-hadoop-metrics2-reporter/0.1.2/dropwizard-metrics-hadoop-metrics2-reporter-0.1.2.jar:/home/alex/.m2/repository/com/google/guava/guava/19.0/guava-19.0.jar:/home/alex/.m2/repository/com/google/protobuf/protobuf-java/2.6.1/protobuf-java-2.6.1.jar:/home/alex/.m2/repository/com/zaxxer/HikariCP/2.6.1/HikariCP-2.6.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-dbcp2/2.7.0/commons-dbcp2-2.7.0.jar:/home/alex/.m2/repository/org/apache/commons/commons-pool2/2.7.0/commons-pool2-2.7.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-core/3.1.0/metrics-core-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-jvm/3.1.0/metrics-jvm-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-json/3.1.0/metrics-json-3.1.0.jar:/home/alex/.m2/repository/javolution/javolution/5.5.1/javolution-5.5.1.jar:/home/alex/.m2/repository/org/antlr/antlr-runtime/3.5.2/antlr-runtime-3.5.2.jar:/home/alex/.m2/repository/org/apache/commons/commons-lang3/3.9/commons-lang3-3.9.jar:/home/alex/.m2/repository/org/apache/derby/derby/10.14.1.0/derby-10.14.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-annotations/3.1.0/hadoop-annotations-3.1.0.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/../lib/tools.jar:/home/alex/.m2/repository/commons-cli/commons-cli/1.2/commons-cli-1.2.jar:/home/alex/.m2/repository/org/apache/commons/commons-math3/3.1.1/commons-math3-3.1.1.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpclient/4.5.2/httpclient-4.5.2.jar:/home/alex/.m2/repository/commons-codec/commons-codec/1.11/commons-codec-1.11.jar:/home/alex/.m2/repository/commons-io/commons-io/2.5/commons-io-2.5.jar:/home/alex/.m2/repository/commons-net/commons-net/3.6/commons-net-3.6.jar:/home/alex/.m2/repository/commons-collections/commons-collections/3.2.2/commons-collections-3.2.2.jar:/home/alex/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-server/9.3.19.v20170502/jetty-server-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-http/9.3.19.v20170502/jetty-http-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-io/9.3.19.v20170502/jetty-io-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util/9.3.19.v20170502/jetty-util-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-servlet/9.3.19.v20170502/jetty-servlet-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-security/9.3.19.v20170502/jetty-security-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-webapp/9.3.19.v20170502/jetty-webapp-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-xml/9.3.19.v20170502/jetty-xml-9.3.19.v20170502.jar:/home/alex/.m2/repository/javax/servlet/jsp/jsp-api/2.1/jsp-api-2.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-core/1.19/jersey-core-1.19.jar:/home/alex/.m2/repository/javax/ws/rs/jsr311-api/1.1.1/jsr311-api-1.1.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-servlet/1.19/jersey-servlet-1.19.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-json/1.19/jersey-json-1.19.jar:/home/alex/.m2/repository/org/codehaus/jettison/jettison/1.1/jettison-1.1.jar:/home/alex/.m2/repository/com/sun/xml/bind/jaxb-impl/2.2.3-1/jaxb-impl-2.2.3-1.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-core-asl/1.9.2/jackson-core-asl-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-mapper-asl/1.9.2/jackson-mapper-asl-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-jaxrs/1.9.2/jackson-jaxrs-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-xc/1.9.2/jackson-xc-1.9.2.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-server/1.19/jersey-server-1.19.jar:/home/alex/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/alex/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/alex/.m2/repository/org/apache/commons/commons-configuration2/2.1.1/commons-configuration2-2.1.1.jar:/home/alex/.m2/repository/org/apache/avro/avro/1.7.7/avro-1.7.7.jar:/home/alex/.m2/repository/com/thoughtworks/paranamer/paranamer/2.3/paranamer-2.3.jar:/home/alex/.m2/repository/org/xerial/snappy/snappy-java/1.0.5/snappy-java-1.0.5.jar:/home/alex/.m2/repository/com/google/re2j/re2j/1.1/re2j-1.1.jar:/home/alex/.m2/repository/com/google/code/gson/gson/2.2.4/gson-2.2.4.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-auth/3.1.0/hadoop-auth-3.1.0.jar:/home/alex/.m2/repository/com/nimbusds/nimbus-jose-jwt/4.41.1/nimbus-jose-jwt-4.41.1.jar:/home/alex/.m2/repository/com/github/stephenc/jcip/jcip-annotations/1.0-1/jcip-annotations-1.0-1.jar:/home/alex/.m2/repository/net/minidev/json-smart/2.3/json-smart-2.3.jar:/home/alex/.m2/repository/net/minidev/accessors-smart/1.2/accessors-smart-1.2.jar:/home/alex/.m2/repository/org/ow2/asm/asm/5.0.4/asm-5.0.4.jar:/home/alex/.m2/repository/com/jcraft/jsch/0.1.54/jsch-0.1.54.jar:/home/alex/.m2/repository/com/google/code/findbugs/jsr305/3.0.0/jsr305-3.0.0.jar:/home/alex/.m2/repository/org/apache/htrace/htrace-core4/4.1.0-incubating/htrace-core4-4.1.0-incubating.jar:/home/alex/.m2/repository/org/apache/commons/commons-compress/1.4.1/commons-compress-1.4.1.jar:/home/alex/.m2/repository/org/tukaani/xz/1.0/xz-1.0.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-simplekdc/1.0.1/kerb-simplekdc-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-client/1.0.1/kerb-client-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-config/1.0.1/kerby-config-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-core/1.0.1/kerb-core-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-pkix/1.0.1/kerby-pkix-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-asn1/1.0.1/kerby-asn1-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-util/1.0.1/kerby-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-common/1.0.1/kerb-common-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-crypto/1.0.1/kerb-crypto-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-util/1.0.1/kerb-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/token-provider/1.0.1/token-provider-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-admin/1.0.1/kerb-admin-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-server/1.0.1/kerb-server-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-identity/1.0.1/kerb-identity-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-xdr/1.0.1/kerby-xdr-1.0.1.jar:/home/alex/.m2/repository/org/codehaus/woodstox/stax2-api/3.1.4/stax2-api-3.1.4.jar:/home/alex/.m2/repository/com/fasterxml/woodstox/woodstox-core/5.0.3/woodstox-core-5.0.3.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-distcp/3.1.0/hadoop-distcp-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs/3.1.0/hadoop-hdfs-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.3.19.v20170502/jetty-util-ajax-9.3.19.v20170502.jar:/home/alex/.m2/repository/commons-daemon/commons-daemon/1.0.13/commons-daemon-1.0.13.jar:/home/alex/.m2/repository/org/fusesource/leveldbjni/leveldbjni-all/1.8/leveldbjni-all-1.8.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.1.0/hadoop-hdfs-client-3.1.0.jar:/home/alex/.m2/repository/com/squareup/okhttp/okhttp/2.7.5/okhttp-2.7.5.jar:/home/alex/.m2/repository/com/squareup/okio/okio/1.6.0/okio-1.6.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-core/3.1.0/hadoop-mapreduce-client-core-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-client/3.1.0/hadoop-yarn-client-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-api/3.1.0/hadoop-yarn-api-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-common/3.1.0/hadoop-yarn-common-3.1.0.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-client/1.19/jersey-client-1.19.jar:/home/alex/.m2/repository/com/google/inject/guice/4.0/guice-4.0.jar:/home/alex/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/alex/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/alex/.m2/repository/com/sun/jersey/contribs/jersey-guice/1.19/jersey-guice-1.19.jar:/home/alex/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.12.0/jackson-module-jaxb-annotations-2.12.0.jar:/home/alex/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.2/jakarta.xml.bind-api-2.3.2.jar:/home/alex/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.1/jakarta.activation-api-1.2.1.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.12.0/jackson-jaxrs-json-provider-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.12.0/jackson-jaxrs-base-2.12.0.jar:/home/alex/.m2/repository/com/google/inject/extensions/guice-servlet/4.0/guice-servlet-4.0.jar:/home/alex/.m2/repository/commons-beanutils/commons-beanutils/1.9.4/commons-beanutils-1.9.4.jar:/home/alex/Repositories/hive/storage-api/target/classes:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.13.2/log4j-slf4j-impl-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-api/2.13.2/log4j-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-1.2-api/2.13.2/log4j-1.2-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-core/2.13.2/log4j-core-2.13.2.jar:/home/alex/.m2/repository/org/apache/thrift/libfb303/0.9.3/libfb303-0.9.3.jar:/home/alex/.m2/repository/org/apache/thrift/libthrift/0.14.1/libthrift-0.14.1.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpcore/4.4.12/httpcore-4.4.12.jar:/home/alex/.m2/repository/org/apache/tomcat/embed/tomcat-embed-core/8.5.46/tomcat-embed-core-8.5.46.jar:/home/alex/.m2/repository/org/apache/tomcat/tomcat-annotations-api/8.5.46/tomcat-annotations-api-8.5.46.jar:/home/alex/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-api-jdo/5.2.4/datanucleus-api-jdo-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-core/5.2.4/datanucleus-core-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-rdbms/5.2.4/datanucleus-rdbms-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/javax.jdo/3.2.0-release/javax.jdo-3.2.0-release.jar:/home/alex/.m2/repository/javax/transaction/javax.transaction-api/1.3/javax.transaction-api-1.3.jar:/home/alex/.m2/repository/org/glassfish/corba/glassfish-corba-omgapi/4.2.2/glassfish-corba-omgapi-4.2.2.jar:/home/alex/.m2/repository/org/skyscreamer/jsonassert/1.4.0/jsonassert-1.4.0.jar:/home/alex/.m2/repository/com/vaadin/external/google/android-json/0.0.20131108.vaadin1/android-json-0.0.20131108.vaadin1.jar:/home/alex/.m2/repository/sqlline/sqlline/1.9.0/sqlline-1.9.0.jar:/home/alex/.m2/repository/org/jline/jline-terminal/3.12.1/jline-terminal-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-reader/3.12.1/jline-reader-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jansi/3.12.1/jline-terminal-jansi-3.12.1.jar:/home/alex/.m2/repository/org/fusesource/jansi/jansi/1.18/jansi-1.18.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jna/3.12.1/jline-terminal-jna-3.12.1.jar:/home/alex/.m2/repository/net/java/dev/jna/jna/5.3.1/jna-5.3.1.jar:/home/alex/.m2/repository/org/jline/jline-builtins/3.12.1/jline-builtins-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-style/3.12.1/jline-style-3.12.1.jar:/home/alex/.m2/repository/jline/jline/2.14.6/jline-2.14.6.jar:/home/alex/.m2/repository/commons-logging/commons-logging/1.1.3/commons-logging-1.1.3.jar:/home/alex/.m2/repository/com/cronutils/cron-utils/9.1.3/cron-utils-9.1.3.jar:/home/alex/.m2/repository/org/glassfish/javax.el/3.0.0/javax.el-3.0.0.jar:/home/alex/.m2/repository/com/oracle/database/jdbc/ojdbc8/21.3.0.0/ojdbc8-21.3.0.0.jar:/home/alex/.m2/repository/mysql/mysql-connector-java/8.0.27/mysql-connector-java-8.0.27.jar:/home/alex/.m2/repository/com/microsoft/sqlserver/mssql-jdbc/6.2.1.jre8/mssql-jdbc-6.2.1.jre8.jar:/home/alex/.m2/repository/junit/junit/4.13/junit-4.13.jar:/home/alex/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-server-integ/1.5.7/apacheds-server-integ-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-interceptor-kerberos/1.5.7/apacheds-interceptor-kerberos-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core/1.5.7/apacheds-core-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-api/1.5.7/apacheds-core-api-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-entry/1.5.7/apacheds-core-entry-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-constants/1.5.7/apacheds-core-constants-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-utils/1.5.7/apacheds-utils-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-kerberos-shared/1.5.7/apacheds-kerberos-shared-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-jndi/1.5.7/apacheds-core-jndi-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-protocol-shared/1.5.7/apacheds-protocol-shared-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-integ/1.5.7/apacheds-core-integ-1.5.7.jar:/home/alex/.m2/repository/ldapsdk/ldapsdk/4.1/ldapsdk-4.1.jar:/home/alex/.m2/repository/org/apache/directory/client/ldap/ldap-client-api/0.1/ldap-client-api-0.1.jar:/home/alex/.m2/repository/commons-pool/commons-pool/1.5.4/commons-pool-1.5.4.jar:/home/alex/.m2/repository/org/apache/mina/mina-core/2.0.0-RC1/mina-core-2.0.0-RC1.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap/0.9.19/shared-ldap-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-i18n/0.9.19/shared-i18n-0.9.19.jar:/home/alex/.m2/repository/antlr/antlr/2.7.7/antlr-2.7.7.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema/0.9.19/shared-ldap-schema-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema-loader/0.9.19/shared-ldap-schema-loader-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema-manager/0.9.19/shared-ldap-schema-manager-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-cursor/0.9.19/shared-cursor-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-jndi/0.9.19/shared-ldap-jndi-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-asn1-codec/0.9.19/shared-asn1-codec-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-asn1/0.9.19/shared-asn1-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-constants/0.9.19/shared-ldap-constants-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-converter/0.9.19/shared-ldap-converter-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema-dao/0.9.19/shared-ldap-schema-dao-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldif/0.9.19/shared-ldif-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-dsml-parser/0.9.19/shared-dsml-parser-0.9.19.jar:/home/alex/.m2/repository/dom4j/dom4j/1.6.1/dom4j-1.6.1.jar:/home/alex/.m2/repository/xml-apis/xml-apis/1.0.b2/xml-apis-1.0.b2.jar:/home/alex/.m2/repository/xpp3/xpp3/1.1.4c/xpp3-1.1.4c.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-test-framework/1.5.7/apacheds-test-framework-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-i18n/1.5.7/apacheds-i18n-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-server-annotations/1.5.7/apacheds-server-annotations-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-annotations/1.5.7/apacheds-core-annotations-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-jdbm-partition/1.5.7/apacheds-jdbm-partition-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-jdbm-store/1.5.7/apacheds-jdbm-store-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-jdbm/1.5.7/apacheds-jdbm-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-avl/1.5.7/apacheds-core-avl-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-xdbm-search/1.5.7/apacheds-xdbm-search-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-ldif-partition/1.5.7/apacheds-ldif-partition-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-avl-partition/1.5.7/apacheds-avl-partition-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-mock/1.5.7/apacheds-core-mock-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-protocol-ldap/1.5.7/apacheds-protocol-ldap-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-xdbm-tools/1.5.7/apacheds-xdbm-tools-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-xdbm-base/1.5.7/apacheds-xdbm-base-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-protocol-kerberos/1.5.7/apacheds-protocol-kerberos-1.5.7.jar:/home/alex/.m2/repository/org/mockito/mockito-core/3.3.3/mockito-core-3.3.3.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy/1.10.5/byte-buddy-1.10.5.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy-agent/1.10.5/byte-buddy-agent-1.10.5.jar:/home/alex/.m2/repository/org/objenesis/objenesis/2.6/objenesis-2.6.jar:/home/alex/.m2/repository/org/postgresql/postgresql/42.2.14/postgresql-42.2.14.jar:/home/alex/.m2/repository/org/apache/curator/curator-test/4.2.0/curator-test-4.2.0.jar:/home/alex/Repositories/hive/standalone-metastore/metastore-server/src/test/resources:"/>
    <property name="java.vm.vendor" value="Private Build"/>
    <property name="nondexPrintstack" value="false"/>
    <property name="sun.arch.data.model" value="64"/>
    <property name="java.vendor.url" value="http://java.oracle.com/"/>
    <property name="user.timezone" value="Europe/Lisbon"/>
    <property name="user.country.format" value="PT"/>
    <property name="java.vm.specification.version" value="1.8"/>
    <property name="os.name" value="Linux"/>
    <property name="test.tmp.dir" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp"/>
    <property name="user.country" value="US"/>
    <property name="sun.java.launcher" value="SUN_STANDARD"/>
    <property name="sun.boot.library.path" value="/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64"/>
    <property name="sun.java.command" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/surefire/surefirebooter2237558859877960320.jar /home/alex/Repositories/hive/standalone-metastore/metastore-server/target/surefire 2024-04-23T21-59-46_173-jvmRun1 surefire1033894983201443176tmp surefire_10002322511234050769733tmp"/>
    <property name="nondexLogging" value="CONFIG"/>
    <property name="surefire.test.class.path" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/test-classes:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/classes:/home/alex/Repositories/hive/standalone-metastore/metastore-common/target/classes:/home/alex/.m2/repository/org/antlr/ST4/4.0.4/ST4-4.0.4.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper/3.5.5/zookeeper-3.5.5.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.5.5/zookeeper-jute-3.5.5.jar:/home/alex/.m2/repository/org/apache/yetus/audience-annotations/0.5.0/audience-annotations-0.5.0.jar:/home/alex/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.8.4/caffeine-2.8.4.jar:/home/alex/.m2/repository/org/checkerframework/checker-qual/3.4.0/checker-qual-3.4.0.jar:/home/alex/.m2/repository/com/google/errorprone/error_prone_annotations/2.3.4/error_prone_annotations-2.3.4.jar:/home/alex/.m2/repository/org/apache/curator/curator-recipes/4.2.0/curator-recipes-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-framework/4.2.0/curator-framework-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-client/4.2.0/curator-client-4.2.0.jar:/home/alex/.m2/repository/org/slf4j/slf4j-api/1.7.30/slf4j-api-1.7.30.jar:/home/alex/.m2/repository/org/apache/orc/orc-core/1.6.9/orc-core-1.6.9.jar:/home/alex/.m2/repository/org/apache/orc/orc-shims/1.6.9/orc-shims-1.6.9.jar:/home/alex/.m2/repository/io/airlift/aircompressor/0.19/aircompressor-0.19.jar:/home/alex/.m2/repository/javax/xml/bind/jaxb-api/2.2.11/jaxb-api-2.2.11.jar:/home/alex/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/alex/.m2/repository/org/threeten/threeten-extra/1.5.0/threeten-extra-1.5.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.12.0/jackson-databind-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.12.0/jackson-annotations-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.12.0/jackson-core-2.12.0.jar:/home/alex/.m2/repository/com/github/joshelser/dropwizard-metrics-hadoop-metrics2-reporter/0.1.2/dropwizard-metrics-hadoop-metrics2-reporter-0.1.2.jar:/home/alex/.m2/repository/com/google/guava/guava/19.0/guava-19.0.jar:/home/alex/.m2/repository/com/google/protobuf/protobuf-java/2.6.1/protobuf-java-2.6.1.jar:/home/alex/.m2/repository/com/zaxxer/HikariCP/2.6.1/HikariCP-2.6.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-dbcp2/2.7.0/commons-dbcp2-2.7.0.jar:/home/alex/.m2/repository/org/apache/commons/commons-pool2/2.7.0/commons-pool2-2.7.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-core/3.1.0/metrics-core-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-jvm/3.1.0/metrics-jvm-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-json/3.1.0/metrics-json-3.1.0.jar:/home/alex/.m2/repository/javolution/javolution/5.5.1/javolution-5.5.1.jar:/home/alex/.m2/repository/org/antlr/antlr-runtime/3.5.2/antlr-runtime-3.5.2.jar:/home/alex/.m2/repository/org/apache/commons/commons-lang3/3.9/commons-lang3-3.9.jar:/home/alex/.m2/repository/org/apache/derby/derby/10.14.1.0/derby-10.14.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-annotations/3.1.0/hadoop-annotations-3.1.0.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/../lib/tools.jar:/home/alex/.m2/repository/commons-cli/commons-cli/1.2/commons-cli-1.2.jar:/home/alex/.m2/repository/org/apache/commons/commons-math3/3.1.1/commons-math3-3.1.1.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpclient/4.5.2/httpclient-4.5.2.jar:/home/alex/.m2/repository/commons-codec/commons-codec/1.11/commons-codec-1.11.jar:/home/alex/.m2/repository/commons-io/commons-io/2.5/commons-io-2.5.jar:/home/alex/.m2/repository/commons-net/commons-net/3.6/commons-net-3.6.jar:/home/alex/.m2/repository/commons-collections/commons-collections/3.2.2/commons-collections-3.2.2.jar:/home/alex/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-server/9.3.19.v20170502/jetty-server-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-http/9.3.19.v20170502/jetty-http-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-io/9.3.19.v20170502/jetty-io-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util/9.3.19.v20170502/jetty-util-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-servlet/9.3.19.v20170502/jetty-servlet-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-security/9.3.19.v20170502/jetty-security-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-webapp/9.3.19.v20170502/jetty-webapp-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-xml/9.3.19.v20170502/jetty-xml-9.3.19.v20170502.jar:/home/alex/.m2/repository/javax/servlet/jsp/jsp-api/2.1/jsp-api-2.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-core/1.19/jersey-core-1.19.jar:/home/alex/.m2/repository/javax/ws/rs/jsr311-api/1.1.1/jsr311-api-1.1.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-servlet/1.19/jersey-servlet-1.19.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-json/1.19/jersey-json-1.19.jar:/home/alex/.m2/repository/org/codehaus/jettison/jettison/1.1/jettison-1.1.jar:/home/alex/.m2/repository/com/sun/xml/bind/jaxb-impl/2.2.3-1/jaxb-impl-2.2.3-1.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-core-asl/1.9.2/jackson-core-asl-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-mapper-asl/1.9.2/jackson-mapper-asl-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-jaxrs/1.9.2/jackson-jaxrs-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-xc/1.9.2/jackson-xc-1.9.2.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-server/1.19/jersey-server-1.19.jar:/home/alex/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/alex/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/alex/.m2/repository/org/apache/commons/commons-configuration2/2.1.1/commons-configuration2-2.1.1.jar:/home/alex/.m2/repository/org/apache/avro/avro/1.7.7/avro-1.7.7.jar:/home/alex/.m2/repository/com/thoughtworks/paranamer/paranamer/2.3/paranamer-2.3.jar:/home/alex/.m2/repository/org/xerial/snappy/snappy-java/1.0.5/snappy-java-1.0.5.jar:/home/alex/.m2/repository/com/google/re2j/re2j/1.1/re2j-1.1.jar:/home/alex/.m2/repository/com/google/code/gson/gson/2.2.4/gson-2.2.4.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-auth/3.1.0/hadoop-auth-3.1.0.jar:/home/alex/.m2/repository/com/nimbusds/nimbus-jose-jwt/4.41.1/nimbus-jose-jwt-4.41.1.jar:/home/alex/.m2/repository/com/github/stephenc/jcip/jcip-annotations/1.0-1/jcip-annotations-1.0-1.jar:/home/alex/.m2/repository/net/minidev/json-smart/2.3/json-smart-2.3.jar:/home/alex/.m2/repository/net/minidev/accessors-smart/1.2/accessors-smart-1.2.jar:/home/alex/.m2/repository/org/ow2/asm/asm/5.0.4/asm-5.0.4.jar:/home/alex/.m2/repository/com/jcraft/jsch/0.1.54/jsch-0.1.54.jar:/home/alex/.m2/repository/com/google/code/findbugs/jsr305/3.0.0/jsr305-3.0.0.jar:/home/alex/.m2/repository/org/apache/htrace/htrace-core4/4.1.0-incubating/htrace-core4-4.1.0-incubating.jar:/home/alex/.m2/repository/org/apache/commons/commons-compress/1.4.1/commons-compress-1.4.1.jar:/home/alex/.m2/repository/org/tukaani/xz/1.0/xz-1.0.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-simplekdc/1.0.1/kerb-simplekdc-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-client/1.0.1/kerb-client-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-config/1.0.1/kerby-config-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-core/1.0.1/kerb-core-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-pkix/1.0.1/kerby-pkix-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-asn1/1.0.1/kerby-asn1-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-util/1.0.1/kerby-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-common/1.0.1/kerb-common-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-crypto/1.0.1/kerb-crypto-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-util/1.0.1/kerb-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/token-provider/1.0.1/token-provider-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-admin/1.0.1/kerb-admin-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-server/1.0.1/kerb-server-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-identity/1.0.1/kerb-identity-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-xdr/1.0.1/kerby-xdr-1.0.1.jar:/home/alex/.m2/repository/org/codehaus/woodstox/stax2-api/3.1.4/stax2-api-3.1.4.jar:/home/alex/.m2/repository/com/fasterxml/woodstox/woodstox-core/5.0.3/woodstox-core-5.0.3.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-distcp/3.1.0/hadoop-distcp-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs/3.1.0/hadoop-hdfs-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.3.19.v20170502/jetty-util-ajax-9.3.19.v20170502.jar:/home/alex/.m2/repository/commons-daemon/commons-daemon/1.0.13/commons-daemon-1.0.13.jar:/home/alex/.m2/repository/org/fusesource/leveldbjni/leveldbjni-all/1.8/leveldbjni-all-1.8.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.1.0/hadoop-hdfs-client-3.1.0.jar:/home/alex/.m2/repository/com/squareup/okhttp/okhttp/2.7.5/okhttp-2.7.5.jar:/home/alex/.m2/repository/com/squareup/okio/okio/1.6.0/okio-1.6.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-core/3.1.0/hadoop-mapreduce-client-core-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-client/3.1.0/hadoop-yarn-client-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-api/3.1.0/hadoop-yarn-api-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-common/3.1.0/hadoop-yarn-common-3.1.0.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-client/1.19/jersey-client-1.19.jar:/home/alex/.m2/repository/com/google/inject/guice/4.0/guice-4.0.jar:/home/alex/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/alex/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/alex/.m2/repository/com/sun/jersey/contribs/jersey-guice/1.19/jersey-guice-1.19.jar:/home/alex/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.12.0/jackson-module-jaxb-annotations-2.12.0.jar:/home/alex/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.2/jakarta.xml.bind-api-2.3.2.jar:/home/alex/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.1/jakarta.activation-api-1.2.1.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.12.0/jackson-jaxrs-json-provider-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.12.0/jackson-jaxrs-base-2.12.0.jar:/home/alex/.m2/repository/com/google/inject/extensions/guice-servlet/4.0/guice-servlet-4.0.jar:/home/alex/.m2/repository/commons-beanutils/commons-beanutils/1.9.4/commons-beanutils-1.9.4.jar:/home/alex/Repositories/hive/storage-api/target/classes:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.13.2/log4j-slf4j-impl-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-api/2.13.2/log4j-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-1.2-api/2.13.2/log4j-1.2-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-core/2.13.2/log4j-core-2.13.2.jar:/home/alex/.m2/repository/org/apache/thrift/libfb303/0.9.3/libfb303-0.9.3.jar:/home/alex/.m2/repository/org/apache/thrift/libthrift/0.14.1/libthrift-0.14.1.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpcore/4.4.12/httpcore-4.4.12.jar:/home/alex/.m2/repository/org/apache/tomcat/embed/tomcat-embed-core/8.5.46/tomcat-embed-core-8.5.46.jar:/home/alex/.m2/repository/org/apache/tomcat/tomcat-annotations-api/8.5.46/tomcat-annotations-api-8.5.46.jar:/home/alex/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-api-jdo/5.2.4/datanucleus-api-jdo-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-core/5.2.4/datanucleus-core-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-rdbms/5.2.4/datanucleus-rdbms-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/javax.jdo/3.2.0-release/javax.jdo-3.2.0-release.jar:/home/alex/.m2/repository/javax/transaction/javax.transaction-api/1.3/javax.transaction-api-1.3.jar:/home/alex/.m2/repository/org/glassfish/corba/glassfish-corba-omgapi/4.2.2/glassfish-corba-omgapi-4.2.2.jar:/home/alex/.m2/repository/org/skyscreamer/jsonassert/1.4.0/jsonassert-1.4.0.jar:/home/alex/.m2/repository/com/vaadin/external/google/android-json/0.0.20131108.vaadin1/android-json-0.0.20131108.vaadin1.jar:/home/alex/.m2/repository/sqlline/sqlline/1.9.0/sqlline-1.9.0.jar:/home/alex/.m2/repository/org/jline/jline-terminal/3.12.1/jline-terminal-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-reader/3.12.1/jline-reader-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jansi/3.12.1/jline-terminal-jansi-3.12.1.jar:/home/alex/.m2/repository/org/fusesource/jansi/jansi/1.18/jansi-1.18.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jna/3.12.1/jline-terminal-jna-3.12.1.jar:/home/alex/.m2/repository/net/java/dev/jna/jna/5.3.1/jna-5.3.1.jar:/home/alex/.m2/repository/org/jline/jline-builtins/3.12.1/jline-builtins-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-style/3.12.1/jline-style-3.12.1.jar:/home/alex/.m2/repository/jline/jline/2.14.6/jline-2.14.6.jar:/home/alex/.m2/repository/commons-logging/commons-logging/1.1.3/commons-logging-1.1.3.jar:/home/alex/.m2/repository/com/cronutils/cron-utils/9.1.3/cron-utils-9.1.3.jar:/home/alex/.m2/repository/org/glassfish/javax.el/3.0.0/javax.el-3.0.0.jar:/home/alex/.m2/repository/com/oracle/database/jdbc/ojdbc8/21.3.0.0/ojdbc8-21.3.0.0.jar:/home/alex/.m2/repository/mysql/mysql-connector-java/8.0.27/mysql-connector-java-8.0.27.jar:/home/alex/.m2/repository/com/microsoft/sqlserver/mssql-jdbc/6.2.1.jre8/mssql-jdbc-6.2.1.jre8.jar:/home/alex/.m2/repository/junit/junit/4.13/junit-4.13.jar:/home/alex/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-server-integ/1.5.7/apacheds-server-integ-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-interceptor-kerberos/1.5.7/apacheds-interceptor-kerberos-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core/1.5.7/apacheds-core-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-api/1.5.7/apacheds-core-api-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-entry/1.5.7/apacheds-core-entry-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-constants/1.5.7/apacheds-core-constants-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-utils/1.5.7/apacheds-utils-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-kerberos-shared/1.5.7/apacheds-kerberos-shared-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-jndi/1.5.7/apacheds-core-jndi-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-protocol-shared/1.5.7/apacheds-protocol-shared-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-integ/1.5.7/apacheds-core-integ-1.5.7.jar:/home/alex/.m2/repository/ldapsdk/ldapsdk/4.1/ldapsdk-4.1.jar:/home/alex/.m2/repository/org/apache/directory/client/ldap/ldap-client-api/0.1/ldap-client-api-0.1.jar:/home/alex/.m2/repository/commons-pool/commons-pool/1.5.4/commons-pool-1.5.4.jar:/home/alex/.m2/repository/org/apache/mina/mina-core/2.0.0-RC1/mina-core-2.0.0-RC1.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap/0.9.19/shared-ldap-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-i18n/0.9.19/shared-i18n-0.9.19.jar:/home/alex/.m2/repository/antlr/antlr/2.7.7/antlr-2.7.7.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema/0.9.19/shared-ldap-schema-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema-loader/0.9.19/shared-ldap-schema-loader-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema-manager/0.9.19/shared-ldap-schema-manager-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-cursor/0.9.19/shared-cursor-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-jndi/0.9.19/shared-ldap-jndi-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-asn1-codec/0.9.19/shared-asn1-codec-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-asn1/0.9.19/shared-asn1-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-constants/0.9.19/shared-ldap-constants-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-converter/0.9.19/shared-ldap-converter-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema-dao/0.9.19/shared-ldap-schema-dao-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldif/0.9.19/shared-ldif-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-dsml-parser/0.9.19/shared-dsml-parser-0.9.19.jar:/home/alex/.m2/repository/dom4j/dom4j/1.6.1/dom4j-1.6.1.jar:/home/alex/.m2/repository/xml-apis/xml-apis/1.0.b2/xml-apis-1.0.b2.jar:/home/alex/.m2/repository/xpp3/xpp3/1.1.4c/xpp3-1.1.4c.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-test-framework/1.5.7/apacheds-test-framework-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-i18n/1.5.7/apacheds-i18n-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-server-annotations/1.5.7/apacheds-server-annotations-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-annotations/1.5.7/apacheds-core-annotations-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-jdbm-partition/1.5.7/apacheds-jdbm-partition-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-jdbm-store/1.5.7/apacheds-jdbm-store-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-jdbm/1.5.7/apacheds-jdbm-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-avl/1.5.7/apacheds-core-avl-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-xdbm-search/1.5.7/apacheds-xdbm-search-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-ldif-partition/1.5.7/apacheds-ldif-partition-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-avl-partition/1.5.7/apacheds-avl-partition-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-mock/1.5.7/apacheds-core-mock-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-protocol-ldap/1.5.7/apacheds-protocol-ldap-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-xdbm-tools/1.5.7/apacheds-xdbm-tools-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-xdbm-base/1.5.7/apacheds-xdbm-base-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-protocol-kerberos/1.5.7/apacheds-protocol-kerberos-1.5.7.jar:/home/alex/.m2/repository/org/mockito/mockito-core/3.3.3/mockito-core-3.3.3.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy/1.10.5/byte-buddy-1.10.5.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy-agent/1.10.5/byte-buddy-agent-1.10.5.jar:/home/alex/.m2/repository/org/objenesis/objenesis/2.6/objenesis-2.6.jar:/home/alex/.m2/repository/org/postgresql/postgresql/42.2.14/postgresql-42.2.14.jar:/home/alex/.m2/repository/org/apache/curator/curator-test/4.2.0/curator-test-4.2.0.jar:/home/alex/Repositories/hive/standalone-metastore/metastore-server/src/test/resources:"/>
    <property name="sun.cpu.endian" value="little"/>
    <property name="nondexExecid" value="dls2le2r09KbM+aHksQTeqQgNAVbKgsiPqOnCfO8ffU="/>
    <property name="user.home" value="/home/alex"/>
    <property name="user.language" value="en"/>
    <property name="java.specification.vendor" value="Oracle Corporation"/>
    <property name="metastore.schema.verification" value="false"/>
    <property name="java.home" value="/usr/lib/jvm/java-8-openjdk-amd64/jre"/>
    <property name="hive.metastore.warehouse.external.dir" value="file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external"/>
    <property name="file.separator" value="/"/>
    <property name="basedir" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server"/>
    <property name="metastore.warehouse.dir" value="file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse"/>
    <property name="nondexEnd" value="9223372036854775807"/>
    <property name="line.separator" value="&#10;"/>
    <property name="java.specification.name" value="Java Platform API Specification"/>
    <property name="java.vm.specification.vendor" value="Oracle Corporation"/>
    <property name="derby.stream.error.file" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/derby.log"/>
    <property name="java.awt.graphicsenv" value="sun.awt.X11GraphicsEnvironment"/>
    <property name="nondexFilter" value=".*"/>
    <property name="nondexSeed" value="974622"/>
    <property name="surefire.real.class.path" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/surefire/surefirebooter2237558859877960320.jar"/>
    <property name="log4j.debug" value="true"/>
    <property name="sun.boot.class.path" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/.nondex/nondex-instr.jar:/home/alex/.m2/repository/edu/illinois/nondex-common/2.1.7/nondex-common-2.1.7.jar:/home/alex/.m2/repository/edu/illinois/nondex-annotations/2.1.7/nondex-annotations-2.1.7.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/classes"/>
    <property name="sun.management.compiler" value="HotSpot 64-Bit Tiered Compilers"/>
    <property name="java.runtime.version" value="1.8.0_402-8u402-ga-2ubuntu1~22.04-b06"/>
    <property name="user.name" value="alex"/>
    <property name="path.separator" value=":"/>
    <property name="javax.jdo.option.ConnectionURL" value="jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true"/>
    <property name="os.version" value="6.5.0-28-generic"/>
    <property name="java.endorsed.dirs" value="/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/endorsed"/>
    <property name="java.runtime.name" value="OpenJDK Runtime Environment"/>
    <property name="file.encoding" value="UTF-8"/>
    <property name="java.vm.name" value="OpenJDK 64-Bit Server VM"/>
    <property name="localRepository" value="/home/alex/.m2/repository"/>
    <property name="nondexDir" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/.nondex"/>
    <property name="build.dir" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target"/>
    <property name="java.vendor.url.bug" value="http://bugreport.sun.com/bugreport/"/>
    <property name="nondexJarDir" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/.nondex"/>
    <property name="java.io.tmpdir" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp"/>
    <property name="com.zaxxer.hikari.pool_number" value="3"/>
    <property name="java.version" value="1.8.0_402"/>
    <property name="user.dir" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server"/>
    <property name="os.arch" value="amd64"/>
    <property name="nondexMode" value="FULL"/>
    <property name="java.vm.specification.name" value="Java Virtual Machine Specification"/>
    <property name="user.language.format" value="pt"/>
    <property name="java.awt.printerjob" value="sun.print.PSPrinterJob"/>
    <property name="sun.os.patch.level" value="unknown"/>
    <property name="derby.version" value="10.14.1.0"/>
    <property name="java.library.path" value="/usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib"/>
    <property name="java.vendor" value="Private Build"/>
    <property name="java.vm.info" value="mixed mode"/>
    <property name="java.vm.version" value="25.402-b06"/>
    <property name="java.specification.maintenance.version" value="5"/>
    <property name="sun.io.unicode.encoding" value="UnicodeLittle"/>
    <property name="java.ext.dirs" value="/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext:/usr/java/packages/lib/ext"/>
    <property name="datanucleus.schema.autoCreateAll" value="true"/>
    <property name="java.class.version" value="52.0"/>
  </properties>
  <testcase name="testDropDatabaseShouldRollback_whenAcidCleanupFails" classname="org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup" time="21.917">
    <failure message="dropTable failed with unexpected exception: MetaException(message:javax.jdo.JDODataStoreException: Transaction failed to commit&#10;NestedThrowables:&#10;org.datanucleus.exceptions.NucleusDataStoreException: Exception thrown flushing changes to datastore)" type="junit.framework.AssertionFailedError"><![CDATA[junit.framework.AssertionFailedError: 
dropTable failed with unexpected exception: MetaException(message:javax.jdo.JDODataStoreException: Transaction failed to commit
NestedThrowables:
org.datanucleus.exceptions.NucleusDataStoreException: Exception thrown flushing changes to datastore)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:118)
]]></failure>
    <system-out><![CDATA[[INFO ] 2024-04-23 23:21:10.685 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:21:10.689 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:21:10.690 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:21:10.690 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:21:10.728 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:21:10.728 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:21:10.728 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:21:10.729 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[DEBUG] 2024-04-23 23:21:10.731 [main] MetastoreConf - MetastoreConf object:
Key: <metastore.acid.housekeeper.interval> old hive key: <hive.metastore.acid.housekeeper.interval>  value: <60s>
Key: <metastore.acid.housekeeper.start> old hive key: <hive.metastore.acid.housekeeper.start>  value: <60s>
Key: <metastore.acid.txn.cleaner.interval> old hive key: <hive.metastore.acid.txn.cleaner.interval>  value: <10s>
Key: <metastore.added.jars.path> old hive key: <hive.added.jars.path>  value: <>
Key: <metastore.aggregate.stats.cache.clean.until> old hive key: <hive.metastore.aggregate.stats.cache.clean.until>  value: <0.8>
Key: <metastore.aggregate.stats.cache.enabled> old hive key: <hive.metastore.aggregate.stats.cache.enabled>  value: <false>
Key: <metastore.aggregate.stats.cache.fpp> old hive key: <hive.metastore.aggregate.stats.cache.fpp>  value: <0.01>
Key: <metastore.aggregate.stats.cache.max.full> old hive key: <hive.metastore.aggregate.stats.cache.max.full>  value: <0.9>
Key: <metastore.aggregate.stats.cache.max.partitions> old hive key: <hive.metastore.aggregate.stats.cache.max.partitions>  value: <10000>
Key: <metastore.aggregate.stats.cache.max.reader.wait> old hive key: <hive.metastore.aggregate.stats.cache.max.reader.wait>  value: <1000ms>
Key: <metastore.aggregate.stats.cache.max.variance> old hive key: <hive.metastore.aggregate.stats.cache.max.variance>  value: <0.01>
Key: <metastore.aggregate.stats.cache.max.writer.wait> old hive key: <hive.metastore.aggregate.stats.cache.max.writer.wait>  value: <5000ms>
Key: <metastore.aggregate.stats.cache.size> old hive key: <hive.metastore.aggregate.stats.cache.size>  value: <10000>
Key: <metastore.aggregate.stats.cache.ttl> old hive key: <hive.metastore.aggregate.stats.cache.ttl>  value: <600s>
Key: <metastore.warehouse.tenant.colocation> old hive key: <hive.metastore.warehouse.tenant.colocation>  value: <false>
Key: <metastore.alter.handler> old hive key: <hive.metastore.alter.impl>  value: <org.apache.hadoop.hive.metastore.HiveAlterHandler>
Key: <metastore.async.log.enabled> old hive key: <hive.async.log.enabled>  value: <true>
Key: <metastore.authorization.storage.checks> old hive key: <hive.metastore.authorization.storage.checks>  value: <false>
Key: <datanucleus.schema.autoCreateAll> old hive key: <datanucleus.schema.autoCreateAll>  value: <true>
Key: <metastore.batch.retrieve.max> old hive key: <hive.metastore.batch.retrieve.max>  value: <300>
Key: <metastore.batch.retrieve.table.partition.max> old hive key: <hive.metastore.batch.retrieve.table.partition.max>  value: <1000>
Key: <metastore.cache.pinobjtypes> old hive key: <hive.metastore.cache.pinobjtypes>  value: <Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order>
Key: <metastore.cached.rawstore.impl> old hive key: <hive.metastore.cached.rawstore.impl>  value: <org.apache.hadoop.hive.metastore.ObjectStore>
Key: <metastore.cached.rawstore.cache.update.frequency> old hive key: <hive.metastore.cached.rawstore.cache.update.frequency>  value: <60s>
Key: <metastore.cached.rawstore.cached.object.whitelist> old hive key: <hive.metastore.cached.rawstore.cached.object.whitelist>  value: <.*>
Key: <metastore.cached.rawstore.cached.object.blacklist> old hive key: <hive.metastore.cached.rawstore.cached.object.blacklist>  value: <>
Key: <metastore.cached.rawstore.max.cache.memory> old hive key: <hive.metastore.cached.rawstore.max.cache.memory>  value: <1Gb>
Key: <metastore.client.capability.check> old hive key: <hive.metastore.client.capability.check>  value: <true>
Key: <metastore.catalog.default> old hive key: <metastore.catalog.default>  value: <hive>
Key: <metastore.cached.rawstore.catalogs> old hive key: <metastore.cached.rawstore.catalogs>  value: <hive>
Key: <metastore.client.connect.retry.delay> old hive key: <hive.metastore.client.connect.retry.delay>  value: <1s>
Key: <metastore.client.kerberos.principal> old hive key: <hive.metastore.client.kerberos.principal>  value: <>
Key: <metastore.client.socket.lifetime> old hive key: <hive.metastore.client.socket.lifetime>  value: <0s>
Key: <metastore.client.socket.timeout> old hive key: <hive.metastore.client.socket.timeout>  value: <600s>
Key: <metastore.compactor.history.retention.did.not.initiate> old hive key: <hive.compactor.history.retention.did.not.initiate>  value: <2>
Key: <metastore.compactor.history.retention.failed> old hive key: <hive.compactor.history.retention.failed>  value: <3>
Key: <metastore.compactor.history.retention.succeeded> old hive key: <hive.compactor.history.retention.succeeded>  value: <3>
Key: <metastore.compactor.history.retention.timeout> old hive key: <hive.compactor.history.retention.timeout>  value: <7d>
Key: <metastore.compactor.initiator.failed.compacts.threshold> old hive key: <hive.compactor.initiator.failed.compacts.threshold>  value: <2>
Key: <metastore.compactor.initiator.failed.retry.time> old hive key: <hive.compactor.initiator.failed.retry.time>  value: <7d>
Key: <metastore.compactor.run.as.user> old hive key: <hive.compactor.run.as.user>  value: <>
Key: <metastore.compactor.oldest.replication.open.txn.threshold.warning> old hive key: <hive.compactor.oldest.replication.open.txn.threshold.warning>  value: <14d>
Key: <metastore.compactor.oldest.replication.open.txn.threshold.error> old hive key: <hive.compactor.oldest.replication.open.txn.threshold.error>  value: <21d>
Key: <metastore.compactor.oldest.open.txn.threshold.warning> old hive key: <hive.compactor.oldest.open.txn.threshold.warning>  value: <24h>
Key: <metastore.compactor.oldest.open.txn.threshold.error> old hive key: <hive.compactor.oldest.open.txn.threshold.error>  value: <72h>
Key: <metastore.compactor.oldest.uncleaned.aborted.txn.time.threshold.warning> old hive key: <hive.compactor.oldest.uncleaned.aborted.txn.time.threshold.warning>  value: <24h>
Key: <metastore.compactor.oldest.uncleaned.aborted.txn.time.threshold.error> old hive key: <hive.compactor.oldest.uncleaned.aborted.txn.time.threshold.error>  value: <48h>
Key: <metastore.compactor.tables.with.aborted.txn.threshold> old hive key: <hive.compactor.tables.with.aborted.txn.threshold>  value: <1>
Key: <metastore.compactor.oldest.uncleaned.compaction.time.threshold> old hive key: <hive.compactor.oldest.uncleaned.compaction.time.threshold>  value: <24h>
Key: <metastore.compactor.failed.compaction.ratio.threshold> old hive key: <hive.compactor.failed.compaction.ratio.threshold>  value: <0.01>
Key: <metastore.compactor.oldest.initiated.compaction.time.threshold.warning> old hive key: <hive.compactor.oldest.initiated.compaction.time.threshold.warning>  value: <1h>
Key: <metastore.compactor.oldest.initiated.compaction.time.threshold.error> old hive key: <hive.compactor.oldest.initiated.compaction.time.threshold.error>  value: <12h>
Key: <metastore.compactor.completed.txn.components.record.threshold.warning> old hive key: <hive.compactor.completed.txn.components.record.threshold.warning>  value: <500000>
Key: <metastore.compactor.completed.txn.components.record.threshold.error> old hive key: <hive.compactor.completed.txn.components.record.threshold.error>  value: <1000000>
Key: <metastore.compactor.txn.to.writeid.record.threshold.warning> old hive key: <hive.compactor.txn.to.writeid.record.threshold.warning>  value: <500000>
Key: <metastore.compactor.txn.to.writeid.record.threshold.error> old hive key: <hive.compactor.txn.to.writeid.record.threshold.error>  value: <1000000>
Key: <metastore.compactor.number.of.disabled.compaction.tables.threshold> old hive key: <hive.compactor.number.of.disabled.compaction.tables.threshold>  value: <1>
Key: <metastore.compactor.acid.metrics.logger.frequency> old hive key: <hive.compactor.acid.metrics.logger.frequency>  value: <360m>
Key: <metastore.housekeeping.leader.hostname> old hive key: <hive.metastore.housekeeping.leader.hostname>  value: <>
Key: <metastore.housekeeping.threads.on> old hive key: <hive.metastore.housekeeping.threads.on>  value: <false>
Key: <metastore.acidmetrics.thread.on> old hive key: <hive.metastore.acidmetrics.thread.on>  value: <true>
Key: <metastore.acidmetrics.check.interval> old hive key: <hive.metastore.acidmetrics.check.interval>  value: <300s>
Key: <metastore.acidmetrics.ext.on> old hive key: <hive.metastore.acidmetrics.ext.on>  value: <true>
Key: <metastore.acidmetrics.table.aborted.txns.threshold> old hive key: <hive.metastore.acidmetrics.table.aborted.txns.threshold>  value: <1500>
Key: <metastore.compactor.initiator.on> old hive key: <hive.compactor.initiator.on>  value: <false>
Key: <metastore.compactor.worker.threads> old hive key: <hive.compactor.worker.threads>  value: <0>
Key: <metastore.compactor.worker.detect.multiple.versions.threshold> old hive key: <hive.metastore.compactor.worker.detect.multiple.versions.threshold>  value: <24h>
Key: <metastore.compactor.enable.stats.compression> old hive key: <metastore.compactor.enable.stats.compression>  value: <true>
Key: <javax.jdo.option.ConnectionDriverName> old hive key: <javax.jdo.option.ConnectionDriverName>  value: <org.apache.derby.jdbc.EmbeddedDriver>
Key: <datanucleus.connectionPool.maxPoolSize> old hive key: <datanucleus.connectionPool.maxPoolSize>  value: <10>
Key: <metastore.ds.connection.url.hook> old hive key: <hive.metastore.ds.connection.url.hook>  value: <>
Key: <javax.jdo.option.ConnectionURL> old hive key: <javax.jdo.option.ConnectionURL>  value: <jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true>
Key: <datanucleus.connectionPoolingType> old hive key: <datanucleus.connectionPoolingType>  value: <HikariCP>
Key: <javax.jdo.option.ConnectionUserName> old hive key: <javax.jdo.option.ConnectionUserName>  value: <APP>
Key: <metastore.create.as.acid> old hive key: <hive.create.as.acid>  value: <false>
Key: <metastore.count.open.txns.interval> old hive key: <hive.count.open.txns.interval>  value: <1s>
Key: <datanucleus.autoStartMechanismMode> old hive key: <datanucleus.autoStartMechanismMode>  value: <ignored>
Key: <datanucleus.cache.level2> old hive key: <datanucleus.cache.level2>  value: <false>
Key: <datanucleus.cache.level2.type> old hive key: <datanucleus.cache.level2.type>  value: <none>
Key: <datanucleus.rdbms.initializeColumnInfo> old hive key: <datanucleus.rdbms.initializeColumnInfo>  value: <NONE>
Key: <datanucleus.plugin.pluginRegistryBundleCheck> old hive key: <datanucleus.plugin.pluginRegistryBundleCheck>  value: <LOG>
Key: <datanucleus.transactionIsolation> old hive key: <datanucleus.transactionIsolation>  value: <read-committed>
Key: <datanucleus.rdbms.useLegacyNativeValueStrategy> old hive key: <datanucleus.rdbms.useLegacyNativeValueStrategy>  value: <true>
Key: <metastore.dbaccess.ssl.truststore.path> old hive key: <hive.metastore.dbaccess.ssl.truststore.path>  value: <>
Key: <metastore.dbaccess.ssl.truststore.type> old hive key: <hive.metastore.dbaccess.ssl.truststore.type>  value: <jks>
Key: <metastore.dbaccess.ssl.use.SSL> old hive key: <hive.metastore.dbaccess.ssl.use.SSL>  value: <false>
Key: <metastore.default.partition.name> old hive key: <hive.exec.default.partition.name>  value: <__HIVE_DEFAULT_PARTITION__>
Key: <metastore.cluster.delegation.key.update-interval> old hive key: <hive.cluster.delegation.key.update-interval>  value: <1d>
Key: <metastore.cluster.delegation.token.gc-interval> old hive key: <hive.cluster.delegation.token.gc-interval>  value: <15m>
Key: <metastore.cluster.delegation.token.max-lifetime> old hive key: <hive.cluster.delegation.token.max-lifetime>  value: <7d>
Key: <metastore.cluster.delegation.token.renew-interval> old hive key: <hive.cluster.delegation.token.renew-interval>  value: <1d>
Key: <metastore.cluster.delegation.token.store.class> old hive key: <hive.cluster.delegation.token.store.class>  value: <org.apache.hadoop.hive.metastore.security.MetastoreDelegationTokenManager>
Key: <javax.jdo.option.DetachAllOnCommit> old hive key: <javax.jdo.option.DetachAllOnCommit>  value: <true>
Key: <metastore.direct.sql.max.elements.in.clause> old hive key: <hive.direct.sql.max.elements.in.clause>  value: <1000>
Key: <metastore.direct.sql.max.elements.values.clause> old hive key: <hive.direct.sql.max.elements.values.clause>  value: <1000>
Key: <metastore.direct.sql.max.parameters> old hive key: <hive.direct.sql.max.parameters>  value: <1000>
Key: <metastore.direct.sql.max.query.length> old hive key: <hive.direct.sql.max.query.length>  value: <100>
Key: <metastore.direct.sql.batch.size> old hive key: <hive.metastore.direct.sql.batch.size>  value: <0>
Key: <metastore.disallow.incompatible.col.type.changes> old hive key: <hive.metastore.disallow.incompatible.col.type.changes>  value: <true>
Key: <metastore.allow.incompatible.col.type.changes.serdes> old hive key: <hive.metastore.allow.incompatible.col.type.changes.serdes>  value: <org.apache.hadoop.hive.kudu.KuduSerDe,org.apache.iceberg.mr.hive.HiveIcebergSerDe>
Key: <metastore.dump.config.on.creation> old hive key: <metastore.dump.config.on.creation>  value: <true>
Key: <metastore.end.function.listeners> old hive key: <hive.metastore.end.function.listeners>  value: <>
Key: <metastore.event.clean.freq> old hive key: <hive.metastore.event.clean.freq>  value: <0s>
Key: <metastore.event.expiry.duration> old hive key: <hive.metastore.event.expiry.duration>  value: <0s>
Key: <metastore.event.listeners> old hive key: <hive.metastore.event.listeners>  value: <>
Key: <metastore.event.message.factory> old hive key: <hive.metastore.event.message.factory>  value: <org.apache.hadoop.hive.metastore.messaging.json.gzip.GzipJSONMessageEncoder>
Key: <metastore.repl.message.factory> old hive key: <hive.metastore.repl.message.factory>  value: <org.apache.hadoop.hive.metastore.messaging.json.gzip.GzipJSONMessageEncoder>
Key: <metastore.notification.parameters.exclude.patterns> old hive key: <hive.metastore.notification.parameters.exclude.patterns>  value: <>
Key: <metastore.event.db.listener.timetolive> old hive key: <hive.metastore.event.db.listener.timetolive>  value: <1d>
Key: <metastore.event.db.clean.maxevents> old hive key: <hive.metastore.event.db.clean.maxevents>  value: <10000>
Key: <metastore.event.db.listener.clean.interval> old hive key: <hive.metastore.event.db.listener.clean.interval>  value: <7200s>
Key: <metastore.event.db.listener.clean.startup.wait.interval> old hive key: <hive.metastore.event.db.listener.clean.startup.wait.interval>  value: <1d>
Key: <metastore.metastore.event.db.notification.api.auth> old hive key: <hive.metastore.event.db.notification.api.auth>  value: <true>
Key: <metastore.execute.setugi> old hive key: <hive.metastore.execute.setugi>  value: <true>
Key: <metastore.expression.proxy> old hive key: <hive.metastore.expression.proxy>  value: <org.apache.hadoop.hive.ql.optimizer.ppr.PartitionExpressionForMetastore>
Key: <metastore.decode.filter.expression.tostring> old hive key: <hive.metastore.decode.filter.expression.tostring>  value: <false>
Key: <metastore.file.metadata.threads> old hive key: <hive.metastore.hbase.file.metadata.threads>  value: <1>
Key: <metastore.filter.hook> old hive key: <hive.metastore.filter.hook>  value: <org.apache.hadoop.hive.metastore.DefaultMetaStoreFilterHookImpl>
Key: <metastore.fs.handler.class> old hive key: <hive.metastore.fs.handler.class>  value: <org.apache.hadoop.hive.metastore.HiveMetaStoreFsImpl>
Key: <metastore.fshandler.threads> old hive key: <hive.metastore.fshandler.threads>  value: <15>
Key: <metastore.hmshandler.retry.attempts> old hive key: <hive.hmshandler.retry.attempts>  value: <10>
Key: <metastore.hmshandler.force.reload.conf> old hive key: <hive.hmshandler.force.reload.conf>  value: <false>
Key: <metastore.hmshandler.retry.interval> old hive key: <hive.hmshandler.retry.interval>  value: <2000ms>
Key: <datanucleus.identifierFactory> old hive key: <datanucleus.identifierFactory>  value: <datanucleus1>
Key: <metastore.init.hooks> old hive key: <hive.metastore.init.hooks>  value: <>
Key: <metastore.initial.metadata.count.enabled> old hive key: <hive.metastore.initial.metadata.count.enabled>  value: <true>
Key: <metastore.integral.jdo.pushdown> old hive key: <hive.metastore.integral.jdo.pushdown>  value: <false>
Key: <metastore.jdbc.max.batch.size> old hive key: <hive.metastore.jdbc.max.batch.size>  value: <1000>
Key: <metastore.kerberos.keytab.file> old hive key: <hive.metastore.kerberos.keytab.file>  value: <>
Key: <metastore.kerberos.principal> old hive key: <hive.metastore.kerberos.principal>  value: <hive-metastore/_HOST@EXAMPLE.COM>
Key: <metastore.authentication> old hive key: <hive.metastore.authentication>  value: <NOSASL>
Key: <metastore.custom.authentication.class> old hive key: <hive.metastore.custom.authentication.class>  value: <>
Key: <metastore.authentication.ldap.url> old hive key: <hive.metastore.authentication.ldap.url>  value: <>
Key: <metastore.authentication.ldap.baseDN> old hive key: <hive.metastore.authentication.ldap.baseDN>  value: <>
Key: <metastore.authentication.ldap.Domain> old hive key: <hive.metastore.authentication.ldap.Domain>  value: <>
Key: <metastore.authentication.ldap.groupDNPattern> old hive key: <hive.metastore.authentication.ldap.groupDNPattern>  value: <>
Key: <metastore.authentication.ldap.groupFilter> old hive key: <hive.metastore.authentication.ldap.groupFilter>  value: <>
Key: <metastore.authentication.ldap.userDNPattern> old hive key: <hive.metastore.authentication.ldap.userDNPattern>  value: <>
Key: <metastore.authentication.ldap.userFilter> old hive key: <hive.metastore.authentication.ldap.userFilter>  value: <>
Key: <metastore.authentication.ldap.guidKey> old hive key: <hive.metastore.authentication.ldap.guidKey>  value: <uid>
Key: <metastore.authentication.ldap.groupMembershipKey> old hive key: <hive.metastore.authentication.ldap.groupMembershipKey>  value: <member>
Key: <metastore.authentication.ldap.userMembershipKey> old hive key: <hive.metastore.authentication.ldap.userMembershipKey>  value: <>
Key: <metastore.authentication.ldap.groupClassKey> old hive key: <hive.metastore.authentication.ldap.groupClassKey>  value: <groupOfNames>
Key: <metastore.authentication.ldap.customLDAPQuery> old hive key: <hive.metastore.authentication.ldap.customLDAPQuery>  value: <>
Key: <metastore.authentication.ldap.binddn> old hive key: <hive.metastore.authentication.ldap.binddn>  value: <>
Key: <metastore.authentication.ldap.bindpw> old hive key: <hive.metastore.authentication.ldap.bindpw>  value: <>
Key: <metastore.limit.partition.request> old hive key: <hive.metastore.limit.partition.request>  value: <-1>
Key: <metastore.client.cache.v2.enabled> old hive key: <hive.metastore.client.cache.v2.enabled>  value: <true>
Key: <metastore.client.cache.v2.maxSize> old hive key: <hive.metastore.client.cache.v2.maxSize>  value: <1Gb>
Key: <metastore.client.cache.v2.recordStats> old hive key: <hive.metastore.client.cache.v2.recordStats>  value: <false>
Key: <metastore.log4j.file> old hive key: <hive.log4j.file>  value: <>
Key: <javax.jdo.PersistenceManagerFactoryClass> old hive key: <javax.jdo.PersistenceManagerFactoryClass>  value: <org.datanucleus.api.jdo.JDOPersistenceManagerFactory>
Key: <metastore.materializations.invalidation.impl> old hive key: <hive.metastore.materializations.invalidation.impl>  value: <DEFAULT>
Key: <metastore.materializations.invalidation.clean.frequency> old hive key: <hive.metastore.materializations.invalidation.clean.frequency>  value: <3600s>
Key: <metastore.materializations.invalidation.max.duration> old hive key: <hive.metastore.materializations.invalidation.max.duration>  value: <86400s>
Key: <metastore.runtime.stats.clean.frequency> old hive key: <hive.metastore.runtime.stats.clean.frequency>  value: <3600s>
Key: <metastore.runtime.stats.max.age> old hive key: <hive.metastore.runtime.stats.max.age>  value: <259200s>
Key: <metastore.scheduled.queries.enabled> old hive key: <hive.metastore.scheduled.queries.enabled>  value: <true>
Key: <metastore.scheduled.queries.execution.timeout> old hive key: <hive.metastore.scheduled.queries.progress.timeout>  value: <120s>
Key: <metastore.scheduled.queries.execution.maint.task.frequency> old hive key: <hive.metastore.scheduled.queries.execution.clean.frequency>  value: <60s>
Key: <metastore.scheduled.queries.execution.max.age> old hive key: <hive.metastore.scheduled.queries.execution.max.age>  value: <2592000s>
Key: <metastore.scheduled.queries.autodisable.count> old hive key: <metastore.scheduled.queries.autodisable.count>  value: <0>
Key: <metastore.scheduled.queries.skip.opportunities.after.failures> old hive key: <metastore.scheduled.queries.skip.opportunities.after.failures>  value: <0>
Key: <metastore.metadata.export.location> old hive key: <hive.metadata.export.location>  value: <>
Key: <metastore.max.event.response> old hive key: <hive.metastore.max.event.response>  value: <1000000>
Key: <metastore.client.filter.enabled> old hive key: <hive.metastore.client.filter.enabled>  value: <true>
Key: <metastore.server.filter.enabled> old hive key: <hive.metastore.server.filter.enabled>  value: <false>
Key: <metastore.metadata.move.exported.metadata.to.trash> old hive key: <hive.metadata.move.exported.metadata.to.trash>  value: <true>
Key: <metastore.metrics.enabled> old hive key: <hive.metastore.metrics.enabled>  value: <false>
Key: <metastore.metrics.hadoop2.component> old hive key: <hive.service.metrics.hadoop2.component>  value: <hivemetastore>
Key: <metastore.metrics.file.frequency> old hive key: <hive.service.metrics.file.frequency>  value: <60000ms>
Key: <metastore.metrics.file.location> old hive key: <hive.service.metrics.file.location>  value: </tmp/report.json>
Key: <metastore.metrics.slf4j.frequency> old hive key: <hive.service.metrics.slf4j.frequency>  value: <5m>
Key: <metastore.metrics.slf4j.logging.level> old hive key: <hive.service.metrics.slf4j.logging.level>  value: <INFO>
Key: <metastore.metrics.reporters> old hive key: <metastore.metrics.reporters>  value: <json,jmx>
Key: <metastore.msck.path.validation> old hive key: <hive.msck.path.validation>  value: <throw>
Key: <metastore.msck.repair.batch.size> old hive key: <hive.msck.repair.batch.size>  value: <3000>
Key: <metastore.msck.repair.batch.max.retries> old hive key: <hive.msck.repair.batch.max.retries>  value: <4>
Key: <metastore.msck.repair.enable.partition.retention> old hive key: <metastore.msck.repair.enable.partition.retention>  value: <false>
Key: <metastore.partition.management.task.frequency> old hive key: <metastore.partition.management.task.frequency>  value: <300s>
Key: <metastore.partition.management.table.types> old hive key: <metastore.partition.management.table.types>  value: <MANAGED_TABLE,EXTERNAL_TABLE>
Key: <metastore.partition.management.task.thread.pool.size> old hive key: <metastore.partition.management.task.thread.pool.size>  value: <3>
Key: <metastore.partition.management.catalog.name> old hive key: <metastore.partition.management.catalog.name>  value: <hive>
Key: <metastore.partition.management.database.pattern> old hive key: <metastore.partition.management.database.pattern>  value: <*>
Key: <metastore.partition.management.table.pattern> old hive key: <metastore.partition.management.table.pattern>  value: <*>
Key: <metastore.metadata.transformer.class> old hive key: <metastore.metadata.transformer.class>  value: <org.apache.hadoop.hive.metastore.MetastoreDefaultTransformer>
Key: <metastore.metadata.transformer.translated.to.external.follows.renames> old hive key: <metastore.metadata.transformer.translated.to.external.follows.renames>  value: <true>
Key: <metastore.metadata.transformer.location.mode> old hive key: <metastore.metadata.transformer.location.mode>  value: <force>
Key: <javax.jdo.option.Multithreaded> old hive key: <javax.jdo.option.Multithreaded>  value: <true>
Key: <metastore.max.open.txns> old hive key: <hive.max.open.txns>  value: <100000>
Key: <javax.jdo.option.NonTransactionalRead> old hive key: <javax.jdo.option.NonTransactionalRead>  value: <true>
Key: <metastore.notification.sequence.lock.max.retries> old hive key: <hive.notification.sequence.lock.max.retries>  value: <10>
Key: <metastore.notification.sequence.lock.retry.sleep.interval> old hive key: <hive.notification.sequence.lock.retry.sleep.interval>  value: <10s>
Key: <metastore.orm.retrieveMapNullsAsEmptyStrings> old hive key: <hive.metastore.orm.retrieveMapNullsAsEmptyStrings>  value: <false>
Key: <metastore.partition.name.whitelist.pattern> old hive key: <hive.metastore.partition.name.whitelist.pattern>  value: <>
Key: <metastore.partition.inherit.table.properties> old hive key: <hive.metastore.partition.inherit.table.properties>  value: <>
Key: <metastore.pre.event.listeners> old hive key: <hive.metastore.pre.event.listeners>  value: <>
Key: <metastore.rawstore.impl> old hive key: <hive.metastore.rawstore.impl>  value: <org.apache.hadoop.hive.metastore.ObjectStore>
Key: <metastore.repl.cmrootdir> old hive key: <hive.repl.cmrootdir>  value: </user/${system:user.name}/cmroot/>
Key: <metastore.repl.cm.encryptionzone.rootdir> old hive key: <hive.repl.cm.encryptionzone.rootdir>  value: <.cmroot>
Key: <metastore.repl.cm.nonencryptionzone.rootdir> old hive key: <hive.repl.cm.nonencryptionzone.rootdir>  value: <>
Key: <metastore.repl.cm.retain> old hive key: <hive.repl.cm.retain>  value: <240h>
Key: <metastore.repl.cm.interval> old hive key: <hive.repl.cm.interval>  value: <3600s>
Key: <metastore.repl.cm.enabled> old hive key: <hive.repl.cm.enabled>  value: <false>
Key: <metastore.repl.rootdir> old hive key: <hive.repl.rootdir>  value: </user/${system:user.name}/repl/>
Key: <metastore.repl.copyfile.maxnumfiles> old hive key: <hive.exec.copyfile.maxnumfiles>  value: <1>
Key: <metastore.repl.copyfile.maxsize> old hive key: <hive.exec.copyfile.maxsize>  value: <33554432>
Key: <metastore.repl.event.db.listener.timetolive> old hive key: <hive.repl.event.db.listener.timetolive>  value: <10d>
Key: <metastore.repl.metrics.cache.maxsize> old hive key: <hive.repl.metrics.cache.maxsize>  value: <10000>
Key: <metastore.repl.metrics.update.frequency> old hive key: <hive.repl.metrics.update.frequency>  value: <1m>
Key: <metastore.repl.metrics.cleanup.frequency> old hive key: <hive.metastore.repl.metrics.cleanup.frequency>  value: <1d>
Key: <metastore.repl.metrics.max.age> old hive key: <hive.metastore.repl.metrics.max.age>  value: <7d>
Key: <metastore.repl.txn.timeout> old hive key: <hive.repl.txn.timeout>  value: <11d>
Key: <metastore.schema.info.class> old hive key: <hive.metastore.schema.info.class>  value: <org.apache.hadoop.hive.metastore.MetaStoreSchemaInfo>
Key: <metastore.schema.verification> old hive key: <hive.metastore.schema.verification>  value: <false>
Key: <metastore.schema.verification.record.version> old hive key: <hive.metastore.schema.verification.record.version>  value: <false>
Key: <metastore.serdes.using.metastore.for.schema> old hive key: <hive.serdes.using.metastore.for.schema>  value: <org.apache.hadoop.hive.ql.io.orc.OrcSerde,org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe,org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe,org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe,org.apache.hadoop.hive.serde2.columnar.LazyBinaryColumnarSerDe,org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe,org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe,org.apache.hadoop.hive.serde2.OpenCSVSerde>
Key: <metastore.server.max.message.size> old hive key: <hive.metastore.server.max.message.size>  value: <104857600>
Key: <metastore.server.max.threads> old hive key: <hive.metastore.server.max.threads>  value: <1000>
Key: <metastore.server.min.threads> old hive key: <hive.metastore.server.min.threads>  value: <200>
Key: <metastore.thrift.port> old hive key: <hive.metastore.port>  value: <9083>
Key: <metastore.keystore.path> old hive key: <hive.metastore.keystore.path>  value: <>
Key: <metastore.keystore.type> old hive key: <hive.metastore.keystore.type>  value: <>
Key: <metastore.keymanagerfactory.algorithm> old hive key: <hive.metastore.keymanagerfactory.algorithm>  value: <>
Key: <metastore.ssl.protocol.blacklist> old hive key: <hive.ssl.protocol.blacklist>  value: <SSLv2,SSLv3>
Key: <metastore.truststore.path> old hive key: <hive.metastore.truststore.path>  value: <>
Key: <metastore.truststore.type> old hive key: <hive.metastore.truststore.type>  value: <>
Key: <metastore.trustmanagerfactory.algorithm> old hive key: <hive.metastore.trustmanagerfactory.algorithm>  value: <>
Key: <metastore.stats.autogather> old hive key: <hive.stats.autogather>  value: <true>
Key: <metastore.stats.fetch.bitvector> old hive key: <hive.stats.fetch.bitvector>  value: <false>
Key: <metastore.stats.ndv.tuner> old hive key: <hive.metastore.stats.ndv.tuner>  value: <0.0>
Key: <metastore.stats.ndv.densityfunction> old hive key: <hive.metastore.stats.ndv.densityfunction>  value: <false>
Key: <metastore.stats.default.aggregator> old hive key: <hive.stats.default.aggregator>  value: <>
Key: <metastore.stats.default.publisher> old hive key: <hive.stats.default.publisher>  value: <>
Key: <metastore.stats.auto.analyze> old hive key: <hive.metastore.stats.auto.analyze>  value: <none>
Key: <metastore.stats.auto.analyze.noop.wait> old hive key: <hive.metastore.stats.auto.analyze.noop.wait>  value: <5m>
Key: <metastore.stats.auto.analyze.worker.count> old hive key: <hive.metastore.stats.auto.analyze.worker.count>  value: <1>
Key: <metastore.storage.schema.reader.impl> old hive key: <metastore.storage.schema.reader.impl>  value: <org.apache.hadoop.hive.metastore.DefaultStorageSchemaReader>
Key: <datanucleus.storeManagerType> old hive key: <datanucleus.storeManagerType>  value: <rdbms>
Key: <metastore.strict.managed.tables> old hive key: <hive.strict.managed.tables>  value: <false>
Key: <metastore.support.special.characters.tablename> old hive key: <hive.support.special.characters.tablename>  value: <true>
Key: <metastore.task.threads.always> old hive key: <metastore.task.threads.always>  value: <org.apache.hadoop.hive.metastore.events.EventCleanerTask,org.apache.hadoop.hive.metastore.RuntimeStatsCleanerTask,org.apache.hadoop.hive.metastore.metrics.AcidMetricService,org.apache.hadoop.hive.metastore.HiveProtoEventsCleanerTask,org.apache.hadoop.hive.metastore.ScheduledQueryExecutionsMaintTask,org.apache.hadoop.hive.metastore.ReplicationMetricsMaintTask>
Key: <metastore.task.threads.remote> old hive key: <metastore.task.threads.remote>  value: <org.apache.hadoop.hive.metastore.txn.AcidHouseKeeperService,org.apache.hadoop.hive.metastore.txn.AcidTxnCleanerService,org.apache.hadoop.hive.metastore.txn.AcidOpenTxnsCounterService,org.apache.hadoop.hive.metastore.MaterializationsRebuildLockCleanerTask,org.apache.hadoop.hive.metastore.PartitionManagementTask>
Key: <metastore.server.tcp.keepalive> old hive key: <hive.metastore.server.tcp.keepalive>  value: <true>
Key: <metastore.thread.pool.size> old hive key: <no.such>  value: <10>
Key: <metastore.connect.retries> old hive key: <hive.metastore.connect.retries>  value: <3>
Key: <metastore.failure.retries> old hive key: <hive.metastore.failure.retries>  value: <1>
Key: <metastore.thrift.bind.host> old hive key: <hive.metastore.thrift.bind.host>  value: <>
Key: <metastore.thrift.uris> old hive key: <hive.metastore.uris>  value: <>
Key: <metastore.service.discovery.mode> old hive key: <hive.metastore.service.discovery.mode>  value: <>
Key: <metastore.zookeeper.kerberos.enabled> old hive key: <hive.zookeeper.kerberos.enabled>  value: <true>
Key: <metastore.zookeeper.client.port> old hive key: <hive.zookeeper.client.port>  value: <2181>
Key: <metastore.zookeeper.session.timeout> old hive key: <hive.zookeeper.session.timeout>  value: <120000ms>
Key: <metastore.zookeeper.connection.timeout> old hive key: <hive.zookeeper.connection.timeout>  value: <15s>
Key: <metastore.zookeeper.namespace> old hive key: <hive.zookeeper.namespace>  value: <hive_metastore>
Key: <metastore.zookeeper.connection.max.retries> old hive key: <hive.zookeeper.connection.max.retries>  value: <3>
Key: <metastore.zookeeper.connection.basesleeptime> old hive key: <hive.zookeeper.connection.basesleeptime>  value: <1000ms>
Key: <metastore.zookeeper.ssl.client.enable> old hive key: <hive.zookeeper.ssl.client.enable>  value: <false>
Key: <metastore.zookeeper.ssl.keystore.location> old hive key: <hive.zookeeper.ssl.keystore.location>  value: <>
Key: <metastore.zookeeper.ssl.truststore.location> old hive key: <hive.zookeeper.ssl.truststore.location>  value: <>
Key: <metastore.thrift.uri.selection> old hive key: <hive.metastore.uri.selection>  value: <RANDOM>
Key: <metastore.token.signature> old hive key: <hive.metastore.token.signature>  value: <>
Key: <metastore.cache.can.use.event> old hive key: <hive.metastore.cache.can.use.event>  value: <false>
Key: <metastore.transactional.event.listeners> old hive key: <hive.metastore.transactional.event.listeners>  value: <>
Key: <metastore.try.direct.sql> old hive key: <hive.metastore.try.direct.sql>  value: <true>
Key: <metastore.try.direct.sql.ddl> old hive key: <hive.metastore.try.direct.sql.ddl>  value: <true>
Key: <metastore.txn.max.open.batch> old hive key: <hive.txn.max.open.batch>  value: <1000>
Key: <metastore.txn.retryable.sqlex.regex> old hive key: <hive.txn.retryable.sqlex.regex>  value: <>
Key: <metastore.txn.store.impl> old hive key: <hive.metastore.txn.store.impl>  value: <org.apache.hadoop.hive.metastore.txn.CompactionTxnHandler>
Key: <metastore.txn.timeout> old hive key: <hive.txn.timeout>  value: <300s>
Key: <metastore.txn.opentxn.timeout> old hive key: <hive.txn.opentxn.timeout>  value: <1000ms>
Key: <metastore.txn.use.minhistorylevel> old hive key: <hive.txn.use.minhistorylevel>  value: <true>
Key: <metastore.uri.resolver> old hive key: <hive.metastore.uri.resolver>  value: <>
Key: <metastore.users.in.admin.role> old hive key: <hive.users.in.admin.role>  value: <>
Key: <metastore.use.SSL> old hive key: <hive.metastore.use.SSL>  value: <false>
Key: <metastore.sasl.enabled> old hive key: <hive.metastore.sasl.enabled>  value: <false>
Key: <metastore.client.auth.mode> old hive key: <hive.metastore.client.auth.mode>  value: <NOSASL>
Key: <metastore.client.plain.username> old hive key: <hive.metastore.client.plain.username>  value: <>
Key: <metastore.authentication.config.username> old hive key: <hive.metastore.authentication.config.username>  value: <>
Key: <metastore.authentication.config.password> old hive key: <hive.metastore.authentication.config.password>  value: <>
Key: <metastore.thrift.framed.transport.enabled> old hive key: <hive.metastore.thrift.framed.transport.enabled>  value: <false>
Key: <metastore.thrift.compact.protocol.enabled> old hive key: <hive.metastore.thrift.compact.protocol.enabled>  value: <false>
Key: <datanucleus.schema.validateColumns> old hive key: <datanucleus.schema.validateColumns>  value: <false>
Key: <datanucleus.schema.validateConstraints> old hive key: <datanucleus.schema.validateConstraints>  value: <false>
Key: <datanucleus.schema.validateTables> old hive key: <datanucleus.schema.validateTables>  value: <false>
Key: <metastore.warehouse.dir> old hive key: <hive.metastore.warehouse.dir>  value: <file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse>
Key: <metastore.warehouse.external.dir> old hive key: <hive.metastore.warehouse.external.dir>  value: <file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external>
Key: <metastore.wm.default.pool.size> old hive key: <hive.metastore.wm.default.pool.size>  value: <4>
Key: <metastore.rawstore.batch.size> old hive key: <metastore.rawstore.batch.size>  value: <-1>
Key: <hive.metastore.runworker.in> old hive key: <hive.metastore.runworker.in>  value: <metastore>
Key: <hive.in.test> old hive key: <hive.in.test>  value: <false>
Key: <hive.in.tez.test> old hive key: <hive.in.tez.test>  value: <false>
Key: <hive.in.iceberg.test> old hive key: <hive.in.iceberg.test>  value: <false>
Key: <hive.security.authorization.manager> old hive key: <hive.security.authorization.manager>  value: <org.apache.hadoop.hive.ql.security.authorization.plugin.sqlstd.SQLStdHiveAuthorizerFactory>
Key: <hive.security.metastore.authenticator.manager> old hive key: <hive.security.metastore.authenticator.manager>  value: <org.apache.hadoop.hive.ql.security.HadoopDefaultMetastoreAuthenticator>
Key: <hive.security.metastore.authorization.auth.reads> old hive key: <hive.security.metastore.authorization.auth.reads>  value: <true>
Key: <hive.txn.manager> old hive key: <hive.txn.manager>  value: <org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager>
Key: <hive.support.concurrency> old hive key: <hive.support.concurrency>  value: <false>
Key: <hive.txn.stats.enabled> old hive key: <hive.txn.stats.enabled>  value: <true>
Key: <metastore.use.custom.database.product> old hive key: <hive.metastore.use.custom.database.product>  value: <false>
Key: <metastore.custom.database.product.classname> old hive key: <hive.metastore.custom.database.product.classname>  value: <none>
Key: <hive.blobstore.supported.schemes> old hive key: <hive.blobstore.supported.schemes>  value: <s3,s3a,s3n>
Key: <hive.service.metrics.codahale.reporter.classes> old hive key: <hive.service.metrics.codahale.reporter.classes>  value: <>
Key: <hive.service.metrics.reporter> old hive key: <hive.service.metrics.reporter>  value: <>
Key: <metastore.dbaccess.ssl.properties> old hive key: <hive.metastore.dbaccess.ssl.properties>  value: <>
Key: <metastore.num.striped.table.locks> old hive key: <hive.metastore.num.striped.table.locks>  value: <32>
Key: <metastore.colstats.retain.on.column.removal> old hive key: <hive.metastore.colstats.retain.on.column.removal>  value: <true>
Key: <test.str> old hive key: <hive.test.str>  value: <defaultval>
Key: <test.str.set> old hive key: <hive.test.str.set>  value: <a>
Key: <test.str.list> old hive key: <hive.test.str.list>  value: <a,b,c>
Key: <test.long> old hive key: <hive.test.long>  value: <42>
Key: <test.double> old hive key: <hive.test.double>  value: <3.141592653589793>
Key: <test.time> old hive key: <hive.test.time>  value: <1s>
Key: <test.deprecated> old hive key: <hive.test.deprecated>  value: <0>
Key: <test.time.validator.inclusive> old hive key: <hive.test.time.validator.inclusive>  value: <1s>
Key: <test.time.validator.exclusive> old hive key: <hive.test.time.validator.exclusive>  value: <1s>
Key: <test.bool> old hive key: <hive.test.bool>  value: <true>
Key: <test.class> old hive key: <hive.test.class>  value: <>
Finished MetastoreConf object.

[INFO ] 2024-04-23 23:21:10.797 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[DEBUG] 2024-04-23 23:21:10.928 [main] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:21:10.938 [main] HMSHandler - 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:21:10.977 [main] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:21:10.978 [main] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:21:10.978 [main] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:21:10.978 [main] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:21:10.978 [main] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:21:10.978 [main] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:21:10.978 [main] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:21:10.978 [main] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:21:10.979 [main] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:21:10.979 [main] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:21:10.979 [main] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:21:10.979 [main] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:21:10.979 [main] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:21:10.979 [main] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:21:10.979 [main] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:21:10.979 [main] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:21:10.979 [main] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:21:10.980 [main] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with true
[DEBUG] 2024-04-23 23:21:10.980 [main] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:21:10.980 [main] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:21:10.980 [main] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:21:10.980 [main] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:21:10.980 [main] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:21:10.989 [main] Shell - Failed to detect a valid hadoop home directory
java.io.FileNotFoundException: HADOOP_HOME and hadoop.home.dir are unset.
	at org.apache.hadoop.util.Shell.checkHadoopHomeInner(Shell.java:469) ~[hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.util.Shell.checkHadoopHome(Shell.java:440) ~[hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.util.Shell.<clinit>(Shell.java:517) ~[hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.util.StringUtils.<clinit>(StringUtils.java:78) ~[hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.conf.Configuration.getStringCollection(Configuration.java:2170) ~[hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.security.alias.CredentialProviderFactory.getProviders(CredentialProviderFactory.java:65) ~[hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.conf.Configuration.getPasswordFromCredentialProviders(Configuration.java:2340) ~[hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.conf.Configuration.getPassword(Configuration.java:2278) ~[hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.hive.metastore.conf.MetastoreConf.getPassword(MetastoreConf.java:2261) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.PersistenceManagerProvider.lambda$getDataSourceProps$1(PersistenceManagerProvider.java:457) ~[classes/:?]
	at com.google.common.base.Suppliers$MemoizingSupplier.get(Suppliers.java:131) [guava-19.0.jar:?]
	at org.apache.hadoop.hive.metastore.PersistenceManagerProvider.getDataSourceProps(PersistenceManagerProvider.java:462) [classes/:?]
	at org.apache.hadoop.hive.metastore.PersistenceManagerProvider.updatePmfProperties(PersistenceManagerProvider.java:152) [classes/:?]
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:357) [classes/:?]
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:77) [hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:137) [hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:59) [classes/:?]
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:67) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.newRawStoreForConf(HMSHandler.java:727) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.getMSForConf(HMSHandler.java:695) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.getMS(HMSHandler.java:689) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.createDefaultDB(HMSHandler.java:783) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.init(HMSHandler.java:431) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:80) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:93) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:133) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.callEmbeddedMetastore(HiveMetaStoreClient.java:293) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:207) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:164) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.setUp(TestMetaStoreAcidCleanup.java:59) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
[DEBUG] 2024-04-23 23:21:11.012 [main] Shell - setsid exited with exit code 0
[DEBUG] 2024-04-23 23:21:11.012 [main] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:21:11.012 [main] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:21:11.012 [main] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:21:11.013 [main] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:21:11.013 [main] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:21:11.013 [main] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:21:11.013 [main] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:21:11.013 [main] PersistenceManagerProvider - javax.jdo.option.Multithreaded = true
[DEBUG] 2024-04-23 23:21:11.013 [main] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:21:11.013 [main] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:21:11.013 [main] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:21:11.014 [main] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:21:11.014 [main] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:21:11.014 [main] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:21:11.014 [main] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:21:11.014 [main] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:21:11.014 [main] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:21:11.014 [main] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:21:11.014 [main] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:21:11.014 [main] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:21:11.014 [main] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:21:11.014 [main] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:21:11.014 [main] PersistenceManagerProvider - Updating the pmf due to property change
[INFO ] 2024-04-23 23:21:11.015 [main] PersistenceManagerProvider - Current pmf properties are uninitialized
[DEBUG] 2024-04-23 23:21:11.026 [main] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:21:11.038 [main] HikariConfig - HikariPool-1 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:21:11.038 [main] HikariConfig - HikariPool-1 - configuration:
[DEBUG] 2024-04-23 23:21:11.040 [main] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:21:11.040 [main] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:21:11.041 [main] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:21:11.041 [main] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:21:11.041 [main] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:21:11.041 [main] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:21:11.041 [main] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:21:11.041 [main] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:21:11.041 [main] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:21:11.042 [main] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:21:11.042 [main] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:21:11.042 [main] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:21:11.042 [main] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:21:11.042 [main] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:21:11.043 [main] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:21:11.043 [main] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:21:11.043 [main] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:21:11.043 [main] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:21:11.043 [main] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true"
[DEBUG] 2024-04-23 23:21:11.043 [main] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:21:11.043 [main] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:21:11.043 [main] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:21:11.043 [main] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:21:11.043 [main] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:21:11.043 [main] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:21:11.044 [main] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:21:11.044 [main] HikariConfig - poolName........................"HikariPool-1"
[DEBUG] 2024-04-23 23:21:11.044 [main] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:21:11.044 [main] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:21:11.044 [main] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:21:11.044 [main] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:21:11.044 [main] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:21:11.044 [main] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:21:11.045 [main] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:21:11.045 [main] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:21:11.046 [main] HikariDataSource - HikariPool-1 - Starting...
[INFO ] 2024-04-23 23:21:11.515 [main] PoolBase - HikariPool-1 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:21:11.517 [main] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:21:11.519 [main] HikariDataSource - HikariPool-1 - Start completed.
log4j: Trying to find [log4j.xml] using context classloader sun.misc.Launcher$AppClassLoader@330bedb4.
log4j: Trying to find [log4j.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
log4j: Trying to find [log4j.xml] using ClassLoader.getSystemResource().
log4j: Trying to find [log4j.properties] using context classloader sun.misc.Launcher$AppClassLoader@330bedb4.
log4j: Trying to find [log4j.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
log4j: Trying to find [log4j.properties] using ClassLoader.getSystemResource().
log4j: Could not find resource: [null].
[DEBUG] 2024-04-23 23:21:11.619 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:21:11.622 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@876032991 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:11.624 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1963604452 (XID = 170), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:11.625 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1144334800 (XID = 172), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:11.626 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@354797227 (XID = 174), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:11.627 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1006008382 (XID = 176), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:11.628 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@292241215 (XID = 178), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:11.629 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1248007708 (XID = 180), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:11.631 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@770998379 (XID = 182), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:11.632 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1484868535 (XID = 184), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:11.632 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:21:12.103 [main] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:21:12.103 [main] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@69e308c6, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:21:12.103 [main] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:21:12.120 [main] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@69e308c6, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@29f0802c created in the thread with id: 1
[DEBUG] 2024-04-23 23:21:12.128 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:12.129 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:12.130 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[WARN ] 2024-04-23 23:21:12.164 [main] MetaStoreDirectSql - Self-test query [select "DB_ID" from "DBS"] failed; direct SQL is disabled
javax.jdo.JDODataStoreException: Error executing SQL query "select "DB_ID" from "DBS"".
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542) ~[datanucleus-api-jdo-5.2.4.jar:?]
	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:456) ~[datanucleus-api-jdo-5.2.4.jar:?]
	at org.datanucleus.api.jdo.JDOQuery.execute(JDOQuery.java:263) ~[datanucleus-api-jdo-5.2.4.jar:?]
	at org.apache.hadoop.hive.metastore.QueryWrapper.execute(QueryWrapper.java:112) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.runTestQuery(MetaStoreDirectSql.java:326) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreDirectSql.<init>(MetaStoreDirectSql.java:214) [classes/:?]
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:415) [classes/:?]
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:370) [classes/:?]
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:77) [hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:137) [hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.hive.metastore.RawStoreProxy.<init>(RawStoreProxy.java:59) [classes/:?]
	at org.apache.hadoop.hive.metastore.RawStoreProxy.getProxy(RawStoreProxy.java:67) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.newRawStoreForConf(HMSHandler.java:727) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.getMSForConf(HMSHandler.java:695) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.getMS(HMSHandler.java:689) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.createDefaultDB(HMSHandler.java:783) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.init(HMSHandler.java:431) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.<init>(RetryingHMSHandler.java:80) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:93) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:133) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.callEmbeddedMetastore(HiveMetaStoreClient.java:293) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:207) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:164) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.setUp(TestMetaStoreAcidCleanup.java:59) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: java.sql.SQLSyntaxErrorException: Table/View 'DBS' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.<init>(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement42.<init>(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.jdbc.Driver42.newEmbedPreparedStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyConnection.prepareStatement(ProxyConnection.java:325) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyConnection.prepareStatement(HikariProxyConnection.java) ~[HikariCP-2.6.1.jar:?]
	at org.datanucleus.store.rdbms.SQLController.getStatementForQuery(SQLController.java:349) ~[datanucleus-rdbms-5.2.4.jar:?]
	at org.datanucleus.store.rdbms.query.RDBMSQueryUtils.getPreparedStatementForQuery(RDBMSQueryUtils.java:224) ~[datanucleus-rdbms-5.2.4.jar:?]
	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:652) ~[datanucleus-rdbms-5.2.4.jar:?]
	at org.datanucleus.store.query.Query.executeQuery(Query.java:1975) ~[datanucleus-core-5.2.4.jar:?]
	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:818) ~[datanucleus-rdbms-5.2.4.jar:?]
	at org.datanucleus.store.query.Query.execute(Query.java:1846) ~[datanucleus-core-5.2.4.jar:?]
	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:439) ~[datanucleus-api-jdo-5.2.4.jar:?]
	... 63 more
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'DBS' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.<init>(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement42.<init>(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.jdbc.Driver42.newEmbedPreparedStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyConnection.prepareStatement(ProxyConnection.java:325) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyConnection.prepareStatement(HikariProxyConnection.java) ~[HikariCP-2.6.1.jar:?]
	at org.datanucleus.store.rdbms.SQLController.getStatementForQuery(SQLController.java:349) ~[datanucleus-rdbms-5.2.4.jar:?]
	at org.datanucleus.store.rdbms.query.RDBMSQueryUtils.getPreparedStatementForQuery(RDBMSQueryUtils.java:224) ~[datanucleus-rdbms-5.2.4.jar:?]
	at org.datanucleus.store.rdbms.query.SQLQuery.performExecute(SQLQuery.java:652) ~[datanucleus-rdbms-5.2.4.jar:?]
	at org.datanucleus.store.query.Query.executeQuery(Query.java:1975) ~[datanucleus-core-5.2.4.jar:?]
	at org.datanucleus.store.rdbms.query.SQLQuery.executeWithArray(SQLQuery.java:818) ~[datanucleus-rdbms-5.2.4.jar:?]
	at org.datanucleus.store.query.Query.execute(Query.java:1846) ~[datanucleus-core-5.2.4.jar:?]
	at org.datanucleus.api.jdo.JDOQuery.executeInternal(JDOQuery.java:439) ~[datanucleus-api-jdo-5.2.4.jar:?]
	... 63 more
[DEBUG] 2024-04-23 23:21:12.167 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:12.168 [main] ObjectStore - Initialized ObjectStore
[DEBUG] 2024-04-23 23:21:12.248 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:12.840 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:12.905 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:12.906 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:12.908 [main] MetaStoreSchemaInfoFactory - HIVE_HOME is not set. Using current directory instead
[WARN ] 2024-04-23 23:21:12.913 [main] ObjectStore - Version information not found in metastore. metastore.schema.verification is not enabled so recording the schema version 4.0.0
[WARN ] 2024-04-23 23:21:12.913 [main] ObjectStore - setMetaStoreSchemaVersion called but recording version is disabled: version = 4.0.0, comment = Set by MetaStore alex@127.0.1.1
[INFO ] 2024-04-23 23:21:12.913 [main] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@69e308c6 from thread id: 1
[DEBUG] 2024-04-23 23:21:12.913 [main] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:21:12.914 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:12.953 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:12.962 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:12.963 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:13.012 [main] MutableMetricsFactory - field org.apache.hadoop.metrics2.lib.MutableRate org.apache.hadoop.security.UserGroupInformation$UgiMetrics.getGroups with annotation @org.apache.hadoop.metrics2.annotation.Metric(valueName=Time, value=[GetGroups], about=, type=DEFAULT, sampleName=Ops, always=false)
[DEBUG] 2024-04-23 23:21:13.016 [main] MutableMetricsFactory - field private org.apache.hadoop.metrics2.lib.MutableGaugeLong org.apache.hadoop.security.UserGroupInformation$UgiMetrics.renewalFailuresTotal with annotation @org.apache.hadoop.metrics2.annotation.Metric(about=, sampleName=Ops, valueName=Time, type=DEFAULT, value=[Renewal failures since startup], always=false)
[DEBUG] 2024-04-23 23:21:13.017 [main] MutableMetricsFactory - field org.apache.hadoop.metrics2.lib.MutableRate org.apache.hadoop.security.UserGroupInformation$UgiMetrics.loginSuccess with annotation @org.apache.hadoop.metrics2.annotation.Metric(type=DEFAULT, about=, value=[Rate of successful kerberos logins and latency (milliseconds)], sampleName=Ops, always=false, valueName=Time)
[DEBUG] 2024-04-23 23:21:13.017 [main] MutableMetricsFactory - field private org.apache.hadoop.metrics2.lib.MutableGaugeInt org.apache.hadoop.security.UserGroupInformation$UgiMetrics.renewalFailures with annotation @org.apache.hadoop.metrics2.annotation.Metric(about=, always=false, type=DEFAULT, valueName=Time, sampleName=Ops, value=[Renewal failures since last successful login])
[DEBUG] 2024-04-23 23:21:13.017 [main] MutableMetricsFactory - field org.apache.hadoop.metrics2.lib.MutableRate org.apache.hadoop.security.UserGroupInformation$UgiMetrics.loginFailure with annotation @org.apache.hadoop.metrics2.annotation.Metric(sampleName=Ops, always=false, about=, type=DEFAULT, valueName=Time, value=[Rate of failed kerberos logins and latency (milliseconds)])
[DEBUG] 2024-04-23 23:21:13.018 [main] MetricsSystemImpl - UgiMetrics, User and group related metrics
[DEBUG] 2024-04-23 23:21:13.034 [main] SecurityUtil - Setting hadoop.security.token.service.use_ip to true
[DEBUG] 2024-04-23 23:21:13.051 [main] Groups -  Creating new Groups object
[DEBUG] 2024-04-23 23:21:13.052 [main] NativeCodeLoader - Trying to load the custom-built native-hadoop library...
[DEBUG] 2024-04-23 23:21:13.053 [main] NativeCodeLoader - Failed to load native-hadoop with error: java.lang.UnsatisfiedLinkError: no hadoop in java.library.path
[DEBUG] 2024-04-23 23:21:13.053 [main] NativeCodeLoader - java.library.path=/usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
[WARN ] 2024-04-23 23:21:13.053 [main] NativeCodeLoader - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[DEBUG] 2024-04-23 23:21:13.053 [main] PerformanceAdvisory - Falling back to shell based
[DEBUG] 2024-04-23 23:21:13.054 [main] JniBasedUnixGroupsMappingWithFallback - Group mapping impl=org.apache.hadoop.security.ShellBasedUnixGroupsMapping
[DEBUG] 2024-04-23 23:21:13.068 [main] Groups - Group mapping impl=org.apache.hadoop.security.JniBasedUnixGroupsMappingWithFallback; cacheTimeout=300000; warningDeltaMs=5000
[DEBUG] 2024-04-23 23:21:13.071 [main] UserGroupInformation - hadoop login
[DEBUG] 2024-04-23 23:21:13.072 [main] UserGroupInformation - hadoop login commit
[DEBUG] 2024-04-23 23:21:13.073 [main] UserGroupInformation - using local user:UnixPrincipal: alex
[DEBUG] 2024-04-23 23:21:13.073 [main] UserGroupInformation - Using user: "UnixPrincipal: alex" with name alex
[DEBUG] 2024-04-23 23:21:13.073 [main] UserGroupInformation - User entry: "alex"
[DEBUG] 2024-04-23 23:21:13.074 [main] UserGroupInformation - UGI loginUser:alex (auth:SIMPLE)
[DEBUG] 2024-04-23 23:21:13.086 [main] FileSystem - Loading filesystems
[DEBUG] 2024-04-23 23:21:13.093 [main] FileSystem - file:// = class org.apache.hadoop.fs.LocalFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar
[DEBUG] 2024-04-23 23:21:13.096 [main] FileSystem - viewfs:// = class org.apache.hadoop.fs.viewfs.ViewFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar
[DEBUG] 2024-04-23 23:21:13.097 [main] FileSystem - har:// = class org.apache.hadoop.fs.HarFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar
[DEBUG] 2024-04-23 23:21:13.098 [main] FileSystem - http:// = class org.apache.hadoop.fs.http.HttpFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar
[DEBUG] 2024-04-23 23:21:13.098 [main] FileSystem - https:// = class org.apache.hadoop.fs.http.HttpsFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar
[DEBUG] 2024-04-23 23:21:13.104 [main] FileSystem - hdfs:// = class org.apache.hadoop.hdfs.DistributedFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.1.0/hadoop-hdfs-client-3.1.0.jar
[DEBUG] 2024-04-23 23:21:13.235 [main] FileSystem - webhdfs:// = class org.apache.hadoop.hdfs.web.WebHdfsFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.1.0/hadoop-hdfs-client-3.1.0.jar
[DEBUG] 2024-04-23 23:21:13.235 [main] FileSystem - swebhdfs:// = class org.apache.hadoop.hdfs.web.SWebHdfsFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.1.0/hadoop-hdfs-client-3.1.0.jar
[DEBUG] 2024-04-23 23:21:13.236 [main] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:21:13.236 [main] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:21:13.248 [main] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:21:13.248 [main] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:21:13.252 [main] ObjectStore - Creating catalog Catalog(name:hive, description:Default catalog, for Hive, locationUri:file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse, createTime:1713910873)
[DEBUG] 2024-04-23 23:21:13.253 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:13.312 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:13.324 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:13.327 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:13.329 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:13.329 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:13.329 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:13.392 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:13.398 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:13.398 [main] ObjectStore - Rollback transaction, isActive: true
[DEBUG] 2024-04-23 23:21:13.399 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:13.399 [main] ObjectStore - rolling back transaction: no open transactions: 0
[INFO ] 2024-04-23 23:21:13.399 [main] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:21:13.400 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:13.411 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:13.420 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:13.421 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:13.431 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:21:13.432 [main] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:21:13.432 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:13.432 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:13.449 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:13.453 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:13.461 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@876032991 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:13.463 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:13.464 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:21:13.464 [main] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:21:13.464 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:13.464 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:13.465 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:13.466 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:13.467 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:21:13.468 [main] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:21:13.471 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:13.472 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:13.475 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:13.477 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:13.497 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@876032991 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:13.503 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:13.511 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@876032991 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:13.514 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:13.516 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:21:13.516 [main] HMSHandler - No user is added in admin role, since config is empty
[DEBUG] 2024-04-23 23:21:13.519 [main] ThreadPool - ThreadPool initialized
[INFO ] 2024-04-23 23:21:13.519 [main] HMSHandler - Scheduling for org.apache.hadoop.hive.metastore.events.EventCleanerTask service with frequency 0ms.
[INFO ] 2024-04-23 23:21:13.521 [main] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:21:13.524 [main] PerfLogger - </PERFLOG method=init start=1713910870928 end=1713910873524 duration=2596 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:13.646 [main] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:13.646 [main] HMSHandler - 0: create_database: Database(name:db, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:21:13.646 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:db, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[DEBUG] 2024-04-23 23:21:13.646 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:13.646 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:13.646 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:13.648 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:13.648 [main] ObjectStore - Rollback transaction, isActive: true
[DEBUG] 2024-04-23 23:21:13.648 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:13.648 [main] ObjectStore - rolling back transaction: no open transactions: 0
[DEBUG] 2024-04-23 23:21:13.649 [main] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:21:13.649 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:13.650 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:13.651 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:13.653 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[WARN ] 2024-04-23 23:21:13.657 [main] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db.db for database db. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:21:13.657 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:13.658 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:13.659 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:13.667 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:13.668 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:13.669 [main] PerfLogger - </PERFLOG method=create_database start=1713910873646 end=1713910873669 duration=23 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:13.774 [main] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:13.774 [main] HMSHandler - 0: create_table_req: Table(tableName:tableDropDatabase, dbName:db, owner:alex, createTime:1713910873, lastAccessTime:1713910873, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:foo, type:string, comment:), FieldSchema(name:bar, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=true, transactional_properties=insert_only}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:21:13.775 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:tableDropDatabase, dbName:db, owner:alex, createTime:1713910873, lastAccessTime:1713910873, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:foo, type:string, comment:), FieldSchema(name:bar, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=true, transactional_properties=insert_only}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:21:13.775 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:13.775 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:13.775 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:13.778 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:13.779 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:13.784 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:13.784 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:13.784 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:13.784 [main] ObjectStore - db details for db db retrieved using ORM in 9.508155ms
[DEBUG] 2024-04-23 23:21:13.785 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:13.785 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:13.785 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 23:21:14.150 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.164 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:14.164 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:14.165 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:21:14.165 [main] MetastoreDefaultTransformer - Starting translation for CreateTable for processor HMSClient-@Lenovo-Bot with [HIVEMANAGEDINSERTWRITE, HIVEMANAGESTATS, HIVECACHEINVALIDATE, CONNECTORWRITE] on table tableDropDatabase
[DEBUG] 2024-04-23 23:21:14.165 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:14.165 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:14.165 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:14.171 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:14.172 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:14.172 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:14.172 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:14.172 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.172 [main] ObjectStore - db details for db db retrieved using ORM in 7.221177ms
[DEBUG] 2024-04-23 23:21:14.172 [main] MetastoreDefaultTransformer - Table is a MANAGED_TABLE
[DEBUG] 2024-04-23 23:21:14.173 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:14.173 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:14.173 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:14.175 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:14.175 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:14.176 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:14.176 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:14.176 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.176 [main] ObjectStore - db details for db db retrieved using ORM in 3.574379ms
[DEBUG] 2024-04-23 23:21:14.177 [main] MetastoreDefaultTransformer - Processor has required capabilities to be able to create INSERT-only tables
[WARN ] 2024-04-23 23:21:14.178 [main] TransactionalValidationListener - Could not verify InputFormat=org.apache.hadoop.hive.ql.io.HiveInputFormat or OutputFormat=org.apache.hadoop.hive.ql.io.HiveOutputFormat  for db.tableDropDatabase
[DEBUG] 2024-04-23 23:21:14.179 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:14.180 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:14.180 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:14.180 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:14.182 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:14.182 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:14.182 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:14.182 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:14.182 [main] ObjectStore - db details for db db retrieved using ORM in 2.902618ms
[DEBUG] 2024-04-23 23:21:14.183 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:14.183 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:14.183 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 23:21:14.184 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:14.184 [main] ObjectStore - Commit transaction: count = 1, isactive true
[WARN ] 2024-04-23 23:21:14.184 [main] HMSHandler - Location: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db.db/tabledropdatabase specified for non-external table:tableDropDatabase
[INFO ] 2024-04-23 23:21:14.186 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db.db/tabledropdatabase
[DEBUG] 2024-04-23 23:21:14.222 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:14.222 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:14.224 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:14.232 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@876032991 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.245 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@876032991 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.253 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@876032991 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.262 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@876032991 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.286 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:14.286 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:14.292 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.295 [main] PerfLogger - </PERFLOG method=create_table_req start=1713910873774 end=1713910874295 duration=521 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:14.307 [main] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:14.307 [main] HMSHandler - 0: get_database: db
[INFO ] 2024-04-23 23:21:14.308 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_database: db	
[DEBUG] 2024-04-23 23:21:14.308 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:14.308 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:14.308 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:14.310 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:14.311 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:14.311 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:14.311 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:14.311 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.311 [main] ObjectStore - db details for db db retrieved using ORM in 3.532829ms
[INFO ] 2024-04-23 23:21:14.311 [main] MetastoreDefaultTransformer - Starting translation for transformDatabase for processor HMSClient-@Lenovo-Bot with [HIVEMANAGEDINSERTWRITE, HIVEMANAGESTATS, HIVECACHEINVALIDATE, CONNECTORWRITE] on database db locationUri=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db.db managedLocationUri=null
[DEBUG] 2024-04-23 23:21:14.312 [main] MetastoreDefaultTransformer - Comparing DB and warehouse paths warehouse=/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse db.getLocationUri=/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db.db
[INFO ] 2024-04-23 23:21:14.312 [main] MetastoreDefaultTransformer - Transformer returning database:Database(name:db, description:null, locationUri:file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db.db, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:1713910873, type:NATIVE)
[DEBUG] 2024-04-23 23:21:14.312 [main] PerfLogger - </PERFLOG method=get_database_req start=1713910874307 end=1713910874312 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:14.313 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=6, comments=HMS client
[DEBUG] 2024-04-23 23:21:14.313 [main] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:14.313 [main] HMSHandler - 0: get_tables_by_type: db=@hive#db pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:21:14.313 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#db pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:21:14.313 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:21:14.313 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:21:14.313 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:14.313 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:14.313 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:14.315 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:14.316 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:14.316 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:14.316 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:14.316 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.316 [main] ObjectStore - db details for db db retrieved using ORM in 2.960683ms
[DEBUG] 2024-04-23 23:21:14.317 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:14.317 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:14.334 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:14.335 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:14.335 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:14.335 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.335 [main] ObjectStore - 0 entries retrieved using ORM in 18.1509ms
[DEBUG] 2024-04-23 23:21:14.335 [main] PerfLogger - </PERFLOG method=get_tables_by_type start=1713910874313 end=1713910874335 duration=22 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:14.335 [main] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:14.335 [main] HMSHandler - 0: get_all_tables: db=@hive#db
[INFO ] 2024-04-23 23:21:14.335 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db	
[DEBUG] 2024-04-23 23:21:14.336 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:14.336 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:14.344 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:14.344 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:14.344 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:14.345 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.345 [main] ObjectStore - 0 entries retrieved using ORM in 9.171264ms
[DEBUG] 2024-04-23 23:21:14.345 [main] PerfLogger - </PERFLOG method=get_all_tables start=1713910874335 end=1713910874345 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:14.345 [main] HiveMetaStoreClient - Selecting dropDatabase method for db (0 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:21:14.345 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:21:14.345 [main] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:14.345 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:14.345 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:14.345 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:14.347 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:14.347 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:14.347 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:14.347 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:14.348 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.348 [main] ObjectStore - db details for db db retrieved using ORM in 2.739859ms
[DEBUG] 2024-04-23 23:21:14.349 [main] HMSHandler - 0: get_multi_table : db=db tbls=
[INFO ] 2024-04-23 23:21:14.349 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=db tbls=	
[DEBUG] 2024-04-23 23:21:14.349 [main] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713910874345 end=1713910874349 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:14.349 [main] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:14.349 [main] HMSHandler - 0: drop_database: @hive#db
[INFO ] 2024-04-23 23:21:14.349 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db	
[DEBUG] 2024-04-23 23:21:14.349 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:14.349 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:14.350 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:14.350 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:14.352 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:14.352 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:14.352 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:14.352 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:14.352 [main] ObjectStore - db details for db db retrieved using ORM in 2.639161ms
[DEBUG] 2024-04-23 23:21:14.352 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 23:21:14.352 [main] HMSHandler - 0: get_all_tables: db=@hive#db
[INFO ] 2024-04-23 23:21:14.352 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db	
[DEBUG] 2024-04-23 23:21:14.353 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:14.353 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:14.356 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:14.356 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:14.356 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:14.356 [main] ObjectStore - 1 entries retrieved using ORM in 3.303449ms
[DEBUG] 2024-04-23 23:21:14.356 [main] HMSHandler - 0: get_functions: db=@hive#db pat=*
[INFO ] 2024-04-23 23:21:14.356 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db pat=*	
[DEBUG] 2024-04-23 23:21:14.356 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:14.398 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@876032991 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.405 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:14.405 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:21:14.405 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:21:14.406 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:14.431 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@876032991 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.437 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:14.438 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:21:14.438 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:21:14.438 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:14.461 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@876032991 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.469 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:14.470 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:21:14.470 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:21:14.470 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:14.470 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:14.470 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:14.474 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:14.474 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:14.474 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:14.474 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:14.474 [main] ObjectStore - db details for db db retrieved using ORM in 4.19505ms
[DEBUG] 2024-04-23 23:21:14.474 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:14.474 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:14.482 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:14.482 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:14.482 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:14.482 [main] ObjectStore - 0 entries retrieved using ORM in 7.594522ms
[DEBUG] 2024-04-23 23:21:14.482 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:14.489 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:14.489 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:14.489 [main] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 23:21:14.491 [main] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 23:21:14.491 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:14.491 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:14.491 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:14.491 [main] ObjectStore - db details for db db retrieved using ORM in 1.862886ms
[DEBUG] 2024-04-23 23:21:14.491 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:21:14.491 [main] ObjectStore - Dropping database hive.db along with all tables
[DEBUG] 2024-04-23 23:21:14.491 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:14.491 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:14.493 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:14.493 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:21:14.517 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@876032991 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.524 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:21:14.540 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:14.540 [main] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:21:14.541 [main] HikariConfig - HikariPool-2 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:21:14.541 [main] HikariConfig - HikariPool-2 - configuration:
[DEBUG] 2024-04-23 23:21:14.542 [main] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:21:14.542 [main] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:21:14.542 [main] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:21:14.542 [main] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:21:14.542 [main] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:21:14.542 [main] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:21:14.542 [main] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:21:14.542 [main] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:21:14.542 [main] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:21:14.542 [main] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:21:14.542 [main] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:21:14.542 [main] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:21:14.542 [main] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:21:14.542 [main] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:21:14.542 [main] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:21:14.542 [main] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:21:14.542 [main] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:21:14.542 [main] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:21:14.542 [main] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true"
[DEBUG] 2024-04-23 23:21:14.542 [main] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:21:14.543 [main] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:21:14.543 [main] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:21:14.543 [main] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:21:14.543 [main] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:21:14.543 [main] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:21:14.543 [main] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:21:14.543 [main] HikariConfig - poolName........................"HikariPool-2"
[DEBUG] 2024-04-23 23:21:14.543 [main] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:21:14.543 [main] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:21:14.543 [main] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:21:14.543 [main] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:21:14.543 [main] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:21:14.543 [main] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:21:14.543 [main] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:21:14.543 [main] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:21:14.543 [main] HikariDataSource - HikariPool-2 - Starting...
[INFO ] 2024-04-23 23:21:14.545 [main] PoolBase - HikariPool-2 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:21:14.545 [main] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:21:14.545 [main] HikariDataSource - HikariPool-2 - Start completed.
[DEBUG] 2024-04-23 23:21:14.546 [main] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:21:14.546 [main] HikariConfig - HikariPool-3 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:21:14.547 [main] HikariConfig - HikariPool-3 - configuration:
[DEBUG] 2024-04-23 23:21:14.548 [main] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:21:14.548 [main] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:21:14.548 [main] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:21:14.548 [main] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:21:14.548 [main] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:21:14.548 [main] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:21:14.548 [main] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:21:14.548 [main] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:21:14.548 [main] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:21:14.548 [main] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:21:14.548 [main] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:21:14.548 [main] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:21:14.548 [main] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:21:14.548 [main] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:21:14.548 [main] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:21:14.548 [main] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:21:14.548 [main] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:21:14.549 [main] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:21:14.549 [main] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true"
[DEBUG] 2024-04-23 23:21:14.549 [main] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:21:14.549 [main] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:21:14.549 [main] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:21:14.549 [main] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:21:14.549 [main] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:21:14.549 [main] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:21:14.549 [main] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:21:14.549 [main] HikariConfig - poolName........................"HikariPool-3"
[DEBUG] 2024-04-23 23:21:14.549 [main] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:21:14.549 [main] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:21:14.549 [main] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:21:14.550 [main] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:21:14.550 [main] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:21:14.550 [main] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:21:14.550 [main] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:21:14.550 [main] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:21:14.550 [main] HikariDataSource - HikariPool-3 - Starting...
[INFO ] 2024-04-23 23:21:14.552 [main] PoolBase - HikariPool-3 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:21:14.552 [main] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2061552777 (XID = 698), (SESSIONID = 23), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:21:14.552 [main] HikariDataSource - HikariPool-3 - Start completed.
[DEBUG] 2024-04-23 23:21:14.552 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.553 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.setConf(ThrowingTxnHandler.java:31) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 67 more
[DEBUG] 2024-04-23 23:21:14.555 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:14.555 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.555 [main] ObjectStore - Rollback transaction, isActive: true
[DEBUG] 2024-04-23 23:21:14.558 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 23:21:14.561 [main] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Transaction failed to commit
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:180)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
NestedThrowablesStackTrace:
Exception thrown flushing changes to datastore
org.datanucleus.exceptions.NucleusDataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:754)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.rollback(TransactionImpl.java:438)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:176)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	... 67 more
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 75 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 77 more
Nested Throwables StackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.rollback(TransactionImpl.java:438)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:176)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 75 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 77 more

[DEBUG] 2024-04-23 23:21:14.646 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:21:14.648 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@779803030 (XID = 701), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.649 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1866978221 (XID = 703), (SESSIONID = 27), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.650 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1583520821 (XID = 705), (SESSIONID = 29), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.651 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@258485474 (XID = 707), (SESSIONID = 31), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.652 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:21:14.652 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@24229977 (XID = 709), (SESSIONID = 33), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.654 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@187094827 (XID = 712), (SESSIONID = 36), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.654 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1634494397 (XID = 713), (SESSIONID = 37), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.656 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@211514019 (XID = 716), (SESSIONID = 40), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.656 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@542207366 (XID = 717), (SESSIONID = 41), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.658 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1271319717 (XID = 720), (SESSIONID = 44), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.658 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@289106863 (XID = 721), (SESSIONID = 45), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.659 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@965920018 (XID = 724), (SESSIONID = 48), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.660 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1082036937 (XID = 725), (SESSIONID = 49), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.660 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:21:14.661 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1557368178 (XID = 727), (SESSIONID = 51), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.662 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1144008206 (XID = 729), (SESSIONID = 53), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.664 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1838074682 (XID = 731), (SESSIONID = 55), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.665 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@946321781 (XID = 733), (SESSIONID = 57), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.667 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1033665626 (XID = 735), (SESSIONID = 59), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:14.667 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:21:16.563 [main] HMSHandler - 0: drop_database: @hive#db
[INFO ] 2024-04-23 23:21:16.563 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db	
[DEBUG] 2024-04-23 23:21:16.564 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:16.564 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:16.564 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:16.564 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:16.571 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:16.572 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:16.572 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:16.572 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:16.572 [main] ObjectStore - db details for db db retrieved using ORM in 8.03424ms
[DEBUG] 2024-04-23 23:21:16.572 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 23:21:16.572 [main] HMSHandler - 0: get_all_tables: db=@hive#db
[INFO ] 2024-04-23 23:21:16.572 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db	
[DEBUG] 2024-04-23 23:21:16.572 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:16.572 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:16.581 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:16.582 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:16.582 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:16.582 [main] ObjectStore - 0 entries retrieved using ORM in 9.637932ms
[DEBUG] 2024-04-23 23:21:16.582 [main] HMSHandler - 0: get_functions: db=@hive#db pat=*
[INFO ] 2024-04-23 23:21:16.582 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db pat=*	
[DEBUG] 2024-04-23 23:21:16.582 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:16.588 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:16.588 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:21:16.588 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:21:16.589 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:16.593 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:16.593 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:21:16.593 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:21:16.594 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:16.598 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:16.599 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:21:16.599 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:21:16.599 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:16.599 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:16.599 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:16.601 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:16.601 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:16.601 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:16.601 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:16.601 [main] ObjectStore - db details for db db retrieved using ORM in 1.76752ms
[DEBUG] 2024-04-23 23:21:16.601 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:16.601 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:16.608 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:16.609 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:16.609 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:16.609 [main] ObjectStore - 0 entries retrieved using ORM in 7.844696ms
[INFO ] 2024-04-23 23:21:16.609 [main] ObjectStore - Dropping database hive.db along with all tables
[DEBUG] 2024-04-23 23:21:16.609 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:16.609 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:16.610 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:16.611 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:21:16.612 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:21:16.613 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:16.614 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.setConf(ThrowingTxnHandler.java:31) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 67 more
[DEBUG] 2024-04-23 23:21:16.614 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:16.614 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:16.615 [main] ObjectStore - Rollback transaction, isActive: true
[DEBUG] 2024-04-23 23:21:16.615 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 23:21:16.616 [main] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Transaction failed to commit
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:180)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
NestedThrowablesStackTrace:
Exception thrown flushing changes to datastore
org.datanucleus.exceptions.NucleusDataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:754)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.rollback(TransactionImpl.java:438)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:176)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	... 67 more
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 75 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 77 more
Nested Throwables StackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.rollback(TransactionImpl.java:438)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:176)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 75 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 77 more

[DEBUG] 2024-04-23 23:21:18.617 [main] HMSHandler - 0: drop_database: @hive#db
[INFO ] 2024-04-23 23:21:18.618 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db	
[DEBUG] 2024-04-23 23:21:18.618 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:18.618 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:18.619 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:18.619 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:18.622 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:18.623 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:18.623 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:18.623 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:18.623 [main] ObjectStore - db details for db db retrieved using ORM in 4.415817ms
[DEBUG] 2024-04-23 23:21:18.623 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 23:21:18.623 [main] HMSHandler - 0: get_all_tables: db=@hive#db
[INFO ] 2024-04-23 23:21:18.623 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db	
[DEBUG] 2024-04-23 23:21:18.623 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:18.623 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:18.626 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:18.626 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:18.626 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:18.626 [main] ObjectStore - 0 entries retrieved using ORM in 3.23441ms
[DEBUG] 2024-04-23 23:21:18.626 [main] HMSHandler - 0: get_functions: db=@hive#db pat=*
[INFO ] 2024-04-23 23:21:18.626 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db pat=*	
[DEBUG] 2024-04-23 23:21:18.627 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:18.629 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:18.629 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:21:18.629 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:21:18.629 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:18.630 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:18.631 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:21:18.631 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:21:18.631 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:18.632 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:18.633 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:21:18.633 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:21:18.633 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:18.633 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:18.633 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:18.634 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:18.635 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:18.635 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:18.635 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:18.635 [main] ObjectStore - db details for db db retrieved using ORM in 2.134003ms
[DEBUG] 2024-04-23 23:21:18.635 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:18.635 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:18.637 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:18.637 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:18.637 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:18.637 [main] ObjectStore - 0 entries retrieved using ORM in 2.476496ms
[INFO ] 2024-04-23 23:21:18.637 [main] ObjectStore - Dropping database hive.db along with all tables
[DEBUG] 2024-04-23 23:21:18.637 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:18.638 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:18.639 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:18.639 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:21:18.640 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:21:18.641 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:18.641 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.setConf(ThrowingTxnHandler.java:31) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 67 more
[DEBUG] 2024-04-23 23:21:18.642 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:18.642 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:18.642 [main] ObjectStore - Rollback transaction, isActive: true
[DEBUG] 2024-04-23 23:21:18.643 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 23:21:18.644 [main] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Transaction failed to commit
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:180)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
NestedThrowablesStackTrace:
Exception thrown flushing changes to datastore
org.datanucleus.exceptions.NucleusDataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:754)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.rollback(TransactionImpl.java:438)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:176)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	... 67 more
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 75 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 77 more
Nested Throwables StackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.rollback(TransactionImpl.java:438)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:176)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 75 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 77 more

[DEBUG] 2024-04-23 23:21:20.645 [main] HMSHandler - 0: drop_database: @hive#db
[INFO ] 2024-04-23 23:21:20.645 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db	
[DEBUG] 2024-04-23 23:21:20.646 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:20.647 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:20.647 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:20.647 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:20.651 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:20.651 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:20.651 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:20.651 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:20.651 [main] ObjectStore - db details for db db retrieved using ORM in 4.403174ms
[DEBUG] 2024-04-23 23:21:20.651 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 23:21:20.651 [main] HMSHandler - 0: get_all_tables: db=@hive#db
[INFO ] 2024-04-23 23:21:20.651 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db	
[DEBUG] 2024-04-23 23:21:20.652 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:20.652 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:20.654 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:20.655 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:20.655 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:20.655 [main] ObjectStore - 0 entries retrieved using ORM in 3.344964ms
[DEBUG] 2024-04-23 23:21:20.655 [main] HMSHandler - 0: get_functions: db=@hive#db pat=*
[INFO ] 2024-04-23 23:21:20.655 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db pat=*	
[DEBUG] 2024-04-23 23:21:20.655 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:20.657 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:20.658 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:21:20.658 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:21:20.658 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:20.659 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:20.659 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:21:20.660 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:21:20.660 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:20.661 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:20.661 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:21:20.661 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:21:20.662 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:20.662 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:20.662 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:20.663 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:20.663 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:20.663 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:20.664 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:20.664 [main] ObjectStore - db details for db db retrieved using ORM in 2.125791ms
[DEBUG] 2024-04-23 23:21:20.664 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:20.664 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:20.667 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:20.667 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:20.667 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:20.667 [main] ObjectStore - 0 entries retrieved using ORM in 3.655371ms
[INFO ] 2024-04-23 23:21:20.668 [main] ObjectStore - Dropping database hive.db along with all tables
[DEBUG] 2024-04-23 23:21:20.668 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:20.668 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:20.669 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:20.669 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:21:20.670 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:21:20.671 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:20.672 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.setConf(ThrowingTxnHandler.java:31) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 67 more
[DEBUG] 2024-04-23 23:21:20.673 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:20.673 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:20.673 [main] ObjectStore - Rollback transaction, isActive: true
[DEBUG] 2024-04-23 23:21:20.674 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 23:21:20.675 [main] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Transaction failed to commit
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:180)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
NestedThrowablesStackTrace:
Exception thrown flushing changes to datastore
org.datanucleus.exceptions.NucleusDataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:754)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.rollback(TransactionImpl.java:438)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:176)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	... 67 more
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 75 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 77 more
Nested Throwables StackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.rollback(TransactionImpl.java:438)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:176)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 75 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 77 more

[DEBUG] 2024-04-23 23:21:22.675 [main] HMSHandler - 0: drop_database: @hive#db
[INFO ] 2024-04-23 23:21:22.676 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db	
[DEBUG] 2024-04-23 23:21:22.676 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:22.676 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:22.676 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:22.677 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:22.681 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:22.681 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:22.682 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:22.682 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:22.682 [main] ObjectStore - db details for db db retrieved using ORM in 5.329427ms
[DEBUG] 2024-04-23 23:21:22.682 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 23:21:22.682 [main] HMSHandler - 0: get_all_tables: db=@hive#db
[INFO ] 2024-04-23 23:21:22.682 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db	
[DEBUG] 2024-04-23 23:21:22.682 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:22.682 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:22.685 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:22.685 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:22.685 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:22.685 [main] ObjectStore - 0 entries retrieved using ORM in 3.138895ms
[DEBUG] 2024-04-23 23:21:22.685 [main] HMSHandler - 0: get_functions: db=@hive#db pat=*
[INFO ] 2024-04-23 23:21:22.685 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db pat=*	
[DEBUG] 2024-04-23 23:21:22.685 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:22.687 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:22.688 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:21:22.688 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:21:22.688 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:22.689 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:22.690 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:21:22.690 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:21:22.690 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:22.691 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:22.691 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:21:22.691 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:21:22.691 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:22.691 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:22.691 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:22.693 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:22.693 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:22.693 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:22.693 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:22.693 [main] ObjectStore - db details for db db retrieved using ORM in 2.00751ms
[DEBUG] 2024-04-23 23:21:22.693 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:22.693 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:22.696 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:22.696 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:22.696 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:22.696 [main] ObjectStore - 0 entries retrieved using ORM in 2.808332ms
[INFO ] 2024-04-23 23:21:22.696 [main] ObjectStore - Dropping database hive.db along with all tables
[DEBUG] 2024-04-23 23:21:22.696 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:22.696 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:22.697 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:22.698 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:21:22.699 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:21:22.700 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:22.700 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.setConf(ThrowingTxnHandler.java:31) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 67 more
[DEBUG] 2024-04-23 23:21:22.701 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:22.701 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:22.701 [main] ObjectStore - Rollback transaction, isActive: true
[DEBUG] 2024-04-23 23:21:22.702 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 23:21:22.703 [main] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Transaction failed to commit
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:180)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
NestedThrowablesStackTrace:
Exception thrown flushing changes to datastore
org.datanucleus.exceptions.NucleusDataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:754)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.rollback(TransactionImpl.java:438)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:176)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	... 67 more
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 75 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 77 more
Nested Throwables StackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.rollback(TransactionImpl.java:438)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:176)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 75 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 77 more

[DEBUG] 2024-04-23 23:21:24.703 [main] HMSHandler - 0: drop_database: @hive#db
[INFO ] 2024-04-23 23:21:24.704 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db	
[DEBUG] 2024-04-23 23:21:24.704 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:24.704 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:24.704 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:24.704 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:24.709 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:24.709 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:24.710 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:24.710 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:24.710 [main] ObjectStore - db details for db db retrieved using ORM in 5.419433ms
[DEBUG] 2024-04-23 23:21:24.710 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 23:21:24.710 [main] HMSHandler - 0: get_all_tables: db=@hive#db
[INFO ] 2024-04-23 23:21:24.710 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db	
[DEBUG] 2024-04-23 23:21:24.710 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:24.710 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:24.713 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:24.713 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:24.713 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:24.713 [main] ObjectStore - 0 entries retrieved using ORM in 3.4317ms
[DEBUG] 2024-04-23 23:21:24.713 [main] HMSHandler - 0: get_functions: db=@hive#db pat=*
[INFO ] 2024-04-23 23:21:24.713 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db pat=*	
[DEBUG] 2024-04-23 23:21:24.713 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:24.716 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:24.716 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:21:24.716 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:21:24.716 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:24.717 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:24.717 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:21:24.717 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:21:24.717 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:24.719 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:24.719 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:21:24.719 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:21:24.719 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:24.719 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:24.719 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:24.721 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:24.721 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:24.721 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:24.721 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:24.721 [main] ObjectStore - db details for db db retrieved using ORM in 1.946175ms
[DEBUG] 2024-04-23 23:21:24.721 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:24.721 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:24.724 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:24.724 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:24.724 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:24.724 [main] ObjectStore - 0 entries retrieved using ORM in 3.150451ms
[INFO ] 2024-04-23 23:21:24.724 [main] ObjectStore - Dropping database hive.db along with all tables
[DEBUG] 2024-04-23 23:21:24.724 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:24.724 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:24.726 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:24.726 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:21:24.727 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:21:24.727 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:24.728 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.setConf(ThrowingTxnHandler.java:31) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 67 more
[DEBUG] 2024-04-23 23:21:24.729 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:24.729 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:24.729 [main] ObjectStore - Rollback transaction, isActive: true
[DEBUG] 2024-04-23 23:21:24.729 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 23:21:24.730 [main] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Transaction failed to commit
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:180)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
NestedThrowablesStackTrace:
Exception thrown flushing changes to datastore
org.datanucleus.exceptions.NucleusDataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:754)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.rollback(TransactionImpl.java:438)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:176)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	... 67 more
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 75 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 77 more
Nested Throwables StackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.rollback(TransactionImpl.java:438)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:176)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 75 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 77 more

[DEBUG] 2024-04-23 23:21:26.731 [main] HMSHandler - 0: drop_database: @hive#db
[INFO ] 2024-04-23 23:21:26.731 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db	
[DEBUG] 2024-04-23 23:21:26.732 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:26.732 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:26.732 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:26.732 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:26.737 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:26.737 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:26.738 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:26.738 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:26.738 [main] ObjectStore - db details for db db retrieved using ORM in 5.576924ms
[DEBUG] 2024-04-23 23:21:26.738 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 23:21:26.738 [main] HMSHandler - 0: get_all_tables: db=@hive#db
[INFO ] 2024-04-23 23:21:26.738 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db	
[DEBUG] 2024-04-23 23:21:26.738 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:26.738 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:26.741 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:26.741 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:26.741 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:26.741 [main] ObjectStore - 0 entries retrieved using ORM in 3.237697ms
[DEBUG] 2024-04-23 23:21:26.741 [main] HMSHandler - 0: get_functions: db=@hive#db pat=*
[INFO ] 2024-04-23 23:21:26.741 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db pat=*	
[DEBUG] 2024-04-23 23:21:26.741 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:26.743 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:26.743 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:21:26.743 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:21:26.743 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:26.745 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:26.745 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:21:26.745 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:21:26.745 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:26.746 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:26.746 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:21:26.746 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:21:26.747 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:26.747 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:26.747 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:26.748 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:26.748 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:26.748 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:26.748 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:26.748 [main] ObjectStore - db details for db db retrieved using ORM in 1.932574ms
[DEBUG] 2024-04-23 23:21:26.749 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:26.749 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:26.751 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:26.752 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:26.752 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:26.752 [main] ObjectStore - 0 entries retrieved using ORM in 3.400949ms
[INFO ] 2024-04-23 23:21:26.752 [main] ObjectStore - Dropping database hive.db along with all tables
[DEBUG] 2024-04-23 23:21:26.752 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:26.752 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:26.753 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:26.754 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:21:26.755 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:21:26.755 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:26.756 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.setConf(ThrowingTxnHandler.java:31) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 67 more
[DEBUG] 2024-04-23 23:21:26.757 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:26.757 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:26.757 [main] ObjectStore - Rollback transaction, isActive: true
[DEBUG] 2024-04-23 23:21:26.757 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 23:21:26.759 [main] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Transaction failed to commit
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:180)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
NestedThrowablesStackTrace:
Exception thrown flushing changes to datastore
org.datanucleus.exceptions.NucleusDataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:754)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.rollback(TransactionImpl.java:438)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:176)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	... 67 more
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 75 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 77 more
Nested Throwables StackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.rollback(TransactionImpl.java:438)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:176)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 75 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 77 more

[DEBUG] 2024-04-23 23:21:28.760 [main] HMSHandler - 0: drop_database: @hive#db
[INFO ] 2024-04-23 23:21:28.760 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db	
[DEBUG] 2024-04-23 23:21:28.760 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:28.761 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:28.761 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:28.761 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:28.766 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:28.766 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:28.767 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:28.767 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:28.767 [main] ObjectStore - db details for db db retrieved using ORM in 6.040868ms
[DEBUG] 2024-04-23 23:21:28.767 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 23:21:28.767 [main] HMSHandler - 0: get_all_tables: db=@hive#db
[INFO ] 2024-04-23 23:21:28.767 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db	
[DEBUG] 2024-04-23 23:21:28.767 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:28.767 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:28.769 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:28.769 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:28.769 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:28.769 [main] ObjectStore - 0 entries retrieved using ORM in 2.49113ms
[DEBUG] 2024-04-23 23:21:28.769 [main] HMSHandler - 0: get_functions: db=@hive#db pat=*
[INFO ] 2024-04-23 23:21:28.769 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db pat=*	
[DEBUG] 2024-04-23 23:21:28.769 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:28.771 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:28.772 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:21:28.772 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:21:28.772 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:28.773 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:28.773 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:21:28.773 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:21:28.773 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:28.774 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:28.775 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:21:28.775 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:21:28.775 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:28.775 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:28.775 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:28.777 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:28.777 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:28.777 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:28.777 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:28.777 [main] ObjectStore - db details for db db retrieved using ORM in 1.987539ms
[DEBUG] 2024-04-23 23:21:28.777 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:28.777 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:28.780 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:28.780 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:28.780 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:28.780 [main] ObjectStore - 0 entries retrieved using ORM in 2.9625ms
[INFO ] 2024-04-23 23:21:28.780 [main] ObjectStore - Dropping database hive.db along with all tables
[DEBUG] 2024-04-23 23:21:28.780 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:28.780 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:28.781 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:28.782 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:21:28.783 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:21:28.784 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:28.785 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.setConf(ThrowingTxnHandler.java:31) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 67 more
[DEBUG] 2024-04-23 23:21:28.786 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:28.786 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:28.786 [main] ObjectStore - Rollback transaction, isActive: true
[DEBUG] 2024-04-23 23:21:28.787 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 23:21:28.788 [main] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Transaction failed to commit
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:180)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
NestedThrowablesStackTrace:
Exception thrown flushing changes to datastore
org.datanucleus.exceptions.NucleusDataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:754)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.rollback(TransactionImpl.java:438)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:176)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	... 67 more
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 75 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 77 more
Nested Throwables StackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.rollback(TransactionImpl.java:438)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:176)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 75 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 77 more

[DEBUG] 2024-04-23 23:21:30.789 [main] HMSHandler - 0: drop_database: @hive#db
[INFO ] 2024-04-23 23:21:30.790 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db	
[DEBUG] 2024-04-23 23:21:30.790 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:30.790 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:30.790 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:30.790 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:30.794 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:30.794 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:30.794 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:30.794 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:30.794 [main] ObjectStore - db details for db db retrieved using ORM in 4.191158ms
[DEBUG] 2024-04-23 23:21:30.794 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 23:21:30.794 [main] HMSHandler - 0: get_all_tables: db=@hive#db
[INFO ] 2024-04-23 23:21:30.795 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db	
[DEBUG] 2024-04-23 23:21:30.795 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:30.795 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:30.797 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:30.797 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:30.797 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:30.797 [main] ObjectStore - 0 entries retrieved using ORM in 2.604419ms
[DEBUG] 2024-04-23 23:21:30.797 [main] HMSHandler - 0: get_functions: db=@hive#db pat=*
[INFO ] 2024-04-23 23:21:30.797 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db pat=*	
[DEBUG] 2024-04-23 23:21:30.797 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:30.799 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:30.800 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:21:30.800 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:21:30.800 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:30.801 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:30.802 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:21:30.802 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:21:30.802 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:30.803 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:30.804 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:21:30.804 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:21:30.804 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:30.804 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:30.804 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:30.805 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:30.805 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:30.805 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:30.805 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:30.805 [main] ObjectStore - db details for db db retrieved using ORM in 1.723273ms
[DEBUG] 2024-04-23 23:21:30.805 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:30.805 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:30.808 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:30.808 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:30.808 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:30.808 [main] ObjectStore - 0 entries retrieved using ORM in 3.054964ms
[INFO ] 2024-04-23 23:21:30.809 [main] ObjectStore - Dropping database hive.db along with all tables
[DEBUG] 2024-04-23 23:21:30.809 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:30.809 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:30.810 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:30.810 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:21:30.811 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:21:30.812 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:30.813 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.setConf(ThrowingTxnHandler.java:31) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 67 more
[DEBUG] 2024-04-23 23:21:30.814 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:30.814 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:30.814 [main] ObjectStore - Rollback transaction, isActive: true
[DEBUG] 2024-04-23 23:21:30.815 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 23:21:30.816 [main] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Transaction failed to commit
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:180)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
NestedThrowablesStackTrace:
Exception thrown flushing changes to datastore
org.datanucleus.exceptions.NucleusDataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:754)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.rollback(TransactionImpl.java:438)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:176)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	... 67 more
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 75 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 77 more
Nested Throwables StackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.rollback(TransactionImpl.java:438)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:176)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 75 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 77 more

[DEBUG] 2024-04-23 23:21:32.817 [main] HMSHandler - 0: drop_database: @hive#db
[INFO ] 2024-04-23 23:21:32.817 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db	
[DEBUG] 2024-04-23 23:21:32.818 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:32.818 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:32.818 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:32.818 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:32.823 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:32.823 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:32.823 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:32.823 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:32.823 [main] ObjectStore - db details for db db retrieved using ORM in 5.168738ms
[DEBUG] 2024-04-23 23:21:32.823 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 23:21:32.823 [main] HMSHandler - 0: get_all_tables: db=@hive#db
[INFO ] 2024-04-23 23:21:32.823 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db	
[DEBUG] 2024-04-23 23:21:32.823 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:32.823 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:32.826 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:32.826 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:32.826 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:32.826 [main] ObjectStore - 0 entries retrieved using ORM in 2.672851ms
[DEBUG] 2024-04-23 23:21:32.826 [main] HMSHandler - 0: get_functions: db=@hive#db pat=*
[INFO ] 2024-04-23 23:21:32.826 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db pat=*	
[DEBUG] 2024-04-23 23:21:32.826 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:32.828 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:32.828 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:21:32.828 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:21:32.828 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:32.829 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:32.830 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:21:32.830 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:21:32.830 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:32.831 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:32.832 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:21:32.832 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:21:32.832 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:32.832 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:32.832 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:32.834 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:32.834 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:32.834 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:32.834 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:32.834 [main] ObjectStore - db details for db db retrieved using ORM in 2.443576ms
[DEBUG] 2024-04-23 23:21:32.834 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:32.834 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:32.838 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:32.838 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:32.838 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:32.838 [main] ObjectStore - 0 entries retrieved using ORM in 3.687573ms
[INFO ] 2024-04-23 23:21:32.838 [main] ObjectStore - Dropping database hive.db along with all tables
[DEBUG] 2024-04-23 23:21:32.838 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:32.838 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:32.839 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:32.839 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:21:32.841 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:21:32.841 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:32.842 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.setConf(ThrowingTxnHandler.java:31) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 67 more
[DEBUG] 2024-04-23 23:21:32.843 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:32.843 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:32.843 [main] ObjectStore - Rollback transaction, isActive: true
[DEBUG] 2024-04-23 23:21:32.844 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 23:21:32.845 [main] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Transaction failed to commit
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:180)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
NestedThrowablesStackTrace:
Exception thrown flushing changes to datastore
org.datanucleus.exceptions.NucleusDataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:754)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.rollback(TransactionImpl.java:438)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:176)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	... 67 more
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 75 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 77 more
Nested Throwables StackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.rollback(TransactionImpl.java:438)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:176)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 75 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 77 more

[DEBUG] 2024-04-23 23:21:34.846 [main] HMSHandler - 0: drop_database: @hive#db
[INFO ] 2024-04-23 23:21:34.846 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db	
[DEBUG] 2024-04-23 23:21:34.846 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:34.847 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:34.847 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:34.847 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:34.851 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:34.852 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:34.852 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:34.852 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:34.852 [main] ObjectStore - db details for db db retrieved using ORM in 5.094565ms
[DEBUG] 2024-04-23 23:21:34.852 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 23:21:34.852 [main] HMSHandler - 0: get_all_tables: db=@hive#db
[INFO ] 2024-04-23 23:21:34.852 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db	
[DEBUG] 2024-04-23 23:21:34.852 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:34.852 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:34.854 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:34.854 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:34.854 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:34.854 [main] ObjectStore - 0 entries retrieved using ORM in 2.459675ms
[DEBUG] 2024-04-23 23:21:34.854 [main] HMSHandler - 0: get_functions: db=@hive#db pat=*
[INFO ] 2024-04-23 23:21:34.854 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db pat=*	
[DEBUG] 2024-04-23 23:21:34.854 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:34.856 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:34.857 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:21:34.857 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:21:34.857 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:34.858 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:34.858 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:21:34.858 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:21:34.858 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:34.859 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:34.860 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:21:34.860 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:21:34.860 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:34.860 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:34.860 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:34.861 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:34.861 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:34.861 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:34.861 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:34.862 [main] ObjectStore - db details for db db retrieved using ORM in 1.582174ms
[DEBUG] 2024-04-23 23:21:34.862 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:34.862 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:34.864 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:34.864 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:34.864 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:34.864 [main] ObjectStore - 0 entries retrieved using ORM in 2.694927ms
[INFO ] 2024-04-23 23:21:34.864 [main] ObjectStore - Dropping database hive.db along with all tables
[DEBUG] 2024-04-23 23:21:34.864 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:34.864 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:34.866 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:34.866 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:21:34.868 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:21:34.869 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:34.870 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.setConf(ThrowingTxnHandler.java:31) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 67 more
[DEBUG] 2024-04-23 23:21:34.871 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:34.871 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:34.871 [main] ObjectStore - Rollback transaction, isActive: true
[DEBUG] 2024-04-23 23:21:34.872 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 23:21:34.873 [main] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Transaction failed to commit
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:180)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
NestedThrowablesStackTrace:
Exception thrown flushing changes to datastore
org.datanucleus.exceptions.NucleusDataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:754)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.rollback(TransactionImpl.java:438)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:176)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	... 67 more
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 75 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 77 more
Nested Throwables StackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.rollback(TransactionImpl.java:438)
	at org.datanucleus.api.jdo.JDOTransaction.rollback(JDOTransaction.java:176)
	at org.apache.hadoop.hive.metastore.ObjectStore.rollbackTransaction(ObjectStore.java:644)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.rollbackTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1794)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy36.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.testDropDatabaseShouldRollback_whenAcidCleanupFails(TestMetaStoreAcidCleanup.java:115)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 75 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 77 more

[DEBUG] 2024-04-23 23:21:34.873 [main] PerfLogger - </PERFLOG method=drop_database start=1713910874349 end=1713910894873 duration=20524 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 23:21:34.875 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:34.876 [main] HMSHandler - 0: get_table : tbl=hive.db.tableDropDatabase
[INFO ] 2024-04-23 23:21:34.876 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.db.tableDropDatabase	
[DEBUG] 2024-04-23 23:21:34.876 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:34.876 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:34.876 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:34.878 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:34.878 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:34.878 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:34.878 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:34.878 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:34.879 [main] ObjectStore - db details for db db retrieved using ORM in 2.921731ms
[DEBUG] 2024-04-23 23:21:34.879 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:34.879 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:34.879 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 23:21:34.914 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:34.967 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:34.980 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:21:34.983 [main] MetastoreDefaultTransformer - Starting translation for processor HMSClient-@Lenovo-Bot on list 1
[INFO ] 2024-04-23 23:21:34.983 [main] MetastoreDefaultTransformer - Table tabledropdatabase,#bucket=0,isBucketed:false,tableType=MANAGED_TABLE,tableCapabilities=null
[DEBUG] 2024-04-23 23:21:34.983 [main] MetastoreDefaultTransformer - Table has no specific required capabilities
[DEBUG] 2024-04-23 23:21:34.983 [main] MetastoreDefaultTransformer - Managed acid table with INSERTWRITE or CONNECTORWRITE capability:RW
[INFO ] 2024-04-23 23:21:34.983 [main] MetastoreDefaultTransformer - Processor has one of the write capabilities on insert-only, granting RW
[INFO ] 2024-04-23 23:21:34.984 [main] MetastoreDefaultTransformer - Transformer return list of 1
[DEBUG] 2024-04-23 23:21:34.985 [main] PerfLogger - </PERFLOG method=get_table_req start=1713910894875 end=1713910894985 duration=110 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:34.985 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=110, comments=HMS client
[DEBUG] 2024-04-23 23:21:34.985 [main] PerfLogger - <PERFLOG method=drop_table_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:34.985 [main] HMSHandler - 0: drop_table : tbl=hive.db.tableDropDatabase
[INFO ] 2024-04-23 23:21:34.985 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.db.tableDropDatabase	
[DEBUG] 2024-04-23 23:21:34.985 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:34.985 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:34.985 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:34.985 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:34.987 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:34.988 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:34.988 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:34.988 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:34.988 [main] ObjectStore - db details for db db retrieved using ORM in 2.815834ms
[DEBUG] 2024-04-23 23:21:34.988 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:34.988 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:34.988 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:34.989 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:34.990 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:34.990 [main] ObjectStore - Not using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:34.990 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:34.990 [main] ObjectStore - db details for db db retrieved using ORM in 1.674859ms
[DEBUG] 2024-04-23 23:21:34.990 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:34.990 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:34.990 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 23:21:34.993 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:35.001 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:35.001 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:35.050 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@876032991 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:35.054 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:35.055 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:35.055 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:21:35.125 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@876032991 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:35.137 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:21:35.137 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:35.137 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:35.177 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@876032991 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:35.195 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:35.195 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:35.195 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:35.195 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 23:21:35.200 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:35.201 [main] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:21:35.201 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:35.229 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@876032991 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:35.240 [main] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:21:35.240 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:35.240 [main] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:21:35.241 [main] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:21:35.241 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:35.272 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@876032991 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:35.284 [main] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:21:35.284 [main] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:21:35.284 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:35.284 [main] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:21:35.284 [main] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:21:35.284 [main] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:21:35.285 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:35.315 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@876032991 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:35.330 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:35.330 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:21:35.330 [main] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:21:35.330 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:35.360 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@876032991 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:35.374 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:35.374 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:21:35.375 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:35.375 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:35.375 [main] ObjectStore - Executing getMTable for hive.db.tabledropdatabase
[DEBUG] 2024-04-23 23:21:35.381 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:35.413 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@876032991 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:35.421 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:35.438 [main] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:21:35.438 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:35.438 [main] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:21:35.489 [main] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:21:35.489 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:35.573 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:35.574 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.setConf(ThrowingTxnHandler.java:31) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropTable(AcidEventListener.java:64) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$22.notify(MetaStoreListenerNotifier.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:401) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_core(HMSHandler.java:3020) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3256) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3244) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy36.drop_table_with_environment_context(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.drop_table_with_environment_context(HiveMetaStoreClient.java:4413) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1830) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1777) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.afterTest(TestMetaStoreAcidCleanup.java:81) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 69 more
[DEBUG] 2024-04-23 23:21:35.575 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:35.575 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:35.575 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db' AND "TC_TABLE"='tabledropdatabase'>
[DEBUG] 2024-04-23 23:21:35.576 [main] TxnHandler - Going to rollback: 
java.sql.SQLSyntaxErrorException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeUpdate(ProxyStatement.java:117) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeUpdate(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.cleanupRecords(TxnHandler.java:4190) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.ThrowingTxnHandler.cleanupRecords(ThrowingTxnHandler.java:41) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropTable(AcidEventListener.java:65) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$22.notify(MetaStoreListenerNotifier.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:401) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_core(HMSHandler.java:3020) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3256) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_table_with_environment_context(HMSHandler.java:3244) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy36.drop_table_with_environment_context(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.drop_table_with_environment_context(HiveMetaStoreClient.java:4413) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1830) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropTable(HiveMetaStoreClient.java:1777) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup.afterTest(TestMetaStoreAcidCleanup.java:81) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DeleteNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 67 more
[INFO ] 2024-04-23 23:21:35.577 [main] TxnHandler - Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
[WARN ] 2024-04-23 23:21:35.577 [main] TxnHandler - Cannot perform cleanup since metastore table does not exist
[DEBUG] 2024-04-23 23:21:35.577 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1952473604 (XID = 696), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:35.577 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:35.579 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@203819996 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:35.580 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 23:21:35.580 [main] ReplChangeManager - Repl policy is not set for database: db
[DEBUG] 2024-04-23 23:21:35.580 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db.db/tabledropdatabase
[INFO ] 2024-04-23 23:21:35.582 [main] deprecation - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
[DEBUG] 2024-04-23 23:21:35.584 [main] PerfLogger - </PERFLOG method=drop_table_with_environment_context start=1713910894985 end=1713910895584 duration=599 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
]]></system-out>
    <system-err><![CDATA[DEBUG StatusLogger Using ShutdownCallbackRegistry class org.apache.logging.log4j.core.util.DefaultShutdownCallbackRegistry
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
DEBUG StatusLogger Took 0,076407 seconds to load 240 plugins from sun.misc.Launcher$AppClassLoader@330bedb4
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger Starting LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@7b9a4292]...
DEBUG StatusLogger Reconfiguration started for context[name=330bedb4] at URI null (org.apache.logging.log4j.core.LoggerContext@7b9a4292) with optional ClassLoader: null
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
DEBUG StatusLogger PluginManager 'ConfigurationFactory' found 6 plugins
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
DEBUG StatusLogger Missing dependencies for Yaml support, ConfigurationFactory org.apache.logging.log4j.core.config.yaml.YamlConfigurationFactory is inactive
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
DEBUG StatusLogger Using configurationFactory org.apache.logging.log4j.core.config.ConfigurationFactory$Factory@6adbc9d
TRACE StatusLogger Trying to find [log4j2-test330bedb4.properties] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.properties] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yaml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yaml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yaml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yaml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test330bedb4.json] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.json] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.json] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.json] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test330bedb4.jsn] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.jsn] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.jsn] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.jsn] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test330bedb4.xml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.xml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test.properties] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.properties] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test.yml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test.yml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.yml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.yml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test.yaml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test.yaml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.yaml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.yaml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test.json] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test.json] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.json] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.json] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test.jsn] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test.jsn] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.jsn] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.jsn] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test.xml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.xml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2330bedb4.properties] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2330bedb4.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.properties] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2330bedb4.yml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2330bedb4.yml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.yml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.yml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2330bedb4.yaml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2330bedb4.yaml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.yaml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.yaml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2330bedb4.json] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2330bedb4.json] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.json] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.json] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2330bedb4.jsn] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2330bedb4.jsn] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.jsn] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.jsn] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2330bedb4.xml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2330bedb4.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.xml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2.properties] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
DEBUG StatusLogger Apache Log4j Core 2.13.2 initializing configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@73a1e9a9
DEBUG StatusLogger Installed 1 script engine
DEBUG StatusLogger Oracle Nashorn version: 1.8.0_402, language: ECMAScript, threading: Not Thread Safe, compile: true, names: [nashorn, Nashorn, js, JS, JavaScript, javascript, ECMAScript, ecmascript], factory class: jdk.nashorn.api.scripting.NashornScriptEngineFactory
DEBUG StatusLogger PluginManager 'Core' found 124 plugins
DEBUG StatusLogger PluginManager 'Level' found 0 plugins
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
TRACE StatusLogger TypeConverterRegistry initializing.
DEBUG StatusLogger PluginManager 'TypeConverter' found 26 plugins
DEBUG StatusLogger createProperty(name="filename", value="logs")
DEBUG StatusLogger Building Plugin[name=properties, class=org.apache.logging.log4j.core.config.PropertiesPlugin].
DEBUG StatusLogger configureSubstitutor(={filename=logs}, Configuration(PropertiesConfig))
DEBUG StatusLogger PluginManager 'Lookup' found 16 plugins
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="STDOUT", level="null", Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="CAPTURED", level="null", Filter=null)
DEBUG StatusLogger Building Plugin[name=root, class=org.apache.logging.log4j.core.config.LoggerConfig$RootLogger].
DEBUG StatusLogger createLogger(additivity="null", level="DEBUG", includeLocation="null", ={STDOUT, CAPTURED}, ={}, Configuration(PropertiesConfig), Filter=null)
DEBUG StatusLogger Building Plugin[name=loggers, class=org.apache.logging.log4j.core.config.LoggersPlugin].
DEBUG StatusLogger createLoggers(={root})
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(header="null", PatternSelector=null, Replace=null, Configuration(PropertiesConfig), charset="null", alwaysWriteExceptions="null", disableAnsi="null", footer="null", pattern="[%-5level] %d{yyyy-MM-dd HH:mm:ss.SSS} [%t] %c{1} - %msg%n", noConsoleNoAnsi="null")
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.ConsoleAppender].
DEBUG StatusLogger ConsoleAppender$Builder(direct="null", follow="null", target="null", bufferSize="null", bufferedIo="null", immediateFlush="null", name="STDOUT", Configuration(PropertiesConfig), ignoreExceptions="null", PatternLayout([%-5level] %d{yyyy-MM-dd HH:mm:ss.SSS} [%t] %c{1} - %msg%n), Filter=null, ={})
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_OUT.false.false
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.hadoop.hive.metastore.testutils.CapturingLogAppender].
DEBUG StatusLogger createAppender(name="CAPTURED")
DEBUG StatusLogger Building Plugin[name=appenders, class=org.apache.logging.log4j.core.config.AppendersPlugin].
DEBUG StatusLogger createAppenders(={STDOUT, CAPTURED})
DEBUG StatusLogger Configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@73a1e9a9 initialized
DEBUG StatusLogger Starting configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@73a1e9a9
DEBUG StatusLogger Started configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@73a1e9a9 OK.
TRACE StatusLogger Stopping org.apache.logging.log4j.core.config.DefaultConfiguration@517cd4b...
TRACE StatusLogger DefaultConfiguration notified 1 ReliabilityStrategies that config will be stopped.
TRACE StatusLogger DefaultConfiguration stopping root LoggerConfig.
TRACE StatusLogger DefaultConfiguration notifying ReliabilityStrategies that appenders will be stopped.
TRACE StatusLogger DefaultConfiguration stopping remaining Appenders.
DEBUG StatusLogger Shutting down OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger OutputStream closed
DEBUG StatusLogger Shut down OutputStreamManager SYSTEM_OUT.false.false-1, all resources released: true
DEBUG StatusLogger Appender DefaultConsole-1 stopped with status true
TRACE StatusLogger DefaultConfiguration stopped 1 remaining Appenders.
TRACE StatusLogger DefaultConfiguration cleaning Appenders from 1 LoggerConfigs.
DEBUG StatusLogger Stopped org.apache.logging.log4j.core.config.DefaultConfiguration@517cd4b OK
TRACE StatusLogger Reregistering MBeans after reconfigure. Selector=org.apache.logging.log4j.core.selector.ClassLoaderContextSelector@1169afe1
TRACE StatusLogger Reregistering context (1/1): '330bedb4' org.apache.logging.log4j.core.LoggerContext@7b9a4292
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=StatusLogger'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=ContextSelector'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncAppenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncLoggerRingBuffer'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*,subtype=RingBuffer'
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=StatusLogger
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=ContextSelector
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=STDOUT
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=CAPTURED
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
TRACE StatusLogger Using DummyNanoClock for nanosecond timestamps.
DEBUG StatusLogger Reconfiguration complete for context[name=330bedb4] at URI /home/alex/Repositories/hive/standalone-metastore/metastore-server/target/test-classes/log4j2.properties (org.apache.logging.log4j.core.LoggerContext@7b9a4292) with optional ClassLoader: null
DEBUG StatusLogger Shutdown hook enabled. Registering a new one.
DEBUG StatusLogger LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@7b9a4292] started OK.
DEBUG StatusLogger AsyncLogger.ThreadNameStrategy=UNCACHED (user specified null, default is UNCACHED)
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
log4j:WARN No appenders could be found for logger (DataNucleus.General).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
]]></system-err>
  </testcase>
  <testcase name="testDropTableShouldRollback_whenAcidCleanupFails" classname="org.apache.hadoop.hive.metastore.TestMetaStoreAcidCleanup" time="0.266"/>
</testsuite>