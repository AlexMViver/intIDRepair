[DEBUG] 2024-04-23 23:21:50.444 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:50.462 [main] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:21:50.463 [main] HikariConfig - HikariPool-2 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:21:50.463 [main] HikariConfig - HikariPool-2 - configuration:
[DEBUG] 2024-04-23 23:21:50.464 [main] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:21:50.464 [main] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:21:50.464 [main] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:21:50.464 [main] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:21:50.465 [main] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:21:50.465 [main] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:21:50.465 [main] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:21:50.465 [main] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:21:50.465 [main] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:21:50.465 [main] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:21:50.465 [main] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:21:50.465 [main] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:21:50.465 [main] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:21:50.465 [main] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:21:50.465 [main] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:21:50.465 [main] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:21:50.465 [main] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:21:50.466 [main] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:21:50.466 [main] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true"
[DEBUG] 2024-04-23 23:21:50.466 [main] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:21:50.466 [main] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:21:50.466 [main] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:21:50.466 [main] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:21:50.466 [main] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:21:50.466 [main] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:21:50.466 [main] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:21:50.466 [main] HikariConfig - poolName........................"HikariPool-2"
[DEBUG] 2024-04-23 23:21:50.466 [main] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:21:50.466 [main] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:21:50.467 [main] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:21:50.467 [main] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:21:50.467 [main] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:21:50.467 [main] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:21:50.467 [main] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:21:50.467 [main] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:21:50.467 [main] HikariDataSource - HikariPool-2 - Starting...
[INFO ] 2024-04-23 23:21:50.469 [main] PoolBase - HikariPool-2 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:21:50.469 [main] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:21:50.469 [main] HikariDataSource - HikariPool-2 - Start completed.
[DEBUG] 2024-04-23 23:21:50.470 [main] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:21:50.470 [main] HikariConfig - HikariPool-3 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:21:50.471 [main] HikariConfig - HikariPool-3 - configuration:
[DEBUG] 2024-04-23 23:21:50.471 [main] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:21:50.471 [main] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:21:50.471 [main] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:21:50.471 [main] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:21:50.471 [main] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:21:50.471 [main] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:21:50.472 [main] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:21:50.472 [main] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:21:50.472 [main] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:21:50.472 [main] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:21:50.472 [main] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:21:50.472 [main] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:21:50.472 [main] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:21:50.472 [main] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:21:50.472 [main] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:21:50.472 [main] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:21:50.472 [main] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:21:50.472 [main] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:21:50.472 [main] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true"
[DEBUG] 2024-04-23 23:21:50.472 [main] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:21:50.472 [main] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:21:50.472 [main] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:21:50.472 [main] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:21:50.472 [main] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:21:50.472 [main] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:21:50.472 [main] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:21:50.472 [main] HikariConfig - poolName........................"HikariPool-3"
[DEBUG] 2024-04-23 23:21:50.473 [main] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:21:50.473 [main] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:21:50.473 [main] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:21:50.473 [main] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:21:50.473 [main] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:21:50.473 [main] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:21:50.473 [main] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:21:50.473 [main] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:21:50.473 [main] HikariDataSource - HikariPool-3 - Starting...
[INFO ] 2024-04-23 23:21:50.475 [main] PoolBase - HikariPool-3 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:21:50.475 [main] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@547507935 (XID = 1566), (SESSIONID = 27), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:21:50.475 [main] HikariDataSource - HikariPool-3 - Start completed.
[DEBUG] 2024-04-23 23:21:50.476 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.479 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:50.479 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.481 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:21:50.487 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:21:50.492 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:21:50.493 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:21:50.503 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:21:50.505 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:21:50.517 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:50.519 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.519 [main] PerfLogger - </PERFLOG method=open_txns start=1713910910444 end=1713910910519 duration=75 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:50.520 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:50.530 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:21:50.535 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
[DEBUG] 2024-04-23 23:21:50.535 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1>
[DEBUG] 2024-04-23 23:21:50.535 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 1>
[DEBUG] 2024-04-23 23:21:50.535 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 1>
[DEBUG] 2024-04-23 23:21:50.535 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:21:50.552 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:21:50.552 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:21:50.555 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:21:50.556 [main] TxnHandler - Going to execute update <UPDATE "TABLE_PARAMS" SET "PARAM_VALUE" = 'myvalue' WHERE "TBL_ID" = 10 AND "PARAM_KEY" = '_metamykey'>
[WARN ] 2024-04-23 23:21:50.559 [main] TxnHandler - Error updating key/value in the sql backend with txnId=1, tableId=10, key=_metamykey, value=myvalue. Only one row should have been affected but 0 rows where affected.
[DEBUG] 2024-04-23 23:21:50.561 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:50.561 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 23:21:50.563 [main] RetryingHMSHandler - java.lang.IllegalStateException: Error updating key/value in the sql backend with txnId=1, tableId=10, key=_metamykey, value=myvalue. Only one row should have been affected but 0 rows where affected.
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.updateKeyValueAssociatedWithTxn(TxnHandler.java:1773)
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.commitTxn(TxnHandler.java:1575)
	at org.apache.hadoop.hive.metastore.HMSHandler.commit_txn(HMSHandler.java:8741)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy37.commit_txn(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.commitTxnWithKeyValue(HiveMetaStoreClient.java:3964)
	at org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.testTxNWithKeyValueNoTableId(TestHiveMetaStoreTxns.java:177)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

[DEBUG] 2024-04-23 23:21:50.563 [main] PerfLogger - </PERFLOG method=commit_txn start=1713910910520 end=1713910910563 duration=43 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 23:21:50.563 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:50.564 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:21:50.568 [main] TxnHandler - Got OpenTxnList with hwm: 1 and openTxnList size 1.
[DEBUG] 2024-04-23 23:21:50.569 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:50.569 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.569 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=1, active=1, idle=0, waiting=0)
[DEBUG] 2024-04-23 23:21:50.571 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2121325970 (XID = 1590), (SESSIONID = 29), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.573 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713910910563 end=1713910910573 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:50.573 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1062066089 (XID = 1592), (SESSIONID = 31), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.575 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@246958637 (XID = 1594), (SESSIONID = 33), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.576 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=1, active=0, idle=1, waiting=0)
[INFO ] 2024-04-23 23:21:50.576 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:21:50.578 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1600268518 (XID = 1599), (SESSIONID = 38), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.578 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1273551060 (XID = 1600), (SESSIONID = 39), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.579 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@18897345 (XID = 1604), (SESSIONID = 42), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.579 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@181785327 (XID = 1605), (SESSIONID = 43), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.581 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@999652088 (XID = 1610), (SESSIONID = 47), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.581 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1529615165 (XID = 1609), (SESSIONID = 46), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.583 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@964564239 (XID = 1615), (SESSIONID = 50), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.583 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1794780576 (XID = 1614), (SESSIONID = 51), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.585 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:50.585 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@779652679 (XID = 1620), (SESSIONID = 55), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.585 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2110627238 (XID = 1619), (SESSIONID = 54), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.587 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1857336299 (XID = 1624), (SESSIONID = 58), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.587 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1077746118 (XID = 1625), (SESSIONID = 59), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.587 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:21:50.589 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:50.589 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1766760894 (XID = 1628), (SESSIONID = 61), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.590 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@926768866 (XID = 1631), (SESSIONID = 63), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.591 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@713149944 (XID = 1633), (SESSIONID = 65), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.591 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:21:50.593 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:21:50.596 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:21:50.599 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:21:50.601 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:21:50.604 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:21:50.607 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:21:50.610 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:21:50.613 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:21:50.616 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:21:50.618 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:21:50.620 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:21:50.622 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:21:50.625 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:21:50.641 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:50.641 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:21:50.644 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:21:50.646 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:21:50.647 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:21:50.650 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:21:50.651 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:21:50.651 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:50.651 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.651 [main] PerfLogger - </PERFLOG method=open_txns start=1713910910641 end=1713910910651 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:50.651 [main] PerfLogger - <PERFLOG method=allocate_table_write_ids from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:50.652 [main] TxnHandler - Going to execute query <SELECT COUNT(*) FROM "TXNS" WHERE "TXN_STATE" = 'o' AND "TXN_TYPE" != 2 AND "TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:21:50.655 [main] TxnHandler - Going to execute query <SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE" FROM "TXNS" WHERE "TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:21:50.657 [main] TxnHandler - Going to execute query <SELECT "CTC_TXNID" FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_TXNID" in (1)>
[ERROR] 2024-04-23 23:21:50.659 [main] TxnHandler - Write ID allocation on db.tbl failed for input txns: {1,read-only}
[DEBUG] 2024-04-23 23:21:50.660 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:50.660 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 23:21:50.660 [main] RetryingHMSHandler - java.lang.IllegalStateException: Write ID allocation failed on db.tbl as not all input txns in open state or read-only
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.allocateTableWriteIds(TxnHandler.java:2140)
	at org.apache.hadoop.hive.metastore.HMSHandler.allocate_table_write_ids(HMSHandler.java:8821)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy37.allocate_table_write_ids(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.allocateTableWriteIdsBatchIntr(HiveMetaStoreClient.java:4033)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.allocateTableWriteIdsBatch(HiveMetaStoreClient.java:4020)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.allocateTableWriteId(HiveMetaStoreClient.java:4012)
	at org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.testAllocateTableWriteIdForReadOnlyTxn(TestHiveMetaStoreTxns.java:360)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

[DEBUG] 2024-04-23 23:21:50.660 [main] PerfLogger - </PERFLOG method=allocate_table_write_ids start=1713910910651 end=1713910910660 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[INFO ] 2024-04-23 23:21:50.661 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:21:50.664 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:50.664 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:50.666 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:21:50.667 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:21:50.667 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:21:50.667 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:21:50.667 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:21:50.667 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:21:50.668 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:21:50.668 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:21:50.668 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:21:50.668 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:21:50.669 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:21:50.669 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:21:50.669 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:21:50.679 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:50.679 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:21:50.681 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:21:50.684 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:21:50.684 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:21:50.687 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:21:50.687 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:21:50.687 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:50.688 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.688 [main] PerfLogger - </PERFLOG method=open_txns start=1713910910678 end=1713910910688 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:50.689 [main] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:50.689 [main] HMSHandler - 0: create_database: Database(name:mydbKeyValueWrongPrefix, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:21:50.690 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:mydbKeyValueWrongPrefix, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[DEBUG] 2024-04-23 23:21:50.690 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:50.691 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:50.691 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:50.691 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.691 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 1.403103ms
[DEBUG] 2024-04-23 23:21:50.691 [main] ObjectStore - Failed to get database hive.mydbKeyValueWrongPrefix, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:21:50.692 [main] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:21:50.692 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:50.693 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:50.693 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.694 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[INFO ] 2024-04-23 23:21:50.696 [main] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db
[INFO ] 2024-04-23 23:21:50.697 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db
[INFO ] 2024-04-23 23:21:50.706 [main] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db
[DEBUG] 2024-04-23 23:21:50.706 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:50.706 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:50.708 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:50.708 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:50.710 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.710 [main] PerfLogger - </PERFLOG method=create_database start=1713910910689 end=1713910910710 duration=21 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:50.715 [main] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:50.716 [main] HMSHandler - 0: create_table_req: Table(tableName:mytable, dbName:mydbKeyValueWrongPrefix, owner:alex, createTime:1713910910, lastAccessTime:1713910910, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:21:50.716 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:mytable, dbName:mydbKeyValueWrongPrefix, owner:alex, createTime:1713910910, lastAccessTime:1713910910, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:21:50.716 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:50.725 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:21:50.726 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:50.726 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:50.726 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.726 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 9.988345ms
[DEBUG] 2024-04-23 23:21:50.726 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:50.726 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:50.726 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 23:21:50.734 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:50.734 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:50.734 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.735 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:50.736 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:50.737 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:21:50.737 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:50.737 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:50.737 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 1.681866ms
[DEBUG] 2024-04-23 23:21:50.737 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:50.737 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:50.737 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 23:21:50.738 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:50.738 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:21:50.739 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvaluewrongprefix.db/mytable
[DEBUG] 2024-04-23 23:21:50.744 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:50.745 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:50.752 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:50.759 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1489959529 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.768 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1489959529 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.775 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1489959529 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.782 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1489959529 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.805 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:50.805 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:50.811 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.814 [main] PerfLogger - </PERFLOG method=create_table_req start=1713910910715 end=1713910910814 duration=99 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:50.814 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:50.815 [main] HMSHandler - 0: get_table : tbl=hive.mydbKeyValueWrongPrefix.mytable
[INFO ] 2024-04-23 23:21:50.816 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.mydbKeyValueWrongPrefix.mytable	
[DEBUG] 2024-04-23 23:21:50.816 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:50.817 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:21:50.818 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:50.818 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:50.818 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.818 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 2.577138ms
[DEBUG] 2024-04-23 23:21:50.818 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:50.818 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:50.818 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 23:21:50.842 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:50.891 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:50.893 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:21:50.895 [main] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:21:50.896 [main] PerfLogger - </PERFLOG method=get_table_req start=1713910910814 end=1713910910896 duration=82 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:50.897 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=83, comments=HMS client
[DEBUG] 2024-04-23 23:21:50.897 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:50.900 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:21:50.901 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
[DEBUG] 2024-04-23 23:21:50.901 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1>
[DEBUG] 2024-04-23 23:21:50.901 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 1>
[DEBUG] 2024-04-23 23:21:50.901 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 1>
[DEBUG] 2024-04-23 23:21:50.901 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:21:50.905 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:21:50.905 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:21:50.906 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:21:50.906 [main] TxnHandler - Error updating key/value in the sql backend with txnId=1, tableId=1, key=mykey, value=myvalue. key should start with _meta.
[DEBUG] 2024-04-23 23:21:50.906 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:50.907 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 23:21:50.907 [main] RetryingHMSHandler - java.lang.IllegalArgumentException: Error updating key/value in the sql backend with txnId=1, tableId=1, key=mykey, value=myvalue. key should start with _meta.
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.updateKeyValueAssociatedWithTxn(TxnHandler.java:1756)
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.commitTxn(TxnHandler.java:1575)
	at org.apache.hadoop.hive.metastore.HMSHandler.commit_txn(HMSHandler.java:8741)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy37.commit_txn(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.commitTxnWithKeyValue(HiveMetaStoreClient.java:3964)
	at org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.testTxNWithKeyWrongPrefix(TestHiveMetaStoreTxns.java:206)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

[DEBUG] 2024-04-23 23:21:50.907 [main] PerfLogger - </PERFLOG method=commit_txn start=1713910910897 end=1713910910907 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 23:21:50.907 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:50.907 [main] HMSHandler - 0: get_table : tbl=hive.mydbKeyValueWrongPrefix.mytable
[INFO ] 2024-04-23 23:21:50.907 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.mydbKeyValueWrongPrefix.mytable	
[DEBUG] 2024-04-23 23:21:50.908 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:50.910 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:21:50.910 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:50.910 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:50.910 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:50.911 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 3.038908ms
[DEBUG] 2024-04-23 23:21:50.911 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:50.911 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:50.911 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 23:21:50.915 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:50.923 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:50.926 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:21:50.929 [main] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:21:50.929 [main] PerfLogger - </PERFLOG method=get_table_req start=1713910910907 end=1713910910929 duration=22 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:50.929 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=22, comments=HMS client
[DEBUG] 2024-04-23 23:21:50.929 [main] PerfLogger - <PERFLOG method=drop_table_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:50.929 [main] HMSHandler - 0: drop_table : tbl=hive.mydbKeyValueWrongPrefix.mytable
[INFO ] 2024-04-23 23:21:50.929 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.mydbKeyValueWrongPrefix.mytable	
[DEBUG] 2024-04-23 23:21:50.929 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:50.929 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:50.931 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:21:50.931 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:50.931 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:50.931 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 1.843517ms
[DEBUG] 2024-04-23 23:21:50.931 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:50.932 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:21:50.933 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:50.933 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:50.933 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 1.863873ms
[DEBUG] 2024-04-23 23:21:50.933 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:50.933 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:50.933 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 23:21:50.938 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:50.946 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:50.946 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:50.951 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:50.952 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:50.952 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:21:50.966 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:21:50.966 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:50.967 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:50.990 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:50.991 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:50.991 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:50.991 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 23:21:50.993 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:50.993 [main] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:21:50.993 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:51.024 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1489959529 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.032 [main] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:21:51.032 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:51.032 [main] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:21:51.033 [main] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:21:51.033 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:51.042 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1489959529 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.049 [main] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:21:51.049 [main] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:21:51.049 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:51.049 [main] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:21:51.049 [main] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:21:51.049 [main] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:21:51.049 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:51.060 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:51.060 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:21:51.060 [main] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:21:51.060 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:51.071 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:51.071 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:21:51.071 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:51.072 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:51.072 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 23:21:51.073 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:51.079 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:51.083 [main] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:21:51.083 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:51.083 [main] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:21:51.106 [main] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:21:51.106 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:51.155 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:51.155 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:51.157 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.158 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvaluewrongprefix
[DEBUG] 2024-04-23 23:21:51.158 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvaluewrongprefix
[DEBUG] 2024-04-23 23:21:51.158 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvaluewrongprefix.db/mytable
[INFO ] 2024-04-23 23:21:51.161 [main] deprecation - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
[DEBUG] 2024-04-23 23:21:51.164 [main] PerfLogger - </PERFLOG method=drop_table_with_environment_context start=1713910910929 end=1713910911164 duration=235 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.164 [main] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.164 [main] HMSHandler - 0: get_database: mydbKeyValueWrongPrefix
[INFO ] 2024-04-23 23:21:51.164 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_database: mydbKeyValueWrongPrefix	
[DEBUG] 2024-04-23 23:21:51.164 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:51.166 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:21:51.166 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:51.166 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:51.167 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.167 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 2.431927ms
[DEBUG] 2024-04-23 23:21:51.167 [main] PerfLogger - </PERFLOG method=get_database_req start=1713910911164 end=1713910911167 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.167 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=3, comments=HMS client
[DEBUG] 2024-04-23 23:21:51.167 [main] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.167 [main] HMSHandler - 0: drop_database: @hive#mydbKeyValueWrongPrefix
[INFO ] 2024-04-23 23:21:51.167 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#mydbKeyValueWrongPrefix	
[DEBUG] 2024-04-23 23:21:51.167 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:51.167 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:51.169 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:21:51.170 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:51.170 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:51.170 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 2.473018ms
[DEBUG] 2024-04-23 23:21:51.170 [main] HMSHandler - 0: get_all_tables: db=@hive#mydbKeyValueWrongPrefix
[INFO ] 2024-04-23 23:21:51.170 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#mydbKeyValueWrongPrefix	
[DEBUG] 2024-04-23 23:21:51.170 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:51.174 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:51.175 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:51.175 [main] ObjectStore - 0 entries retrieved using SQL in 4.172822ms
[DEBUG] 2024-04-23 23:21:51.175 [main] HMSHandler - 0: get_functions: db=@hive#mydbKeyValueWrongPrefix pat=*
[INFO ] 2024-04-23 23:21:51.175 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#mydbKeyValueWrongPrefix pat=*	
[DEBUG] 2024-04-23 23:21:51.175 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:51.191 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1489959529 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.199 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:51.199 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:21:51.199 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:21:51.199 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:51.206 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1489959529 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.210 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:51.211 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:21:51.211 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:21:51.211 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:51.250 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1489959529 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.256 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:51.257 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=mydbKeyValueWrongPrefix pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:21:51.257 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=mydbKeyValueWrongPrefix pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:21:51.257 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:51.259 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:21:51.260 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:51.260 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:51.260 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 2.543698ms
[DEBUG] 2024-04-23 23:21:51.260 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:51.266 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:51.267 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:51.267 [main] ObjectStore - 0 entries retrieved using SQL in 6.437799ms
[INFO ] 2024-04-23 23:21:51.267 [main] ObjectStore - Dropping database hive.mydbKeyValueWrongPrefix along with all tables
[DEBUG] 2024-04-23 23:21:51.267 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:51.267 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:51.272 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:51.273 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:21:51.300 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1489959529 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.307 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:21:51.315 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:51.317 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:51.317 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.318 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 23:21:51.321 [main] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 23:21:51.324 [main] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 23:21:51.327 [main] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 23:21:51.330 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 23:21:51.333 [main] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 23:21:51.336 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:51.336 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.336 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:51.337 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.338 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:21:51.338 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvaluewrongprefix
[DEBUG] 2024-04-23 23:21:51.338 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvaluewrongprefix.db
[DEBUG] 2024-04-23 23:21:51.339 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:21:51.339 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvaluewrongprefix
[DEBUG] 2024-04-23 23:21:51.340 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db
[DEBUG] 2024-04-23 23:21:51.340 [main] PerfLogger - </PERFLOG method=drop_database start=1713910911167 end=1713910911340 duration=173 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.340 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.340 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:21:51.343 [main] TxnHandler - Got OpenTxnList with hwm: 1 and openTxnList size 1.
[DEBUG] 2024-04-23 23:21:51.343 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:51.343 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.343 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713910911340 end=1713910911343 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:21:51.344 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:21:51.348 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:51.350 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:51.352 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:21:51.354 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:21:51.355 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:21:51.357 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:21:51.359 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:21:51.361 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:21:51.363 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:21:51.365 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:21:51.367 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:21:51.369 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:21:51.371 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:21:51.373 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:21:51.374 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:21:51.386 [main] PerfLogger - <PERFLOG method=lock from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.396 [main] TxnHandler - Executing a batch of <INSERT INTO "HIVE_LOCKS" ( "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_LAST_HEARTBEAT", "HL_USER", "HL_HOST", "HL_AGENT_INFO") VALUES (?, ?, ?, ?, ?, ?, ?, ?, { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000, ?, ?, ?)> queries. Batch size: 3
[DEBUG] 2024-04-23 23:21:51.397 [main] TxnHandler - Going to execute query <SELECT "NL_NEXT" FROM "NEXT_LOCK_ID">
[DEBUG] 2024-04-23 23:21:51.399 [main] TxnHandler - Going to execute updates in batch: <UPDATE "NEXT_LOCK_ID" SET "NL_NEXT" = 2>, and <UPDATE "HIVE_LOCKS" SET "HL_LOCK_EXT_ID" = 1 WHERE "HL_LOCK_EXT_ID" = -7783977560135639589>
[DEBUG] 2024-04-23 23:21:51.407 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 23:21:51.408 [main] TxnHandler - Found 3 locks for extLockId=1. Locks: [lockid:1 intLockId:1 txnid:0 db:mydb table:mytable partition:mypartition=MyValue state:WAITING type:EXCLUSIVE, lockid:1 intLockId:2 txnid:0 db:mydb table:yourtable partition:null state:WAITING type:SHARED_WRITE, lockid:1 intLockId:3 txnid:0 db:yourdb table:null partition:null state:WAITING type:SHARED_READ]
[DEBUG] 2024-04-23 23:21:51.408 [main] TxnHandler - Going to execute query <(select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='r' AND "EX"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NOT NULL AND "REQ"."HL_TABLE" IS NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NULL AND "EX"."HL_LOCK_TYPE"='r' AND "REQ"."HL_TABLE" IS NOT NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='w' AND "EX"."HL_LOCK_TYPE" IN ('x','e') fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='x' AND "EX"."HL_LOCK_TYPE"!='r' fetch first 1 rows only)>
[DEBUG] 2024-04-23 23:21:51.427 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LOCK_STATE" = 'a', "HL_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_ACQUIRED_AT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_BLOCKEDBY_EXT_ID"=NULL,"HL_BLOCKEDBY_INT_ID"=NULL WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 23:21:51.431 [main] TxnHandler - Successfully acquired locks: [lockid:1 intLockId:1 txnid:0 db:mydb table:mytable partition:mypartition=MyValue state:WAITING type:EXCLUSIVE, lockid:1 intLockId:2 txnid:0 db:mydb table:yourtable partition:null state:WAITING type:SHARED_WRITE, lockid:1 intLockId:3 txnid:0 db:yourdb table:null partition:null state:WAITING type:SHARED_READ]
[DEBUG] 2024-04-23 23:21:51.431 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.432 [main] PerfLogger - </PERFLOG method=lock start=1713910911386 end=1713910911432 duration=46 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.432 [main] PerfLogger - <PERFLOG method=check_lock from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.432 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 23:21:51.432 [main] TxnHandler - getTxnIdFromLockId(1) Return txnid:0
[DEBUG] 2024-04-23 23:21:51.432 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 23:21:51.436 [main] TxnHandler - Successfully heartbeated for extLockId=1
[DEBUG] 2024-04-23 23:21:51.436 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 23:21:51.436 [main] TxnHandler - Found 3 locks for extLockId=1. Locks: [lockid:1 intLockId:1 txnid:0 db:mydb table:mytable partition:mypartition=MyValue state:ACQUIRED type:EXCLUSIVE, lockid:1 intLockId:2 txnid:0 db:mydb table:yourtable partition:null state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:3 txnid:0 db:yourdb table:null partition:null state:ACQUIRED type:SHARED_READ]
[DEBUG] 2024-04-23 23:21:51.436 [main] TxnHandler - Going to execute query <(select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='r' AND "EX"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NOT NULL AND "REQ"."HL_TABLE" IS NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NULL AND "EX"."HL_LOCK_TYPE"='r' AND "REQ"."HL_TABLE" IS NOT NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='w' AND "EX"."HL_LOCK_TYPE" IN ('x','e') fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='x' AND "EX"."HL_LOCK_TYPE"!='r' fetch first 1 rows only)>
[DEBUG] 2024-04-23 23:21:51.437 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LOCK_STATE" = 'a', "HL_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_ACQUIRED_AT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_BLOCKEDBY_EXT_ID"=NULL,"HL_BLOCKEDBY_INT_ID"=NULL WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 23:21:51.437 [main] TxnHandler - Successfully acquired locks: [lockid:1 intLockId:1 txnid:0 db:mydb table:mytable partition:mypartition=MyValue state:ACQUIRED type:EXCLUSIVE, lockid:1 intLockId:2 txnid:0 db:mydb table:yourtable partition:null state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:3 txnid:0 db:yourdb table:null partition:null state:ACQUIRED type:SHARED_READ]
[DEBUG] 2024-04-23 23:21:51.438 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.438 [main] PerfLogger - </PERFLOG method=check_lock start=1713910911432 end=1713910911438 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.438 [main] PerfLogger - <PERFLOG method=heartbeat from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.438 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 23:21:51.438 [main] TxnHandler - Successfully heartbeated for extLockId=1
[DEBUG] 2024-04-23 23:21:51.439 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.439 [main] PerfLogger - </PERFLOG method=heartbeat start=1713910911438 end=1713910911439 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.439 [main] PerfLogger - <PERFLOG method=unlock from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.439 [main] TxnHandler - Going to execute update <DELETE FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1 AND ("HL_TXNID" = 0 OR ("HL_TXNID" <> 0 AND "HL_LOCK_STATE" = 'w'))>
[DEBUG] 2024-04-23 23:21:51.442 [main] TxnHandler - Successfully unlocked at least 1 lock with extLockId=1
[DEBUG] 2024-04-23 23:21:51.442 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.442 [main] PerfLogger - </PERFLOG method=unlock start=1713910911439 end=1713910911442 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:21:51.442 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:21:51.446 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:51.447 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:51.450 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:21:51.450 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:21:51.451 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:21:51.451 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:21:51.451 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:21:51.452 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:21:51.452 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:21:51.453 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:21:51.453 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:21:51.453 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:21:51.453 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:21:51.454 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:21:51.454 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:21:51.462 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.463 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:21:51.466 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:21:51.470 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:21:51.470 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:21:51.480 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1),(2, 1),(3, 1)>
[INFO ] 2024-04-23 23:21:51.483 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1, 2, 3]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:21:51.483 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:51.483 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.483 [main] PerfLogger - </PERFLOG method=open_txns start=1713910911462 end=1713910911483 duration=21 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.484 [main] PerfLogger - <PERFLOG method=abort_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.487 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:21:51.487 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:21:51.490 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:21:51.490 [main] TxnHandler - Going to execute select <SELECT "RTM_REPL_POLICY" FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:21:51.492 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'a' WHERE "TXN_STATE" = 'o' AND ("TXN_ID" in (1))>
[DEBUG] 2024-04-23 23:21:51.493 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:21:51.493 [main] TxnUtils - Adding query to batch: <DELETE FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:21:51.493 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:21:51.501 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:51.501 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.501 [main] PerfLogger - </PERFLOG method=abort_txn start=1713910911484 end=1713910911501 duration=17 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.501 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.507 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 2 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:21:51.510 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
[DEBUG] 2024-04-23 23:21:51.511 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 2>
[DEBUG] 2024-04-23 23:21:51.511 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 2>
[DEBUG] 2024-04-23 23:21:51.511 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 2>
[DEBUG] 2024-04-23 23:21:51.511 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:21:51.518 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (2)>
[DEBUG] 2024-04-23 23:21:51.518 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:21:51.521 [main] TxnHandler - Removed transactions: ([2]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:21:51.523 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:2
[DEBUG] 2024-04-23 23:21:51.523 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:51.524 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.524 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:51.524 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.524 [main] PerfLogger - </PERFLOG method=commit_txn start=1713910911501 end=1713910911524 duration=23 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.524 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.524 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:21:51.528 [main] TxnHandler - Got OpenTxnList with hwm: 3 and openTxnList size 2.
[DEBUG] 2024-04-23 23:21:51.528 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:51.528 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.528 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713910911524 end=1713910911528 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:21:51.528 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:21:51.531 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:51.532 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:51.534 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:21:51.534 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:21:51.535 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:21:51.535 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:21:51.535 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:21:51.535 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:21:51.536 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:21:51.536 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:21:51.536 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:21:51.536 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:21:51.536 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:21:51.537 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:21:51.537 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:21:51.546 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.546 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:21:51.549 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:21:51.552 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:21:51.552 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:21:51.557 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:21:51.559 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:21:51.559 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:51.559 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.559 [main] PerfLogger - </PERFLOG method=open_txns start=1713910911546 end=1713910911559 duration=13 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.559 [main] PerfLogger - <PERFLOG method=lock from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.566 [main] TxnHandler - Going to execute query <SELECT "T2W_WRITEID" FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE" = ? AND "T2W_TABLE" = ? AND "T2W_TXNID" = ?>
[DEBUG] 2024-04-23 23:21:51.566 [main] TxnHandler - Going to execute query <SELECT "T2W_WRITEID" FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE" = ? AND "T2W_TABLE" = ? AND "T2W_TXNID" = ?>
[DEBUG] 2024-04-23 23:21:51.566 [main] TxnHandler - Executing a batch of <INSERT INTO "TXN_COMPONENTS" ("TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_OPERATION_TYPE", "TC_WRITEID") VALUES (?, ?, ?, ?, ?, ?)> queries. Batch size: 2
[DEBUG] 2024-04-23 23:21:51.568 [main] TxnHandler - Executing a batch of <INSERT INTO "HIVE_LOCKS" ( "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_LAST_HEARTBEAT", "HL_USER", "HL_HOST", "HL_AGENT_INFO") VALUES (?, ?, ?, ?, ?, ?, ?, ?, 0, ?, ?, ?)> queries. Batch size: 3
[DEBUG] 2024-04-23 23:21:51.569 [main] TxnHandler - Going to execute query <SELECT "NL_NEXT" FROM "NEXT_LOCK_ID">
[DEBUG] 2024-04-23 23:21:51.569 [main] TxnHandler - Going to execute updates in batch: <UPDATE "NEXT_LOCK_ID" SET "NL_NEXT" = 2>, and <UPDATE "HIVE_LOCKS" SET "HL_LOCK_EXT_ID" = 1 WHERE "HL_LOCK_EXT_ID" = 8725798066912059746>
[DEBUG] 2024-04-23 23:21:51.572 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 23:21:51.572 [main] TxnHandler - Found 3 locks for extLockId=1. Locks: [lockid:1 intLockId:1 txnid:1 db:mydb table:mytable partition:mypartition=MyValue state:WAITING type:SHARED_WRITE, lockid:1 intLockId:2 txnid:1 db:mydb table:yourtable partition:null state:WAITING type:SHARED_WRITE, lockid:1 intLockId:3 txnid:1 db:yourdb table:null partition:null state:WAITING type:SHARED_READ]
[DEBUG] 2024-04-23 23:21:51.572 [main] TxnHandler - Going to execute query <(select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='r' AND "EX"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NOT NULL AND "REQ"."HL_TABLE" IS NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NULL AND "EX"."HL_LOCK_TYPE"='r' AND "REQ"."HL_TABLE" IS NOT NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='w' AND "EX"."HL_LOCK_TYPE" IN ('x','e') fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='x' AND "EX"."HL_LOCK_TYPE"!='r' fetch first 1 rows only)>
[DEBUG] 2024-04-23 23:21:51.573 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LOCK_STATE" = 'a', "HL_LAST_HEARTBEAT" = 0,"HL_ACQUIRED_AT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_BLOCKEDBY_EXT_ID"=NULL,"HL_BLOCKEDBY_INT_ID"=NULL WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 23:21:51.576 [main] TxnHandler - Successfully acquired locks: [lockid:1 intLockId:1 txnid:1 db:mydb table:mytable partition:mypartition=MyValue state:WAITING type:SHARED_WRITE, lockid:1 intLockId:2 txnid:1 db:mydb table:yourtable partition:null state:WAITING type:SHARED_WRITE, lockid:1 intLockId:3 txnid:1 db:yourdb table:null partition:null state:WAITING type:SHARED_READ]
[DEBUG] 2024-04-23 23:21:51.576 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.576 [main] PerfLogger - </PERFLOG method=lock start=1713910911559 end=1713910911576 duration=17 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.576 [main] PerfLogger - <PERFLOG method=check_lock from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.576 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 23:21:51.576 [main] TxnHandler - getTxnIdFromLockId(1) Return txnid:1
[DEBUG] 2024-04-23 23:21:51.577 [main] TxnHandler - Going to execute update <UPDATE "TXNS" SET "TXN_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 WHERE "TXN_ID" = 1 AND "TXN_STATE" = 'o'>
[DEBUG] 2024-04-23 23:21:51.579 [main] TxnHandler - Successfully heartbeated for txnId=1
[DEBUG] 2024-04-23 23:21:51.579 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 23:21:51.580 [main] TxnHandler - Found 3 locks for extLockId=1. Locks: [lockid:1 intLockId:1 txnid:1 db:mydb table:mytable partition:mypartition=MyValue state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:2 txnid:1 db:mydb table:yourtable partition:null state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:3 txnid:1 db:yourdb table:null partition:null state:ACQUIRED type:SHARED_READ]
[DEBUG] 2024-04-23 23:21:51.580 [main] TxnHandler - Going to execute query <(select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='r' AND "EX"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NOT NULL AND "REQ"."HL_TABLE" IS NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NULL AND "EX"."HL_LOCK_TYPE"='r' AND "REQ"."HL_TABLE" IS NOT NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='w' AND "EX"."HL_LOCK_TYPE" IN ('x','e') fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='x' AND "EX"."HL_LOCK_TYPE"!='r' fetch first 1 rows only)>
[DEBUG] 2024-04-23 23:21:51.580 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LOCK_STATE" = 'a', "HL_LAST_HEARTBEAT" = 0,"HL_ACQUIRED_AT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_BLOCKEDBY_EXT_ID"=NULL,"HL_BLOCKEDBY_INT_ID"=NULL WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 23:21:51.581 [main] TxnHandler - Successfully acquired locks: [lockid:1 intLockId:1 txnid:1 db:mydb table:mytable partition:mypartition=MyValue state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:2 txnid:1 db:mydb table:yourtable partition:null state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:3 txnid:1 db:yourdb table:null partition:null state:ACQUIRED type:SHARED_READ]
[DEBUG] 2024-04-23 23:21:51.581 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.581 [main] PerfLogger - </PERFLOG method=check_lock start=1713910911576 end=1713910911581 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.581 [main] PerfLogger - <PERFLOG method=heartbeat from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.581 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 23:21:51.582 [main] TxnHandler - Successfully heartbeated for extLockId=1
[DEBUG] 2024-04-23 23:21:51.582 [main] TxnHandler - Going to execute update <UPDATE "TXNS" SET "TXN_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 WHERE "TXN_ID" = 1 AND "TXN_STATE" = 'o'>
[DEBUG] 2024-04-23 23:21:51.582 [main] TxnHandler - Successfully heartbeated for txnId=1
[DEBUG] 2024-04-23 23:21:51.582 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.582 [main] PerfLogger - </PERFLOG method=heartbeat start=1713910911581 end=1713910911582 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.582 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.588 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode false
[DEBUG] 2024-04-23 23:21:51.588 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS">
[DEBUG] 2024-04-23 23:21:51.590 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'Y' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1 AND "TC_OPERATION_TYPE" <> 'c'>
[DEBUG] 2024-04-23 23:21:51.593 [main] TxnUtils - Adding query to batch: <UPDATE "WRITE_SET" SET "WS_COMMIT_ID" = 1 WHERE "WS_COMMIT_ID" = 251005746289335911 AND "WS_TXNID" = 1>
[DEBUG] 2024-04-23 23:21:51.593 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1>
[DEBUG] 2024-04-23 23:21:51.593 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 1>
[DEBUG] 2024-04-23 23:21:51.593 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 1>
[DEBUG] 2024-04-23 23:21:51.594 [main] TxnUtils - Going to execute queries in batch. Batch size: 4
[DEBUG] 2024-04-23 23:21:51.602 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:21:51.602 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:21:51.602 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:21:51.602 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:1
[DEBUG] 2024-04-23 23:21:51.602 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:51.603 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.603 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:51.603 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.603 [main] PerfLogger - </PERFLOG method=commit_txn start=1713910911582 end=1713910911603 duration=21 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:21:51.603 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:21:51.606 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:51.607 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:51.609 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:21:51.609 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:21:51.610 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:21:51.610 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:21:51.610 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:21:51.610 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:21:51.611 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:21:51.611 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:21:51.611 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:21:51.612 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:21:51.612 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:21:51.612 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:21:51.612 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:21:51.618 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.618 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:21:51.620 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:21:51.622 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:21:51.622 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:21:51.629 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1),(2, 1),(3, 1)>
[INFO ] 2024-04-23 23:21:51.629 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1, 2, 3]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:21:51.629 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:51.630 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.630 [main] PerfLogger - </PERFLOG method=open_txns start=1713910911618 end=1713910911630 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.630 [main] PerfLogger - <PERFLOG method=allocate_table_write_ids from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.630 [main] TxnHandler - Going to execute query <SELECT COUNT(*) FROM "TXNS" WHERE "TXN_STATE" = 'o' AND "TXN_TYPE" != 2 AND "TXN_ID" in (1,2,3)>
[DEBUG] 2024-04-23 23:21:51.634 [main] TxnHandler - Going to execute query <SELECT "T2W_TXNID", "T2W_WRITEID" FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE" = 'db' AND "T2W_TABLE" = 'tbl' AND "T2W_TXNID" in (1,2,3)>
[DEBUG] 2024-04-23 23:21:51.636 [main] TxnHandler - Going to execute query <SELECT "NWI_NEXT" FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE" = 'db' AND "NWI_TABLE" = 'tbl'>
[DEBUG] 2024-04-23 23:21:51.638 [main] TxnHandler - Going to execute insert <INSERT INTO "NEXT_WRITE_ID" ("NWI_DATABASE", "NWI_TABLE", "NWI_NEXT") VALUES ('db', 'tbl', 4)>
[INFO ] 2024-04-23 23:21:51.640 [main] TxnHandler - Allocated writeId: 1 for txnId: 1
[INFO ] 2024-04-23 23:21:51.640 [main] TxnHandler - Allocated writeId: 2 for txnId: 2
[INFO ] 2024-04-23 23:21:51.640 [main] TxnHandler - Allocated writeId: 3 for txnId: 3
[DEBUG] 2024-04-23 23:21:51.640 [main] TxnHandler - Executing a batch of <INSERT INTO "TXN_TO_WRITE_ID" ("T2W_TXNID", "T2W_DATABASE", "T2W_TABLE", "T2W_WRITEID") VALUES (?, ?, ?, ?)> queries. Batch size: 3
[INFO ] 2024-04-23 23:21:51.640 [main] TxnHandler - Allocated write ids for dbName=db, tblName=tbl (txnIds: [1, 2, 3])
[DEBUG] 2024-04-23 23:21:51.642 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.642 [main] PerfLogger - </PERFLOG method=allocate_table_write_ids start=1713910911630 end=1713910911642 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.642 [main] PerfLogger - <PERFLOG method=abort_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.644 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:21:51.644 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:21:51.644 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:21:51.644 [main] TxnHandler - Going to execute select <SELECT "RTM_REPL_POLICY" FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:21:51.644 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'a' WHERE "TXN_STATE" = 'o' AND ("TXN_ID" in (1))>
[DEBUG] 2024-04-23 23:21:51.644 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:21:51.645 [main] TxnUtils - Adding query to batch: <DELETE FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:21:51.645 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:21:51.647 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:51.648 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.648 [main] PerfLogger - </PERFLOG method=abort_txn start=1713910911642 end=1713910911648 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.648 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.648 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:21:51.650 [main] TxnHandler - Got OpenTxnList with hwm: 3 and openTxnList size 3.
[DEBUG] 2024-04-23 23:21:51.650 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:51.650 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.650 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713910911648 end=1713910911650 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.651 [main] PerfLogger - <PERFLOG method=get_valid_write_ids from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.653 [main] TxnHandler - Going to execute query<SELECT MAX("T2W_WRITEID") FROM "TXN_TO_WRITE_ID" WHERE "T2W_TXNID" <= 3 AND "T2W_DATABASE" = 'db' AND "T2W_TABLE" = 'tbl'>
[DEBUG] 2024-04-23 23:21:51.655 [main] TxnHandler - Going to execute query<SELECT "T2W_TXNID", "T2W_WRITEID" FROM "TXN_TO_WRITE_ID" WHERE "T2W_WRITEID" <= 3 AND "T2W_DATABASE" = 'db' AND "T2W_TABLE" = 'tbl' ORDER BY "T2W_WRITEID" ASC>
[DEBUG] 2024-04-23 23:21:51.658 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:51.658 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.658 [main] PerfLogger - </PERFLOG method=get_valid_write_ids start=1713910911651 end=1713910911658 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.659 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.663 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 3 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:21:51.665 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
[DEBUG] 2024-04-23 23:21:51.665 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 3>
[DEBUG] 2024-04-23 23:21:51.665 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 3>
[DEBUG] 2024-04-23 23:21:51.665 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 3>
[DEBUG] 2024-04-23 23:21:51.665 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:21:51.671 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (3)>
[DEBUG] 2024-04-23 23:21:51.671 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:21:51.673 [main] TxnHandler - Removed transactions: ([3]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:21:51.673 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:3
[DEBUG] 2024-04-23 23:21:51.673 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:51.673 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.673 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:51.673 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.673 [main] PerfLogger - </PERFLOG method=commit_txn start=1713910911659 end=1713910911673 duration=14 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.673 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.674 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:21:51.674 [main] TxnHandler - Got OpenTxnList with hwm: 3 and openTxnList size 2.
[DEBUG] 2024-04-23 23:21:51.674 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:51.674 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.674 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713910911673 end=1713910911674 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.674 [main] PerfLogger - <PERFLOG method=get_valid_write_ids from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.675 [main] TxnHandler - Going to execute query<SELECT MAX("T2W_WRITEID") FROM "TXN_TO_WRITE_ID" WHERE "T2W_TXNID" <= 3 AND "T2W_DATABASE" = 'db' AND "T2W_TABLE" = 'tbl'>
[DEBUG] 2024-04-23 23:21:51.675 [main] TxnHandler - Going to execute query<SELECT "T2W_TXNID", "T2W_WRITEID" FROM "TXN_TO_WRITE_ID" WHERE "T2W_WRITEID" <= 3 AND "T2W_DATABASE" = 'db' AND "T2W_TABLE" = 'tbl' ORDER BY "T2W_WRITEID" ASC>
[DEBUG] 2024-04-23 23:21:51.675 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:51.675 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.675 [main] PerfLogger - </PERFLOG method=get_valid_write_ids start=1713910911674 end=1713910911675 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:21:51.675 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:21:51.678 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:51.678 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:51.680 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:21:51.681 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:21:51.681 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:21:51.681 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:21:51.681 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:21:51.682 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:21:51.682 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:21:51.682 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:21:51.682 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:21:51.682 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:21:51.683 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:21:51.683 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:21:51.683 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:21:51.689 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.689 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:21:51.691 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:21:51.693 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:21:51.693 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:21:51.700 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1),(2, 1),(3, 1)>
[INFO ] 2024-04-23 23:21:51.700 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1, 2, 3]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:21:51.700 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:51.700 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.700 [main] PerfLogger - </PERFLOG method=open_txns start=1713910911689 end=1713910911700 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.700 [main] PerfLogger - <PERFLOG method=abort_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.702 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:21:51.702 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:21:51.703 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:21:51.703 [main] TxnHandler - Going to execute select <SELECT "RTM_REPL_POLICY" FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:21:51.703 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'a' WHERE "TXN_STATE" = 'o' AND ("TXN_ID" in (1))>
[DEBUG] 2024-04-23 23:21:51.703 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:21:51.703 [main] TxnUtils - Adding query to batch: <DELETE FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:21:51.703 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:21:51.705 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:51.706 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.706 [main] PerfLogger - </PERFLOG method=abort_txn start=1713910911700 end=1713910911706 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.706 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.708 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 2 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:21:51.708 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
[DEBUG] 2024-04-23 23:21:51.708 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 2>
[DEBUG] 2024-04-23 23:21:51.708 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 2>
[DEBUG] 2024-04-23 23:21:51.708 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 2>
[DEBUG] 2024-04-23 23:21:51.708 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:21:51.710 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (2)>
[DEBUG] 2024-04-23 23:21:51.710 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:21:51.710 [main] TxnHandler - Removed transactions: ([2]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:21:51.711 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:2
[DEBUG] 2024-04-23 23:21:51.711 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:51.711 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.711 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:51.711 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.711 [main] PerfLogger - </PERFLOG method=commit_txn start=1713910911706 end=1713910911711 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.711 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.711 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:21:51.713 [main] TxnHandler - Got OpenTxnList with hwm: 3 and openTxnList size 2.
[DEBUG] 2024-04-23 23:21:51.713 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:51.713 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.714 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713910911711 end=1713910911714 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:21:51.714 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:21:51.717 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:51.717 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:51.719 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:21:51.720 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:21:51.720 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:21:51.720 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:21:51.720 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:21:51.721 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:21:51.721 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:21:51.721 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:21:51.721 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:21:51.721 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:21:51.721 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:21:51.721 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:21:51.722 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:21:51.728 [main] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.728 [main] HMSHandler - 0: create_database: Database(name:mydbKeyValue, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:21:51.728 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:mydbKeyValue, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[DEBUG] 2024-04-23 23:21:51.728 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:51.729 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:51.729 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:51.729 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.729 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.518798ms
[DEBUG] 2024-04-23 23:21:51.729 [main] ObjectStore - Failed to get database hive.mydbKeyValue, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:21:51.730 [main] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:21:51.730 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:51.733 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:51.733 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.734 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[INFO ] 2024-04-23 23:21:51.734 [main] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db
[INFO ] 2024-04-23 23:21:51.734 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db
[INFO ] 2024-04-23 23:21:51.737 [main] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db
[DEBUG] 2024-04-23 23:21:51.737 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:51.737 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:51.740 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:51.740 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:51.741 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.741 [main] PerfLogger - </PERFLOG method=create_database start=1713910911728 end=1713910911741 duration=13 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.742 [main] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.742 [main] HMSHandler - 0: create_table_req: Table(tableName:mytable, dbName:mydbKeyValue, owner:alex, createTime:1713910911, lastAccessTime:1713910911, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:21:51.742 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:mytable, dbName:mydbKeyValue, owner:alex, createTime:1713910911, lastAccessTime:1713910911, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:21:51.742 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:51.745 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:21:51.746 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:51.746 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:51.746 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.746 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 4.170591ms
[DEBUG] 2024-04-23 23:21:51.746 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:51.746 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:51.746 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 23:21:51.751 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:51.751 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:51.751 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.752 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:51.752 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:51.753 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:21:51.753 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:51.753 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:51.753 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.343922ms
[DEBUG] 2024-04-23 23:21:51.753 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:51.753 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:51.753 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 23:21:51.754 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:51.754 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:21:51.755 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvalue.db/mytable
[DEBUG] 2024-04-23 23:21:51.760 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:51.760 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:51.765 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:51.783 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:51.783 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:51.786 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.787 [main] PerfLogger - </PERFLOG method=create_table_req start=1713910911742 end=1713910911787 duration=45 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.788 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.788 [main] HMSHandler - 0: get_table : tbl=hive.mydbKeyValue.mytable
[INFO ] 2024-04-23 23:21:51.788 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.mydbKeyValue.mytable	
[DEBUG] 2024-04-23 23:21:51.788 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:51.789 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:21:51.789 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:51.789 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:51.790 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.790 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.93593ms
[DEBUG] 2024-04-23 23:21:51.790 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:51.790 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:51.790 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 23:21:51.801 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:51.837 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:51.839 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:21:51.840 [main] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:21:51.841 [main] PerfLogger - </PERFLOG method=get_table_req start=1713910911788 end=1713910911841 duration=53 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.841 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=53, comments=HMS client
[DEBUG] 2024-04-23 23:21:51.842 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.843 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:21:51.844 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:21:51.847 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:21:51.847 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:21:51.851 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:21:51.852 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:21:51.852 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:51.852 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.853 [main] PerfLogger - </PERFLOG method=open_txns start=1713910911842 end=1713910911853 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.853 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.855 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:21:51.857 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
[DEBUG] 2024-04-23 23:21:51.858 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1>
[DEBUG] 2024-04-23 23:21:51.858 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 1>
[DEBUG] 2024-04-23 23:21:51.858 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 1>
[DEBUG] 2024-04-23 23:21:51.858 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:21:51.860 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:21:51.860 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:21:51.860 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:21:51.860 [main] TxnHandler - Going to execute update <UPDATE "TABLE_PARAMS" SET "PARAM_VALUE" = 'myvalue' WHERE "TBL_ID" = 2 AND "PARAM_KEY" = '_metamykey'>
[WARN ] 2024-04-23 23:21:51.862 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:1
[DEBUG] 2024-04-23 23:21:51.863 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:51.863 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.863 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:51.863 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.863 [main] PerfLogger - </PERFLOG method=commit_txn start=1713910911853 end=1713910911863 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.863 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.863 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:21:51.865 [main] TxnHandler - Got OpenTxnList with hwm: 1 and openTxnList size 0.
[DEBUG] 2024-04-23 23:21:51.866 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:51.866 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.866 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713910911863 end=1713910911866 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.868 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.868 [main] HMSHandler - 0: get_table : tbl=hive.mydbKeyValue.mytable
[INFO ] 2024-04-23 23:21:51.868 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.mydbKeyValue.mytable	
[DEBUG] 2024-04-23 23:21:51.868 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:51.870 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:21:51.870 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:51.870 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:51.870 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:51.870 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 2.361553ms
[DEBUG] 2024-04-23 23:21:51.871 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:51.871 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:51.871 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 23:21:51.874 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:51.880 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:51.881 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:21:51.883 [main] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:21:51.883 [main] PerfLogger - </PERFLOG method=get_table_req start=1713910911868 end=1713910911883 duration=15 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:51.883 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=15, comments=HMS client
[DEBUG] 2024-04-23 23:21:51.883 [main] PerfLogger - <PERFLOG method=drop_table_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:51.883 [main] HMSHandler - 0: drop_table : tbl=hive.mydbKeyValue.mytable
[INFO ] 2024-04-23 23:21:51.883 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.mydbKeyValue.mytable	
[DEBUG] 2024-04-23 23:21:51.883 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:51.884 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:51.885 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:21:51.885 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:51.885 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:51.885 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.662473ms
[DEBUG] 2024-04-23 23:21:51.885 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:51.887 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:21:51.887 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:51.887 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:51.887 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.926524ms
[DEBUG] 2024-04-23 23:21:51.887 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:51.887 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:51.887 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 23:21:51.890 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:51.895 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:51.895 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:51.898 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:51.898 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:51.898 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:21:51.903 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:21:51.903 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:51.903 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:51.913 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:51.913 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:51.913 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:51.913 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 23:21:51.915 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:51.915 [main] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:21:51.915 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:51.920 [main] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:21:51.920 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:51.920 [main] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:21:51.921 [main] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:21:51.921 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:51.926 [main] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:21:51.926 [main] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:21:51.926 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:51.926 [main] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:21:51.926 [main] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:21:51.926 [main] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:21:51.926 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:51.933 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:51.933 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:21:51.933 [main] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:21:51.933 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:51.940 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:51.940 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:21:51.940 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:51.940 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:21:51.940 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 23:21:51.942 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:21:51.946 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:51.949 [main] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:21:51.949 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:51.949 [main] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:21:51.962 [main] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:21:51.962 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:52.001 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:52.001 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:52.002 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.003 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvalue
[DEBUG] 2024-04-23 23:21:52.003 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvalue
[DEBUG] 2024-04-23 23:21:52.003 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvalue.db/mytable
[DEBUG] 2024-04-23 23:21:52.003 [main] PerfLogger - </PERFLOG method=drop_table_with_environment_context start=1713910911883 end=1713910912003 duration=120 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:52.004 [main] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:52.004 [main] HMSHandler - 0: get_database: mydbKeyValue
[INFO ] 2024-04-23 23:21:52.004 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_database: mydbKeyValue	
[DEBUG] 2024-04-23 23:21:52.004 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:52.006 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:21:52.006 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:52.006 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:52.006 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.006 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 2.729384ms
[DEBUG] 2024-04-23 23:21:52.006 [main] PerfLogger - </PERFLOG method=get_database_req start=1713910912004 end=1713910912006 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:52.007 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:21:52.007 [main] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:52.007 [main] HMSHandler - 0: drop_database: @hive#mydbKeyValue
[INFO ] 2024-04-23 23:21:52.007 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#mydbKeyValue	
[DEBUG] 2024-04-23 23:21:52.007 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:52.007 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:52.008 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:21:52.009 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:52.009 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:52.009 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.813213ms
[DEBUG] 2024-04-23 23:21:52.009 [main] HMSHandler - 0: get_all_tables: db=@hive#mydbKeyValue
[INFO ] 2024-04-23 23:21:52.009 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#mydbKeyValue	
[DEBUG] 2024-04-23 23:21:52.009 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:52.012 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:52.012 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:52.012 [main] ObjectStore - 0 entries retrieved using SQL in 3.139983ms
[DEBUG] 2024-04-23 23:21:52.012 [main] HMSHandler - 0: get_functions: db=@hive#mydbKeyValue pat=*
[INFO ] 2024-04-23 23:21:52.012 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#mydbKeyValue pat=*	
[DEBUG] 2024-04-23 23:21:52.012 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:52.017 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:52.018 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:21:52.018 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:21:52.018 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:52.022 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:52.022 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:21:52.022 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:21:52.022 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:52.026 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:52.026 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=mydbKeyValue pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:21:52.026 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=mydbKeyValue pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:21:52.026 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:52.028 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:21:52.028 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:52.028 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:52.028 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.567445ms
[DEBUG] 2024-04-23 23:21:52.028 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:52.032 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:52.032 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:52.032 [main] ObjectStore - 0 entries retrieved using SQL in 3.510126ms
[INFO ] 2024-04-23 23:21:52.032 [main] ObjectStore - Dropping database hive.mydbKeyValue along with all tables
[DEBUG] 2024-04-23 23:21:52.032 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:52.032 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:52.035 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:52.036 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:21:52.041 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:21:52.045 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:52.048 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:52.048 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.048 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 23:21:52.050 [main] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 23:21:52.051 [main] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 23:21:52.053 [main] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 23:21:52.055 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 23:21:52.057 [main] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 23:21:52.060 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:52.060 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.060 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:52.061 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.061 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:21:52.061 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvalue
[DEBUG] 2024-04-23 23:21:52.062 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvalue.db
[DEBUG] 2024-04-23 23:21:52.062 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:21:52.062 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvalue
[DEBUG] 2024-04-23 23:21:52.063 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db
[DEBUG] 2024-04-23 23:21:52.063 [main] PerfLogger - </PERFLOG method=drop_database start=1713910912007 end=1713910912063 duration=56 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:21:52.065 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:21:52.070 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:52.071 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:52.073 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:21:52.074 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:21:52.076 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:21:52.078 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:21:52.079 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:21:52.081 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:21:52.083 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:21:52.084 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:21:52.086 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:21:52.088 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:21:52.089 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:21:52.091 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:21:52.092 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:21:52.101 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:52.101 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:21:52.103 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:21:52.105 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:21:52.105 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:21:52.108 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:21:52.108 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:21:52.108 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:52.108 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.108 [main] PerfLogger - </PERFLOG method=open_txns start=1713910912101 end=1713910912108 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:52.109 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:52.112 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:21:52.112 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
[DEBUG] 2024-04-23 23:21:52.113 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1>
[DEBUG] 2024-04-23 23:21:52.113 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 1>
[DEBUG] 2024-04-23 23:21:52.113 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 1>
[DEBUG] 2024-04-23 23:21:52.113 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:21:52.118 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:21:52.119 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:21:52.119 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:21:52.119 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:1
[DEBUG] 2024-04-23 23:21:52.119 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:52.119 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.119 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:52.119 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.119 [main] PerfLogger - </PERFLOG method=commit_txn start=1713910912109 end=1713910912119 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:52.119 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:52.120 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:21:52.122 [main] TxnHandler - Got OpenTxnList with hwm: 1 and openTxnList size 0.
[DEBUG] 2024-04-23 23:21:52.122 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:52.122 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.122 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713910912119 end=1713910912122 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:21:52.122 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:21:52.125 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:52.125 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:52.127 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:21:52.127 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:21:52.127 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:21:52.127 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:21:52.128 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:21:52.128 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:21:52.128 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:21:52.128 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:21:52.128 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:21:52.128 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:21:52.129 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:21:52.129 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:21:52.129 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:21:52.135 [main] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:52.135 [main] HMSHandler - 0: create_database: Database(name:mydb, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:21:52.135 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:mydb, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[DEBUG] 2024-04-23 23:21:52.136 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:52.137 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:52.137 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:52.137 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.137 [main] ObjectStore - db details for db mydb retrieved using SQL in 1.61833ms
[DEBUG] 2024-04-23 23:21:52.137 [main] ObjectStore - Failed to get database hive.mydb, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:21:52.137 [main] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:21:52.138 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:52.141 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:52.141 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.142 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[WARN ] 2024-04-23 23:21:52.143 [main] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydb.db for database mydb. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:21:52.143 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:52.143 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:52.146 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:52.146 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:52.148 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.148 [main] PerfLogger - </PERFLOG method=create_database start=1713910912135 end=1713910912148 duration=13 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:52.148 [main] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:52.148 [main] HMSHandler - 0: create_table_req: Table(tableName:mytable, dbName:mydb, owner:alex, createTime:1713910912, lastAccessTime:1713910912, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:21:52.148 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:mytable, dbName:mydb, owner:alex, createTime:1713910912, lastAccessTime:1713910912, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:21:52.149 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:52.150 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydb locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydb.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:21:52.151 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:52.151 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:52.151 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.151 [main] ObjectStore - db details for db mydb retrieved using SQL in 2.713564ms
[DEBUG] 2024-04-23 23:21:52.151 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:52.151 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:52.152 [main] ObjectStore - Executing getMTable for hive.mydb.mytable
[DEBUG] 2024-04-23 23:21:52.157 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:52.157 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:52.157 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.157 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:52.157 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:52.159 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydb locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydb.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:21:52.159 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:52.159 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:52.159 [main] ObjectStore - db details for db mydb retrieved using SQL in 1.970684ms
[DEBUG] 2024-04-23 23:21:52.159 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:52.160 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:52.160 [main] ObjectStore - Executing getMTable for hive.mydb.mytable
[DEBUG] 2024-04-23 23:21:52.161 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:52.161 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:21:52.163 [main] MetaStoreServerUtils - Updating table stats for mytable
[INFO ] 2024-04-23 23:21:52.163 [main] MetaStoreServerUtils - Updated size of table mytable to 0
[DEBUG] 2024-04-23 23:21:52.163 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:52.163 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:21:52.165 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:21:52.182 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:52.182 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:52.186 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.189 [main] PerfLogger - </PERFLOG method=create_table_req start=1713910912148 end=1713910912188 duration=40 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:52.189 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:52.189 [main] HMSHandler - 0: get_table : tbl=hive.mydb.mytable
[INFO ] 2024-04-23 23:21:52.189 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.mydb.mytable	
[DEBUG] 2024-04-23 23:21:52.189 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:52.191 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydb locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydb.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:21:52.191 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:21:52.191 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:52.191 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.192 [main] ObjectStore - db details for db mydb retrieved using SQL in 2.701076ms
[DEBUG] 2024-04-23 23:21:52.192 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:21:52.192 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:21:52.192 [main] ObjectStore - Executing getMTable for hive.mydb.mytable
[DEBUG] 2024-04-23 23:21:52.204 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:21:52.235 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:21:52.237 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:21:52.239 [main] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:21:52.239 [main] PerfLogger - </PERFLOG method=get_table_req start=1713910912189 end=1713910912239 duration=50 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:52.239 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=50, comments=HMS client
[DEBUG] 2024-04-23 23:21:52.240 [main] PerfLogger - <PERFLOG method=compact2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:52.240 [main] TxnHandler - About to execute SQL: SELECT "MT_COMMENT" FROM "AUX_TABLE" WHERE "MT_KEY1"='CompactionScheduler' and "MT_KEY2"=0
[DEBUG] 2024-04-23 23:21:52.245 [main] TxnHandler - 'CompactionScheduler' locked by 'Lenovo-Bot'
[DEBUG] 2024-04-23 23:21:52.245 [main] TxnHandler - going to execute query <SELECT "NCQ_NEXT" FROM "NEXT_COMPACTION_QUEUE_ID">
[DEBUG] 2024-04-23 23:21:52.247 [main] TxnHandler - Going to execute update <UPDATE "NEXT_COMPACTION_QUEUE_ID" SET "NCQ_NEXT" = 2>
[DEBUG] 2024-04-23 23:21:52.252 [main] TxnHandler - Going to execute query <SELECT "CQ_ID", "CQ_STATE" FROM "COMPACTION_QUEUE" WHERE "CQ_STATE" IN('i','w') AND "CQ_DATABASE"=? AND "CQ_TABLE"=? AND "CQ_PARTITION" is null>
[DEBUG] 2024-04-23 23:21:52.256 [main] TxnHandler - Going to execute update <INSERT INTO "COMPACTION_QUEUE" ("CQ_ID", "CQ_DATABASE", "CQ_TABLE", "CQ_STATE", "CQ_TYPE", "CQ_ENQUEUE_TIME", "CQ_TBLPROPERTIES", "CQ_INITIATOR_ID") values (1, ?, ?, 'i', 'i',{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000, ?, ?)>
[DEBUG] 2024-04-23 23:21:52.257 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:52.259 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.259 [main] PoolBase - HikariPool-3 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@547507935 (XID = 1566), (SESSIONID = 27), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.260 [main] TxnHandler - 'CompactionScheduler' unlocked by 'Lenovo-Bot'
[DEBUG] 2024-04-23 23:21:52.260 [main] PerfLogger - </PERFLOG method=compact2 start=1713910912240 end=1713910912260 duration=20 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:52.260 [main] PerfLogger - <PERFLOG method=find_next_compact2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:52.260 [main] CompactionTxnHandler - Going to execute query <SELECT "CQ_ID", "CQ_DATABASE", "CQ_TABLE", "CQ_PARTITION", "CQ_TYPE", "CQ_TBLPROPERTIES" FROM "COMPACTION_QUEUE" WHERE "CQ_STATE" = 'i'>
[DEBUG] 2024-04-23 23:21:52.263 [main] TxnHandler - Going to execute query <values current_timestamp>
[DEBUG] 2024-04-23 23:21:52.265 [main] CompactionTxnHandler - Going to execute update <UPDATE   "COMPACTION_QUEUE" SET  "CQ_WORKER_ID" = 'myworker',  "CQ_WORKER_VERSION" = 'null',  "CQ_START" = 1713910912264,  "CQ_STATE" = 'w' WHERE "CQ_ID" = 1  AND "CQ_STATE"='i'>
[DEBUG] 2024-04-23 23:21:52.268 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.270 [main] PerfLogger - </PERFLOG method=find_next_compact2 start=1713910912260 end=1713910912270 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:52.270 [main] PerfLogger - <PERFLOG method=mark_cleaned from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:52.270 [main] CompactionTxnHandler - Running markCleaned with CompactionInfo: id:1,dbname:mydb,tableName:mytable,partName:null,state: ,type:MINOR,enqueueTime:0,start:0,properties:0:,runAs:null,tooManyAborts:false,hasOldAbort:false,highestWriteId:0,errorMessage:null,workerId: null,initiatorId: null
[DEBUG] 2024-04-23 23:21:52.274 [main] CompactionTxnHandler - Going to execute update <INSERT INTO "COMPLETED_COMPACTIONS"("CC_ID", "CC_DATABASE", "CC_TABLE", "CC_PARTITION", "CC_STATE", "CC_TYPE", "CC_TBLPROPERTIES", "CC_WORKER_ID", "CC_START", "CC_END", "CC_RUN_AS", "CC_HIGHEST_WRITE_ID", "CC_META_INFO", "CC_HADOOP_JOB_ID", "CC_ERROR_MESSAGE", "CC_ENQUEUE_TIME", "CC_WORKER_VERSION", "CC_INITIATOR_ID", "CC_INITIATOR_VERSION") SELECT "CQ_ID", "CQ_DATABASE", "CQ_TABLE", "CQ_PARTITION", 's', "CQ_TYPE", "CQ_TBLPROPERTIES", "CQ_WORKER_ID", "CQ_START", { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000, "CQ_RUN_AS", "CQ_HIGHEST_WRITE_ID", "CQ_META_INFO", "CQ_HADOOP_JOB_ID", "CQ_ERROR_MESSAGE", "CQ_ENQUEUE_TIME", "CQ_WORKER_VERSION", "CQ_INITIATOR_ID", "CQ_INITIATOR_VERSION"FROM "COMPACTION_QUEUE" WHERE "CQ_ID" = ?> for CQ_ID=1
[DEBUG] 2024-04-23 23:21:52.277 [main] CompactionTxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_ID" = ?>
[DEBUG] 2024-04-23 23:21:52.280 [main] CompactionTxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE" = ? AND "CTC_TABLE" = ?>
[WARN ] 2024-04-23 23:21:52.280 [main] CompactionTxnHandler - Expected to remove at least one row from completed_txn_components when marking compaction entry as clean!
[DEBUG] 2024-04-23 23:21:52.280 [main] CompactionTxnHandler - Removed 0 records from completed_txn_components
[DEBUG] 2024-04-23 23:21:52.280 [main] CompactionTxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" IN ( SELECT "TXN_ID" FROM "TXNS" WHERE "TXN_STATE" = 'a') AND "TC_DATABASE" = ? AND "TC_TABLE" = ? AND "TC_PARTITION" IS NULL>
[DEBUG] 2024-04-23 23:21:52.285 [main] CompactionTxnHandler - Removed 0 records from txn_components
[DEBUG] 2024-04-23 23:21:52.285 [main] CompactionTxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:52.285 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.285 [main] PerfLogger - </PERFLOG method=mark_cleaned start=1713910912270 end=1713910912285 duration=15 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:52.286 [main] PerfLogger - <PERFLOG method=get_latest_committed_compaction_info from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[ERROR] 2024-04-23 23:21:52.288 [main] RetryingHMSHandler - MetaException(message:Database name and table name cannot be null.)
	at org.apache.hadoop.hive.metastore.HMSHandler.get_latest_committed_compaction_info(HMSHandler.java:8811)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy37.get_latest_committed_compaction_info(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.getLatestCommittedCompactionInfo(HiveMetaStoreClient.java:4155)
	at org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.lambda$testGetLatestCommittedCompactionInfo$0(TestHiveMetaStoreTxns.java:432)
	at org.junit.Assert.assertThrows(Assert.java:1001)
	at org.junit.Assert.assertThrows(Assert.java:981)
	at org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.testGetLatestCommittedCompactionInfo(TestHiveMetaStoreTxns.java:432)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

[DEBUG] 2024-04-23 23:21:52.288 [main] PerfLogger - </PERFLOG method=get_latest_committed_compaction_info start=1713910912286 end=1713910912288 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 23:21:52.288 [main] PerfLogger - <PERFLOG method=get_latest_committed_compaction_info from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:52.294 [main] TxnHandler - Going to execute query <SELECT * FROM (   SELECT   "CC_ID", "CC_DATABASE", "CC_TABLE", "CC_PARTITION", "CC_TYPE"   FROM "COMPLETED_COMPACTIONS"     WHERE "CC_STATE" = 's'   UNION ALL   SELECT   "CQ_ID" AS "CC_ID", "CQ_DATABASE" AS "CC_DATABASE"   ,"CQ_TABLE" AS "CC_TABLE", "CQ_PARTITION" AS "CC_PARTITION"   ,"CQ_TYPE" AS "CC_TYPE"   FROM "COMPACTION_QUEUE"     WHERE "CQ_STATE" = 'r') AS compactions  WHERE "CC_DATABASE"=? AND "CC_TABLE"=? AND "CC_PARTITION" IS NULL ORDER BY "CC_ID" DESC>
[DEBUG] 2024-04-23 23:21:52.295 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:52.295 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.295 [main] PerfLogger - </PERFLOG method=get_latest_committed_compaction_info start=1713910912288 end=1713910912295 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:52.295 [main] PerfLogger - <PERFLOG method=get_latest_committed_compaction_info from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:52.295 [main] TxnHandler - Going to execute query <SELECT * FROM (   SELECT   "CC_ID", "CC_DATABASE", "CC_TABLE", "CC_PARTITION", "CC_TYPE"   FROM "COMPLETED_COMPACTIONS"     WHERE "CC_STATE" = 's'   UNION ALL   SELECT   "CQ_ID" AS "CC_ID", "CQ_DATABASE" AS "CC_DATABASE"   ,"CQ_TABLE" AS "CC_TABLE", "CQ_PARTITION" AS "CC_PARTITION"   ,"CQ_TYPE" AS "CC_TYPE"   FROM "COMPACTION_QUEUE"     WHERE "CQ_STATE" = 'r') AS compactions  WHERE "CC_DATABASE"=? AND "CC_TABLE"=? AND "CC_PARTITION" IS NULL ORDER BY "CC_ID" DESC>
[DEBUG] 2024-04-23 23:21:52.296 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:52.296 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.296 [main] PerfLogger - </PERFLOG method=get_latest_committed_compaction_info start=1713910912295 end=1713910912296 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:21:52.296 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:21:52.310 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:52.310 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:52.312 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:21:52.312 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:21:52.312 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:21:52.313 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:21:52.313 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:21:52.313 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:21:52.313 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:21:52.314 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:21:52.314 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:21:52.314 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:21:52.315 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:21:52.315 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:21:52.315 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:21:52.323 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:52.323 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:21:52.325 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:21:52.328 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:21:52.328 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:21:52.332 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:21:52.332 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:21:52.332 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:52.333 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.333 [main] PerfLogger - </PERFLOG method=open_txns start=1713910912323 end=1713910912333 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:52.333 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:52.333 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:21:52.333 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:21:52.334 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 1, lowWaterMark 0
[DEBUG] 2024-04-23 23:21:52.334 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:21:52.339 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(2, 1),(3, 1),(4, 1)>
[INFO ] 2024-04-23 23:21:52.342 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([2, 3, 4]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:21:52.342 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:52.342 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.342 [main] PerfLogger - </PERFLOG method=open_txns start=1713910912333 end=1713910912342 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:52.342 [main] PerfLogger - <PERFLOG method=abort_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:52.345 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (2)>
[DEBUG] 2024-04-23 23:21:52.345 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:21:52.347 [main] TxnHandler - Removed transactions: ([2]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:21:52.348 [main] TxnHandler - Going to execute select <SELECT "RTM_REPL_POLICY" FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (2)>
[DEBUG] 2024-04-23 23:21:52.350 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'a' WHERE "TXN_STATE" = 'o' AND ("TXN_ID" in (2))>
[DEBUG] 2024-04-23 23:21:52.350 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" in (2)>
[DEBUG] 2024-04-23 23:21:52.350 [main] TxnUtils - Adding query to batch: <DELETE FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (2)>
[DEBUG] 2024-04-23 23:21:52.350 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:21:52.358 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:52.358 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.358 [main] PerfLogger - </PERFLOG method=abort_txn start=1713910912342 end=1713910912358 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:52.358 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:52.363 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 3 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:21:52.367 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
[DEBUG] 2024-04-23 23:21:52.367 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 3>
[DEBUG] 2024-04-23 23:21:52.367 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 3>
[DEBUG] 2024-04-23 23:21:52.367 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 3>
[DEBUG] 2024-04-23 23:21:52.367 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:21:52.374 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (3)>
[DEBUG] 2024-04-23 23:21:52.374 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:21:52.377 [main] TxnHandler - Removed transactions: ([3]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:21:52.377 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:3
[DEBUG] 2024-04-23 23:21:52.377 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:52.377 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.377 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:52.377 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.377 [main] PerfLogger - </PERFLOG method=commit_txn start=1713910912358 end=1713910912377 duration=19 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:21:52.377 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:52.377 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:21:52.380 [main] TxnHandler - Got OpenTxnList with hwm: 4 and openTxnList size 3.
[DEBUG] 2024-04-23 23:21:52.380 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:21:52.380 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.380 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713910912377 end=1713910912380 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:21:52.381 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:21:52.384 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:52.384 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:52.386 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:21:52.386 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:21:52.386 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:21:52.386 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:21:52.387 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:21:52.387 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:21:52.387 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:21:52.387 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:21:52.387 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:21:52.388 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:21:52.388 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:21:52.388 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:21:52.388 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:21:52.394 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:21:52.394 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:21:52.395 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:21:52.397 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:21:52.397 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:21:52.400 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:21:52.400 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:21:52.400 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:21:52.400 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1230507176 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:21:52.400 [main] PerfLogger - </PERFLOG method=open_txns start=1713910912394 end=1713910912400 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:21:52.402 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:21:52.404 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:52.404 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:52.406 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:21:52.406 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:21:52.406 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:21:52.406 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:21:52.407 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:21:52.407 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:21:52.407 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:21:52.407 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:21:52.407 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:21:52.407 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:21:52.407 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:21:52.408 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:21:52.408 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[INFO ] 2024-04-23 23:21:52.413 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:21:52.415 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:52.415 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:21:52.417 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:21:52.417 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:21:52.417 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:21:52.417 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:21:52.418 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:21:52.418 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:21:52.418 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:21:52.418 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:21:52.418 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:21:52.419 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:21:52.419 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:21:52.419 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:21:52.419 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:21:52.430 [Thread-15] ShutdownHookManager - ShutdownHookManger complete shutdown.
