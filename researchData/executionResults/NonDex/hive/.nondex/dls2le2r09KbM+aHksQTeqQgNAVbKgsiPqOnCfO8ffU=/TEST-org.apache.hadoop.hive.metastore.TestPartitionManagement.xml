<?xml version="1.0" encoding="UTF-8"?>
<testsuite xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://maven.apache.org/surefire/maven-surefire-plugin/xsd/surefire-test-report-3.0.xsd" version="3.0" name="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="269.261" tests="16" errors="9" skipped="0" failures="6">
  <properties>
    <property name="sun.desktop" value="gnome"/>
    <property name="awt.toolkit" value="sun.awt.X11.XToolkit"/>
    <property name="nondexStart" value="0"/>
    <property name="java.specification.version" value="1.8"/>
    <property name="file.encoding.pkg" value="sun.io"/>
    <property name="sun.cpu.isalist" value=""/>
    <property name="sun.jnu.encoding" value="UTF-8"/>
    <property name="java.class.path" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/test-classes:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/classes:/home/alex/Repositories/hive/standalone-metastore/metastore-common/target/classes:/home/alex/.m2/repository/org/antlr/ST4/4.0.4/ST4-4.0.4.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper/3.5.5/zookeeper-3.5.5.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.5.5/zookeeper-jute-3.5.5.jar:/home/alex/.m2/repository/org/apache/yetus/audience-annotations/0.5.0/audience-annotations-0.5.0.jar:/home/alex/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.8.4/caffeine-2.8.4.jar:/home/alex/.m2/repository/org/checkerframework/checker-qual/3.4.0/checker-qual-3.4.0.jar:/home/alex/.m2/repository/com/google/errorprone/error_prone_annotations/2.3.4/error_prone_annotations-2.3.4.jar:/home/alex/.m2/repository/org/apache/curator/curator-recipes/4.2.0/curator-recipes-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-framework/4.2.0/curator-framework-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-client/4.2.0/curator-client-4.2.0.jar:/home/alex/.m2/repository/org/slf4j/slf4j-api/1.7.30/slf4j-api-1.7.30.jar:/home/alex/.m2/repository/org/apache/orc/orc-core/1.6.9/orc-core-1.6.9.jar:/home/alex/.m2/repository/org/apache/orc/orc-shims/1.6.9/orc-shims-1.6.9.jar:/home/alex/.m2/repository/io/airlift/aircompressor/0.19/aircompressor-0.19.jar:/home/alex/.m2/repository/javax/xml/bind/jaxb-api/2.2.11/jaxb-api-2.2.11.jar:/home/alex/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/alex/.m2/repository/org/threeten/threeten-extra/1.5.0/threeten-extra-1.5.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.12.0/jackson-databind-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.12.0/jackson-annotations-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.12.0/jackson-core-2.12.0.jar:/home/alex/.m2/repository/com/github/joshelser/dropwizard-metrics-hadoop-metrics2-reporter/0.1.2/dropwizard-metrics-hadoop-metrics2-reporter-0.1.2.jar:/home/alex/.m2/repository/com/google/guava/guava/19.0/guava-19.0.jar:/home/alex/.m2/repository/com/google/protobuf/protobuf-java/2.6.1/protobuf-java-2.6.1.jar:/home/alex/.m2/repository/com/zaxxer/HikariCP/2.6.1/HikariCP-2.6.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-dbcp2/2.7.0/commons-dbcp2-2.7.0.jar:/home/alex/.m2/repository/org/apache/commons/commons-pool2/2.7.0/commons-pool2-2.7.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-core/3.1.0/metrics-core-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-jvm/3.1.0/metrics-jvm-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-json/3.1.0/metrics-json-3.1.0.jar:/home/alex/.m2/repository/javolution/javolution/5.5.1/javolution-5.5.1.jar:/home/alex/.m2/repository/org/antlr/antlr-runtime/3.5.2/antlr-runtime-3.5.2.jar:/home/alex/.m2/repository/org/apache/commons/commons-lang3/3.9/commons-lang3-3.9.jar:/home/alex/.m2/repository/org/apache/derby/derby/10.14.1.0/derby-10.14.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-annotations/3.1.0/hadoop-annotations-3.1.0.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/../lib/tools.jar:/home/alex/.m2/repository/commons-cli/commons-cli/1.2/commons-cli-1.2.jar:/home/alex/.m2/repository/org/apache/commons/commons-math3/3.1.1/commons-math3-3.1.1.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpclient/4.5.2/httpclient-4.5.2.jar:/home/alex/.m2/repository/commons-codec/commons-codec/1.11/commons-codec-1.11.jar:/home/alex/.m2/repository/commons-io/commons-io/2.5/commons-io-2.5.jar:/home/alex/.m2/repository/commons-net/commons-net/3.6/commons-net-3.6.jar:/home/alex/.m2/repository/commons-collections/commons-collections/3.2.2/commons-collections-3.2.2.jar:/home/alex/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-server/9.3.19.v20170502/jetty-server-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-http/9.3.19.v20170502/jetty-http-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-io/9.3.19.v20170502/jetty-io-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util/9.3.19.v20170502/jetty-util-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-servlet/9.3.19.v20170502/jetty-servlet-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-security/9.3.19.v20170502/jetty-security-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-webapp/9.3.19.v20170502/jetty-webapp-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-xml/9.3.19.v20170502/jetty-xml-9.3.19.v20170502.jar:/home/alex/.m2/repository/javax/servlet/jsp/jsp-api/2.1/jsp-api-2.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-core/1.19/jersey-core-1.19.jar:/home/alex/.m2/repository/javax/ws/rs/jsr311-api/1.1.1/jsr311-api-1.1.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-servlet/1.19/jersey-servlet-1.19.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-json/1.19/jersey-json-1.19.jar:/home/alex/.m2/repository/org/codehaus/jettison/jettison/1.1/jettison-1.1.jar:/home/alex/.m2/repository/com/sun/xml/bind/jaxb-impl/2.2.3-1/jaxb-impl-2.2.3-1.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-core-asl/1.9.2/jackson-core-asl-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-mapper-asl/1.9.2/jackson-mapper-asl-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-jaxrs/1.9.2/jackson-jaxrs-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-xc/1.9.2/jackson-xc-1.9.2.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-server/1.19/jersey-server-1.19.jar:/home/alex/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/alex/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/alex/.m2/repository/org/apache/commons/commons-configuration2/2.1.1/commons-configuration2-2.1.1.jar:/home/alex/.m2/repository/org/apache/avro/avro/1.7.7/avro-1.7.7.jar:/home/alex/.m2/repository/com/thoughtworks/paranamer/paranamer/2.3/paranamer-2.3.jar:/home/alex/.m2/repository/org/xerial/snappy/snappy-java/1.0.5/snappy-java-1.0.5.jar:/home/alex/.m2/repository/com/google/re2j/re2j/1.1/re2j-1.1.jar:/home/alex/.m2/repository/com/google/code/gson/gson/2.2.4/gson-2.2.4.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-auth/3.1.0/hadoop-auth-3.1.0.jar:/home/alex/.m2/repository/com/nimbusds/nimbus-jose-jwt/4.41.1/nimbus-jose-jwt-4.41.1.jar:/home/alex/.m2/repository/com/github/stephenc/jcip/jcip-annotations/1.0-1/jcip-annotations-1.0-1.jar:/home/alex/.m2/repository/net/minidev/json-smart/2.3/json-smart-2.3.jar:/home/alex/.m2/repository/net/minidev/accessors-smart/1.2/accessors-smart-1.2.jar:/home/alex/.m2/repository/org/ow2/asm/asm/5.0.4/asm-5.0.4.jar:/home/alex/.m2/repository/com/jcraft/jsch/0.1.54/jsch-0.1.54.jar:/home/alex/.m2/repository/com/google/code/findbugs/jsr305/3.0.0/jsr305-3.0.0.jar:/home/alex/.m2/repository/org/apache/htrace/htrace-core4/4.1.0-incubating/htrace-core4-4.1.0-incubating.jar:/home/alex/.m2/repository/org/apache/commons/commons-compress/1.4.1/commons-compress-1.4.1.jar:/home/alex/.m2/repository/org/tukaani/xz/1.0/xz-1.0.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-simplekdc/1.0.1/kerb-simplekdc-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-client/1.0.1/kerb-client-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-config/1.0.1/kerby-config-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-core/1.0.1/kerb-core-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-pkix/1.0.1/kerby-pkix-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-asn1/1.0.1/kerby-asn1-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-util/1.0.1/kerby-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-common/1.0.1/kerb-common-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-crypto/1.0.1/kerb-crypto-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-util/1.0.1/kerb-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/token-provider/1.0.1/token-provider-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-admin/1.0.1/kerb-admin-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-server/1.0.1/kerb-server-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-identity/1.0.1/kerb-identity-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-xdr/1.0.1/kerby-xdr-1.0.1.jar:/home/alex/.m2/repository/org/codehaus/woodstox/stax2-api/3.1.4/stax2-api-3.1.4.jar:/home/alex/.m2/repository/com/fasterxml/woodstox/woodstox-core/5.0.3/woodstox-core-5.0.3.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-distcp/3.1.0/hadoop-distcp-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs/3.1.0/hadoop-hdfs-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.3.19.v20170502/jetty-util-ajax-9.3.19.v20170502.jar:/home/alex/.m2/repository/commons-daemon/commons-daemon/1.0.13/commons-daemon-1.0.13.jar:/home/alex/.m2/repository/org/fusesource/leveldbjni/leveldbjni-all/1.8/leveldbjni-all-1.8.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.1.0/hadoop-hdfs-client-3.1.0.jar:/home/alex/.m2/repository/com/squareup/okhttp/okhttp/2.7.5/okhttp-2.7.5.jar:/home/alex/.m2/repository/com/squareup/okio/okio/1.6.0/okio-1.6.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-core/3.1.0/hadoop-mapreduce-client-core-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-client/3.1.0/hadoop-yarn-client-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-api/3.1.0/hadoop-yarn-api-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-common/3.1.0/hadoop-yarn-common-3.1.0.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-client/1.19/jersey-client-1.19.jar:/home/alex/.m2/repository/com/google/inject/guice/4.0/guice-4.0.jar:/home/alex/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/alex/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/alex/.m2/repository/com/sun/jersey/contribs/jersey-guice/1.19/jersey-guice-1.19.jar:/home/alex/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.12.0/jackson-module-jaxb-annotations-2.12.0.jar:/home/alex/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.2/jakarta.xml.bind-api-2.3.2.jar:/home/alex/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.1/jakarta.activation-api-1.2.1.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.12.0/jackson-jaxrs-json-provider-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.12.0/jackson-jaxrs-base-2.12.0.jar:/home/alex/.m2/repository/com/google/inject/extensions/guice-servlet/4.0/guice-servlet-4.0.jar:/home/alex/.m2/repository/commons-beanutils/commons-beanutils/1.9.4/commons-beanutils-1.9.4.jar:/home/alex/Repositories/hive/storage-api/target/classes:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.13.2/log4j-slf4j-impl-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-api/2.13.2/log4j-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-1.2-api/2.13.2/log4j-1.2-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-core/2.13.2/log4j-core-2.13.2.jar:/home/alex/.m2/repository/org/apache/thrift/libfb303/0.9.3/libfb303-0.9.3.jar:/home/alex/.m2/repository/org/apache/thrift/libthrift/0.14.1/libthrift-0.14.1.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpcore/4.4.12/httpcore-4.4.12.jar:/home/alex/.m2/repository/org/apache/tomcat/embed/tomcat-embed-core/8.5.46/tomcat-embed-core-8.5.46.jar:/home/alex/.m2/repository/org/apache/tomcat/tomcat-annotations-api/8.5.46/tomcat-annotations-api-8.5.46.jar:/home/alex/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-api-jdo/5.2.4/datanucleus-api-jdo-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-core/5.2.4/datanucleus-core-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-rdbms/5.2.4/datanucleus-rdbms-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/javax.jdo/3.2.0-release/javax.jdo-3.2.0-release.jar:/home/alex/.m2/repository/javax/transaction/javax.transaction-api/1.3/javax.transaction-api-1.3.jar:/home/alex/.m2/repository/org/glassfish/corba/glassfish-corba-omgapi/4.2.2/glassfish-corba-omgapi-4.2.2.jar:/home/alex/.m2/repository/org/skyscreamer/jsonassert/1.4.0/jsonassert-1.4.0.jar:/home/alex/.m2/repository/com/vaadin/external/google/android-json/0.0.20131108.vaadin1/android-json-0.0.20131108.vaadin1.jar:/home/alex/.m2/repository/sqlline/sqlline/1.9.0/sqlline-1.9.0.jar:/home/alex/.m2/repository/org/jline/jline-terminal/3.12.1/jline-terminal-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-reader/3.12.1/jline-reader-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jansi/3.12.1/jline-terminal-jansi-3.12.1.jar:/home/alex/.m2/repository/org/fusesource/jansi/jansi/1.18/jansi-1.18.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jna/3.12.1/jline-terminal-jna-3.12.1.jar:/home/alex/.m2/repository/net/java/dev/jna/jna/5.3.1/jna-5.3.1.jar:/home/alex/.m2/repository/org/jline/jline-builtins/3.12.1/jline-builtins-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-style/3.12.1/jline-style-3.12.1.jar:/home/alex/.m2/repository/jline/jline/2.14.6/jline-2.14.6.jar:/home/alex/.m2/repository/commons-logging/commons-logging/1.1.3/commons-logging-1.1.3.jar:/home/alex/.m2/repository/com/cronutils/cron-utils/9.1.3/cron-utils-9.1.3.jar:/home/alex/.m2/repository/org/glassfish/javax.el/3.0.0/javax.el-3.0.0.jar:/home/alex/.m2/repository/com/oracle/database/jdbc/ojdbc8/21.3.0.0/ojdbc8-21.3.0.0.jar:/home/alex/.m2/repository/mysql/mysql-connector-java/8.0.27/mysql-connector-java-8.0.27.jar:/home/alex/.m2/repository/com/microsoft/sqlserver/mssql-jdbc/6.2.1.jre8/mssql-jdbc-6.2.1.jre8.jar:/home/alex/.m2/repository/junit/junit/4.13/junit-4.13.jar:/home/alex/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-server-integ/1.5.7/apacheds-server-integ-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-interceptor-kerberos/1.5.7/apacheds-interceptor-kerberos-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core/1.5.7/apacheds-core-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-api/1.5.7/apacheds-core-api-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-entry/1.5.7/apacheds-core-entry-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-constants/1.5.7/apacheds-core-constants-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-utils/1.5.7/apacheds-utils-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-kerberos-shared/1.5.7/apacheds-kerberos-shared-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-jndi/1.5.7/apacheds-core-jndi-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-protocol-shared/1.5.7/apacheds-protocol-shared-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-integ/1.5.7/apacheds-core-integ-1.5.7.jar:/home/alex/.m2/repository/ldapsdk/ldapsdk/4.1/ldapsdk-4.1.jar:/home/alex/.m2/repository/org/apache/directory/client/ldap/ldap-client-api/0.1/ldap-client-api-0.1.jar:/home/alex/.m2/repository/commons-pool/commons-pool/1.5.4/commons-pool-1.5.4.jar:/home/alex/.m2/repository/org/apache/mina/mina-core/2.0.0-RC1/mina-core-2.0.0-RC1.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap/0.9.19/shared-ldap-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-i18n/0.9.19/shared-i18n-0.9.19.jar:/home/alex/.m2/repository/antlr/antlr/2.7.7/antlr-2.7.7.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema/0.9.19/shared-ldap-schema-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema-loader/0.9.19/shared-ldap-schema-loader-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema-manager/0.9.19/shared-ldap-schema-manager-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-cursor/0.9.19/shared-cursor-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-jndi/0.9.19/shared-ldap-jndi-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-asn1-codec/0.9.19/shared-asn1-codec-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-asn1/0.9.19/shared-asn1-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-constants/0.9.19/shared-ldap-constants-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-converter/0.9.19/shared-ldap-converter-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema-dao/0.9.19/shared-ldap-schema-dao-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldif/0.9.19/shared-ldif-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-dsml-parser/0.9.19/shared-dsml-parser-0.9.19.jar:/home/alex/.m2/repository/dom4j/dom4j/1.6.1/dom4j-1.6.1.jar:/home/alex/.m2/repository/xml-apis/xml-apis/1.0.b2/xml-apis-1.0.b2.jar:/home/alex/.m2/repository/xpp3/xpp3/1.1.4c/xpp3-1.1.4c.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-test-framework/1.5.7/apacheds-test-framework-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-i18n/1.5.7/apacheds-i18n-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-server-annotations/1.5.7/apacheds-server-annotations-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-annotations/1.5.7/apacheds-core-annotations-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-jdbm-partition/1.5.7/apacheds-jdbm-partition-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-jdbm-store/1.5.7/apacheds-jdbm-store-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-jdbm/1.5.7/apacheds-jdbm-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-avl/1.5.7/apacheds-core-avl-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-xdbm-search/1.5.7/apacheds-xdbm-search-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-ldif-partition/1.5.7/apacheds-ldif-partition-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-avl-partition/1.5.7/apacheds-avl-partition-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-mock/1.5.7/apacheds-core-mock-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-protocol-ldap/1.5.7/apacheds-protocol-ldap-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-xdbm-tools/1.5.7/apacheds-xdbm-tools-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-xdbm-base/1.5.7/apacheds-xdbm-base-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-protocol-kerberos/1.5.7/apacheds-protocol-kerberos-1.5.7.jar:/home/alex/.m2/repository/org/mockito/mockito-core/3.3.3/mockito-core-3.3.3.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy/1.10.5/byte-buddy-1.10.5.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy-agent/1.10.5/byte-buddy-agent-1.10.5.jar:/home/alex/.m2/repository/org/objenesis/objenesis/2.6/objenesis-2.6.jar:/home/alex/.m2/repository/org/postgresql/postgresql/42.2.14/postgresql-42.2.14.jar:/home/alex/.m2/repository/org/apache/curator/curator-test/4.2.0/curator-test-4.2.0.jar:/home/alex/Repositories/hive/standalone-metastore/metastore-server/src/test/resources:"/>
    <property name="java.vm.vendor" value="Private Build"/>
    <property name="nondexPrintstack" value="false"/>
    <property name="sun.arch.data.model" value="64"/>
    <property name="java.vendor.url" value="http://java.oracle.com/"/>
    <property name="user.timezone" value="Europe/Lisbon"/>
    <property name="user.country.format" value="PT"/>
    <property name="test.tmp.dir" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp"/>
    <property name="java.vm.specification.version" value="1.8"/>
    <property name="os.name" value="Linux"/>
    <property name="sun.java.launcher" value="SUN_STANDARD"/>
    <property name="user.country" value="US"/>
    <property name="sun.boot.library.path" value="/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64"/>
    <property name="sun.java.command" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/surefire/surefirebooter3086804005860458714.jar /home/alex/Repositories/hive/standalone-metastore/metastore-server/target/surefire 2024-04-23T21-59-46_173-jvmRun1 surefire2152029583382649589tmp surefire_10116949070400853004329tmp"/>
    <property name="nondexLogging" value="CONFIG"/>
    <property name="surefire.test.class.path" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/test-classes:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/classes:/home/alex/Repositories/hive/standalone-metastore/metastore-common/target/classes:/home/alex/.m2/repository/org/antlr/ST4/4.0.4/ST4-4.0.4.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper/3.5.5/zookeeper-3.5.5.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.5.5/zookeeper-jute-3.5.5.jar:/home/alex/.m2/repository/org/apache/yetus/audience-annotations/0.5.0/audience-annotations-0.5.0.jar:/home/alex/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.8.4/caffeine-2.8.4.jar:/home/alex/.m2/repository/org/checkerframework/checker-qual/3.4.0/checker-qual-3.4.0.jar:/home/alex/.m2/repository/com/google/errorprone/error_prone_annotations/2.3.4/error_prone_annotations-2.3.4.jar:/home/alex/.m2/repository/org/apache/curator/curator-recipes/4.2.0/curator-recipes-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-framework/4.2.0/curator-framework-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-client/4.2.0/curator-client-4.2.0.jar:/home/alex/.m2/repository/org/slf4j/slf4j-api/1.7.30/slf4j-api-1.7.30.jar:/home/alex/.m2/repository/org/apache/orc/orc-core/1.6.9/orc-core-1.6.9.jar:/home/alex/.m2/repository/org/apache/orc/orc-shims/1.6.9/orc-shims-1.6.9.jar:/home/alex/.m2/repository/io/airlift/aircompressor/0.19/aircompressor-0.19.jar:/home/alex/.m2/repository/javax/xml/bind/jaxb-api/2.2.11/jaxb-api-2.2.11.jar:/home/alex/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/alex/.m2/repository/org/threeten/threeten-extra/1.5.0/threeten-extra-1.5.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.12.0/jackson-databind-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.12.0/jackson-annotations-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.12.0/jackson-core-2.12.0.jar:/home/alex/.m2/repository/com/github/joshelser/dropwizard-metrics-hadoop-metrics2-reporter/0.1.2/dropwizard-metrics-hadoop-metrics2-reporter-0.1.2.jar:/home/alex/.m2/repository/com/google/guava/guava/19.0/guava-19.0.jar:/home/alex/.m2/repository/com/google/protobuf/protobuf-java/2.6.1/protobuf-java-2.6.1.jar:/home/alex/.m2/repository/com/zaxxer/HikariCP/2.6.1/HikariCP-2.6.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-dbcp2/2.7.0/commons-dbcp2-2.7.0.jar:/home/alex/.m2/repository/org/apache/commons/commons-pool2/2.7.0/commons-pool2-2.7.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-core/3.1.0/metrics-core-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-jvm/3.1.0/metrics-jvm-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-json/3.1.0/metrics-json-3.1.0.jar:/home/alex/.m2/repository/javolution/javolution/5.5.1/javolution-5.5.1.jar:/home/alex/.m2/repository/org/antlr/antlr-runtime/3.5.2/antlr-runtime-3.5.2.jar:/home/alex/.m2/repository/org/apache/commons/commons-lang3/3.9/commons-lang3-3.9.jar:/home/alex/.m2/repository/org/apache/derby/derby/10.14.1.0/derby-10.14.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-annotations/3.1.0/hadoop-annotations-3.1.0.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/../lib/tools.jar:/home/alex/.m2/repository/commons-cli/commons-cli/1.2/commons-cli-1.2.jar:/home/alex/.m2/repository/org/apache/commons/commons-math3/3.1.1/commons-math3-3.1.1.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpclient/4.5.2/httpclient-4.5.2.jar:/home/alex/.m2/repository/commons-codec/commons-codec/1.11/commons-codec-1.11.jar:/home/alex/.m2/repository/commons-io/commons-io/2.5/commons-io-2.5.jar:/home/alex/.m2/repository/commons-net/commons-net/3.6/commons-net-3.6.jar:/home/alex/.m2/repository/commons-collections/commons-collections/3.2.2/commons-collections-3.2.2.jar:/home/alex/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-server/9.3.19.v20170502/jetty-server-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-http/9.3.19.v20170502/jetty-http-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-io/9.3.19.v20170502/jetty-io-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util/9.3.19.v20170502/jetty-util-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-servlet/9.3.19.v20170502/jetty-servlet-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-security/9.3.19.v20170502/jetty-security-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-webapp/9.3.19.v20170502/jetty-webapp-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-xml/9.3.19.v20170502/jetty-xml-9.3.19.v20170502.jar:/home/alex/.m2/repository/javax/servlet/jsp/jsp-api/2.1/jsp-api-2.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-core/1.19/jersey-core-1.19.jar:/home/alex/.m2/repository/javax/ws/rs/jsr311-api/1.1.1/jsr311-api-1.1.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-servlet/1.19/jersey-servlet-1.19.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-json/1.19/jersey-json-1.19.jar:/home/alex/.m2/repository/org/codehaus/jettison/jettison/1.1/jettison-1.1.jar:/home/alex/.m2/repository/com/sun/xml/bind/jaxb-impl/2.2.3-1/jaxb-impl-2.2.3-1.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-core-asl/1.9.2/jackson-core-asl-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-mapper-asl/1.9.2/jackson-mapper-asl-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-jaxrs/1.9.2/jackson-jaxrs-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-xc/1.9.2/jackson-xc-1.9.2.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-server/1.19/jersey-server-1.19.jar:/home/alex/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/alex/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/alex/.m2/repository/org/apache/commons/commons-configuration2/2.1.1/commons-configuration2-2.1.1.jar:/home/alex/.m2/repository/org/apache/avro/avro/1.7.7/avro-1.7.7.jar:/home/alex/.m2/repository/com/thoughtworks/paranamer/paranamer/2.3/paranamer-2.3.jar:/home/alex/.m2/repository/org/xerial/snappy/snappy-java/1.0.5/snappy-java-1.0.5.jar:/home/alex/.m2/repository/com/google/re2j/re2j/1.1/re2j-1.1.jar:/home/alex/.m2/repository/com/google/code/gson/gson/2.2.4/gson-2.2.4.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-auth/3.1.0/hadoop-auth-3.1.0.jar:/home/alex/.m2/repository/com/nimbusds/nimbus-jose-jwt/4.41.1/nimbus-jose-jwt-4.41.1.jar:/home/alex/.m2/repository/com/github/stephenc/jcip/jcip-annotations/1.0-1/jcip-annotations-1.0-1.jar:/home/alex/.m2/repository/net/minidev/json-smart/2.3/json-smart-2.3.jar:/home/alex/.m2/repository/net/minidev/accessors-smart/1.2/accessors-smart-1.2.jar:/home/alex/.m2/repository/org/ow2/asm/asm/5.0.4/asm-5.0.4.jar:/home/alex/.m2/repository/com/jcraft/jsch/0.1.54/jsch-0.1.54.jar:/home/alex/.m2/repository/com/google/code/findbugs/jsr305/3.0.0/jsr305-3.0.0.jar:/home/alex/.m2/repository/org/apache/htrace/htrace-core4/4.1.0-incubating/htrace-core4-4.1.0-incubating.jar:/home/alex/.m2/repository/org/apache/commons/commons-compress/1.4.1/commons-compress-1.4.1.jar:/home/alex/.m2/repository/org/tukaani/xz/1.0/xz-1.0.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-simplekdc/1.0.1/kerb-simplekdc-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-client/1.0.1/kerb-client-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-config/1.0.1/kerby-config-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-core/1.0.1/kerb-core-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-pkix/1.0.1/kerby-pkix-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-asn1/1.0.1/kerby-asn1-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-util/1.0.1/kerby-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-common/1.0.1/kerb-common-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-crypto/1.0.1/kerb-crypto-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-util/1.0.1/kerb-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/token-provider/1.0.1/token-provider-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-admin/1.0.1/kerb-admin-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-server/1.0.1/kerb-server-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-identity/1.0.1/kerb-identity-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-xdr/1.0.1/kerby-xdr-1.0.1.jar:/home/alex/.m2/repository/org/codehaus/woodstox/stax2-api/3.1.4/stax2-api-3.1.4.jar:/home/alex/.m2/repository/com/fasterxml/woodstox/woodstox-core/5.0.3/woodstox-core-5.0.3.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-distcp/3.1.0/hadoop-distcp-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs/3.1.0/hadoop-hdfs-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.3.19.v20170502/jetty-util-ajax-9.3.19.v20170502.jar:/home/alex/.m2/repository/commons-daemon/commons-daemon/1.0.13/commons-daemon-1.0.13.jar:/home/alex/.m2/repository/org/fusesource/leveldbjni/leveldbjni-all/1.8/leveldbjni-all-1.8.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.1.0/hadoop-hdfs-client-3.1.0.jar:/home/alex/.m2/repository/com/squareup/okhttp/okhttp/2.7.5/okhttp-2.7.5.jar:/home/alex/.m2/repository/com/squareup/okio/okio/1.6.0/okio-1.6.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-core/3.1.0/hadoop-mapreduce-client-core-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-client/3.1.0/hadoop-yarn-client-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-api/3.1.0/hadoop-yarn-api-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-common/3.1.0/hadoop-yarn-common-3.1.0.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-client/1.19/jersey-client-1.19.jar:/home/alex/.m2/repository/com/google/inject/guice/4.0/guice-4.0.jar:/home/alex/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/alex/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/alex/.m2/repository/com/sun/jersey/contribs/jersey-guice/1.19/jersey-guice-1.19.jar:/home/alex/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.12.0/jackson-module-jaxb-annotations-2.12.0.jar:/home/alex/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.2/jakarta.xml.bind-api-2.3.2.jar:/home/alex/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.1/jakarta.activation-api-1.2.1.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.12.0/jackson-jaxrs-json-provider-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.12.0/jackson-jaxrs-base-2.12.0.jar:/home/alex/.m2/repository/com/google/inject/extensions/guice-servlet/4.0/guice-servlet-4.0.jar:/home/alex/.m2/repository/commons-beanutils/commons-beanutils/1.9.4/commons-beanutils-1.9.4.jar:/home/alex/Repositories/hive/storage-api/target/classes:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.13.2/log4j-slf4j-impl-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-api/2.13.2/log4j-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-1.2-api/2.13.2/log4j-1.2-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-core/2.13.2/log4j-core-2.13.2.jar:/home/alex/.m2/repository/org/apache/thrift/libfb303/0.9.3/libfb303-0.9.3.jar:/home/alex/.m2/repository/org/apache/thrift/libthrift/0.14.1/libthrift-0.14.1.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpcore/4.4.12/httpcore-4.4.12.jar:/home/alex/.m2/repository/org/apache/tomcat/embed/tomcat-embed-core/8.5.46/tomcat-embed-core-8.5.46.jar:/home/alex/.m2/repository/org/apache/tomcat/tomcat-annotations-api/8.5.46/tomcat-annotations-api-8.5.46.jar:/home/alex/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-api-jdo/5.2.4/datanucleus-api-jdo-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-core/5.2.4/datanucleus-core-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-rdbms/5.2.4/datanucleus-rdbms-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/javax.jdo/3.2.0-release/javax.jdo-3.2.0-release.jar:/home/alex/.m2/repository/javax/transaction/javax.transaction-api/1.3/javax.transaction-api-1.3.jar:/home/alex/.m2/repository/org/glassfish/corba/glassfish-corba-omgapi/4.2.2/glassfish-corba-omgapi-4.2.2.jar:/home/alex/.m2/repository/org/skyscreamer/jsonassert/1.4.0/jsonassert-1.4.0.jar:/home/alex/.m2/repository/com/vaadin/external/google/android-json/0.0.20131108.vaadin1/android-json-0.0.20131108.vaadin1.jar:/home/alex/.m2/repository/sqlline/sqlline/1.9.0/sqlline-1.9.0.jar:/home/alex/.m2/repository/org/jline/jline-terminal/3.12.1/jline-terminal-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-reader/3.12.1/jline-reader-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jansi/3.12.1/jline-terminal-jansi-3.12.1.jar:/home/alex/.m2/repository/org/fusesource/jansi/jansi/1.18/jansi-1.18.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jna/3.12.1/jline-terminal-jna-3.12.1.jar:/home/alex/.m2/repository/net/java/dev/jna/jna/5.3.1/jna-5.3.1.jar:/home/alex/.m2/repository/org/jline/jline-builtins/3.12.1/jline-builtins-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-style/3.12.1/jline-style-3.12.1.jar:/home/alex/.m2/repository/jline/jline/2.14.6/jline-2.14.6.jar:/home/alex/.m2/repository/commons-logging/commons-logging/1.1.3/commons-logging-1.1.3.jar:/home/alex/.m2/repository/com/cronutils/cron-utils/9.1.3/cron-utils-9.1.3.jar:/home/alex/.m2/repository/org/glassfish/javax.el/3.0.0/javax.el-3.0.0.jar:/home/alex/.m2/repository/com/oracle/database/jdbc/ojdbc8/21.3.0.0/ojdbc8-21.3.0.0.jar:/home/alex/.m2/repository/mysql/mysql-connector-java/8.0.27/mysql-connector-java-8.0.27.jar:/home/alex/.m2/repository/com/microsoft/sqlserver/mssql-jdbc/6.2.1.jre8/mssql-jdbc-6.2.1.jre8.jar:/home/alex/.m2/repository/junit/junit/4.13/junit-4.13.jar:/home/alex/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-server-integ/1.5.7/apacheds-server-integ-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-interceptor-kerberos/1.5.7/apacheds-interceptor-kerberos-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core/1.5.7/apacheds-core-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-api/1.5.7/apacheds-core-api-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-entry/1.5.7/apacheds-core-entry-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-constants/1.5.7/apacheds-core-constants-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-utils/1.5.7/apacheds-utils-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-kerberos-shared/1.5.7/apacheds-kerberos-shared-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-jndi/1.5.7/apacheds-core-jndi-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-protocol-shared/1.5.7/apacheds-protocol-shared-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-integ/1.5.7/apacheds-core-integ-1.5.7.jar:/home/alex/.m2/repository/ldapsdk/ldapsdk/4.1/ldapsdk-4.1.jar:/home/alex/.m2/repository/org/apache/directory/client/ldap/ldap-client-api/0.1/ldap-client-api-0.1.jar:/home/alex/.m2/repository/commons-pool/commons-pool/1.5.4/commons-pool-1.5.4.jar:/home/alex/.m2/repository/org/apache/mina/mina-core/2.0.0-RC1/mina-core-2.0.0-RC1.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap/0.9.19/shared-ldap-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-i18n/0.9.19/shared-i18n-0.9.19.jar:/home/alex/.m2/repository/antlr/antlr/2.7.7/antlr-2.7.7.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema/0.9.19/shared-ldap-schema-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema-loader/0.9.19/shared-ldap-schema-loader-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema-manager/0.9.19/shared-ldap-schema-manager-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-cursor/0.9.19/shared-cursor-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-jndi/0.9.19/shared-ldap-jndi-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-asn1-codec/0.9.19/shared-asn1-codec-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-asn1/0.9.19/shared-asn1-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-constants/0.9.19/shared-ldap-constants-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-converter/0.9.19/shared-ldap-converter-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema-dao/0.9.19/shared-ldap-schema-dao-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldif/0.9.19/shared-ldif-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-dsml-parser/0.9.19/shared-dsml-parser-0.9.19.jar:/home/alex/.m2/repository/dom4j/dom4j/1.6.1/dom4j-1.6.1.jar:/home/alex/.m2/repository/xml-apis/xml-apis/1.0.b2/xml-apis-1.0.b2.jar:/home/alex/.m2/repository/xpp3/xpp3/1.1.4c/xpp3-1.1.4c.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-test-framework/1.5.7/apacheds-test-framework-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-i18n/1.5.7/apacheds-i18n-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-server-annotations/1.5.7/apacheds-server-annotations-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-annotations/1.5.7/apacheds-core-annotations-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-jdbm-partition/1.5.7/apacheds-jdbm-partition-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-jdbm-store/1.5.7/apacheds-jdbm-store-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-jdbm/1.5.7/apacheds-jdbm-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-avl/1.5.7/apacheds-core-avl-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-xdbm-search/1.5.7/apacheds-xdbm-search-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-ldif-partition/1.5.7/apacheds-ldif-partition-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-avl-partition/1.5.7/apacheds-avl-partition-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-mock/1.5.7/apacheds-core-mock-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-protocol-ldap/1.5.7/apacheds-protocol-ldap-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-xdbm-tools/1.5.7/apacheds-xdbm-tools-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-xdbm-base/1.5.7/apacheds-xdbm-base-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-protocol-kerberos/1.5.7/apacheds-protocol-kerberos-1.5.7.jar:/home/alex/.m2/repository/org/mockito/mockito-core/3.3.3/mockito-core-3.3.3.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy/1.10.5/byte-buddy-1.10.5.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy-agent/1.10.5/byte-buddy-agent-1.10.5.jar:/home/alex/.m2/repository/org/objenesis/objenesis/2.6/objenesis-2.6.jar:/home/alex/.m2/repository/org/postgresql/postgresql/42.2.14/postgresql-42.2.14.jar:/home/alex/.m2/repository/org/apache/curator/curator-test/4.2.0/curator-test-4.2.0.jar:/home/alex/Repositories/hive/standalone-metastore/metastore-server/src/test/resources:"/>
    <property name="nondexExecid" value="dls2le2r09KbM+aHksQTeqQgNAVbKgsiPqOnCfO8ffU="/>
    <property name="sun.cpu.endian" value="little"/>
    <property name="user.home" value="/home/alex"/>
    <property name="user.language" value="en"/>
    <property name="java.specification.vendor" value="Oracle Corporation"/>
    <property name="metastore.schema.verification" value="false"/>
    <property name="java.home" value="/usr/lib/jvm/java-8-openjdk-amd64/jre"/>
    <property name="hive.metastore.warehouse.external.dir" value="file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external"/>
    <property name="file.separator" value="/"/>
    <property name="basedir" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server"/>
    <property name="metastore.warehouse.dir" value="file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse"/>
    <property name="nondexEnd" value="9223372036854775807"/>
    <property name="line.separator" value="&#10;"/>
    <property name="derby.stream.error.file" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/derby.log"/>
    <property name="java.vm.specification.vendor" value="Oracle Corporation"/>
    <property name="java.specification.name" value="Java Platform API Specification"/>
    <property name="java.awt.graphicsenv" value="sun.awt.X11GraphicsEnvironment"/>
    <property name="nondexFilter" value=".*"/>
    <property name="nondexSeed" value="974622"/>
    <property name="surefire.real.class.path" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/surefire/surefirebooter3086804005860458714.jar"/>
    <property name="log4j.debug" value="true"/>
    <property name="sun.boot.class.path" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/.nondex/nondex-instr.jar:/home/alex/.m2/repository/edu/illinois/nondex-common/2.1.7/nondex-common-2.1.7.jar:/home/alex/.m2/repository/edu/illinois/nondex-annotations/2.1.7/nondex-annotations-2.1.7.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/classes"/>
    <property name="sun.management.compiler" value="HotSpot 64-Bit Tiered Compilers"/>
    <property name="java.runtime.version" value="1.8.0_402-8u402-ga-2ubuntu1~22.04-b06"/>
    <property name="user.name" value="alex"/>
    <property name="javax.jdo.option.ConnectionURL" value="jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true"/>
    <property name="path.separator" value=":"/>
    <property name="os.version" value="6.5.0-28-generic"/>
    <property name="java.endorsed.dirs" value="/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/endorsed"/>
    <property name="java.runtime.name" value="OpenJDK Runtime Environment"/>
    <property name="file.encoding" value="UTF-8"/>
    <property name="java.vm.name" value="OpenJDK 64-Bit Server VM"/>
    <property name="localRepository" value="/home/alex/.m2/repository"/>
    <property name="build.dir" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target"/>
    <property name="nondexDir" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/.nondex"/>
    <property name="java.vendor.url.bug" value="http://bugreport.sun.com/bugreport/"/>
    <property name="nondexJarDir" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/.nondex"/>
    <property name="java.io.tmpdir" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp"/>
    <property name="com.zaxxer.hikari.pool_number" value="13"/>
    <property name="java.version" value="1.8.0_402"/>
    <property name="user.dir" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server"/>
    <property name="os.arch" value="amd64"/>
    <property name="nondexMode" value="FULL"/>
    <property name="java.vm.specification.name" value="Java Virtual Machine Specification"/>
    <property name="java.awt.printerjob" value="sun.print.PSPrinterJob"/>
    <property name="user.language.format" value="pt"/>
    <property name="sun.os.patch.level" value="unknown"/>
    <property name="derby.version" value="10.14.1.0"/>
    <property name="java.library.path" value="/usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib"/>
    <property name="java.vendor" value="Private Build"/>
    <property name="java.vm.info" value="mixed mode"/>
    <property name="java.vm.version" value="25.402-b06"/>
    <property name="java.specification.maintenance.version" value="5"/>
    <property name="sun.io.unicode.encoding" value="UnicodeLittle"/>
    <property name="java.ext.dirs" value="/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext:/usr/java/packages/lib/ext"/>
    <property name="datanucleus.schema.autoCreateAll" value="true"/>
    <property name="java.class.version" value="52.0"/>
  </properties>
  <testcase name="testNoPartitionDiscoveryForReplTable" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="25.912"/>
  <testcase name="testPartitionDiscoveryTablePattern" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="14.458">
    <failure message="expected:&lt;5&gt; but was:&lt;3&gt;" type="java.lang.AssertionError"><![CDATA[java.lang.AssertionError: expected:<5> but was:<3>
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.testPartitionDiscoveryTablePattern(TestPartitionManagement.java:432)
]]></failure>
    <system-out><![CDATA[[INFO ] 2024-04-23 23:22:19.079 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:22:19.079 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:22:19.080 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:22:19.080 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:22:19.093 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:22:19.093 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:22:19.093 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:22:19.093 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:22:19.096 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:22:19.158 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131;create=true
[INFO ] 2024-04-23 23:22:19.720 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:22:19.720 [MetaStoreThread-46131] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:22:19.721 [MetaStoreThread-46131] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] HMSHandler - 5: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131;create=true
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131;create=true
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:22:19.722 [MetaStoreThread-46131] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:22:19.723 [MetaStoreThread-46131] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:22:19.723 [MetaStoreThread-46131] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:22:19.723 [MetaStoreThread-46131] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131;create=true
[DEBUG] 2024-04-23 23:22:19.723 [MetaStoreThread-46131] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:22:19.723 [MetaStoreThread-46131] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:22:19.723 [MetaStoreThread-46131] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:22:19.723 [MetaStoreThread-46131] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:22:19.723 [MetaStoreThread-46131] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:22:19.723 [MetaStoreThread-46131] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:22:19.723 [MetaStoreThread-46131] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:22:19.723 [MetaStoreThread-46131] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:22:19.723 [MetaStoreThread-46131] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:22:19.723 [MetaStoreThread-46131] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:22:19.723 [MetaStoreThread-46131] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:22:19.725 [MetaStoreThread-46131] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 10
[DEBUG] 2024-04-23 23:22:19.725 [MetaStoreThread-46131] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 32
[DEBUG] 2024-04-23 23:22:19.728 [MetaStoreThread-46131] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 9, unloaded classes: 108
[DEBUG] 2024-04-23 23:22:19.728 [MetaStoreThread-46131] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:19.728 [MetaStoreThread-46131] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:19.728 [MetaStoreThread-46131] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:19.728 [MetaStoreThread-46131] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:19.728 [MetaStoreThread-46131] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:19.728 [MetaStoreThread-46131] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:19.728 [MetaStoreThread-46131] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:19.728 [MetaStoreThread-46131] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:19.728 [MetaStoreThread-46131] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:19.728 [MetaStoreThread-46131] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:19.729 [MetaStoreThread-46131] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:19.729 [MetaStoreThread-46131] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:19.729 [MetaStoreThread-46131] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:19.729 [MetaStoreThread-46131] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:19.729 [MetaStoreThread-46131] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:22:19.729 [MetaStoreThread-46131] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:22:19.729 [MetaStoreThread-46131] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:22:19.729 [MetaStoreThread-46131] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:22:19.730 [MetaStoreThread-46131] HikariConfig - HikariPool-4 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:22:19.730 [MetaStoreThread-46131] HikariConfig - HikariPool-4 - configuration:
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131;create=true"
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - poolName........................"HikariPool-4"
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:22:19.731 [MetaStoreThread-46131] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:22:19.732 [MetaStoreThread-46131] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:22:19.732 [MetaStoreThread-46131] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:22:19.732 [MetaStoreThread-46131] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:22:19.732 [MetaStoreThread-46131] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:22:19.732 [MetaStoreThread-46131] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:22:19.732 [MetaStoreThread-46131] HikariDataSource - HikariPool-4 - Starting...
[INFO ] 2024-04-23 23:22:19.733 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:22:19.733 [MetaStoreThread-46131] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[INFO ] 2024-04-23 23:22:19.734 [MetaStoreThread-46131] HikariDataSource - HikariPool-4 - Start completed.
[DEBUG] 2024-04-23 23:22:19.834 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:22:19.835 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:19.836 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@47357812 (XID = 1157), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:19.837 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@857389112 (XID = 1159), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:19.838 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1660772411 (XID = 1161), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:19.839 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@144968640 (XID = 1163), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:19.840 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1723039359 (XID = 1165), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:19.841 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1836160424 (XID = 1167), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:19.842 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1315713414 (XID = 1169), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:19.843 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1900716603 (XID = 1171), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:19.843 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:22:20.053 [MetaStoreThread-46131] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:22:20.053 [MetaStoreThread-46131] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7bb86443, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:22:20.053 [MetaStoreThread-46131] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:22:20.053 [MetaStoreThread-46131] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7bb86443, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@39a37076 created in the thread with id: 79
[DEBUG] 2024-04-23 23:22:20.053 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.053 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.053 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.159 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.245 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.269 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.316 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.337 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.344 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.467 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.500 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.509 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.518 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.521 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.523 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.523 [MetaStoreThread-46131] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:22:20.523 [MetaStoreThread-46131] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:22:20.524 [MetaStoreThread-46131] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7bb86443 from thread id: 79
[DEBUG] 2024-04-23 23:22:20.524 [MetaStoreThread-46131] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:22:20.524 [MetaStoreThread-46131] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.529 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.532 [MetaStoreThread-46131] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.533 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[INFO ] 2024-04-23 23:22:20.533 [MetaStoreThread-46131] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:22:20.533 [MetaStoreThread-46131] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.534 [MetaStoreThread-46131] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.534 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.534 [MetaStoreThread-46131] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.534 [MetaStoreThread-46131] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.538 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.538 [MetaStoreThread-46131] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.540 [MetaStoreThread-46131] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:20.541 [MetaStoreThread-46131] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.541 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.541 [MetaStoreThread-46131] ObjectStore - db details for db default retrieved using SQL in 2.771585ms
[DEBUG] 2024-04-23 23:22:20.541 [MetaStoreThread-46131] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:22:20.541 [MetaStoreThread-46131] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:22:20.541 [MetaStoreThread-46131] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.547 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.549 [MetaStoreThread-46131] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.550 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.553 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[INFO ] 2024-04-23 23:22:20.553 [MetaStoreThread-46131] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:22:20.553 [MetaStoreThread-46131] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.554 [MetaStoreThread-46131] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.558 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.561 [MetaStoreThread-46131] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:20.565 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.566 [MetaStoreThread-46131] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.567 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[INFO ] 2024-04-23 23:22:20.567 [MetaStoreThread-46131] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:22:20.567 [MetaStoreThread-46131] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.567 [MetaStoreThread-46131] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.568 [MetaStoreThread-46131] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:20.569 [MetaStoreThread-46131] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.569 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[INFO ] 2024-04-23 23:22:20.569 [MetaStoreThread-46131] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:22:20.569 [MetaStoreThread-46131] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.570 [MetaStoreThread-46131] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.570 [MetaStoreThread-46131] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:20.570 [MetaStoreThread-46131] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.576 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.580 [MetaStoreThread-46131] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:20.584 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.586 [MetaStoreThread-46131] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.586 [MetaStoreThread-46131] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[INFO ] 2024-04-23 23:22:20.587 [MetaStoreThread-46131] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:22:20.587 [MetaStoreThread-46131] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:22:20.587 [MetaStoreThread-46131] PerfLogger - </PERFLOG method=init start=1713910939721 end=1713910940587 duration=866 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=5 retryCount=0 error=false>
[INFO ] 2024-04-23 23:22:20.587 [MetaStoreThread-46131] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:22:20.587 [MetaStoreThread-46131] HiveMetaStore - Started the new metaserver on port [46131]...
[INFO ] 2024-04-23 23:22:20.587 [MetaStoreThread-46131] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:22:20.587 [MetaStoreThread-46131] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:22:20.587 [MetaStoreThread-46131] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:22:20.587 [MetaStoreThread-46131] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:22:20.587 [MetaStoreThread-46131] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:22:20.587 [MetaStoreThread-46131] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:22:20.587 [MetaStoreThread-46131] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:22:20.587 [MetaStoreThread-46131] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:22:20.587 [MetaStoreThread-46131] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:22:20.587 [MetaStoreThread-46131] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:22:20.587 [MetaStoreThread-46131] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:22:20.587 [MetaStoreThread-46131] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:22:20.587 [MetaStoreThread-46131] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:22:20.588 [MetaStoreThread-46131] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:22:20.588 [MetaStoreThread-46131] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:22:20.588 [MetaStoreThread-46131] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:22:20.723 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:22:20.723 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 6: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:22:20.723 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:22:20.727 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/46131) is created
[INFO ] 2024-04-23 23:22:20.727 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 46131 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/46131 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131;create=true
[INFO ] 2024-04-23 23:22:20.727 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:22:20.730 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:22:20.731 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:46131]
[INFO ] 2024-04-23 23:22:20.731 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:46131)
[INFO ] 2024-04-23 23:22:20.731 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:46131) current connections: 1
[DEBUG] 2024-04-23 23:22:20.731 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:20.731 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910940731 end=1713910940731 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:20.732 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:20.732 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:20.732 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 create_database: Database(name:db5, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:22:20.732 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db5, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:22:20.733 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:22:20.733 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:22:20.733 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:20.733 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:22:20.733 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:22:20.733 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:22:20.733 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131;create=true
[DEBUG] 2024-04-23 23:22:20.733 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:22:20.733 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:22:20.733 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:20.733 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:22:20.733 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:22:20.733 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:22:20.733 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:22:20.733 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:20.733 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:20.733 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:22:20.733 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131;create=true
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@449885c7, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:22:20.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:22:20.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@449885c7, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@24817562 created in the thread with id: 96
[DEBUG] 2024-04-23 23:22:20.735 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.735 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.735 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.739 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.740 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.740 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:22:20.740 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:22:20.740 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@449885c7 from thread id: 96
[DEBUG] 2024-04-23 23:22:20.740 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:20.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.741 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.008934ms
[DEBUG] 2024-04-23 23:22:20.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db5, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:22:20.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:22:20.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.743 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.743 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:22:20.743 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:22:20.743 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:22:20.743 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:22:20.743 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:22:20.743 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db
[INFO ] 2024-04-23 23:22:20.743 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db
[INFO ] 2024-04-23 23:22:20.747 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db
[DEBUG] 2024-04-23 23:22:20.747 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.747 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.748 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:20.748 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.749 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.749 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713910940732 end=1713910940749 duration=17 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:20.750 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:20.750 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:20.750 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 create_table_req: Table(tableName:tbl5, dbName:db5, owner:alex, createTime:1713910940, lastAccessTime:1713910940, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:s, type:string, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:do, type:double, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:22:20.750 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl5, dbName:db5, owner:alex, createTime:1713910940, lastAccessTime:1713910940, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:s, type:string, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:do, type:double, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:22:20.750 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.754 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:20.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:20.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.755 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 4.524805ms
[DEBUG] 2024-04-23 23:22:20.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:22:20.761 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:20.761 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.761 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.761 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.761 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.762 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:20.763 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:20.763 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:20.763 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.437842ms
[DEBUG] 2024-04-23 23:22:20.763 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.763 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:20.763 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:22:20.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:20.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:20.764 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:22:20.764 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:22:20.764 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:22:20.764 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:22:20.764 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/46131/db5.db/tbl5
[DEBUG] 2024-04-23 23:22:20.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:20.775 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:20.779 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.784 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.789 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.795 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:20.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.811 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.812 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713910940750 end=1713910940812 duration=62 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:20.812 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:20.812 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:20.812 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 add_partition : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:22:20.812 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:22:20.813 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.813 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.813 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:20.813 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:22:20.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:20.854 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:20.854 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:20.860 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:22:20.860 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:22:20.860 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:22:20.860 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:22:20.861 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/46131/db5.db/tbl5/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:22:20.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:20.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:22:20.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:20.870 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:20.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.883 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.885 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910940812 end=1713910940885 duration=73 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:20.885 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:20.885 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:20.885 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 add_partition : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:22:20.886 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:22:20.886 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.886 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.886 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:20.886 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:22:20.888 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:20.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:20.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.893 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:20.893 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:22:20.894 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:22:20.894 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:22:20.894 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:22:20.894 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/46131/db5.db/tbl5/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:22:20.899 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.899 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:20.899 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:22:20.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:20.903 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:20.903 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.905 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.907 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910940885 end=1713910940907 duration=22 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:20.908 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:20.908 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:20.908 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 add_partition : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:22:20.908 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:22:20.908 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.908 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.908 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:20.908 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:22:20.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:20.915 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:20.915 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.915 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:20.916 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:22:20.916 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:22:20.916 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:22:20.916 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:22:20.916 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/46131/db5.db/tbl5/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:22:20.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:20.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:22:20.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:20.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:20.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.929 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.931 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910940908 end=1713910940931 duration=23 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:20.932 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:20.932 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:20.932 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713910940932 end=1713910940932 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:20.932 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:20.932 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:20.932 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_table : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:22:20.932 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:22:20.932 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.933 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:20.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:20.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.933 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.435571ms
[DEBUG] 2024-04-23 23:22:20.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:22:20.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:20.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.941 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[INFO ] 2024-04-23 23:22:20.943 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:22:20.943 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713910940932 end=1713910940943 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:20.943 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=11, comments=HMS client
[DEBUG] 2024-04-23 23:22:20.943 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:20.943 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:20.943 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:22:20.943 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:22:20.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:22:20.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.948 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.622238ms + 0.019136ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:22:20.952 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.443247ms + 0.103606ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:22:20.954 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.966676ms + 0.387533ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:22:20.957 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.644007ms + 0.233379ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:20.958 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.679596ms + 0.136748ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:22:20.961 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.028398ms + 0.147361ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:20.963 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.334944ms + 0.158929ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:20.965 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.941107ms + 0.152912ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:20.968 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.157192ms + 0.384852ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:20.970 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.973033ms + 0.198354ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:22:20.970 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:20.970 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:20.970 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 27.003631ms
[DEBUG] 2024-04-23 23:22:20.970 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.971 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.971 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910940943 end=1713910940971 duration=28 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:20.982 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:20.982 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:20.982 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 alter_table: hive.db5.tbl5 newtbl=tbl5
[INFO ] 2024-04-23 23:22:20.982 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db5.tbl5 newtbl=tbl5	
[DEBUG] 2024-04-23 23:22:20.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.983 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:20.983 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:20.983 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.984 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.524254ms
[DEBUG] 2024-04-23 23:22:20.984 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:22:20.984 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:22:20.984 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:22:20.984 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:22:20.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.985 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:20.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:20.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.986 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.865172ms
[DEBUG] 2024-04-23 23:22:20.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:22:20.989 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:20.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:20.994 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:20.996 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:20.996 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.997 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:20.997 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:20.997 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:20.997 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.340508ms
[DEBUG] 2024-04-23 23:22:20.997 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:20.997 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:20.997 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:22:21.000 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:21.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:21.004 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db5
[WARN ] 2024-04-23 23:22:21.004 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:22:21.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:21.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:21.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:21.006 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:21.006 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:22:21.007 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:21.008 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:22:21.008 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:21.008 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:22:21.013 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:21.016 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:21.016 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:21.018 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.019 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713910940982 end=1713910941019 duration=37 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[INFO ] 2024-04-23 23:22:21.021 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:22:21.021 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:46131]
[INFO ] 2024-04-23 23:22:21.021 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:46131)
[INFO ] 2024-04-23 23:22:21.022 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:46131) current connections: 2
[DEBUG] 2024-04-23 23:22:21.022 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:21.022 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910941022 end=1713910941022 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=8 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:21.023 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:21.023 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:21.023 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 8: source:127.0.0.1 get_table_metas : tbl=hive.*.*tblfoo*
[INFO ] 2024-04-23 23:22:21.023 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*tblfoo*	
[INFO ] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 8: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131;create=true
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:22:21.025 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131;create=true
[DEBUG] 2024-04-23 23:22:21.026 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:22:21.026 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:22:21.026 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:22:21.026 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:22:21.026 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:22:21.026 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:22:21.026 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:22:21.026 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:22:21.026 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:22:21.026 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:22:21.026 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:22:21.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4c799e98, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:22:21.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:22:21.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4c799e98, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2cdbb78a created in the thread with id: 110
[DEBUG] 2024-04-23 23:22:21.026 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.026 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.026 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.029 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.029 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.029 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:22:21.029 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:22:21.029 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4c799e98 from thread id: 110
[DEBUG] 2024-04-23 23:22:21.029 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:21.030 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableName.matches(:param2) ) &&  (tableType == :param3 || tableType == :param4 ) params: hive, (?i).*tblfoo.*, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:22:21.036 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:21.036 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.036 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713910941023 end=1713910941036 duration=13 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=8 retryCount=0 error=false>
[INFO ] 2024-04-23 23:22:21.037 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: *tblfoo* found: 0
[INFO ] 2024-04-23 23:22:21.037 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 1
[DEBUG] 2024-04-23 23:22:21.037 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:21.037 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:21.037 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:21.037 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 8: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:22:21.037 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:21.037 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:22:21.037 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:22:21.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4c799e98, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2cdbb78a will be shutdown
[INFO ] 2024-04-23 23:22:21.037 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:22:21.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:22:21.037 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 8: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:22:21.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:21.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[INFO ] 2024-04-23 23:22:21.037 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:22:21.037 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713910941037 end=1713910941037 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=8 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:21.037 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:22:21.038 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 8: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:22:21.038 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:22:21.038 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.134095ms + 0.01288ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:22:21.040 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.70102ms + 0.168968ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:22:21.041 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.287229ms + 0.424607ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:22:21.041 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.303345ms + 0.286835ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:21.042 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.305645ms + 0.217362ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:22:21.043 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.26142ms + 0.187442ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:21.043 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.225479ms + 0.360188ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:21.044 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.260407ms + 0.12657ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:21.044 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.28968ms + 0.291664ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:21.045 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.247108ms + 0.133566ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:22:21.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:21.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:21.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 7.602739ms
[DEBUG] 2024-04-23 23:22:21.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:21.045 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.045 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910941037 end=1713910941045 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[INFO ] 2024-04-23 23:22:21.047 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:22:21.047 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:46131]
[INFO ] 2024-04-23 23:22:21.047 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:46131)
[INFO ] 2024-04-23 23:22:21.047 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:46131) current connections: 2
[DEBUG] 2024-04-23 23:22:21.048 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:21.048 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910941048 end=1713910941048 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=9 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:21.048 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:21.048 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:21.048 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: source:127.0.0.1 get_table_metas : tbl=hive.*.tbl5*
[INFO ] 2024-04-23 23:22:21.048 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.tbl5*	
[INFO ] 2024-04-23 23:22:21.049 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:22:21.049 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:22:21.049 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:21.049 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:22:21.049 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:22:21.049 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:22:21.049 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131;create=true
[DEBUG] 2024-04-23 23:22:21.049 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:22:21.049 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:22:21.049 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:21.049 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:22:21.049 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:22:21.049 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:22:21.049 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:22:21.049 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:21.049 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:21.049 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:22:21.049 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:22:21.049 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131;create=true
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@19d91f6d, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@19d91f6d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@280a20a1 created in the thread with id: 111
[DEBUG] 2024-04-23 23:22:21.050 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.051 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.051 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.053 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.053 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.053 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:22:21.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:22:21.053 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@19d91f6d from thread id: 111
[DEBUG] 2024-04-23 23:22:21.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:21.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableName.matches(:param2) ) &&  (tableType == :param3 || tableType == :param4 ) params: hive, (?i)tbl5.*, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:22:21.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:21.058 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.058 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713910941048 end=1713910941058 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=9 retryCount=0 error=false>
[INFO ] 2024-04-23 23:22:21.058 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: tbl5* found: 0
[INFO ] 2024-04-23 23:22:21.059 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 1
[DEBUG] 2024-04-23 23:22:21.059 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:21.059 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:21.059 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:21.059 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:22:21.059 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:21.059 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:22:21.059 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:22:21.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@19d91f6d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@280a20a1 will be shutdown
[INFO ] 2024-04-23 23:22:21.059 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:22:21.059 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:22:21.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[INFO ] 2024-04-23 23:22:21.059 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:22:21.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:21.059 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713910941059 end=1713910941059 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=9 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:21.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:21.059 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:22:21.059 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:22:21.060 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:22:21.060 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.028615ms + 0.013481ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:22:21.061 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.723905ms + 0.128563ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:22:21.062 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.247795ms + 0.394688ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:22:21.063 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.2338ms + 0.190414ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:21.063 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.213756ms + 0.121565ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:22:21.064 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.205325ms + 0.120828ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:21.064 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.202649ms + 0.120126ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:21.064 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.217014ms + 0.120161ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:21.065 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.2759ms + 0.298091ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:21.065 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.231695ms + 0.1215ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:22:21.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:21.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:21.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 6.371901ms
[DEBUG] 2024-04-23 23:22:21.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:21.066 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.066 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910941059 end=1713910941066 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:21.067 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:21.067 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:21.067 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:22:21.067 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:22:21.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:22:21.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:21.070 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:21.071 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.071 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713910941067 end=1713910941071 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:21.071 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:21.071 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:21.071 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:22:21.071 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:22:21.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:21.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:21.075 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.076 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713910941071 end=1713910941076 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:21.076 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:21.076 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:21.076 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_database: db5
[INFO ] 2024-04-23 23:22:21.077 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db5	
[DEBUG] 2024-04-23 23:22:21.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:21.078 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:21.078 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:21.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:21.079 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 2.156198ms
[DEBUG] 2024-04-23 23:22:21.079 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713910941076 end=1713910941079 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:21.079 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=3, comments=HMS client
[DEBUG] 2024-04-23 23:22:21.079 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:21.079 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:21.079 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_tables_by_type: db=@hive#db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:22:21.079 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:22:21.079 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:22:21.079 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:22:21.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:21.081 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:21.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:21.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:21.081 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.922989ms
[DEBUG] 2024-04-23 23:22:21.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:21.086 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:21.086 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:21.086 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.086 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 4.790695ms
[DEBUG] 2024-04-23 23:22:21.086 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713910941079 end=1713910941086 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:21.087 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:21.087 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:21.087 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:22:21.087 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:22:21.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:21.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:21.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:21.090 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.091 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 3.792656ms
[DEBUG] 2024-04-23 23:22:21.091 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713910941087 end=1713910941091 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:21.091 [main] HiveMetaStoreClient - Selecting dropDatabase method for db5 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:22:21.091 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:22:21.091 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:21.091 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:21.091 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:21.092 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:21.092 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:21.093 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:21.093 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.093 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.701583ms
[DEBUG] 2024-04-23 23:22:21.093 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_multi_table : db=db5 tbls=tbl5
[INFO ] 2024-04-23 23:22:21.093 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db5 tbls=tbl5	
[DEBUG] 2024-04-23 23:22:21.093 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:21.097 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:21.098 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:21.099 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:21.099 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:21.099 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.259729ms
[DEBUG] 2024-04-23 23:22:21.099 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:21.099 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.099 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713910941091 end=1713910941099 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:21.099 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:21.099 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:21.099 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:22:21.099 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:22:21.099 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:21.099 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:21.100 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:21.101 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:21.101 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:21.101 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.199718ms
[DEBUG] 2024-04-23 23:22:21.101 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:22:21.101 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:22:21.101 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:21.101 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:21.101 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:21.101 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.645699ms
[DEBUG] 2024-04-23 23:22:21.101 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:22:21.102 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:22:21.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:21.111 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.116 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:21.116 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:22:21.117 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:22:21.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:21.123 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:21.128 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:22:21.128 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:22:21.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:21.154 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:21.159 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:22:21.159 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:22:21.159 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:22:21.159 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:22:21.159 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:22:21.159 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:22:21.159 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:21.160 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:21.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:21.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:21.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.144336ms
[DEBUG] 2024-04-23 23:22:21.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:21.161 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:21.161 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:21.161 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.618571ms
[DEBUG] 2024-04-23 23:22:21.161 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:21.162 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:21.162 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:21.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:21.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:21.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.061238ms
[DEBUG] 2024-04-23 23:22:21.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:22:21.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:22:21.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:21.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:21.164 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:21.164 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:22:21.180 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.186 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:22:21.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:21.191 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:22:21.191 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.191 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:21.194 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:21.196 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:21.198 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:21.200 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:21.202 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:21.204 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:22:21.204 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.205 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:21.206 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:21.206 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:22:21.206 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:22:23.207 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:22:23.207 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:22:23.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:23.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:23.211 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:23.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:23.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:23.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 4.322841ms
[DEBUG] 2024-04-23 23:22:23.212 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:22:23.212 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:22:23.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:23.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:23.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:23.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.576097ms
[DEBUG] 2024-04-23 23:22:23.213 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:22:23.213 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:22:23.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:23.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:23.215 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:22:23.215 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:22:23.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:23.216 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:23.216 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:22:23.216 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:22:23.216 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:23.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:23.217 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:22:23.217 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:22:23.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:23.218 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:23.218 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:23.218 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:23.218 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.01159ms
[DEBUG] 2024-04-23 23:22:23.218 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:23.219 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:23.219 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:23.219 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.604432ms
[DEBUG] 2024-04-23 23:22:23.219 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:23.220 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:23.221 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:23.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:23.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:23.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.35258ms
[DEBUG] 2024-04-23 23:22:23.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:22:23.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:22:23.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:23.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:23.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:23.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:22:23.223 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:22:23.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:23.224 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:22:23.224 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:23.224 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:23.224 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:23.224 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:23.224 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:23.225 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:23.225 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:23.225 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:22:23.225 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:23.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:23.226 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:23.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:22:23.226 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:22:25.227 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:22:25.227 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:22:25.227 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:25.228 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:25.230 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:25.231 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:25.232 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:25.232 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 4.036922ms
[DEBUG] 2024-04-23 23:22:25.232 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:22:25.232 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:22:25.232 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:25.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:25.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:25.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.613258ms
[DEBUG] 2024-04-23 23:22:25.233 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:22:25.233 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:22:25.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:25.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:25.234 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:22:25.234 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:22:25.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:25.235 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:25.235 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:22:25.235 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:22:25.235 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:25.236 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:25.237 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:22:25.237 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:22:25.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:25.237 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:25.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:25.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:25.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.947342ms
[DEBUG] 2024-04-23 23:22:25.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:25.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:25.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:25.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.536501ms
[DEBUG] 2024-04-23 23:22:25.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:25.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:25.240 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:25.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:25.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:25.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.035162ms
[DEBUG] 2024-04-23 23:22:25.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:22:25.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:22:25.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:25.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:25.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:25.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:22:25.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:22:25.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:25.243 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:22:25.243 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:25.243 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:25.243 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:25.243 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:25.243 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:25.243 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:25.243 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:25.243 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:22:25.244 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:25.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:25.245 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:25.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:22:25.245 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:22:26.068 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:22:27.246 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:22:27.246 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:22:27.246 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:27.246 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:27.249 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:27.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:27.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:27.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 3.115694ms
[DEBUG] 2024-04-23 23:22:27.250 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:22:27.250 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:22:27.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:27.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:27.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:27.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.693711ms
[DEBUG] 2024-04-23 23:22:27.251 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:22:27.251 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:22:27.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:27.252 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:27.253 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:22:27.253 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:22:27.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:27.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:27.254 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:22:27.254 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:22:27.254 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:27.255 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:27.255 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:22:27.255 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:22:27.255 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:27.256 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:27.256 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:27.256 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:27.256 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.107549ms
[DEBUG] 2024-04-23 23:22:27.256 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:27.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:27.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:27.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.70629ms
[DEBUG] 2024-04-23 23:22:27.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:27.258 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:27.259 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:27.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:27.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:27.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.113286ms
[DEBUG] 2024-04-23 23:22:27.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:22:27.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:22:27.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:27.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:27.260 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:27.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:22:27.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:22:27.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:27.262 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:22:27.262 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:27.262 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:27.262 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:27.262 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:27.263 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:27.263 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:27.263 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:27.263 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:22:27.263 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:27.263 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:27.264 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:27.264 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:22:27.265 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:22:29.265 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:22:29.266 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:22:29.266 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:29.266 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:29.269 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:29.269 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:29.269 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:29.269 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 2.906303ms
[DEBUG] 2024-04-23 23:22:29.269 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:22:29.269 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:22:29.269 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:29.270 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:29.270 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:29.270 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.710398ms
[DEBUG] 2024-04-23 23:22:29.270 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:22:29.270 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:22:29.270 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:29.272 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:29.272 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:22:29.272 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:22:29.272 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:29.273 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:29.273 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:22:29.273 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:22:29.273 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:29.274 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:29.274 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:22:29.274 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:22:29.274 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:29.275 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:29.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:29.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:29.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.224997ms
[DEBUG] 2024-04-23 23:22:29.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:29.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:29.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:29.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.606577ms
[DEBUG] 2024-04-23 23:22:29.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:29.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:29.278 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:29.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:29.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:29.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.02851ms
[DEBUG] 2024-04-23 23:22:29.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:22:29.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:22:29.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:29.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:29.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:29.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:22:29.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:22:29.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:29.282 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:22:29.282 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:29.282 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:29.282 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:29.282 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:29.282 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:29.282 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:29.282 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:29.282 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:22:29.283 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:29.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:29.284 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:29.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:22:29.284 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:22:30.686 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:22:30.691 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:22:31.286 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:22:31.286 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:22:31.286 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:31.286 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:31.289 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:31.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:31.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:31.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 3.108326ms
[DEBUG] 2024-04-23 23:22:31.290 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:22:31.290 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:22:31.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:31.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:31.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:31.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.687699ms
[DEBUG] 2024-04-23 23:22:31.290 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:22:31.291 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:22:31.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:31.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:31.292 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:22:31.293 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:22:31.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:31.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:31.294 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:22:31.294 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:22:31.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:31.295 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:31.296 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:22:31.296 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:22:31.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:31.296 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:31.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:31.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:31.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.095047ms
[DEBUG] 2024-04-23 23:22:31.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:31.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:31.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:31.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.608449ms
[DEBUG] 2024-04-23 23:22:31.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:31.299 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:31.299 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:31.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:31.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:31.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.054129ms
[DEBUG] 2024-04-23 23:22:31.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:22:31.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:22:31.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:31.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:31.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:31.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:22:31.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:22:31.303 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:31.303 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:22:31.303 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:31.303 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:31.304 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:31.304 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:31.304 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:31.304 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:31.304 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:31.304 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:22:31.304 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:31.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:31.305 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:31.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:22:31.306 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:22:33.307 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:22:33.307 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:22:33.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:33.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:33.309 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:33.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:33.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:33.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 2.349823ms
[DEBUG] 2024-04-23 23:22:33.310 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:22:33.310 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:22:33.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:33.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:33.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:33.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.572513ms
[DEBUG] 2024-04-23 23:22:33.310 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:22:33.311 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:22:33.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:33.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:33.312 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:22:33.312 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:22:33.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:33.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:33.313 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:22:33.313 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:22:33.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:33.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:33.315 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:22:33.315 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:22:33.315 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:33.315 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:33.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:33.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:33.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.032736ms
[DEBUG] 2024-04-23 23:22:33.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:33.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:33.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:33.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.597783ms
[DEBUG] 2024-04-23 23:22:33.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:33.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:33.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:33.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:22:33.342 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:22:33.342 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:33.342 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:33.346 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.259689ms + 0.011353ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  and "PARTITIONS"."PART_NAME" in (?,?,?)]
[DEBUG] 2024-04-23 23:22:33.352 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.082037ms + 0.009812ms, the query is [delete from "PART_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:22:33.354 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.174145ms + 0.009686ms, the query is [delete from "PART_COL_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:22:33.356 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.212663ms + 0.00867ms, the query is [delete from "PART_COL_STATS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:22:33.359 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.103023ms + 0.009849ms, the query is [delete from "PARTITION_PARAMS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:22:33.361 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.141751ms + 0.009734ms, the query is [delete from "PARTITION_KEY_VALS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:22:33.363 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.247001ms + 0.00935ms, the query is [delete from "PARTITIONS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:22:33.369 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.560786ms + 0.012158ms, the query is [delete from "SD_PARAMS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:22:33.371 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.629224ms + 0.009511ms, the query is [delete from "SORT_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:22:33.374 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.743254ms + 0.009585ms, the query is [delete from "BUCKETING_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:22:33.377 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.59584ms + 0.009295ms, the query is [delete from "SKEWED_COL_NAMES" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:22:33.381 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.294667ms + 0.010746ms, the query is [delete from "SDS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:22:33.384 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.405033ms + 0.008555ms, the query is [delete from "SERDE_PARAMS" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:22:33.387 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.225096ms + 0.009852ms, the query is [delete from "SERDES" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:22:33.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:33.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:33.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 49.085381ms
[DEBUG] 2024-04-23 23:22:33.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:33.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:22:33.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:22:33.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:33.392 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_table : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:22:33.393 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_table : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:22:33.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:33.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:33.394 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:33.394 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:33.394 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:33.394 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.646602ms
[DEBUG] 2024-04-23 23:22:33.394 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:33.395 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:33.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:33.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:33.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.278441ms
[DEBUG] 2024-04-23 23:22:33.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:33.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:22:33.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:22:33.397 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:22:33.397 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:33.397 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:33.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:33.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:33.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:33.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:33.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:22:33.414 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:22:33.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:22:33.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:22:33.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:22:33.421 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:33.426 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:22:33.426 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:22:33.426 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:22:33.427 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:22:33.427 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:22:33.431 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1139774799 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:33.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:22:33.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:22:33.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:22:33.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:22:33.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:22:33.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:22:33.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:22:33.444 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:22:33.444 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:22:33.444 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:22:33.444 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:22:33.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:22:33.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:22:33.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:22:33.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 23:22:33.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:22:33.453 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 23:22:33.458 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:22:33.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:22:33.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:22:33.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:22:33.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:22:33.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:22:33.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:33.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:22:33.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:22:33.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:33.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:33.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:33.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:22:33.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:22:33.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:33.522 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:22:33.522 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:33.522 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:33.523 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:33.523 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:33.523 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:33.523 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:33.523 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:22:33.523 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:22:33.524 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:33.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:33.525 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@209316579 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:33.526 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:22:33.526 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db5
[DEBUG] 2024-04-23 23:22:33.527 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/46131/db5.db
[INFO ] 2024-04-23 23:22:33.527 [TThreadPoolServer WorkerProcess-%d] deprecation - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
[DEBUG] 2024-04-23 23:22:33.529 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:22:33.529 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db5
[DEBUG] 2024-04-23 23:22:33.529 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db
[DEBUG] 2024-04-23 23:22:33.530 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713910941099 end=1713910953530 duration=12431 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=6 error=false>
[INFO ] 2024-04-23 23:22:33.530 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 0
[DEBUG] 2024-04-23 23:22:33.530 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:33.530 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:33.530 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:22:33.530 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:22:33.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@449885c7, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@24817562 will be shutdown
[DEBUG] 2024-04-23 23:22:33.531 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:22:33.531 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:22:33.531 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713910953530 end=1713910953531 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:33.531 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:22:33.531 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:22:33.531 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
]]></system-out>
  </testcase>
  <testcase name="testNoPartitionRetentionForReplTarget" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="52.177">
    <error message="javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore&#10;NestedThrowables:&#10;java.sql.BatchUpdateException: DELETE on table &apos;DBS&apos; caused a violation of foreign key constraint &apos;TBLS_FK1&apos; for key (2).  The statement has been rolled back." type="org.apache.hadoop.hive.metastore.api.MetaException"><![CDATA[org.apache.hadoop.hive.metastore.api.MetaException: 
javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
NestedThrowables:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.tearDown(TestPartitionManagement.java:100)
]]></error>
    <system-out><![CDATA[[INFO ] 2024-04-23 23:22:33.537 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:22:33.537 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:22:33.538 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:22:33.538 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:22:33.546 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:22:33.546 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:22:33.546 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:22:33.546 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:22:33.548 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:22:33.589 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483;create=true
[INFO ] 2024-04-23 23:22:34.051 [MetaStoreThread-45483] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[INFO ] 2024-04-23 23:22:34.051 [main] MetaStoreTestUtils - Waiting the HMS to start.
[DEBUG] 2024-04-23 23:22:34.051 [MetaStoreThread-45483] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] HMSHandler - 10: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483;create=true
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483;create=true
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:22:34.052 [MetaStoreThread-45483] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46131;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483;create=true
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 31
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 121
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:34.053 [MetaStoreThread-45483] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:34.054 [MetaStoreThread-45483] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:22:34.054 [MetaStoreThread-45483] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:22:34.054 [MetaStoreThread-45483] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:22:34.054 [MetaStoreThread-45483] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:22:34.054 [MetaStoreThread-45483] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:22:34.055 [MetaStoreThread-45483] HikariConfig - HikariPool-5 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:22:34.055 [MetaStoreThread-45483] HikariConfig - HikariPool-5 - configuration:
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483;create=true"
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:22:34.056 [MetaStoreThread-45483] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:22:34.057 [MetaStoreThread-45483] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:22:34.057 [MetaStoreThread-45483] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:22:34.057 [MetaStoreThread-45483] HikariConfig - poolName........................"HikariPool-5"
[DEBUG] 2024-04-23 23:22:34.057 [MetaStoreThread-45483] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:22:34.057 [MetaStoreThread-45483] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:22:34.057 [MetaStoreThread-45483] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:22:34.057 [MetaStoreThread-45483] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:22:34.057 [MetaStoreThread-45483] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:22:34.057 [MetaStoreThread-45483] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:22:34.057 [MetaStoreThread-45483] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:22:34.057 [MetaStoreThread-45483] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:22:34.057 [MetaStoreThread-45483] HikariDataSource - HikariPool-5 - Starting...
[INFO ] 2024-04-23 23:22:34.058 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:22:34.059 [MetaStoreThread-45483] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[INFO ] 2024-04-23 23:22:34.059 [MetaStoreThread-45483] HikariDataSource - HikariPool-5 - Start completed.
[DEBUG] 2024-04-23 23:22:34.159 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:22:34.161 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1311037999 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.162 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@253349908 (XID = 1148), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.163 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1054620117 (XID = 1150), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.164 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1865822043 (XID = 1152), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.165 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1833150044 (XID = 1154), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.166 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1803039956 (XID = 1156), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.167 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1487828102 (XID = 1158), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.169 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@329201562 (XID = 1160), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.170 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1786242694 (XID = 1162), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.170 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:22:34.309 [MetaStoreThread-45483] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:22:34.309 [MetaStoreThread-45483] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3abd8e6c, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:22:34.309 [MetaStoreThread-45483] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:22:34.310 [MetaStoreThread-45483] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3abd8e6c, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@248c9fee created in the thread with id: 114
[DEBUG] 2024-04-23 23:22:34.310 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.310 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.310 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.410 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.486 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1311037999 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.500 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1311037999 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.535 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1311037999 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.550 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1311037999 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.556 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1311037999 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.668 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1311037999 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.696 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1311037999 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.704 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1311037999 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.710 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1311037999 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.713 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.715 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.715 [MetaStoreThread-45483] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:22:34.715 [MetaStoreThread-45483] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:22:34.715 [MetaStoreThread-45483] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3abd8e6c from thread id: 114
[DEBUG] 2024-04-23 23:22:34.715 [MetaStoreThread-45483] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:22:34.715 [MetaStoreThread-45483] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:34.719 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.739 [MetaStoreThread-45483] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:34.739 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[INFO ] 2024-04-23 23:22:34.739 [MetaStoreThread-45483] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:22:34.739 [MetaStoreThread-45483] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:34.740 [MetaStoreThread-45483] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:34.740 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.740 [MetaStoreThread-45483] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:34.741 [MetaStoreThread-45483] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:34.744 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.744 [MetaStoreThread-45483] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:34.746 [MetaStoreThread-45483] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:34.746 [MetaStoreThread-45483] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:34.746 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.746 [MetaStoreThread-45483] ObjectStore - db details for db default retrieved using SQL in 2.28374ms
[DEBUG] 2024-04-23 23:22:34.746 [MetaStoreThread-45483] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:22:34.746 [MetaStoreThread-45483] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:22:34.746 [MetaStoreThread-45483] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:34.753 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.756 [MetaStoreThread-45483] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:34.756 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.759 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[INFO ] 2024-04-23 23:22:34.760 [MetaStoreThread-45483] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:22:34.760 [MetaStoreThread-45483] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:34.760 [MetaStoreThread-45483] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:34.766 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.769 [MetaStoreThread-45483] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:34.772 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1311037999 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.773 [MetaStoreThread-45483] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:34.774 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[INFO ] 2024-04-23 23:22:34.774 [MetaStoreThread-45483] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:22:34.774 [MetaStoreThread-45483] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:34.774 [MetaStoreThread-45483] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:34.775 [MetaStoreThread-45483] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:34.776 [MetaStoreThread-45483] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:34.776 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[INFO ] 2024-04-23 23:22:34.776 [MetaStoreThread-45483] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:22:34.776 [MetaStoreThread-45483] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:34.776 [MetaStoreThread-45483] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:34.777 [MetaStoreThread-45483] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:34.777 [MetaStoreThread-45483] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:34.781 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1311037999 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.785 [MetaStoreThread-45483] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:34.787 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1311037999 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:34.789 [MetaStoreThread-45483] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:34.790 [MetaStoreThread-45483] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[INFO ] 2024-04-23 23:22:34.790 [MetaStoreThread-45483] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:22:34.791 [MetaStoreThread-45483] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:22:34.791 [MetaStoreThread-45483] PerfLogger - </PERFLOG method=init start=1713910954051 end=1713910954791 duration=740 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=10 retryCount=0 error=false>
[INFO ] 2024-04-23 23:22:34.791 [MetaStoreThread-45483] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:22:34.791 [MetaStoreThread-45483] HiveMetaStore - Started the new metaserver on port [45483]...
[INFO ] 2024-04-23 23:22:34.791 [MetaStoreThread-45483] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:22:34.791 [MetaStoreThread-45483] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:22:34.791 [MetaStoreThread-45483] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:22:34.791 [MetaStoreThread-45483] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:22:34.791 [MetaStoreThread-45483] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:22:34.791 [MetaStoreThread-45483] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:22:34.791 [MetaStoreThread-45483] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:22:34.791 [MetaStoreThread-45483] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:22:34.791 [MetaStoreThread-45483] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:22:34.791 [MetaStoreThread-45483] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:22:34.791 [MetaStoreThread-45483] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:22:34.791 [MetaStoreThread-45483] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:22:34.791 [MetaStoreThread-45483] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:22:34.791 [MetaStoreThread-45483] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:22:34.791 [MetaStoreThread-45483] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:22:34.791 [MetaStoreThread-45483] HiveMetaStore - Direct SQL optimization = true
[INFO ] 2024-04-23 23:22:35.052 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 45483 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45483 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483;create=true
[INFO ] 2024-04-23 23:22:35.052 [main] TestTxnDbUtil - Creating transactional tables
[DEBUG] 2024-04-23 23:22:35.052 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:22:35.052 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 11: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:22:35.052 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:22:35.056 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:22:35.056 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:45483]
[INFO ] 2024-04-23 23:22:35.056 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:45483)
[INFO ] 2024-04-23 23:22:35.056 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:45483) current connections: 1
[DEBUG] 2024-04-23 23:22:35.057 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:35.057 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910955057 end=1713910955057 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:35.057 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:35.057 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:35.057 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 create_database: Database(name:db_repl2, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:22:35.058 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db_repl2, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483;create=true
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:22:35.059 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:22:35.060 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:22:35.060 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:22:35.060 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:22:35.060 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:22:35.060 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:22:35.060 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:22:35.060 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483;create=true
[DEBUG] 2024-04-23 23:22:35.060 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:22:35.060 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:22:35.060 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:22:35.060 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:22:35.060 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:22:35.060 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:22:35.060 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:22:35.060 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:22:35.060 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:22:35.060 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:22:35.060 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:22:35.060 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@61dc4bee, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:22:35.060 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:22:35.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@61dc4bee, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2730c3a created in the thread with id: 129
[DEBUG] 2024-04-23 23:22:35.061 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.061 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.061 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.063 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.064 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.064 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:22:35.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:22:35.065 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@61dc4bee from thread id: 129
[DEBUG] 2024-04-23 23:22:35.065 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:35.065 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:35.065 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:35.065 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.031722ms
[DEBUG] 2024-04-23 23:22:35.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db_repl2, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:22:35.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:22:35.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:35.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:35.067 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.067 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:22:35.067 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:22:35.068 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:22:35.068 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:22:35.068 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[WARN ] 2024-04-23 23:22:35.068 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db for database db_repl2. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:22:35.068 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:35.068 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.069 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.069 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:35.070 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.070 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713910955057 end=1713910955070 duration=13 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:35.071 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:35.071 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:35.071 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 create_table_req: Table(tableName:tbl_repl2, dbName:db_repl2, owner:alex, createTime:1713910955, lastAccessTime:1713910955, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:b, type:binary, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:22:35.071 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl_repl2, dbName:db_repl2, owner:alex, createTime:1713910955, lastAccessTime:1713910955, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:b, type:binary, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:22:35.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:35.074 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:35.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:35.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:35.075 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 3.838379ms
[DEBUG] 2024-04-23 23:22:35.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:35.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:22:35.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:35.081 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:35.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.082 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:35.083 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:35.083 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.083 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.749921ms
[DEBUG] 2024-04-23 23:22:35.083 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.083 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:35.083 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:22:35.084 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:35.084 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.084 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:22:35.084 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:22:35.084 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:22:35.084 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:22:35.085 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45483/db_repl2.db/tbl_repl2
[DEBUG] 2024-04-23 23:22:35.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:35.094 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:35.098 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1311037999 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.103 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1311037999 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.108 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1311037999 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.113 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1311037999 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.127 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.127 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:35.129 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.130 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713910955071 end=1713910955130 duration=59 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:35.130 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:35.130 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:35.130 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 add_partition : tbl=hive.db_repl2.tbl_repl2
[INFO ] 2024-04-23 23:22:35.131 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db_repl2.tbl_repl2	
[DEBUG] 2024-04-23 23:22:35.131 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:35.131 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.131 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:35.131 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:22:35.140 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:35.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.177 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:22:35.177 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:22:35.177 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:22:35.177 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:22:35.177 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45483/db_repl2.db/tbl_repl2/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:22:35.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:35.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:22:35.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:35.186 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1311037999 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:35.198 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.199 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910955130 end=1713910955199 duration=69 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:35.200 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:35.200 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:35.200 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 add_partition : tbl=hive.db_repl2.tbl_repl2
[INFO ] 2024-04-23 23:22:35.200 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db_repl2.tbl_repl2	
[DEBUG] 2024-04-23 23:22:35.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:35.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:35.201 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:22:35.203 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:35.207 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.207 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.207 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.208 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:22:35.208 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:22:35.208 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:22:35.208 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:22:35.208 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45483/db_repl2.db/tbl_repl2/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:22:35.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:35.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:22:35.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:35.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:35.220 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.221 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910955200 end=1713910955221 duration=21 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:35.222 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:35.222 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:35.222 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 add_partition : tbl=hive.db_repl2.tbl_repl2
[INFO ] 2024-04-23 23:22:35.222 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db_repl2.tbl_repl2	
[DEBUG] 2024-04-23 23:22:35.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:35.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:35.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:22:35.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:35.228 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.228 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.229 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:22:35.229 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:22:35.229 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:22:35.229 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:22:35.229 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45483/db_repl2.db/tbl_repl2/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:22:35.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:35.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:22:35.235 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:35.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:35.241 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.243 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713910955222 end=1713910955242 duration=20 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:35.243 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:35.243 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:35.243 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713910955243 end=1713910955243 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:35.243 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:35.243 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:35.243 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_table : tbl=hive.db_repl2.tbl_repl2
[INFO ] 2024-04-23 23:22:35.244 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db_repl2.tbl_repl2	
[DEBUG] 2024-04-23 23:22:35.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:35.245 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:35.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:35.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:35.245 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.53857ms
[DEBUG] 2024-04-23 23:22:35.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:35.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:22:35.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.252 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:35.253 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[INFO ] 2024-04-23 23:22:35.254 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:22:35.254 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713910955243 end=1713910955254 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:35.255 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=12, comments=HMS client
[DEBUG] 2024-04-23 23:22:35.255 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:35.255 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:35.255 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_partitions : tbl=hive.db_repl2.tbl_repl2
[INFO ] 2024-04-23 23:22:35.255 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db_repl2.tbl_repl2	
[DEBUG] 2024-04-23 23:22:35.255 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:22:35.255 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:35.255 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.259 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.92272ms + 0.009608ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:22:35.263 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.417141ms + 0.126848ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:22:35.265 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.824309ms + 0.384572ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:22:35.267 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.646468ms + 0.195799ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:35.269 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.752967ms + 0.133227ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:22:35.271 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.645778ms + 0.133306ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:35.273 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.66599ms + 0.134919ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:35.275 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.736731ms + 0.137345ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:35.277 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.710454ms + 0.306852ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:35.279 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.85708ms + 0.140725ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:22:35.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:35.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 24.081292ms
[DEBUG] 2024-04-23 23:22:35.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:35.279 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.279 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910955255 end=1713910955279 duration=24 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:35.280 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:35.280 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:35.280 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 alter_table: hive.db_repl2.tbl_repl2 newtbl=tbl_repl2
[INFO ] 2024-04-23 23:22:35.280 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db_repl2.tbl_repl2 newtbl=tbl_repl2	
[DEBUG] 2024-04-23 23:22:35.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:35.282 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:35.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:35.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:35.282 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.568565ms
[DEBUG] 2024-04-23 23:22:35.282 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:22:35.282 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:22:35.282 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:22:35.282 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:22:35.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:35.284 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:35.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:35.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:35.284 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.358894ms
[DEBUG] 2024-04-23 23:22:35.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:35.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:22:35.286 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:35.292 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:35.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.294 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:35.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:35.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.261893ms
[DEBUG] 2024-04-23 23:22:35.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:35.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:22:35.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:35.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.300 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db_repl2
[WARN ] 2024-04-23 23:22:35.301 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:22:35.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:35.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:35.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:35.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:22:35.303 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:35.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:22:35.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:22:35.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:22:35.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:22:35.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:35.314 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.315 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713910955280 end=1713910955315 duration=35 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:35.315 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:35.315 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:35.315 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_database: db_repl2
[INFO ] 2024-04-23 23:22:35.316 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db_repl2	
[DEBUG] 2024-04-23 23:22:35.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:35.317 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:35.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:35.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:35.317 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.787929ms
[DEBUG] 2024-04-23 23:22:35.317 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713910955315 end=1713910955317 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:35.318 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=3, comments=HMS client
[DEBUG] 2024-04-23 23:22:35.318 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:35.318 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:35.318 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 alter_database @hive#db_repl2
[INFO ] 2024-04-23 23:22:35.318 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_database @hive#db_repl2	
[DEBUG] 2024-04-23 23:22:35.318 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:22:35.318 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:22:35.318 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:22:35.318 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:22:35.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:35.319 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:22:35.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:35.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:35.320 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.514149ms
[DEBUG] 2024-04-23 23:22:35.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:35.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:35.325 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.325 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_database start=1713910955318 end=1713910955325 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[INFO ] 2024-04-23 23:22:35.326 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:22:35.326 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:45483]
[INFO ] 2024-04-23 23:22:35.327 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:45483)
[INFO ] 2024-04-23 23:22:35.327 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:45483) current connections: 2
[DEBUG] 2024-04-23 23:22:35.327 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:35.327 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910955327 end=1713910955327 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=13 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:35.328 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:35.328 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:35.328 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 13: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:22:35.328 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:22:35.329 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 13: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:22:35.329 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:22:35.329 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:35.329 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:22:35.329 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:22:35.329 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:22:35.329 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483;create=true
[DEBUG] 2024-04-23 23:22:35.329 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:22:35.329 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:22:35.329 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:35.329 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:22:35.329 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483;create=true
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@68ef5dd5, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@68ef5dd5, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1ad345e0 created in the thread with id: 138
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.330 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.331 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.333 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.334 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.334 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:22:35.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:22:35.334 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@68ef5dd5 from thread id: 138
[DEBUG] 2024-04-23 23:22:35.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:35.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:22:35.341 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:35.341 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.341 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713910955328 end=1713910955341 duration=13 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=13 retryCount=0 error=false>
[INFO ] 2024-04-23 23:22:35.342 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:22:35.342 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 1
[DEBUG] 2024-04-23 23:22:35.342 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:35.342 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:22:35.342 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:22:35.342 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 13: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:22:35.342 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:22:35.342 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:22:35.342 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_partitions : tbl=hive.db_repl2.tbl_repl2
[INFO ] 2024-04-23 23:22:35.342 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@68ef5dd5, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1ad345e0 will be shutdown
[INFO ] 2024-04-23 23:22:35.342 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db_repl2.tbl_repl2	
[DEBUG] 2024-04-23 23:22:35.342 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 13: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:22:35.342 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[INFO ] 2024-04-23 23:22:35.342 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:22:35.342 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713910955342 end=1713910955342 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=13 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:35.342 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:22:35.342 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:22:35.342 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:22:35.343 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 13: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:22:35.343 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:22:35.343 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.112358ms + 0.008892ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:22:35.345 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.736679ms + 0.110938ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:22:35.345 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.234154ms + 0.284086ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:22:35.346 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.221748ms + 0.176586ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:35.346 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.24509ms + 0.115931ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:22:35.347 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.24602ms + 0.185286ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:35.347 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.212594ms + 0.111985ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:35.348 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.247136ms + 0.167042ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:35.348 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.314377ms + 0.266828ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:22:35.349 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.241821ms + 0.114422ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:22:35.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:22:35.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:22:35.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 6.358129ms
[DEBUG] 2024-04-23 23:22:35.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:22:35.349 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:22:35.349 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910955342 end=1713910955349 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:22:49.834 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:22:56.069 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:23:00.687 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:23:00.691 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:23:04.160 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:23:05.353 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:23:05.353 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:45483]
[INFO ] 2024-04-23 23:23:05.354 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:45483)
[INFO ] 2024-04-23 23:23:05.354 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:45483) current connections: 2
[DEBUG] 2024-04-23 23:23:05.355 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:05.355 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713910985355 end=1713910985355 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:05.356 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:05.356 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:05.356 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:23:05.356 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:23:05.357 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:23:05.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:23:05.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:05.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:23:05.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:23:05.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:23:05.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483;create=true
[DEBUG] 2024-04-23 23:23:05.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:23:05.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:23:05.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:05.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:23:05.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:23:05.357 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483;create=true
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2d130890, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:23:05.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2d130890, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@785e27cc created in the thread with id: 139
[DEBUG] 2024-04-23 23:23:05.359 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:05.359 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:05.359 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:05.360 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:05.360 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:05.361 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:23:05.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:23:05.361 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2d130890 from thread id: 139
[DEBUG] 2024-04-23 23:23:05.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:05.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:23:05.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:05.362 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:05.362 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713910985356 end=1713910985362 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[INFO ] 2024-04-23 23:23:05.362 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:23:05.362 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 1
[DEBUG] 2024-04-23 23:23:05.362 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:05.362 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:05.362 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:05.362 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:23:05.362 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:05.363 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_partitions : tbl=hive.db_repl2.tbl_repl2
[INFO ] 2024-04-23 23:23:05.363 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:23:05.363 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2d130890, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@785e27cc will be shutdown
[INFO ] 2024-04-23 23:23:05.363 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db_repl2.tbl_repl2	
[DEBUG] 2024-04-23 23:23:05.363 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:23:05.363 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:23:05.363 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:05.363 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[INFO ] 2024-04-23 23:23:05.363 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:23:05.363 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713910985362 end=1713910985363 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:05.363 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:23:05.363 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:23:05.363 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:23:05.364 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.908652ms + 0.006577ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:23:05.365 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.536516ms + 0.123122ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:23:05.366 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.33969ms + 0.349025ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:23:05.366 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.296082ms + 0.263342ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:05.367 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.243975ms + 0.113693ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:23:05.367 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.216949ms + 0.111529ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:05.367 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.200723ms + 0.109857ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:05.368 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.216097ms + 0.128871ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:05.368 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.238519ms + 0.305093ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:05.369 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.182592ms + 0.123449ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:23:05.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:05.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:05.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 6.151897ms
[DEBUG] 2024-04-23 23:23:05.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:05.369 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:05.369 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713910985362 end=1713910985369 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:05.370 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:05.370 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:05.370 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:23:05.370 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:23:05.370 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:23:05.370 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:05.372 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:05.372 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:05.372 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713910985370 end=1713910985372 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:05.373 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:05.373 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:05.373 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:23:05.373 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:23:05.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:05.376 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:05.376 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:05.376 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713910985373 end=1713910985376 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:05.376 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:05.376 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:05.376 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_database: db_repl2
[INFO ] 2024-04-23 23:23:05.377 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db_repl2	
[DEBUG] 2024-04-23 23:23:05.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:05.377 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:05.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:05.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:05.378 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:05.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.354357ms
[DEBUG] 2024-04-23 23:23:05.378 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713910985376 end=1713910985378 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:05.378 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:23:05.378 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:05.378 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:05.378 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_tables_by_type: db=@hive#db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:05.379 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:05.379 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:05.379 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:05.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:05.380 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:05.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:05.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:05.380 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:05.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.274692ms
[DEBUG] 2024-04-23 23:23:05.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:05.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:05.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:05.383 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:05.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 3.463389ms
[DEBUG] 2024-04-23 23:23:05.384 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713910985378 end=1713910985384 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:05.384 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:05.384 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:05.384 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:23:05.384 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:23:05.384 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:05.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:05.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:05.387 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:05.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 3.029089ms
[DEBUG] 2024-04-23 23:23:05.387 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713910985384 end=1713910985387 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:05.387 [main] HiveMetaStoreClient - Selecting dropDatabase method for db_repl2 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:23:05.387 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:23:05.387 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:05.387 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:05.388 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:05.388 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:05.389 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:05.389 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:05.389 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:05.389 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.276806ms
[DEBUG] 2024-04-23 23:23:05.389 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_multi_table : db=db_repl2 tbls=tbl_repl2
[INFO ] 2024-04-23 23:23:05.389 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db_repl2 tbls=tbl_repl2	
[DEBUG] 2024-04-23 23:23:05.389 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:05.394 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:05.395 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:05.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:05.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:05.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.547299ms
[DEBUG] 2024-04-23 23:23:05.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:05.396 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:05.396 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713910985387 end=1713910985396 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:05.396 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:05.396 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:05.396 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:23:05.397 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:23:05.397 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:05.397 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:05.398 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:05.398 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:05.398 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:05.398 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.763079ms
[DEBUG] 2024-04-23 23:23:05.399 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:23:05.399 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:23:05.399 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:05.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:05.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:05.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.046812ms
[DEBUG] 2024-04-23 23:23:05.400 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:23:05.400 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:23:05.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:05.412 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1311037999 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:05.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:05.418 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:05.419 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:05.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:05.425 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1311037999 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:05.430 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:05.430 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:05.430 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:05.430 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:05.457 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1311037999 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:05.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:05.461 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:23:05.461 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:23:05.461 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:23:05.461 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:23:05.461 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:05.461 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:05.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:05.462 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:05.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:05.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:05.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.640298ms
[DEBUG] 2024-04-23 23:23:05.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:05.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:05.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:05.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.656891ms
[DEBUG] 2024-04-23 23:23:05.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:05.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:05.465 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:05.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:05.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:05.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.128616ms
[DEBUG] 2024-04-23 23:23:05.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:05.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:23:05.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:05.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:05.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:05.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:05.484 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1311037999 (XID = 1146), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:05.488 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:05.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:05.493 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:05.493 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:05.493 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:05.495 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:05.496 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:05.498 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:05.499 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:05.501 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:05.503 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:05.503 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:05.503 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:05.504 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:05.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:05.505 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:07.506 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:23:07.507 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:23:07.507 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:07.507 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:07.510 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:07.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:07.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:07.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 4.435317ms
[DEBUG] 2024-04-23 23:23:07.512 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:23:07.512 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:23:07.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:07.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:07.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:07.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.535953ms
[DEBUG] 2024-04-23 23:23:07.512 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:23:07.513 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:23:07.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:07.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:07.514 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:07.515 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:07.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:07.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:07.516 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:07.516 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:07.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:07.517 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:07.517 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:07.517 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:07.517 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:07.518 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:07.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:07.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:07.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.969293ms
[DEBUG] 2024-04-23 23:23:07.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:07.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:07.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:07.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.542493ms
[DEBUG] 2024-04-23 23:23:07.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:07.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:07.520 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:07.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:07.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:07.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.888079ms
[DEBUG] 2024-04-23 23:23:07.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:07.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:23:07.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:07.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:07.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:07.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:07.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:07.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:07.523 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:07.523 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:07.523 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:07.523 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:07.523 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:07.523 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:07.523 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:07.523 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:07.523 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:07.524 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:07.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:07.525 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:07.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:07.525 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:09.526 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:23:09.526 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:23:09.526 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:09.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:09.529 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:09.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:09.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:09.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 3.724815ms
[DEBUG] 2024-04-23 23:23:09.530 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:23:09.531 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:23:09.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:09.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:09.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:09.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.629769ms
[DEBUG] 2024-04-23 23:23:09.531 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:23:09.531 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:23:09.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:09.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:09.533 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:09.533 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:09.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:09.534 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:09.534 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:09.534 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:09.534 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:09.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:09.535 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:09.535 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:09.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:09.536 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:09.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:09.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:09.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.922679ms
[DEBUG] 2024-04-23 23:23:09.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:09.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:09.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:09.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.542759ms
[DEBUG] 2024-04-23 23:23:09.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:09.538 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:09.538 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:09.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:09.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:09.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.053553ms
[DEBUG] 2024-04-23 23:23:09.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:09.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:23:09.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:09.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:09.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:09.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:09.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:09.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:09.541 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:09.541 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:09.542 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:09.542 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:09.542 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:09.542 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:09.542 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:09.542 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:09.542 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:09.542 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:09.542 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:09.544 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:09.544 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:09.544 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:11.545 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:23:11.545 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:23:11.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:11.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:11.548 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:11.549 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:11.549 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:11.549 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 3.837113ms
[DEBUG] 2024-04-23 23:23:11.549 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:23:11.549 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:23:11.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:11.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:11.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:11.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.695035ms
[DEBUG] 2024-04-23 23:23:11.550 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:23:11.550 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:23:11.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:11.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:11.552 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:11.552 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:11.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:11.553 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:11.553 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:11.553 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:11.553 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:11.554 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:11.554 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:11.554 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:11.554 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:11.555 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:11.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:11.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:11.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.989196ms
[DEBUG] 2024-04-23 23:23:11.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:11.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:11.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:11.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.570002ms
[DEBUG] 2024-04-23 23:23:11.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:11.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:11.557 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:11.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:11.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:11.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.923959ms
[DEBUG] 2024-04-23 23:23:11.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:11.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:23:11.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:11.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:11.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:11.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:11.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:11.560 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:11.560 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:11.560 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:11.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:11.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:11.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:11.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:11.561 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:11.561 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:11.561 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:11.561 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:11.561 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:11.562 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:11.562 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:11.562 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:13.563 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:23:13.564 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:23:13.564 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:13.564 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:13.567 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:13.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:13.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:13.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 3.700946ms
[DEBUG] 2024-04-23 23:23:13.568 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:23:13.568 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:23:13.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:13.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:13.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:13.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.625366ms
[DEBUG] 2024-04-23 23:23:13.568 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:23:13.568 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:23:13.569 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:13.570 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:13.570 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:13.570 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:13.570 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:13.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:13.571 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:13.571 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:13.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:13.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:13.572 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:13.572 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:13.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:13.573 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:13.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:13.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:13.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.012951ms
[DEBUG] 2024-04-23 23:23:13.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:13.574 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:13.574 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:13.574 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.663407ms
[DEBUG] 2024-04-23 23:23:13.574 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:13.575 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:13.576 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:13.576 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:13.576 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:13.576 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.125652ms
[DEBUG] 2024-04-23 23:23:13.576 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:13.576 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:23:13.576 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:13.576 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:13.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:13.578 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:13.578 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:13.579 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:13.579 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:13.579 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:13.579 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:13.579 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:13.580 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:13.580 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:13.580 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:13.580 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:13.580 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:13.580 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:13.580 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:13.582 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:13.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:13.583 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:15.583 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:23:15.584 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:23:15.584 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:15.584 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:15.586 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:15.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:15.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:15.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 2.744008ms
[DEBUG] 2024-04-23 23:23:15.587 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:23:15.587 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:23:15.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:15.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:15.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:15.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.46126ms
[DEBUG] 2024-04-23 23:23:15.588 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:23:15.589 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:23:15.589 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:15.592 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:15.592 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:15.592 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:15.592 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:15.594 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:15.595 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:15.595 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:15.595 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:15.596 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:15.597 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:15.597 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:15.597 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:15.599 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:15.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:15.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:15.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 2.438324ms
[DEBUG] 2024-04-23 23:23:15.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:15.601 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:15.601 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:15.601 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 1.265673ms
[DEBUG] 2024-04-23 23:23:15.601 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:15.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:15.604 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:15.605 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:15.605 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:15.605 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 2.18485ms
[DEBUG] 2024-04-23 23:23:15.605 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:15.605 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:23:15.605 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:15.605 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:15.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:15.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:15.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:15.610 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:15.610 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:15.610 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:15.610 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:15.610 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:15.610 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:15.610 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:15.611 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:15.611 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:15.611 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:15.611 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:15.611 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:15.613 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:15.613 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:15.613 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:17.613 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:23:17.614 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:23:17.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:17.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:17.617 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:17.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:17.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:17.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 3.276916ms
[DEBUG] 2024-04-23 23:23:17.617 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:23:17.618 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:23:17.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:17.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:17.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:17.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.51478ms
[DEBUG] 2024-04-23 23:23:17.618 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:23:17.618 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:23:17.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:17.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:17.620 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:17.620 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:17.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:17.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:17.621 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:17.621 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:17.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:17.622 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:17.622 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:17.622 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:17.622 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:17.623 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:17.623 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:17.623 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:17.623 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.150219ms
[DEBUG] 2024-04-23 23:23:17.623 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:17.624 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:17.624 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:17.624 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.609697ms
[DEBUG] 2024-04-23 23:23:17.624 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:17.625 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:17.625 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:17.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:17.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:17.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.968673ms
[DEBUG] 2024-04-23 23:23:17.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:17.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:23:17.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:17.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:17.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:17.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:17.628 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:17.628 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:17.628 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:17.628 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:17.628 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:17.629 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:17.629 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:17.629 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:17.629 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:17.629 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:17.629 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:17.629 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:17.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:17.631 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:17.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:17.631 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:19.632 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:23:19.632 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:23:19.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:19.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:19.636 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:19.637 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:19.637 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:19.637 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 3.86047ms
[DEBUG] 2024-04-23 23:23:19.637 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:23:19.637 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:23:19.637 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:19.637 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:19.637 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:19.637 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.671553ms
[DEBUG] 2024-04-23 23:23:19.638 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:23:19.638 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:23:19.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:19.639 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:19.640 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:19.640 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:19.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:19.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:19.641 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:19.641 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:19.641 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:19.641 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:19.642 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:19.642 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:19.642 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:19.643 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:19.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:19.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:19.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.067782ms
[DEBUG] 2024-04-23 23:23:19.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:19.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:19.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:19.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.515708ms
[DEBUG] 2024-04-23 23:23:19.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:19.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:19.645 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:19.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:19.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:19.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.865717ms
[DEBUG] 2024-04-23 23:23:19.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:19.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:23:19.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:19.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:19.646 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:19.646 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:19.647 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:19.647 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:19.648 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:19.648 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:19.648 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:19.648 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:19.648 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:19.648 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:19.648 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:19.648 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:19.648 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:19.648 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:19.648 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:19.649 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:19.650 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:19.650 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:19.835 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:23:21.651 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:23:21.651 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:23:21.651 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:21.651 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:21.654 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:21.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:21.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:21.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 3.462611ms
[DEBUG] 2024-04-23 23:23:21.655 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:23:21.655 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:23:21.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:21.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:21.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:21.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.510992ms
[DEBUG] 2024-04-23 23:23:21.655 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:23:21.655 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:23:21.656 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:21.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:21.657 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:21.657 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:21.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:21.658 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:21.658 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:21.658 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:21.658 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:21.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:21.659 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:21.659 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:21.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:21.660 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:21.660 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:21.660 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:21.660 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.921967ms
[DEBUG] 2024-04-23 23:23:21.660 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:21.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:21.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:21.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.510564ms
[DEBUG] 2024-04-23 23:23:21.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:21.662 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:21.662 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:21.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:21.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:21.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.048444ms
[DEBUG] 2024-04-23 23:23:21.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:21.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:23:21.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:21.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:21.664 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:21.664 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:21.665 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:21.665 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:21.665 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:21.665 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:21.665 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:21.665 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:21.666 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:21.666 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:21.666 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:21.666 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:21.666 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:21.666 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:21.666 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:21.667 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:21.667 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:21.668 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:23.668 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:23:23.669 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:23:23.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:23.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:23.672 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:23.673 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:23.673 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:23.673 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 3.769157ms
[DEBUG] 2024-04-23 23:23:23.673 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:23:23.673 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:23:23.673 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:23.675 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:23.675 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:23.675 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.014823ms
[DEBUG] 2024-04-23 23:23:23.675 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:23:23.676 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:23:23.676 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:23.681 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:23.682 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:23.682 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:23.682 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:23.684 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:23.685 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:23.685 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:23.685 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:23.686 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:23.686 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:23.686 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:23.686 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:23.687 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:23.687 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:23.687 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:23.687 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.09947ms
[DEBUG] 2024-04-23 23:23:23.687 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:23.688 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:23.688 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:23.688 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.522648ms
[DEBUG] 2024-04-23 23:23:23.688 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:23.688 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:23.689 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:23.689 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:23.689 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:23.689 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.927319ms
[DEBUG] 2024-04-23 23:23:23.689 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:23.689 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:23:23.689 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:23.689 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:23.690 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:23.690 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:23.691 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:23.691 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:23.692 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:23.692 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:23.692 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:23.692 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:23.692 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:23.692 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:23.692 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:23.692 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:23.692 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:23.692 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:23.692 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:23.694 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:23.694 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:23.694 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:25.695 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:23:25.695 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:23:25.695 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:25.695 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:25.698 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:25.699 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:25.699 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:25.699 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 3.756689ms
[DEBUG] 2024-04-23 23:23:25.699 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:23:25.699 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:23:25.699 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:25.700 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:25.700 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:25.700 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.92691ms
[DEBUG] 2024-04-23 23:23:25.700 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:23:25.701 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:23:25.701 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:25.702 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:25.703 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:25.703 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:25.703 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:25.703 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:25.704 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:25.704 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:25.704 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:25.704 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:25.705 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:25.705 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:25.705 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:25.706 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:25.706 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:25.706 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:25.706 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.049829ms
[DEBUG] 2024-04-23 23:23:25.706 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:25.707 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:25.707 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:25.707 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.581745ms
[DEBUG] 2024-04-23 23:23:25.707 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:25.707 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:25.708 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:25.708 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:25.708 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:25.708 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.935976ms
[DEBUG] 2024-04-23 23:23:25.708 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:25.708 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:23:25.708 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:25.708 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:25.709 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:25.709 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:25.710 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:25.711 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:25.711 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:25.711 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:25.711 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:25.711 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:25.711 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:25.711 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:25.711 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:25.711 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:23:25.711 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:25.712 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:25.712 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:25.713 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1804166041 (XID = 1144), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:25.713 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:25.713 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:25.713 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713910985396 end=1713911005713 duration=20317 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=-1 error=true>
]]></system-out>
  </testcase>
  <testcase name="testPartitionDiscoveryDBPattern" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="22.028">
    <failure message="expected:&lt;5&gt; but was:&lt;3&gt;" type="java.lang.AssertionError"><![CDATA[java.lang.AssertionError: expected:<5> but was:<3>
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.testPartitionDiscoveryDBPattern(TestPartitionManagement.java:383)
]]></failure>
    <system-out><![CDATA[[INFO ] 2024-04-23 23:23:25.715 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:23:25.715 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:23:25.715 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:23:25.715 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:23:25.723 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:23:25.723 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:23:25.723 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:23:25.723 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:23:25.725 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:23:25.766 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029;create=true
[DEBUG] 2024-04-23 23:23:26.069 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:23:26.153 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:23:26.153 [MetaStoreThread-33029] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:23:26.154 [MetaStoreThread-33029] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:23:26.154 [MetaStoreThread-33029] HMSHandler - 15: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:23:26.154 [MetaStoreThread-33029] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:23:26.154 [MetaStoreThread-33029] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:26.154 [MetaStoreThread-33029] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:23:26.154 [MetaStoreThread-33029] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:23:26.154 [MetaStoreThread-33029] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:23:26.154 [MetaStoreThread-33029] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029;create=true
[DEBUG] 2024-04-23 23:23:26.154 [MetaStoreThread-33029] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:23:26.154 [MetaStoreThread-33029] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:23:26.154 [MetaStoreThread-33029] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:26.154 [MetaStoreThread-33029] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:23:26.154 [MetaStoreThread-33029] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:23:26.154 [MetaStoreThread-33029] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:23:26.154 [MetaStoreThread-33029] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:23:26.154 [MetaStoreThread-33029] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:26.154 [MetaStoreThread-33029] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:26.154 [MetaStoreThread-33029] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:23:26.154 [MetaStoreThread-33029] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:23:26.154 [MetaStoreThread-33029] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:26.154 [MetaStoreThread-33029] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029;create=true
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45483;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029;create=true
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 10
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 119
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:26.155 [MetaStoreThread-33029] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:26.156 [MetaStoreThread-33029] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:26.156 [MetaStoreThread-33029] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:26.156 [MetaStoreThread-33029] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:26.156 [MetaStoreThread-33029] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:26.156 [MetaStoreThread-33029] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:26.156 [MetaStoreThread-33029] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:26.156 [MetaStoreThread-33029] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:26.156 [MetaStoreThread-33029] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:26.156 [MetaStoreThread-33029] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:26.156 [MetaStoreThread-33029] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:26.156 [MetaStoreThread-33029] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:26.156 [MetaStoreThread-33029] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:26.156 [MetaStoreThread-33029] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:23:26.156 [MetaStoreThread-33029] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:23:26.157 [MetaStoreThread-33029] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:23:26.157 [MetaStoreThread-33029] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:23:26.158 [MetaStoreThread-33029] HikariConfig - HikariPool-6 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:23:26.158 [MetaStoreThread-33029] HikariConfig - HikariPool-6 - configuration:
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029;create=true"
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - poolName........................"HikariPool-6"
[DEBUG] 2024-04-23 23:23:26.159 [MetaStoreThread-33029] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:23:26.160 [MetaStoreThread-33029] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:23:26.160 [MetaStoreThread-33029] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:23:26.160 [MetaStoreThread-33029] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:23:26.160 [MetaStoreThread-33029] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:23:26.160 [MetaStoreThread-33029] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:23:26.160 [MetaStoreThread-33029] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:23:26.160 [MetaStoreThread-33029] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:23:26.160 [MetaStoreThread-33029] HikariDataSource - HikariPool-6 - Starting...
[INFO ] 2024-04-23 23:23:26.161 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:23:26.161 [MetaStoreThread-33029] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[INFO ] 2024-04-23 23:23:26.161 [MetaStoreThread-33029] HikariDataSource - HikariPool-6 - Start completed.
[DEBUG] 2024-04-23 23:23:26.262 [HikariPool-6 housekeeper] HikariPool - HikariPool-6 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:23:26.263 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1899835410 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.264 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@805321257 (XID = 1154), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.266 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@24800532 (XID = 1156), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.267 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1345308006 (XID = 1158), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.268 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1615781485 (XID = 1160), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.270 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1415674352 (XID = 1162), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.271 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@12182591 (XID = 1164), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.272 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2040304273 (XID = 1166), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.273 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@925999222 (XID = 1168), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.273 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:23:26.403 [MetaStoreThread-33029] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:23:26.403 [MetaStoreThread-33029] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@da94456, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:23:26.403 [MetaStoreThread-33029] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:23:26.403 [MetaStoreThread-33029] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@da94456, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5fe97a60 created in the thread with id: 142
[DEBUG] 2024-04-23 23:23:26.403 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.403 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.404 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.498 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.574 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1899835410 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.589 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1899835410 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.628 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1899835410 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.761 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:23:26.762 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:23:26.762 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:23:26.762 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@61dc4bee, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2730c3a will be shutdown
[DEBUG] 2024-04-23 23:23:26.762 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 12: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:23:26.762 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:23:26.768 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1899835410 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.775 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1899835410 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.891 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1899835410 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.919 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1899835410 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.926 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1899835410 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.933 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1899835410 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.936 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.938 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.938 [MetaStoreThread-33029] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:23:26.938 [MetaStoreThread-33029] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:23:26.938 [MetaStoreThread-33029] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@da94456 from thread id: 142
[DEBUG] 2024-04-23 23:23:26.938 [MetaStoreThread-33029] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:23:26.938 [MetaStoreThread-33029] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:26.942 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.944 [MetaStoreThread-33029] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:26.945 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[INFO ] 2024-04-23 23:23:26.945 [MetaStoreThread-33029] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:23:26.945 [MetaStoreThread-33029] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:26.946 [MetaStoreThread-33029] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:26.946 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.946 [MetaStoreThread-33029] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:26.947 [MetaStoreThread-33029] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:26.949 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.950 [MetaStoreThread-33029] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:26.952 [MetaStoreThread-33029] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:26.952 [MetaStoreThread-33029] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:26.952 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.952 [MetaStoreThread-33029] ObjectStore - db details for db default retrieved using SQL in 2.307646ms
[DEBUG] 2024-04-23 23:23:26.952 [MetaStoreThread-33029] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:23:26.952 [MetaStoreThread-33029] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:23:26.952 [MetaStoreThread-33029] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:26.958 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.960 [MetaStoreThread-33029] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:26.961 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.963 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[INFO ] 2024-04-23 23:23:26.964 [MetaStoreThread-33029] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:23:26.964 [MetaStoreThread-33029] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:26.964 [MetaStoreThread-33029] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:26.968 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.970 [MetaStoreThread-33029] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:26.973 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1899835410 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.975 [MetaStoreThread-33029] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:26.975 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[INFO ] 2024-04-23 23:23:26.975 [MetaStoreThread-33029] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:23:26.975 [MetaStoreThread-33029] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:26.975 [MetaStoreThread-33029] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:26.976 [MetaStoreThread-33029] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:26.977 [MetaStoreThread-33029] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:26.977 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[INFO ] 2024-04-23 23:23:26.977 [MetaStoreThread-33029] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:23:26.977 [MetaStoreThread-33029] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:26.977 [MetaStoreThread-33029] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:26.978 [MetaStoreThread-33029] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:26.978 [MetaStoreThread-33029] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:26.982 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1899835410 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.985 [MetaStoreThread-33029] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:26.988 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1899835410 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:26.989 [MetaStoreThread-33029] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:26.990 [MetaStoreThread-33029] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[INFO ] 2024-04-23 23:23:26.990 [MetaStoreThread-33029] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:23:26.991 [MetaStoreThread-33029] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:23:26.991 [MetaStoreThread-33029] PerfLogger - </PERFLOG method=init start=1713911006154 end=1713911006991 duration=837 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=15 retryCount=0 error=false>
[INFO ] 2024-04-23 23:23:26.991 [MetaStoreThread-33029] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:23:26.991 [MetaStoreThread-33029] HiveMetaStore - Started the new metaserver on port [33029]...
[INFO ] 2024-04-23 23:23:26.991 [MetaStoreThread-33029] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:23:26.991 [MetaStoreThread-33029] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:23:26.991 [MetaStoreThread-33029] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:23:26.991 [MetaStoreThread-33029] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:23:26.991 [MetaStoreThread-33029] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:23:26.991 [MetaStoreThread-33029] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:23:26.991 [MetaStoreThread-33029] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:23:26.991 [MetaStoreThread-33029] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:23:26.991 [MetaStoreThread-33029] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:23:26.991 [MetaStoreThread-33029] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:23:26.991 [MetaStoreThread-33029] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:23:26.991 [MetaStoreThread-33029] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:23:26.991 [MetaStoreThread-33029] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:23:26.991 [MetaStoreThread-33029] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:23:26.991 [MetaStoreThread-33029] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:23:26.991 [MetaStoreThread-33029] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:23:27.155 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:23:27.155 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 16: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:23:27.155 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:23:27.159 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33029) is created
[INFO ] 2024-04-23 23:23:27.159 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 33029 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33029 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029;create=true
[INFO ] 2024-04-23 23:23:27.159 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:23:27.162 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:23:27.162 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:33029]
[INFO ] 2024-04-23 23:23:27.162 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:33029)
[INFO ] 2024-04-23 23:23:27.162 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:33029) current connections: 2
[DEBUG] 2024-04-23 23:23:27.163 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.163 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911007163 end=1713911007163 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:27.163 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:27.164 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.164 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 create_database: Database(name:db4, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:23:27.164 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db4, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:23:27.164 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029;create=true
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029;create=true
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:23:27.165 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:23:27.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4bdf8676, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:23:27.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:23:27.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4bdf8676, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1c2ba0fc created in the thread with id: 159
[DEBUG] 2024-04-23 23:23:27.166 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.167 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.167 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.168 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.169 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.169 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:23:27.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:23:27.169 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4bdf8676 from thread id: 159
[DEBUG] 2024-04-23 23:23:27.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:27.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.170 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.941533ms
[DEBUG] 2024-04-23 23:23:27.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db4, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:23:27.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:23:27.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.172 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.172 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:23:27.172 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:23:27.172 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:23:27.172 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:23:27.172 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[WARN ] 2024-04-23 23:23:27.172 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db for database db4. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:23:27.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.175 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.176 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713911007164 end=1713911007175 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:27.176 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:27.176 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.176 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 create_table_req: Table(tableName:tbl4, dbName:db4, owner:alex, createTime:1713911007, lastAccessTime:1713911007, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:b, type:binary, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:23:27.176 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl4, dbName:db4, owner:alex, createTime:1713911007, lastAccessTime:1713911007, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:b, type:binary, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:23:27.177 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.181 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:27.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:27.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.182 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 5.092638ms
[DEBUG] 2024-04-23 23:23:27.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:23:27.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.188 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.189 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:27.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:27.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.452566ms
[DEBUG] 2024-04-23 23:23:27.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:27.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:23:27.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:27.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.191 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:23:27.191 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:23:27.191 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:23:27.191 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:23:27.192 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33029/db4.db/tbl4
[DEBUG] 2024-04-23 23:23:27.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:27.202 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:27.206 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1899835410 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.211 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1899835410 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.216 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1899835410 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.220 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1899835410 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.231 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.231 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.233 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.234 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713911007176 end=1713911007234 duration=58 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:27.234 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:27.234 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.234 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 add_partition : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:23:27.235 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:23:27.235 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.235 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.235 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:27.235 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:23:27.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:27.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.273 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.273 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:23:27.273 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:23:27.273 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:23:27.273 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:23:27.273 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33029/db4.db/tbl4/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:23:27.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:27.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:23:27.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:27.282 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1899835410 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.293 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.295 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911007234 end=1713911007295 duration=61 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:27.295 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:27.296 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.296 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 add_partition : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:23:27.296 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:23:27.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:27.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:23:27.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:27.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.302 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:23:27.302 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:23:27.302 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:23:27.302 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:23:27.303 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33029/db4.db/tbl4/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:23:27.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:27.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:23:27.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:27.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.314 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.315 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911007296 end=1713911007315 duration=19 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:27.316 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:27.316 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.316 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 add_partition : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:23:27.316 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:23:27.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:27.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:23:27.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:27.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.323 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.323 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:23:27.323 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:23:27.323 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:23:27.323 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:23:27.323 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33029/db4.db/tbl4/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:23:27.329 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.329 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:27.329 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:23:27.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:27.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.337 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.338 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911007316 end=1713911007338 duration=22 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:27.339 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:27.339 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.339 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713911007339 end=1713911007339 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:27.339 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:27.339 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.339 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_table : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:23:27.339 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:23:27.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.341 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:27.341 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:27.341 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.341 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.341 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.760827ms
[DEBUG] 2024-04-23 23:23:27.341 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.341 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.341 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:23:27.344 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.349 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[INFO ] 2024-04-23 23:23:27.350 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:23:27.350 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911007339 end=1713911007350 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:27.350 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=11, comments=HMS client
[DEBUG] 2024-04-23 23:23:27.350 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:27.351 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.351 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:23:27.351 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:23:27.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:23:27.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.355 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.972939ms + 0.007354ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:23:27.359 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.447602ms + 0.130033ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:23:27.361 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.999607ms + 0.532778ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:23:27.364 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.059613ms + 0.222956ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:27.366 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.755935ms + 0.163475ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:23:27.368 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.170846ms + 0.215572ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:27.371 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.133898ms + 0.267685ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:27.373 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.370626ms + 0.210833ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:27.376 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.973245ms + 0.391209ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:27.378 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.993641ms + 0.131508ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:23:27.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:27.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 27.378907ms
[DEBUG] 2024-04-23 23:23:27.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.378 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.378 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911007351 end=1713911007378 duration=27 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:27.389 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:27.389 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.390 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 alter_table: hive.db4.tbl4 newtbl=tbl4
[INFO ] 2024-04-23 23:23:27.390 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db4.tbl4 newtbl=tbl4	
[DEBUG] 2024-04-23 23:23:27.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.391 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:27.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:27.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.391 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.712416ms
[DEBUG] 2024-04-23 23:23:27.391 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:23:27.392 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:23:27.392 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:23:27.392 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:23:27.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.393 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:27.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:27.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.393 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.672806ms
[DEBUG] 2024-04-23 23:23:27.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:23:27.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.399 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.400 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.402 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:27.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:27.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.067629ms
[DEBUG] 2024-04-23 23:23:27.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:27.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:23:27.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:27.407 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.407 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db4
[WARN ] 2024-04-23 23:23:27.407 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:23:27.407 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.407 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:27.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:27.409 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:27.409 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:23:27.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:27.411 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:23:27.411 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:27.411 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:23:27.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:27.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.420 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.421 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713911007389 end=1713911007421 duration=32 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[INFO ] 2024-04-23 23:23:27.422 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:23:27.422 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:33029]
[INFO ] 2024-04-23 23:23:27.422 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:33029)
[INFO ] 2024-04-23 23:23:27.422 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:33029) current connections: 3
[DEBUG] 2024-04-23 23:23:27.423 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.423 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911007423 end=1713911007423 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=18 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:27.423 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:27.423 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.423 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 18: source:127.0.0.1 get_table_metas : tbl=hive.*dbfoo*.*
[INFO ] 2024-04-23 23:23:27.423 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*dbfoo*.*	
[INFO ] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 18: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029;create=true
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029;create=true
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:23:27.424 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:23:27.425 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:23:27.425 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:23:27.425 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:23:27.425 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:23:27.425 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:23:27.425 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:23:27.425 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:23:27.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@93e5594, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:23:27.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:23:27.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@93e5594, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@12f8cfe5 created in the thread with id: 172
[DEBUG] 2024-04-23 23:23:27.425 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.425 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.425 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.427 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.427 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.427 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:23:27.427 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:23:27.427 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@93e5594 from thread id: 172
[DEBUG] 2024-04-23 23:23:27.427 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.427 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (database.name.matches(:param2) ) &&  (tableType == :param3 || tableType == :param4 ) params: hive, (?i).*dbfoo.*, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:23:27.434 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.434 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.434 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911007423 end=1713911007434 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=18 retryCount=0 error=false>
[INFO ] 2024-04-23 23:23:27.434 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: *dbfoo* tablePattern: * found: 0
[INFO ] 2024-04-23 23:23:27.434 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 2
[DEBUG] 2024-04-23 23:23:27.434 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:27.434 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.435 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 18: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:23:27.435 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[INFO ] 2024-04-23 23:23:27.435 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:23:27.435 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:23:27.435 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@93e5594, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@12f8cfe5 will be shutdown
[DEBUG] 2024-04-23 23:23:27.435 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4
[DEBUG] 2024-04-23 23:23:27.435 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 18: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:23:27.435 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4	
[INFO ] 2024-04-23 23:23:27.435 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:23:27.435 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:23:27.435 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911007434 end=1713911007435 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=18 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:27.435 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.435 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.435 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:23:27.435 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 18: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:23:27.435 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:23:27.436 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.199347ms + 0.007708ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:23:27.437 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.81611ms + 0.112439ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:23:27.438 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.308036ms + 0.398094ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:23:27.439 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.295887ms + 0.273054ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:27.439 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.278981ms + 0.17494ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:23:27.440 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.26877ms + 0.200373ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:27.440 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.239458ms + 0.194398ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:27.441 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.253714ms + 0.19361ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:27.442 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.334466ms + 0.432053ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:27.442 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.284961ms + 0.196615ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:23:27.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:27.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 7.488607ms
[DEBUG] 2024-04-23 23:23:27.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.443 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.443 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911007435 end=1713911007443 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[INFO ] 2024-04-23 23:23:27.444 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:23:27.444 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:33029]
[INFO ] 2024-04-23 23:23:27.444 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:33029)
[INFO ] 2024-04-23 23:23:27.444 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:33029) current connections: 3
[DEBUG] 2024-04-23 23:23:27.445 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.445 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911007445 end=1713911007445 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:27.445 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:27.445 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.445 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_table_metas : tbl=hive.*db4*.*
[INFO ] 2024-04-23 23:23:27.445 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*db4*.*	
[INFO ] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029;create=true
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:23:27.446 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:23:27.447 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:23:27.447 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:23:27.447 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:23:27.447 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029;create=true
[DEBUG] 2024-04-23 23:23:27.447 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:23:27.447 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:23:27.447 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:23:27.447 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:23:27.447 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:23:27.447 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:23:27.447 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:23:27.447 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:23:27.447 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:23:27.447 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:23:27.447 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:23:27.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@73a00f1c, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:23:27.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:23:27.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@73a00f1c, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@bec3f22 created in the thread with id: 173
[DEBUG] 2024-04-23 23:23:27.447 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.447 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.447 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.449 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.449 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.449 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:23:27.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:23:27.450 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@73a00f1c from thread id: 173
[DEBUG] 2024-04-23 23:23:27.450 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.450 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (database.name.matches(:param2) ) &&  (tableType == :param3 || tableType == :param4 ) params: hive, (?i).*db4.*, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:23:27.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.455 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.455 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911007445 end=1713911007455 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[INFO ] 2024-04-23 23:23:27.455 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: *db4* tablePattern: * found: 0
[INFO ] 2024-04-23 23:23:27.456 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 2
[DEBUG] 2024-04-23 23:23:27.456 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:27.456 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.456 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:27.456 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:23:27.456 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:23:27.456 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:23:27.456 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:23:27.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@73a00f1c, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@bec3f22 will be shutdown
[INFO ] 2024-04-23 23:23:27.456 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:23:27.456 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:23:27.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[INFO ] 2024-04-23 23:23:27.456 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:23:27.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.456 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911007456 end=1713911007456 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:27.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.456 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:23:27.456 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:23:27.456 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:23:27.457 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.093081ms + 0.008083ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:23:27.458 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.799744ms + 0.109498ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:23:27.459 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.297545ms + 0.412335ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:23:27.460 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.304551ms + 0.281151ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:27.460 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.27824ms + 0.195831ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:23:27.461 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.266897ms + 0.200894ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:27.461 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.26945ms + 0.197564ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:27.462 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.280074ms + 0.207389ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:27.463 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.376545ms + 0.466374ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:27.463 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.30671ms + 0.195969ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:23:27.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:27.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 7.622242ms
[DEBUG] 2024-04-23 23:23:27.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.464 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.464 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911007456 end=1713911007464 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:27.465 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:27.465 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.465 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:23:27.465 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:23:27.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:23:27.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.468 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.468 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.468 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713911007465 end=1713911007468 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:27.468 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:27.468 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.468 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:23:27.468 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:23:27.468 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.472 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.472 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911007468 end=1713911007472 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:27.473 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:27.473 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.473 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_database: db4
[INFO ] 2024-04-23 23:23:27.473 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db4	
[DEBUG] 2024-04-23 23:23:27.473 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.474 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:27.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:27.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.474 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.75886ms
[DEBUG] 2024-04-23 23:23:27.475 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911007473 end=1713911007475 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:27.475 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=3, comments=HMS client
[DEBUG] 2024-04-23 23:23:27.475 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:27.475 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.475 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_tables_by_type: db=@hive#db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:27.475 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:27.475 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:27.475 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:27.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.476 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:27.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:27.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.476 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.42308ms
[DEBUG] 2024-04-23 23:23:27.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.479 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:27.479 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.479 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.479 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.743863ms
[DEBUG] 2024-04-23 23:23:27.479 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911007475 end=1713911007479 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:27.479 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:27.480 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.480 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:23:27.480 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:23:27.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:27.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.483 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 3.321718ms
[DEBUG] 2024-04-23 23:23:27.483 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911007480 end=1713911007483 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:27.483 [main] HiveMetaStoreClient - Selecting dropDatabase method for db4 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:23:27.483 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:23:27.483 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:27.483 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.484 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:27.485 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:27.485 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.485 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.485 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.493256ms
[DEBUG] 2024-04-23 23:23:27.485 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_multi_table : db=db4 tbls=tbl4
[INFO ] 2024-04-23 23:23:27.485 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db4 tbls=tbl4	
[DEBUG] 2024-04-23 23:23:27.485 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.489 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.490 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:27.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:27.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.123703ms
[DEBUG] 2024-04-23 23:23:27.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.490 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.491 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911007483 end=1713911007491 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:27.491 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:27.491 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:27.491 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:23:27.491 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:23:27.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:27.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.492 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:27.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:27.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.274667ms
[DEBUG] 2024-04-23 23:23:27.493 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:23:27.493 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:23:27.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:27.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.747036ms
[DEBUG] 2024-04-23 23:23:27.494 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:23:27.494 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:23:27.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.503 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1899835410 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.507 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.507 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:27.507 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:27.507 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.511 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1899835410 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.515 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:27.515 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:27.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.536 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1899835410 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.540 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:23:27.540 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:23:27.540 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:23:27.540 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:23:27.540 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:27.540 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:27.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.541 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:27.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:27.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.139947ms
[DEBUG] 2024-04-23 23:23:27.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.542 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:27.542 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.542 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.614003ms
[DEBUG] 2024-04-23 23:23:27.542 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:27.543 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:27.544 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:27.544 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:27.544 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.986001ms
[DEBUG] 2024-04-23 23:23:27.544 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:27.544 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:23:27.544 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:27.544 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:27.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:27.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:27.560 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1899835410 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.564 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:27.569 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:27.569 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:27.569 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.569 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:27.570 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:27.572 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:27.573 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:27.575 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:27.576 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:27.577 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:27.577 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:27.579 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:27.579 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:27.579 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:29.580 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:23:29.581 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:23:29.581 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:29.581 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:29.584 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:29.585 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:29.585 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:29.585 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 4.149644ms
[DEBUG] 2024-04-23 23:23:29.585 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:23:29.585 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:23:29.585 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:29.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:29.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:29.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.735222ms
[DEBUG] 2024-04-23 23:23:29.586 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:23:29.586 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:23:29.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:29.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:29.588 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:29.588 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:29.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:29.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:29.589 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:29.589 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:29.589 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:29.589 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:29.589 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:29.589 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:29.590 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:29.590 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:29.590 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:29.590 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:29.590 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.880813ms
[DEBUG] 2024-04-23 23:23:29.590 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:29.591 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:29.591 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:29.591 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.509295ms
[DEBUG] 2024-04-23 23:23:29.591 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:29.592 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:29.592 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:29.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:29.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:29.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.121551ms
[DEBUG] 2024-04-23 23:23:29.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:29.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:23:29.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:29.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:29.594 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:29.594 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:29.595 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:29.595 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:29.595 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:29.595 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:29.595 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:29.596 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:29.596 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:29.596 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:29.596 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:29.596 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:29.596 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:29.596 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:29.596 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:29.597 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:29.597 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:29.597 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:30.688 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:23:30.692 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:23:31.598 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:23:31.598 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:23:31.598 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:31.599 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:31.601 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:31.602 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:31.602 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:31.602 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.495984ms
[DEBUG] 2024-04-23 23:23:31.602 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:23:31.602 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:23:31.602 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:31.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:31.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:31.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.705478ms
[DEBUG] 2024-04-23 23:23:31.603 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:23:31.603 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:23:31.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:31.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:31.604 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:31.604 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:31.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:31.605 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:31.605 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:31.605 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:31.605 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:31.606 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:31.606 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:31.606 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:31.606 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:31.607 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:31.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:31.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:31.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.960832ms
[DEBUG] 2024-04-23 23:23:31.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:31.608 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:31.608 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:31.608 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.509451ms
[DEBUG] 2024-04-23 23:23:31.608 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:31.608 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:31.609 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:31.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:31.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:31.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.819818ms
[DEBUG] 2024-04-23 23:23:31.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:31.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:23:31.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:31.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:31.610 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:31.610 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:31.611 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:31.611 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:31.611 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:31.611 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:31.612 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:31.612 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:31.612 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:31.612 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:31.612 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:31.612 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:31.612 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:31.612 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:31.612 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:31.613 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:31.613 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:31.613 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:33.614 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:23:33.614 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:23:33.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:33.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:33.617 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:33.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:33.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:33.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.340619ms
[DEBUG] 2024-04-23 23:23:33.618 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:23:33.618 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:23:33.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:33.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:33.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:33.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.48886ms
[DEBUG] 2024-04-23 23:23:33.618 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:23:33.618 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:23:33.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:33.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:33.620 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:33.620 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:33.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:33.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:33.621 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:33.621 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:33.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:33.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:33.621 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:33.621 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:33.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:33.622 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:33.622 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:33.622 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:33.622 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.806967ms
[DEBUG] 2024-04-23 23:23:33.622 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:33.623 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:33.623 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:33.623 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.578171ms
[DEBUG] 2024-04-23 23:23:33.623 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:33.624 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:33.625 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:33.625 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:33.625 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:33.625 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.934612ms
[DEBUG] 2024-04-23 23:23:33.625 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:33.625 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:23:33.625 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:33.625 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:33.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:33.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:33.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:33.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:33.628 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:33.628 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:33.628 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:33.628 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:33.628 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:33.628 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:33.628 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:33.628 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:33.628 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:33.628 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:33.628 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:33.629 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:33.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:33.630 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:34.160 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:23:35.631 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:23:35.631 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:23:35.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:35.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:35.634 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:35.635 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:35.635 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:35.635 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.656422ms
[DEBUG] 2024-04-23 23:23:35.635 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:23:35.635 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:23:35.635 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:35.635 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:35.635 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:35.635 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.536571ms
[DEBUG] 2024-04-23 23:23:35.635 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:23:35.635 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:23:35.635 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:35.637 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:35.637 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:35.637 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:35.637 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:35.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:35.638 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:35.638 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:35.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:35.639 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:35.639 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:35.639 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:35.639 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:35.640 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:35.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:35.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:35.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.905139ms
[DEBUG] 2024-04-23 23:23:35.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:35.641 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:35.641 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:35.641 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.571668ms
[DEBUG] 2024-04-23 23:23:35.641 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:35.641 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:35.642 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:35.642 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:35.642 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:35.642 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.950337ms
[DEBUG] 2024-04-23 23:23:35.642 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:35.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:23:35.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:35.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:35.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:35.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:35.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:35.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:35.645 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:35.645 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:35.645 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:35.645 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:35.645 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:35.645 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:35.645 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:35.646 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:35.646 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:35.646 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:35.646 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:35.647 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:35.647 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:35.647 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:37.648 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:23:37.648 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:23:37.648 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:37.648 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:37.650 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:37.650 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:37.650 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:37.650 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 2.128184ms
[DEBUG] 2024-04-23 23:23:37.650 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:23:37.650 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:23:37.650 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:37.651 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:37.651 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:37.651 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.529599ms
[DEBUG] 2024-04-23 23:23:37.651 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:23:37.651 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:23:37.651 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:37.652 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:37.652 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:37.652 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:37.652 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:37.653 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:37.653 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:37.653 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:37.653 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:37.654 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:37.654 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:37.654 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:37.654 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:37.655 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:37.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:37.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:37.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.991875ms
[DEBUG] 2024-04-23 23:23:37.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:37.656 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:37.656 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:37.656 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.492979ms
[DEBUG] 2024-04-23 23:23:37.656 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:37.656 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:37.657 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:37.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:37.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:37.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.866529ms
[DEBUG] 2024-04-23 23:23:37.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:37.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:23:37.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:37.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:37.658 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:37.658 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:37.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:37.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:37.660 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:37.660 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:37.660 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:37.660 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:37.660 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:37.660 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:37.660 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:37.660 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:37.660 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:37.660 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:37.660 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:37.661 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:37.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:37.661 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:39.662 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:23:39.662 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:23:39.662 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:39.662 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:39.665 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:39.666 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:39.666 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:39.666 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.504787ms
[DEBUG] 2024-04-23 23:23:39.666 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:23:39.666 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:23:39.666 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:39.667 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:39.667 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:39.667 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.096209ms
[DEBUG] 2024-04-23 23:23:39.667 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:23:39.667 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:23:39.667 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:39.668 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:39.668 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:39.668 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:39.668 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:39.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:39.669 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:39.669 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:39.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:39.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:39.670 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:39.670 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:39.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:39.671 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:39.671 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:39.671 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:39.671 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.918059ms
[DEBUG] 2024-04-23 23:23:39.671 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:39.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:39.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:39.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.500677ms
[DEBUG] 2024-04-23 23:23:39.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:39.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:39.673 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:39.673 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:39.673 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:39.673 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.809431ms
[DEBUG] 2024-04-23 23:23:39.673 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:39.673 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:23:39.673 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:39.673 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:39.674 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:39.674 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:39.675 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:39.675 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:39.675 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:39.675 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:39.676 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:39.676 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:39.676 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:39.676 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:39.676 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:39.676 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:39.676 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:39.676 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:39.676 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:39.677 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:39.677 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:39.677 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:41.678 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:23:41.678 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:23:41.678 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:41.678 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:41.681 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:41.682 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:41.682 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:41.682 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.651814ms
[DEBUG] 2024-04-23 23:23:41.682 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:23:41.682 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:23:41.682 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:41.683 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:41.683 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:41.683 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.058555ms
[DEBUG] 2024-04-23 23:23:41.683 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:23:41.683 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:23:41.683 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:41.685 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:41.685 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:41.685 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:41.685 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:41.685 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:41.686 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:41.686 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:41.686 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:41.686 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:41.686 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:41.686 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:41.687 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:41.687 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:41.687 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:41.687 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:41.687 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.948368ms
[DEBUG] 2024-04-23 23:23:41.688 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:41.688 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:41.688 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:41.688 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.503391ms
[DEBUG] 2024-04-23 23:23:41.688 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:41.689 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:41.689 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:41.689 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:41.689 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:41.689 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.79381ms
[DEBUG] 2024-04-23 23:23:41.689 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:41.690 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:23:41.690 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:41.690 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:41.690 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:41.690 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:41.691 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:41.692 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:41.692 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:41.692 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:41.692 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:41.692 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:41.692 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:41.692 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:41.692 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:41.692 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:41.692 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:41.692 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:41.692 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:41.693 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:41.693 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:41.694 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:43.694 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:23:43.695 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:23:43.695 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:43.695 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:43.698 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:43.698 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:43.698 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:43.698 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.328242ms
[DEBUG] 2024-04-23 23:23:43.698 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:23:43.698 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:23:43.698 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:43.699 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:43.699 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:43.699 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.556557ms
[DEBUG] 2024-04-23 23:23:43.699 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:23:43.699 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:23:43.699 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:43.700 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:43.700 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:43.700 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:43.700 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:43.701 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:43.701 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:43.701 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:43.701 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:43.702 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:43.702 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:43.702 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:43.702 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:43.703 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:43.703 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:43.703 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:43.703 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.944477ms
[DEBUG] 2024-04-23 23:23:43.703 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:43.704 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:43.704 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:43.704 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.504151ms
[DEBUG] 2024-04-23 23:23:43.704 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:43.704 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:43.705 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:43.705 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:43.705 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:43.705 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.8114ms
[DEBUG] 2024-04-23 23:23:43.705 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:43.705 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:23:43.705 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:43.705 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:43.706 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:43.706 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:43.707 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:43.707 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:43.707 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:43.707 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:43.707 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:43.707 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:43.707 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:43.707 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:43.708 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:43.708 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:43.708 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:43.708 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:43.708 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:43.709 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:43.709 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:43.709 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:45.710 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:23:45.710 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:23:45.710 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:45.710 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:45.713 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:45.714 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:45.714 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:45.714 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.665984ms
[DEBUG] 2024-04-23 23:23:45.714 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:23:45.714 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:23:45.714 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:45.715 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:45.715 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:45.715 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.018859ms
[DEBUG] 2024-04-23 23:23:45.715 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:23:45.715 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:23:45.715 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:45.716 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:45.717 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:45.717 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:45.717 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:45.717 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:45.717 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:45.717 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:45.717 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:45.718 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:45.718 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:45.718 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:45.718 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:45.719 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:45.719 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:45.719 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:45.719 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.904888ms
[DEBUG] 2024-04-23 23:23:45.719 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:45.720 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:45.720 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:45.720 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.520529ms
[DEBUG] 2024-04-23 23:23:45.720 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:45.721 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:45.721 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:45.721 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:45.721 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:45.721 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.846956ms
[DEBUG] 2024-04-23 23:23:45.721 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:45.721 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:23:45.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:45.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:45.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:45.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:45.723 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:45.723 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:45.724 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:45.724 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:45.724 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:45.724 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:45.724 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:45.724 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:45.724 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:45.724 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:45.724 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:45.724 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:45.724 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:45.725 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:45.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:45.725 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:47.726 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:23:47.726 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:23:47.726 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:47.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:47.729 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:47.730 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:47.730 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:47.730 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.448454ms
[DEBUG] 2024-04-23 23:23:47.730 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:23:47.730 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:23:47.730 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:47.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:47.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:47.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.629878ms
[DEBUG] 2024-04-23 23:23:47.731 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:23:47.731 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:23:47.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:47.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:47.732 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:47.732 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:47.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:47.733 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:47.733 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:47.733 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:47.733 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:47.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:47.734 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 17: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:47.734 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:47.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:47.735 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:47.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:47.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:47.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.934383ms
[DEBUG] 2024-04-23 23:23:47.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:47.736 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:47.736 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:47.736 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.493504ms
[DEBUG] 2024-04-23 23:23:47.736 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:47.736 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:47.737 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:47.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:47.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:47.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.83732ms
[DEBUG] 2024-04-23 23:23:47.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:47.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:23:47.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:47.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:47.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:47.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:47.739 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:47.739 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:47.739 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:47.739 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:47.739 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:47.739 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:47.740 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:47.740 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:47.740 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:47.740 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:23:47.740 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:47.740 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:47.740 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:47.741 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1892999883 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:47.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:47.741 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:47.741 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911007491 end=1713911027741 duration=20250 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=-1 error=true>
]]></system-out>
  </testcase>
  <testcase name="testPartitionDiscoveryDBPattern" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="22.028">
    <error message="javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore&#10;NestedThrowables:&#10;java.sql.BatchUpdateException: DELETE on table &apos;DBS&apos; caused a violation of foreign key constraint &apos;TBLS_FK1&apos; for key (2).  The statement has been rolled back." type="org.apache.hadoop.hive.metastore.api.MetaException"><![CDATA[org.apache.hadoop.hive.metastore.api.MetaException: 
javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
NestedThrowables:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.tearDown(TestPartitionManagement.java:100)
]]></error>
  </testcase>
  <testcase name="testPartitionRetention" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="22.194">
    <failure message="expected:&lt;5&gt; but was:&lt;3&gt;" type="java.lang.AssertionError"><![CDATA[java.lang.AssertionError: expected:<5> but was:<3>
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.testPartitionRetention(TestPartitionManagement.java:537)
]]></failure>
    <system-out><![CDATA[[INFO ] 2024-04-23 23:23:47.742 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:23:47.742 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:23:47.742 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:23:47.742 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:23:47.750 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:23:47.750 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:23:47.750 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:23:47.750 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:23:47.752 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:23:47.783 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613;create=true
[INFO ] 2024-04-23 23:23:48.290 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:23:48.290 [MetaStoreThread-33613] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:23:48.290 [MetaStoreThread-33613] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] HMSHandler - 20: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613;create=true
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613;create=true
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33029;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613;create=true
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:23:48.291 [MetaStoreThread-33613] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:23:48.292 [MetaStoreThread-33613] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:23:48.292 [MetaStoreThread-33613] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:23:48.292 [MetaStoreThread-33613] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 120
[DEBUG] 2024-04-23 23:23:48.292 [MetaStoreThread-33613] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:48.292 [MetaStoreThread-33613] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:48.292 [MetaStoreThread-33613] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:48.292 [MetaStoreThread-33613] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:48.292 [MetaStoreThread-33613] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:48.292 [MetaStoreThread-33613] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:48.292 [MetaStoreThread-33613] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:48.292 [MetaStoreThread-33613] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:48.292 [MetaStoreThread-33613] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:48.292 [MetaStoreThread-33613] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:48.292 [MetaStoreThread-33613] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:48.292 [MetaStoreThread-33613] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:48.292 [MetaStoreThread-33613] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:48.292 [MetaStoreThread-33613] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:23:48.292 [MetaStoreThread-33613] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:23:48.292 [MetaStoreThread-33613] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:23:48.293 [MetaStoreThread-33613] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:23:48.293 [MetaStoreThread-33613] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:23:48.293 [MetaStoreThread-33613] HikariConfig - HikariPool-7 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:23:48.293 [MetaStoreThread-33613] HikariConfig - HikariPool-7 - configuration:
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613;create=true"
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - poolName........................"HikariPool-7"
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:23:48.294 [MetaStoreThread-33613] HikariDataSource - HikariPool-7 - Starting...
[INFO ] 2024-04-23 23:23:48.295 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:23:48.296 [MetaStoreThread-33613] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[INFO ] 2024-04-23 23:23:48.296 [MetaStoreThread-33613] HikariDataSource - HikariPool-7 - Start completed.
[DEBUG] 2024-04-23 23:23:48.396 [HikariPool-7 housekeeper] HikariPool - HikariPool-7 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:23:48.398 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@587403587 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.399 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1648237432 (XID = 1154), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.400 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1402386520 (XID = 1156), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.401 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@34726967 (XID = 1158), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.402 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@770066476 (XID = 1160), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.403 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@106928791 (XID = 1162), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.404 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1899031202 (XID = 1164), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.405 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@394521064 (XID = 1166), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.407 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1282861243 (XID = 1168), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.407 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:23:48.571 [MetaStoreThread-33613] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:23:48.571 [MetaStoreThread-33613] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@12cede72, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:23:48.571 [MetaStoreThread-33613] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:23:48.571 [MetaStoreThread-33613] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@12cede72, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4799837c created in the thread with id: 176
[DEBUG] 2024-04-23 23:23:48.571 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.571 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.572 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.658 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.722 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@587403587 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.737 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@587403587 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.776 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@587403587 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.792 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@587403587 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.798 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@587403587 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.913 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@587403587 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.938 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@587403587 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.944 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@587403587 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.950 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@587403587 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.952 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.954 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.954 [MetaStoreThread-33613] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:23:48.954 [MetaStoreThread-33613] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:23:48.954 [MetaStoreThread-33613] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@12cede72 from thread id: 176
[DEBUG] 2024-04-23 23:23:48.954 [MetaStoreThread-33613] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:23:48.954 [MetaStoreThread-33613] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:48.957 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.959 [MetaStoreThread-33613] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:48.960 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[INFO ] 2024-04-23 23:23:48.960 [MetaStoreThread-33613] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:23:48.960 [MetaStoreThread-33613] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:48.960 [MetaStoreThread-33613] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:48.961 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.961 [MetaStoreThread-33613] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:48.961 [MetaStoreThread-33613] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:48.963 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.963 [MetaStoreThread-33613] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:48.965 [MetaStoreThread-33613] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:48.965 [MetaStoreThread-33613] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:48.965 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.965 [MetaStoreThread-33613] ObjectStore - db details for db default retrieved using SQL in 1.718761ms
[DEBUG] 2024-04-23 23:23:48.965 [MetaStoreThread-33613] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:23:48.965 [MetaStoreThread-33613] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:23:48.965 [MetaStoreThread-33613] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:48.970 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.972 [MetaStoreThread-33613] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:48.973 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.975 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[INFO ] 2024-04-23 23:23:48.975 [MetaStoreThread-33613] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:23:48.975 [MetaStoreThread-33613] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:48.975 [MetaStoreThread-33613] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:48.978 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.981 [MetaStoreThread-33613] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:48.983 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@587403587 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.985 [MetaStoreThread-33613] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:48.985 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[INFO ] 2024-04-23 23:23:48.985 [MetaStoreThread-33613] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:23:48.985 [MetaStoreThread-33613] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:48.986 [MetaStoreThread-33613] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:48.986 [MetaStoreThread-33613] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:48.986 [MetaStoreThread-33613] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:48.987 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[INFO ] 2024-04-23 23:23:48.987 [MetaStoreThread-33613] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:23:48.987 [MetaStoreThread-33613] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:48.987 [MetaStoreThread-33613] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:48.988 [MetaStoreThread-33613] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:48.988 [MetaStoreThread-33613] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:48.991 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@587403587 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.994 [MetaStoreThread-33613] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:48.996 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@587403587 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:48.997 [MetaStoreThread-33613] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:48.998 [MetaStoreThread-33613] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[INFO ] 2024-04-23 23:23:48.998 [MetaStoreThread-33613] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:23:48.998 [MetaStoreThread-33613] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:23:48.998 [MetaStoreThread-33613] PerfLogger - </PERFLOG method=init start=1713911028290 end=1713911028998 duration=708 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=20 retryCount=0 error=false>
[INFO ] 2024-04-23 23:23:48.998 [MetaStoreThread-33613] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:23:48.998 [MetaStoreThread-33613] HiveMetaStore - Started the new metaserver on port [33613]...
[INFO ] 2024-04-23 23:23:48.998 [MetaStoreThread-33613] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:23:48.998 [MetaStoreThread-33613] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:23:48.998 [MetaStoreThread-33613] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:23:48.998 [MetaStoreThread-33613] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:23:48.998 [MetaStoreThread-33613] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:23:48.998 [MetaStoreThread-33613] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:23:48.998 [MetaStoreThread-33613] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:23:48.998 [MetaStoreThread-33613] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:23:48.998 [MetaStoreThread-33613] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:23:48.998 [MetaStoreThread-33613] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:23:48.998 [MetaStoreThread-33613] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:23:48.998 [MetaStoreThread-33613] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:23:48.998 [MetaStoreThread-33613] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:23:48.998 [MetaStoreThread-33613] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:23:48.998 [MetaStoreThread-33613] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:23:48.998 [MetaStoreThread-33613] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:23:49.292 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:23:49.293 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 21: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:23:49.293 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:23:49.305 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33613) is created
[INFO ] 2024-04-23 23:23:49.305 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 33613 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33613 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613;create=true
[INFO ] 2024-04-23 23:23:49.305 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:23:49.313 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:23:49.314 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:33613]
[INFO ] 2024-04-23 23:23:49.314 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:33613)
[INFO ] 2024-04-23 23:23:49.315 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:33613) current connections: 3
[DEBUG] 2024-04-23 23:23:49.316 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:49.316 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911029316 end=1713911029316 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:49.317 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:49.317 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:49.317 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 create_database: Database(name:db7, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:23:49.317 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db7, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:23:49.320 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:23:49.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:23:49.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:49.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:23:49.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:23:49.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:23:49.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613;create=true
[DEBUG] 2024-04-23 23:23:49.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:23:49.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:23:49.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:49.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:23:49.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:23:49.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:23:49.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:23:49.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:49.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:49.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:23:49.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:23:49.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:49.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:49.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:23:49.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:49.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:49.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:49.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:23:49.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:23:49.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:23:49.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:23:49.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:23:49.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:23:49.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:23:49.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:23:49.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:23:49.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:23:49.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613;create=true
[DEBUG] 2024-04-23 23:23:49.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:23:49.322 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:23:49.322 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:23:49.322 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:23:49.322 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:23:49.322 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:23:49.322 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:23:49.322 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:23:49.322 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:23:49.322 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:23:49.322 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:23:49.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@8c23d6b, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:23:49.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:23:49.323 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@8c23d6b, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@71dd9011 created in the thread with id: 193
[DEBUG] 2024-04-23 23:23:49.324 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.325 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.325 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.329 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.330 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.331 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:23:49.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:23:49.331 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@8c23d6b from thread id: 193
[DEBUG] 2024-04-23 23:23:49.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:49.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.333 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 2.435258ms
[DEBUG] 2024-04-23 23:23:49.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db7, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:23:49.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:23:49.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.337 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.338 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:23:49.338 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:23:49.338 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:23:49.338 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:23:49.338 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[WARN ] 2024-04-23 23:23:49.339 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db for database db7. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:23:49.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.342 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.342 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.346 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.346 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713911029317 end=1713911029346 duration=29 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:49.348 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:49.349 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:49.349 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 create_table_req: Table(tableName:tbl7, dbName:db7, owner:alex, createTime:1713911029, lastAccessTime:1713911029, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:s, type:string, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:l, type:bigint, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:23:49.349 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl7, dbName:db7, owner:alex, createTime:1713911029, lastAccessTime:1713911029, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:s, type:string, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:l, type:bigint, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:23:49.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.360 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:49.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:49.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.361 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 11.450214ms
[DEBUG] 2024-04-23 23:23:49.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:23:49.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.371 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.372 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:49.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:49.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.501055ms
[DEBUG] 2024-04-23 23:23:49.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:49.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:23:49.374 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:49.374 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.374 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:23:49.374 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:23:49.374 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:23:49.374 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:23:49.374 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33613/db7.db/tbl7
[DEBUG] 2024-04-23 23:23:49.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:49.386 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:49.389 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@587403587 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.394 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@587403587 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.400 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@587403587 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.405 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@587403587 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.421 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.423 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713911029349 end=1713911029423 duration=74 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:49.423 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:49.423 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:49.423 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 add_partition : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:23:49.423 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:23:49.424 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.424 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.424 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:49.424 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:23:49.433 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:49.457 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.457 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.463 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:23:49.463 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:23:49.463 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:23:49.463 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:23:49.463 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33613/db7.db/tbl7/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:23:49.468 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.468 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:49.468 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:23:49.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:49.473 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@587403587 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.484 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.486 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911029423 end=1713911029486 duration=63 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:49.486 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:49.486 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:49.486 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 add_partition : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:23:49.486 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:23:49.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:49.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:23:49.489 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:49.492 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.492 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.493 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:23:49.493 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:23:49.493 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:23:49.493 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:23:49.493 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33613/db7.db/tbl7/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:23:49.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:49.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:23:49.499 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:49.502 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.502 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.505 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.506 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911029486 end=1713911029506 duration=20 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:49.507 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:49.507 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:49.507 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 add_partition : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:23:49.507 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:23:49.507 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.507 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.507 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:49.507 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:23:49.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:49.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.513 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:23:49.513 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:23:49.513 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:23:49.513 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:23:49.513 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33613/db7.db/tbl7/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:23:49.517 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:49.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:23:49.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:49.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.524 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.525 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911029507 end=1713911029525 duration=18 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:49.526 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:49.526 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:49.526 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713911029526 end=1713911029526 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:49.526 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:49.526 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:49.526 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_table : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:23:49.526 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:23:49.526 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.527 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:49.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:49.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.527 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.245502ms
[DEBUG] 2024-04-23 23:23:49.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:23:49.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.534 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[INFO ] 2024-04-23 23:23:49.534 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:23:49.535 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911029526 end=1713911029535 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:49.535 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=9, comments=HMS client
[DEBUG] 2024-04-23 23:23:49.535 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:49.535 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:49.535 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_partitions : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:23:49.535 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:23:49.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:23:49.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.541 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 5.825238ms + 0.008187ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:23:49.546 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.288255ms + 0.11294ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:23:49.549 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.586562ms + 0.444465ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:23:49.552 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.313813ms + 0.299608ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:49.555 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.33215ms + 0.246554ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:23:49.557 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.238727ms + 0.202221ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:49.560 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.29598ms + 0.2752ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:49.563 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.461828ms + 0.278804ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:49.566 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.488764ms + 0.464455ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:49.568 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.523066ms + 0.214436ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:23:49.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:49.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 33.220732ms
[DEBUG] 2024-04-23 23:23:49.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.569 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.569 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911029535 end=1713911029569 duration=34 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:49.579 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:49.579 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:49.579 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 alter_table: hive.db7.tbl7 newtbl=tbl7
[INFO ] 2024-04-23 23:23:49.580 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db7.tbl7 newtbl=tbl7	
[DEBUG] 2024-04-23 23:23:49.580 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.581 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:49.581 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:49.581 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.581 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.581 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.728076ms
[DEBUG] 2024-04-23 23:23:49.581 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:23:49.581 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:23:49.581 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:23:49.581 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:23:49.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.583 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:49.583 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:49.583 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.583 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.583 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.627389ms
[DEBUG] 2024-04-23 23:23:49.583 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.583 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.583 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:23:49.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.590 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.592 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.595 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:49.595 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:49.595 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.595 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.584383ms
[DEBUG] 2024-04-23 23:23:49.595 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.595 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:49.595 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:23:49.598 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:49.601 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.601 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db7
[WARN ] 2024-04-23 23:23:49.602 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:23:49.602 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.602 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:49.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:49.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:49.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:23:49.605 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:49.606 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:23:49.606 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:49.606 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:23:49.612 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:49.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.617 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.619 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713911029579 end=1713911029619 duration=40 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[INFO ] 2024-04-23 23:23:49.621 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:23:49.621 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:33613]
[INFO ] 2024-04-23 23:23:49.621 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:33613)
[INFO ] 2024-04-23 23:23:49.621 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:33613) current connections: 4
[DEBUG] 2024-04-23 23:23:49.621 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:49.621 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911029621 end=1713911029621 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=23 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:49.622 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:49.622 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:49.622 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 23: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:23:49.622 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 23: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613;create=true
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613;create=true
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6c699158, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:23:49.623 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6c699158, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2c05c99e created in the thread with id: 206
[DEBUG] 2024-04-23 23:23:49.624 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.624 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.624 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.625 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.626 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.626 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:23:49.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:23:49.626 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6c699158 from thread id: 206
[DEBUG] 2024-04-23 23:23:49.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:23:49.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.631 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.631 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911029622 end=1713911029631 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=23 retryCount=0 error=false>
[INFO ] 2024-04-23 23:23:49.631 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:23:49.632 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 3
[DEBUG] 2024-04-23 23:23:49.632 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:49.632 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:49.632 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:49.632 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 23: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:23:49.632 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:23:49.632 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:23:49.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6c699158, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2c05c99e will be shutdown
[DEBUG] 2024-04-23 23:23:49.632 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_partitions : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:23:49.632 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:23:49.632 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 23: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:23:49.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[INFO ] 2024-04-23 23:23:49.632 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:23:49.632 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911029632 end=1713911029632 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=23 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:49.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.632 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:23:49.632 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 23: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:23:49.632 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:23:49.633 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.210694ms + 0.008123ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:23:49.634 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.671689ms + 0.094008ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:23:49.635 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.265064ms + 0.480407ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:23:49.636 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.265682ms + 0.245741ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:49.636 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.274308ms + 0.177339ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:23:49.637 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.320468ms + 0.193475ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:49.637 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.280476ms + 0.17786ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:49.638 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.256145ms + 0.170332ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:49.639 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.356142ms + 0.445981ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:23:49.639 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.274409ms + 0.17535ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:23:49.639 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:49.639 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.639 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 7.402802ms
[DEBUG] 2024-04-23 23:23:49.639 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.640 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.640 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911029632 end=1713911029640 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:49.640 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:49.640 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:49.640 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:23:49.641 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:23:49.641 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:23:49.641 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.644 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.644 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713911029640 end=1713911029644 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:49.644 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:49.644 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:49.644 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:23:49.644 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:23:49.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.647 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.648 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.648 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911029644 end=1713911029648 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:49.648 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:49.648 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:49.648 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_database: db7
[INFO ] 2024-04-23 23:23:49.649 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db7	
[DEBUG] 2024-04-23 23:23:49.649 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.650 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:49.650 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:49.650 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.650 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.650 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.705195ms
[DEBUG] 2024-04-23 23:23:49.650 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911029648 end=1713911029650 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:49.650 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:23:49.651 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:49.651 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:49.651 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_tables_by_type: db=@hive#db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:49.651 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:49.651 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:49.651 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:49.651 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.652 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:49.652 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:49.652 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.652 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.653 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.547422ms
[DEBUG] 2024-04-23 23:23:49.653 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.656 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:49.656 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.657 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 4.086351ms
[DEBUG] 2024-04-23 23:23:49.657 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911029651 end=1713911029657 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:49.657 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:49.657 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:49.657 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:23:49.657 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:23:49.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:49.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.661 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 3.780165ms
[DEBUG] 2024-04-23 23:23:49.661 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911029657 end=1713911029661 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:49.661 [main] HiveMetaStoreClient - Selecting dropDatabase method for db7 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:23:49.661 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:23:49.661 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:49.662 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:49.662 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.663 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:49.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:49.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.663 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.594645ms
[DEBUG] 2024-04-23 23:23:49.663 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_multi_table : db=db7 tbls=tbl7
[INFO ] 2024-04-23 23:23:49.663 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db7 tbls=tbl7	
[DEBUG] 2024-04-23 23:23:49.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.668 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.669 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:49.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:49.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.250504ms
[DEBUG] 2024-04-23 23:23:49.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.670 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.670 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911029662 end=1713911029670 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:23:49.670 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:23:49.670 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:23:49.670 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:23:49.670 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:23:49.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:49.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.671 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:49.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:49.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.313243ms
[DEBUG] 2024-04-23 23:23:49.672 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:23:49.672 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:23:49.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:49.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.699101ms
[DEBUG] 2024-04-23 23:23:49.673 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:23:49.673 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:23:49.673 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.683 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@587403587 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.688 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.688 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:49.688 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:49.688 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.694 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@587403587 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.697 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.698 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:49.698 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:49.698 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.727 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@587403587 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.732 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:23:49.732 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:23:49.732 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:23:49.732 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:23:49.732 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:49.732 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:49.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.733 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:49.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:49.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.399896ms
[DEBUG] 2024-04-23 23:23:49.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:49.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.817343ms
[DEBUG] 2024-04-23 23:23:49.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:49.736 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:49.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:49.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:49.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.299396ms
[DEBUG] 2024-04-23 23:23:49.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:49.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:23:49.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:49.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:49.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:49.739 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:49.758 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@587403587 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.762 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:49.767 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:49.767 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:49.767 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.767 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:49.769 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:49.770 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:49.772 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:49.773 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:49.775 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:49.777 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:49.777 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.777 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:49.779 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:49.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:49.779 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:49.835 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:23:51.780 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:23:51.780 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:23:51.780 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:51.780 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:51.783 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:51.784 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:51.784 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:51.784 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.87975ms
[DEBUG] 2024-04-23 23:23:51.784 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:23:51.784 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:23:51.784 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:51.785 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:51.785 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:51.785 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.06164ms
[DEBUG] 2024-04-23 23:23:51.785 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:23:51.785 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:23:51.785 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:51.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:51.787 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:51.787 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:51.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:51.788 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:51.788 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:51.788 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:51.788 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:51.788 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:51.789 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:51.789 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:51.789 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:51.789 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:51.790 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:51.790 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:51.790 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.863646ms
[DEBUG] 2024-04-23 23:23:51.790 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:51.790 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:51.790 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:51.790 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.485087ms
[DEBUG] 2024-04-23 23:23:51.790 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:51.791 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:51.791 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:51.792 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:51.792 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:51.792 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.929666ms
[DEBUG] 2024-04-23 23:23:51.792 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:51.792 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:23:51.792 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:51.792 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:51.793 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:51.793 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:51.793 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:51.794 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:51.794 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:51.794 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:51.794 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:51.794 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:51.794 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:51.794 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:51.794 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:51.794 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:51.794 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:51.794 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:51.794 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:51.795 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:51.795 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:51.795 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:53.796 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:23:53.796 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:23:53.796 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:53.796 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:53.799 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:53.800 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:53.800 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:53.800 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.321676ms
[DEBUG] 2024-04-23 23:23:53.800 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:23:53.800 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:23:53.800 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:53.801 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:53.801 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:53.801 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.440729ms
[DEBUG] 2024-04-23 23:23:53.801 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:23:53.801 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:23:53.801 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:53.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:53.803 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:53.803 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:53.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:53.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:53.804 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:53.804 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:53.804 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:53.804 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:53.804 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:53.804 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:53.804 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:53.805 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:53.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:53.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:53.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.754953ms
[DEBUG] 2024-04-23 23:23:53.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:53.806 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:53.806 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:53.806 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.436154ms
[DEBUG] 2024-04-23 23:23:53.806 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:53.806 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:53.807 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:53.807 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:53.807 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:53.807 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.729933ms
[DEBUG] 2024-04-23 23:23:53.807 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:53.807 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:23:53.807 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:53.807 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:53.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:53.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:53.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:53.809 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:53.809 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:53.809 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:53.809 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:53.809 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:53.809 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:53.809 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:53.809 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:53.809 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:53.809 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:53.809 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:53.809 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:53.810 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:53.810 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:53.810 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:55.811 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:23:55.811 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:23:55.811 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:55.811 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:55.814 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:55.814 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:55.814 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:55.814 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.246048ms
[DEBUG] 2024-04-23 23:23:55.814 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:23:55.815 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:23:55.815 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:55.815 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:55.815 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:55.815 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.666781ms
[DEBUG] 2024-04-23 23:23:55.815 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:23:55.815 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:23:55.815 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:55.817 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:55.817 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:55.817 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:55.817 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:55.817 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:55.818 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:55.818 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:55.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:55.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:55.818 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:55.818 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:55.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:55.819 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:55.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:55.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:55.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.772036ms
[DEBUG] 2024-04-23 23:23:55.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:55.820 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:55.820 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:55.820 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.454242ms
[DEBUG] 2024-04-23 23:23:55.820 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:55.820 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:55.821 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:55.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:55.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:55.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.823085ms
[DEBUG] 2024-04-23 23:23:55.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:55.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:23:55.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:55.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:55.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:55.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:55.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:55.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:55.823 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:55.823 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:55.824 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:55.824 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:55.824 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:55.824 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:55.824 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:55.824 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:55.824 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:55.824 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:55.824 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:55.825 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:55.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:55.825 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:56.070 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:23:56.263 [HikariPool-6 housekeeper] HikariPool - HikariPool-6 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:23:57.826 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:23:57.826 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:23:57.826 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:57.826 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:57.829 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:57.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:57.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:57.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.398771ms
[DEBUG] 2024-04-23 23:23:57.829 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:23:57.830 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:23:57.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:57.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:57.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:57.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.644882ms
[DEBUG] 2024-04-23 23:23:57.830 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:23:57.830 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:23:57.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:57.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:57.832 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:57.832 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:57.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:57.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:57.833 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:57.833 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:57.833 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:57.833 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:57.833 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:57.833 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:57.833 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:57.834 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:57.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:57.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:57.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.842503ms
[DEBUG] 2024-04-23 23:23:57.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:57.835 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:57.835 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:57.835 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.553958ms
[DEBUG] 2024-04-23 23:23:57.835 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:57.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:57.836 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:57.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:57.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:57.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.767617ms
[DEBUG] 2024-04-23 23:23:57.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:57.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:23:57.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:57.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:57.837 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:57.837 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:57.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:57.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:57.838 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:57.838 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:57.838 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:57.839 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:57.839 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:57.839 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:57.839 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:57.839 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:57.839 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:57.839 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:57.839 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:57.840 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:57.840 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:57.840 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:23:59.841 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:23:59.841 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:23:59.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:23:59.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:59.844 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:59.844 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:59.844 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:59.844 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.518405ms
[DEBUG] 2024-04-23 23:23:59.844 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:23:59.845 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:23:59.845 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:59.845 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:59.845 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:59.845 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.753105ms
[DEBUG] 2024-04-23 23:23:59.845 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:23:59.845 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:23:59.845 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:59.847 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:59.847 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:23:59.847 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:23:59.847 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:59.848 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:59.848 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:23:59.848 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:23:59.848 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:59.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:59.849 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:23:59.849 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:23:59.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:59.850 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:59.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:59.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:59.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.939863ms
[DEBUG] 2024-04-23 23:23:59.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:59.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:59.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:59.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.524825ms
[DEBUG] 2024-04-23 23:23:59.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:59.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:59.852 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:23:59.852 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:23:59.852 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:59.852 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.903241ms
[DEBUG] 2024-04-23 23:23:59.852 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:23:59.852 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:23:59.852 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:23:59.852 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:23:59.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:23:59.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:23:59.854 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:23:59.854 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:23:59.854 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:23:59.854 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:59.854 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:59.854 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:59.854 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:59.855 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:59.855 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:59.855 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:23:59.855 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:23:59.855 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:59.855 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:23:59.855 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:23:59.856 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:23:59.856 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:00.689 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:24:00.692 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:24:01.856 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:24:01.857 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:24:01.857 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:01.857 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:01.859 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:01.859 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:01.859 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:01.859 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 2.490836ms
[DEBUG] 2024-04-23 23:24:01.859 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:24:01.859 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:24:01.859 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:01.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:01.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:01.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.563094ms
[DEBUG] 2024-04-23 23:24:01.860 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:24:01.860 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:24:01.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:01.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:01.861 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:01.861 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:01.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:01.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:01.862 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:01.862 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:01.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:01.863 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:01.863 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:01.863 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:01.863 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:01.864 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:01.864 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:01.864 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:01.864 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.846242ms
[DEBUG] 2024-04-23 23:24:01.864 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:01.864 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:01.864 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:01.864 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.454316ms
[DEBUG] 2024-04-23 23:24:01.864 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:01.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:01.866 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:01.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:01.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:01.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.818922ms
[DEBUG] 2024-04-23 23:24:01.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:01.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:24:01.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:01.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:01.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:01.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:01.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:01.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:01.868 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:01.868 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:01.868 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:01.868 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:01.868 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:01.868 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:01.868 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:01.869 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:01.869 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:01.869 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:01.869 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:01.870 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:01.870 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:01.870 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:03.870 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:24:03.870 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:24:03.871 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:03.871 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:03.873 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:03.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:03.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:03.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 2.546666ms
[DEBUG] 2024-04-23 23:24:03.873 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:24:03.873 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:24:03.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:03.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:03.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:03.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.578355ms
[DEBUG] 2024-04-23 23:24:03.874 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:24:03.874 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:24:03.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:03.876 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:03.876 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:03.876 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:03.876 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:03.876 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:03.877 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:03.877 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:03.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:03.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:03.878 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:03.878 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:03.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:03.878 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:03.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:03.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:03.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.997177ms
[DEBUG] 2024-04-23 23:24:03.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:03.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:03.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:03.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.537678ms
[DEBUG] 2024-04-23 23:24:03.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:03.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:03.880 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:03.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:03.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:03.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.835679ms
[DEBUG] 2024-04-23 23:24:03.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:03.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:24:03.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:03.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:03.882 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:03.882 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:03.882 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:03.883 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:03.883 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:03.883 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:03.883 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:03.883 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:03.883 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:03.883 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:03.883 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:03.883 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:03.883 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:03.883 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:03.883 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:03.884 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:03.884 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:03.885 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:04.160 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:24:05.885 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:24:05.885 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:24:05.886 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:05.886 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:05.888 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:05.889 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:05.889 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:05.889 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.648344ms
[DEBUG] 2024-04-23 23:24:05.889 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:24:05.889 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:24:05.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:05.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:05.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:05.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.705435ms
[DEBUG] 2024-04-23 23:24:05.890 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:24:05.890 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:24:05.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:05.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:05.892 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:05.892 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:05.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:05.893 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:05.893 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:05.893 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:05.893 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:05.893 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:05.894 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:05.894 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:05.894 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:05.894 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:05.895 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:05.895 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:05.895 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.897838ms
[DEBUG] 2024-04-23 23:24:05.895 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:05.895 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:05.895 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:05.895 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.48318ms
[DEBUG] 2024-04-23 23:24:05.895 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:05.896 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:05.896 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:05.896 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:05.896 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:05.896 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.79656ms
[DEBUG] 2024-04-23 23:24:05.896 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:05.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:24:05.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:05.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:05.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:05.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:05.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:05.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:05.899 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:05.899 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:05.899 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:05.899 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:05.899 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:05.899 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:05.899 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:05.899 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:05.899 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:05.899 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:05.899 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:05.900 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:05.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:05.900 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:07.901 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:24:07.901 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:24:07.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:07.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:07.904 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:07.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:07.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:07.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.691695ms
[DEBUG] 2024-04-23 23:24:07.905 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:24:07.905 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:24:07.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:07.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:07.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:07.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.722029ms
[DEBUG] 2024-04-23 23:24:07.906 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:24:07.906 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:24:07.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:07.908 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:07.908 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:07.908 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:07.908 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:07.908 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:07.909 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:07.909 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:07.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:07.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:07.910 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:07.910 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:07.910 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:07.910 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:07.910 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:07.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:07.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.965815ms
[DEBUG] 2024-04-23 23:24:07.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:07.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:07.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:07.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.577281ms
[DEBUG] 2024-04-23 23:24:07.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:07.912 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:07.912 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:07.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:07.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:07.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.862169ms
[DEBUG] 2024-04-23 23:24:07.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:07.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:24:07.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:07.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:07.914 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:07.914 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:07.914 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:07.915 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:07.915 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:07.915 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:07.915 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:07.915 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:07.915 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:07.915 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:07.915 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:07.915 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:07.915 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:07.915 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:07.915 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:07.916 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:07.916 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:07.916 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:09.917 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:24:09.917 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:24:09.918 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:09.918 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:09.920 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:09.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:09.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:09.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.394005ms
[DEBUG] 2024-04-23 23:24:09.921 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:24:09.921 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:24:09.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:09.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:09.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:09.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.904289ms
[DEBUG] 2024-04-23 23:24:09.923 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:24:09.923 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:24:09.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:09.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:09.927 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:09.927 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:09.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:09.928 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:09.928 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:09.928 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:09.928 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:09.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:09.929 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:09.929 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:09.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:09.930 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:09.930 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:09.930 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:09.930 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.876938ms
[DEBUG] 2024-04-23 23:24:09.930 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:09.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:09.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:09.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.541144ms
[DEBUG] 2024-04-23 23:24:09.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:09.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:09.932 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:09.932 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:09.932 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:09.932 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.826675ms
[DEBUG] 2024-04-23 23:24:09.932 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:09.932 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:24:09.932 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:09.932 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:09.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:09.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:09.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:09.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:09.934 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:09.935 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:09.935 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:09.935 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:09.935 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:09.935 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:09.935 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:09.935 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:24:09.935 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:09.935 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:09.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:09.936 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1158648862 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:09.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:09.936 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:09.936 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911029670 end=1713911049936 duration=20266 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=-1 error=true>
]]></system-out>
  </testcase>
  <testcase name="testPartitionRetention" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="22.195">
    <error message="javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore&#10;NestedThrowables:&#10;java.sql.BatchUpdateException: DELETE on table &apos;DBS&apos; caused a violation of foreign key constraint &apos;TBLS_FK1&apos; for key (2).  The statement has been rolled back." type="org.apache.hadoop.hive.metastore.api.MetaException"><![CDATA[org.apache.hadoop.hive.metastore.api.MetaException: 
javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
NestedThrowables:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.tearDown(TestPartitionManagement.java:100)
]]></error>
  </testcase>
  <testcase name="testPartitionDiscoveryNonDefaultCatalog" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="22.021">
    <failure message="expected:&lt;5&gt; but was:&lt;3&gt;" type="java.lang.AssertionError"><![CDATA[java.lang.AssertionError: expected:<5> but was:<3>
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.testPartitionDiscoveryNonDefaultCatalog(TestPartitionManagement.java:344)
]]></failure>
    <system-out><![CDATA[[INFO ] 2024-04-23 23:24:09.937 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:24:09.937 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:24:09.937 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:24:09.937 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:24:09.944 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:24:09.945 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:24:09.945 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:24:09.945 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:24:09.946 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:24:09.976 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079;create=true
[INFO ] 2024-04-23 23:24:10.360 [MetaStoreThread-38079] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[INFO ] 2024-04-23 23:24:10.360 [main] MetaStoreTestUtils - Waiting the HMS to start.
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] HMSHandler - 24: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079;create=true
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079;create=true
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:24:10.361 [MetaStoreThread-38079] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33613;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079;create=true
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 10
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 119
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:24:10.362 [MetaStoreThread-38079] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:10.363 [MetaStoreThread-38079] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:24:10.363 [MetaStoreThread-38079] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:24:10.363 [MetaStoreThread-38079] HikariConfig - HikariPool-8 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:24:10.363 [MetaStoreThread-38079] HikariConfig - HikariPool-8 - configuration:
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079;create=true"
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - poolName........................"HikariPool-8"
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:24:10.364 [MetaStoreThread-38079] HikariDataSource - HikariPool-8 - Starting...
[INFO ] 2024-04-23 23:24:10.366 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:24:10.366 [MetaStoreThread-38079] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:10.366 [MetaStoreThread-38079] HikariDataSource - HikariPool-8 - Start completed.
[DEBUG] 2024-04-23 23:24:10.466 [HikariPool-8 housekeeper] HikariPool - HikariPool-8 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:24:10.468 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@537804200 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:10.469 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1630746515 (XID = 1154), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:10.470 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1343754890 (XID = 1156), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:10.471 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@18663644 (XID = 1158), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:10.473 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1142724865 (XID = 1160), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:10.474 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@89273721 (XID = 1162), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:10.475 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1931118050 (XID = 1164), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:10.476 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2136930536 (XID = 1166), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:10.477 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2102874129 (XID = 1168), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:10.477 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:24:10.555 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:24:10.557 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:24:10.557 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:24:10.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@8c23d6b, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@71dd9011 will be shutdown
[DEBUG] 2024-04-23 23:24:10.558 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 22: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:24:10.558 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:24:10.622 [MetaStoreThread-38079] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:24:10.622 [MetaStoreThread-38079] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@200413d5, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:24:10.622 [MetaStoreThread-38079] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:24:10.623 [MetaStoreThread-38079] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@200413d5, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4bdf4f84 created in the thread with id: 209
[DEBUG] 2024-04-23 23:24:10.623 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:10.623 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:10.623 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:10.707 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:10.779 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@537804200 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:10.795 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@537804200 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:10.830 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@537804200 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:10.845 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@537804200 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:10.850 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@537804200 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:10.955 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@537804200 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:10.983 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@537804200 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:10.989 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@537804200 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:10.996 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@537804200 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:10.998 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.000 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.000 [MetaStoreThread-38079] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:24:11.000 [MetaStoreThread-38079] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:24:11.000 [MetaStoreThread-38079] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@200413d5 from thread id: 209
[DEBUG] 2024-04-23 23:24:11.000 [MetaStoreThread-38079] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:24:11.000 [MetaStoreThread-38079] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.003 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.006 [MetaStoreThread-38079] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.006 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:11.006 [MetaStoreThread-38079] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:24:11.006 [MetaStoreThread-38079] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.007 [MetaStoreThread-38079] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.007 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.007 [MetaStoreThread-38079] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.007 [MetaStoreThread-38079] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.010 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.010 [MetaStoreThread-38079] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.011 [MetaStoreThread-38079] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:11.012 [MetaStoreThread-38079] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.012 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.012 [MetaStoreThread-38079] ObjectStore - db details for db default retrieved using SQL in 1.906032ms
[DEBUG] 2024-04-23 23:24:11.012 [MetaStoreThread-38079] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:24:11.012 [MetaStoreThread-38079] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:24:11.012 [MetaStoreThread-38079] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.017 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.019 [MetaStoreThread-38079] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.020 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.022 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:11.022 [MetaStoreThread-38079] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:24:11.022 [MetaStoreThread-38079] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.022 [MetaStoreThread-38079] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.025 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.028 [MetaStoreThread-38079] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.030 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@537804200 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.031 [MetaStoreThread-38079] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.032 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:11.032 [MetaStoreThread-38079] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:24:11.032 [MetaStoreThread-38079] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.032 [MetaStoreThread-38079] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.032 [MetaStoreThread-38079] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.033 [MetaStoreThread-38079] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.033 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:11.033 [MetaStoreThread-38079] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:24:11.033 [MetaStoreThread-38079] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.033 [MetaStoreThread-38079] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.034 [MetaStoreThread-38079] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.034 [MetaStoreThread-38079] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.037 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@537804200 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.040 [MetaStoreThread-38079] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.043 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@537804200 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.044 [MetaStoreThread-38079] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.045 [MetaStoreThread-38079] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:11.045 [MetaStoreThread-38079] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:24:11.045 [MetaStoreThread-38079] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:24:11.045 [MetaStoreThread-38079] PerfLogger - </PERFLOG method=init start=1713911050361 end=1713911051045 duration=684 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:11.045 [MetaStoreThread-38079] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:24:11.045 [MetaStoreThread-38079] HiveMetaStore - Started the new metaserver on port [38079]...
[INFO ] 2024-04-23 23:24:11.045 [MetaStoreThread-38079] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:24:11.045 [MetaStoreThread-38079] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:24:11.045 [MetaStoreThread-38079] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:24:11.045 [MetaStoreThread-38079] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:24:11.045 [MetaStoreThread-38079] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:24:11.045 [MetaStoreThread-38079] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:24:11.045 [MetaStoreThread-38079] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:24:11.045 [MetaStoreThread-38079] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:24:11.045 [MetaStoreThread-38079] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:24:11.045 [MetaStoreThread-38079] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:24:11.045 [MetaStoreThread-38079] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:24:11.045 [MetaStoreThread-38079] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:24:11.045 [MetaStoreThread-38079] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:24:11.045 [MetaStoreThread-38079] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:24:11.045 [MetaStoreThread-38079] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:24:11.045 [MetaStoreThread-38079] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:24:11.362 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:24:11.363 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 25: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:24:11.363 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:24:11.375 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38079) is created
[INFO ] 2024-04-23 23:24:11.375 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 38079 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38079 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079;create=true
[INFO ] 2024-04-23 23:24:11.376 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:24:11.383 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:24:11.383 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:38079]
[INFO ] 2024-04-23 23:24:11.383 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:38079)
[INFO ] 2024-04-23 23:24:11.384 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:38079) current connections: 4
[DEBUG] 2024-04-23 23:24:11.385 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.385 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911051385 end=1713911051385 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:11.394 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:11.398 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_catalog from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.398 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 create_catalog: Catalog(name:cat3, locationUri:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3)
[INFO ] 2024-04-23 23:24:11.398 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_catalog: Catalog(name:cat3, locationUri:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3)	
[INFO ] 2024-04-23 23:24:11.401 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:24:11.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:24:11.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:11.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:11.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:24:11.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:24:11.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079;create=true
[DEBUG] 2024-04-23 23:24:11.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:24:11.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:24:11.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:11.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:24:11.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:24:11.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:24:11.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:24:11.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:11.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:11.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:24:11.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:11.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:11.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:11.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:24:11.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:11.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:11.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:11.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:24:11.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:24:11.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:24:11.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:24:11.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:24:11.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:24:11.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:24:11.403 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:24:11.403 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:24:11.403 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:24:11.403 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079;create=true
[DEBUG] 2024-04-23 23:24:11.403 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:24:11.403 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:24:11.403 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:24:11.403 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:11.403 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:24:11.403 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:24:11.403 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:24:11.403 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:24:11.403 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:11.403 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:24:11.403 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:24:11.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6192c463, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:24:11.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:24:11.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6192c463, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@767b585c created in the thread with id: 226
[DEBUG] 2024-04-23 23:24:11.406 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.406 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.406 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.410 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.411 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.412 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:24:11.412 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:24:11.412 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6192c463 from thread id: 226
[DEBUG] 2024-04-23 23:24:11.412 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog cat3
[DEBUG] 2024-04-23 23:24:11.412 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.413 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.414 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:11.414 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:11.414 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:11.414 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:24:11.414 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.414 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Creating catalog Catalog(name:cat3, locationUri:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3, createTime:1713911051)
[DEBUG] 2024-04-23 23:24:11.414 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.423 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.426 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.427 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog cat3
[DEBUG] 2024-04-23 23:24:11.427 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.430 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.430 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.430 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:11.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:11.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.433 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.434 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_catalog start=1713911051398 end=1713911051434 duration=36 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:11.435 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:11.435 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.435 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 create_database: Database(name:db3, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:cat3, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:24:11.435 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db3, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:cat3, createTime:0, type:NATIVE)	
[DEBUG] 2024-04-23 23:24:11.435 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:11.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.437 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.529998ms
[DEBUG] 2024-04-23 23:24:11.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database cat3.db3, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:24:11.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog cat3
[DEBUG] 2024-04-23 23:24:11.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.438 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.439 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:11.439 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:11.439 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:11.439 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:24:11.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.440 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.440 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.440 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.441 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713911051435 end=1713911051441 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:11.441 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:11.441 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.441 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 create_table_req: Table(tableName:tbl3, dbName:db3, owner:alex, createTime:1713911051, lastAccessTime:1713911051, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:s, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:cat3, ownerType:USER)
[INFO ] 2024-04-23 23:24:11.442 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl3, dbName:db3, owner:alex, createTime:1713911051, lastAccessTime:1713911051, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:s, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:cat3, ownerType:USER)	
[DEBUG] 2024-04-23 23:24:11.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.445 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:11.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:11.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.446 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 4.114047ms
[DEBUG] 2024-04-23 23:24:11.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:24:11.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.451 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.452 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:11.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:11.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.055435ms
[DEBUG] 2024-04-23 23:24:11.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:11.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:24:11.453 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:11.453 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.453 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:11.453 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:11.453 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:11.453 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:24:11.453 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.453 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:11.457 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:11.460 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@537804200 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.464 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@537804200 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.468 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@537804200 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.472 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@537804200 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.485 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.486 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713911051441 end=1713911051486 duration=45 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:11.486 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:11.487 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.487 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:24:11.487 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:24:11.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:11.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:24:11.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:11.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.523 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:11.523 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:11.523 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:11.523 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:24:11.523 [TThreadPoolServer WorkerProcess-%d] MetaStoreServerUtils - Updating partition stats fast for: tbl3
[INFO ] 2024-04-23 23:24:11.523 [TThreadPoolServer WorkerProcess-%d] MetaStoreServerUtils - Updated size to 0
[DEBUG] 2024-04-23 23:24:11.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:11.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:24:11.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:11.527 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@537804200 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.539 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.540 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911051487 end=1713911051540 duration=53 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:11.540 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:11.540 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.541 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:24:11.541 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:24:11.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:11.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:24:11.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:11.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.546 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:11.546 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:11.546 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:11.547 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:24:11.547 [TThreadPoolServer WorkerProcess-%d] MetaStoreServerUtils - Updating partition stats fast for: tbl3
[INFO ] 2024-04-23 23:24:11.547 [TThreadPoolServer WorkerProcess-%d] MetaStoreServerUtils - Updated size to 0
[DEBUG] 2024-04-23 23:24:11.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:11.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:24:11.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:11.553 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.553 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.555 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.556 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911051540 end=1713911051556 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:11.557 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:11.557 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.557 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:24:11.557 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:24:11.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:11.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:24:11.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:11.561 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.561 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.562 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.562 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:11.562 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:11.562 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:11.562 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:24:11.563 [TThreadPoolServer WorkerProcess-%d] MetaStoreServerUtils - Updating partition stats fast for: tbl3
[INFO ] 2024-04-23 23:24:11.563 [TThreadPoolServer WorkerProcess-%d] MetaStoreServerUtils - Updated size to 0
[DEBUG] 2024-04-23 23:24:11.563 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.563 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:11.563 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:24:11.564 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:11.567 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.570 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.571 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911051557 end=1713911051571 duration=14 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:11.572 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:11.572 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.572 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713911051572 end=1713911051572 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:11.572 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:11.572 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.572 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_table : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:24:11.572 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:24:11.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.573 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:11.574 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:11.574 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.574 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.574 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.583594ms
[DEBUG] 2024-04-23 23:24:11.574 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.574 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.574 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:24:11.576 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.580 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.581 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:11.582 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:24:11.582 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911051572 end=1713911051582 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:11.582 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=10, comments=HMS client
[DEBUG] 2024-04-23 23:24:11.582 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:11.582 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.583 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:24:11.583 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:24:11.583 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:24:11.583 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.583 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.587 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.288736ms + 0.007515ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:11.590 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.835374ms + 0.081462ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:11.592 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.74282ms + 0.464063ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:24:11.594 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.575583ms + 0.201326ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:11.596 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.775621ms + 0.134604ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:24:11.598 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.700404ms + 0.139303ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:11.600 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.687815ms + 0.133962ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:11.602 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.635968ms + 0.133857ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:11.604 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.75548ms + 0.290283ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:11.606 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.909845ms + 0.144427ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:24:11.606 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:11.606 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.606 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 23.033929ms
[DEBUG] 2024-04-23 23:24:11.606 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.607 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.607 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911051582 end=1713911051607 duration=25 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:11.608 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:11.609 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.609 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 alter_table: cat3.db3.tbl3 newtbl=tbl3
[INFO ] 2024-04-23 23:24:11.609 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: cat3.db3.tbl3 newtbl=tbl3	
[DEBUG] 2024-04-23 23:24:11.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.610 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:11.610 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:11.610 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.610 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.610 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.367616ms
[DEBUG] 2024-04-23 23:24:11.610 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:11.610 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:11.610 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:11.610 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:24:11.610 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.611 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:11.611 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:11.611 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.612 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.612 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.198087ms
[DEBUG] 2024-04-23 23:24:11.612 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.612 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.612 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:24:11.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.618 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.620 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:11.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:11.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.106309ms
[DEBUG] 2024-04-23 23:24:11.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:11.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:24:11.622 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:11.625 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.626 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db3
[WARN ] 2024-04-23 23:24:11.626 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:24:11.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:11.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:11.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:11.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:24:11.628 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:11.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:24:11.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:11.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:24:11.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:11.636 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.636 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.637 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.638 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713911051609 end=1713911051638 duration=29 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:11.639 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:24:11.639 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:38079]
[INFO ] 2024-04-23 23:24:11.640 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:38079)
[INFO ] 2024-04-23 23:24:11.640 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:38079) current connections: 5
[DEBUG] 2024-04-23 23:24:11.640 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.641 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911051640 end=1713911051641 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=27 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:11.641 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:11.641 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.641 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 27: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:24:11.641 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 27: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079;create=true
[DEBUG] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:11.642 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079;create=true
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@30f47b58, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@30f47b58, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7ffae522 created in the thread with id: 227
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.643 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.645 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.645 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.645 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:24:11.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:24:11.645 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@30f47b58 from thread id: 227
[DEBUG] 2024-04-23 23:24:11.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:24:11.651 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.651 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.651 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911051641 end=1713911051651 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=27 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:11.651 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:24:11.651 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 4
[DEBUG] 2024-04-23 23:24:11.652 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:11.652 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.652 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:11.652 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 27: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:24:11.652 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:24:11.652 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@30f47b58, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7ffae522 will be shutdown
[DEBUG] 2024-04-23 23:24:11.652 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.652 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 27: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:24:11.652 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:24:11.652 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911051652 end=1713911051652 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=27 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:11.652 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:24:11.652 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:24:11.652 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:24:11.652 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.652 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.652 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:24:11.652 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 27: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:24:11.652 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:24:11.653 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.196438ms + 0.006872ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:11.654 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.618765ms + 0.103901ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:11.655 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.215706ms + 0.45297ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:24:11.656 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.225201ms + 0.179506ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:11.656 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.192257ms + 0.110088ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:24:11.657 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.164627ms + 0.113253ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:11.657 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.161536ms + 0.109218ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:11.657 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.158424ms + 0.108275ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:11.658 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.207182ms + 0.25865ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:11.658 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.172233ms + 0.10972ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:24:11.658 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:11.658 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.658 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 6.155838ms
[DEBUG] 2024-04-23 23:24:11.658 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.658 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.659 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911051652 end=1713911051659 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:11.661 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:24:11.661 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:38079]
[INFO ] 2024-04-23 23:24:11.661 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:38079)
[INFO ] 2024-04-23 23:24:11.661 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:38079) current connections: 5
[DEBUG] 2024-04-23 23:24:11.662 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.662 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911051662 end=1713911051662 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:11.662 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:11.662 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.662 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_table_metas : tbl=cat3.*.*
[INFO ] 2024-04-23 23:24:11.662 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=cat3.*.*	
[INFO ] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079;create=true
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079;create=true
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@56544b32, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:24:11.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:24:11.664 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@56544b32, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@67483e36 created in the thread with id: 228
[DEBUG] 2024-04-23 23:24:11.664 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.664 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.664 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.665 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.665 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.665 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:24:11.665 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:24:11.665 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@56544b32 from thread id: 228
[DEBUG] 2024-04-23 23:24:11.666 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.666 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: cat3, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:24:11.667 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.667 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.668 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911051662 end=1713911051668 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:11.668 [main] PartitionManagementTask - Looking for tables using catalog: cat3 dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:24:11.668 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 4
[DEBUG] 2024-04-23 23:24:11.668 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:11.668 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.668 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:24:11.668 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[INFO ] 2024-04-23 23:24:11.668 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:24:11.668 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@56544b32, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@67483e36 will be shutdown
[DEBUG] 2024-04-23 23:24:11.668 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.668 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:24:11.668 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:24:11.668 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:24:11.668 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:24:11.668 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911051668 end=1713911051668 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:11.668 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:24:11.668 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.668 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.668 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:24:11.668 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:24:11.668 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:24:11.669 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.987344ms + 0.006864ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:11.670 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.61478ms + 0.107741ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:11.671 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.223835ms + 0.443955ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:24:11.672 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.179412ms + 0.160172ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:11.672 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.201637ms + 0.106531ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:24:11.672 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.182298ms + 0.106192ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:11.673 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.178133ms + 0.104613ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:11.673 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.175014ms + 0.103687ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:11.674 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.256768ms + 0.35199ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:11.674 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.156149ms + 0.104961ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:24:11.674 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:11.674 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.674 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 5.851964ms
[DEBUG] 2024-04-23 23:24:11.674 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.674 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.674 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911051668 end=1713911051674 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:11.675 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:11.675 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.675 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:24:11.675 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:24:11.675 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:24:11.675 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.678 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.678 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.678 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713911051675 end=1713911051678 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:11.678 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:11.678 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.678 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_databases: @cat3#
[INFO ] 2024-04-23 23:24:11.678 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @cat3#	
[DEBUG] 2024-04-23 23:24:11.678 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.681 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.681 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.682 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911051678 end=1713911051682 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:11.682 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:11.682 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.682 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_database: db3
[INFO ] 2024-04-23 23:24:11.682 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db3	
[DEBUG] 2024-04-23 23:24:11.682 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.683 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:11.683 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:11.683 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.684 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.684 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.561665ms
[DEBUG] 2024-04-23 23:24:11.684 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911051682 end=1713911051684 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:11.684 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:24:11.684 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:11.684 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.684 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_tables_by_type: db=@hive#db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:11.684 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:11.684 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:11.684 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:11.684 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.685 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:11.685 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.685 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.685 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.776829ms
[DEBUG] 2024-04-23 23:24:11.685 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db3, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:24:11.685 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.688 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:11.688 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.688 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.688 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.994544ms
[DEBUG] 2024-04-23 23:24:11.688 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911051684 end=1713911051688 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:11.688 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:11.688 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.688 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@hive#db3
[INFO ] 2024-04-23 23:24:11.688 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db3	
[DEBUG] 2024-04-23 23:24:11.689 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.691 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:11.691 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.692 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.692 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 3.134318ms
[DEBUG] 2024-04-23 23:24:11.692 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911051688 end=1713911051692 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:11.692 [main] HiveMetaStoreClient - Selecting dropDatabase method for db3 (0 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:24:11.692 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:24:11.692 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:11.692 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.692 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.693 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:11.693 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.693 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.693 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.684211ms
[DEBUG] 2024-04-23 23:24:11.693 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db3, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:24:11.693 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_multi_table : db=db3 tbls=
[INFO ] 2024-04-23 23:24:11.693 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db3 tbls=	
[DEBUG] 2024-04-23 23:24:11.693 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911051692 end=1713911051693 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:11.693 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:11.693 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:11.693 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:24:11.693 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:24:11.693 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:11.693 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.694 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:11.694 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:11.694 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.694 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.11663ms
[DEBUG] 2024-04-23 23:24:11.694 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:24:11.694 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:24:11.694 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.695 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:11.695 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.695 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.597355ms
[DEBUG] 2024-04-23 23:24:11.695 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:24:11.695 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:24:11.695 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.702 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@537804200 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.706 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.706 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:11.706 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:11.706 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.710 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@537804200 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.713 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.713 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:11.713 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:11.713 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.733 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@537804200 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.736 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.736 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:11.736 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:11.736 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:11.736 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:24:11.736 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:11.736 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:11.736 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.737 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:11.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:11.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.970846ms
[DEBUG] 2024-04-23 23:24:11.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:11.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.49866ms
[DEBUG] 2024-04-23 23:24:11.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:11.742 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:11.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:11.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:11.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.932494ms
[DEBUG] 2024-04-23 23:24:11.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:11.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:24:11.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:11.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:11.743 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:11.743 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:11.757 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@537804200 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.761 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:11.765 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:11.765 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:11.765 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.765 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:24:11.765 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.765 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:11.766 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:11.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:11.766 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:13.768 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:24:13.768 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:24:13.768 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:13.768 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:13.770 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:13.771 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:13.771 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:13.771 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.241068ms
[DEBUG] 2024-04-23 23:24:13.771 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:24:13.771 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:24:13.771 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:13.773 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:13.773 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:13.773 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.676867ms
[DEBUG] 2024-04-23 23:24:13.773 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:24:13.773 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:24:13.773 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:13.775 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:13.775 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:13.775 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:13.775 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:13.775 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:13.776 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:13.776 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:13.776 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:13.776 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:13.776 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:13.776 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:13.776 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:13.777 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:13.778 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:13.778 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:13.778 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.135243ms
[DEBUG] 2024-04-23 23:24:13.778 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:13.778 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:13.778 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:13.778 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.491315ms
[DEBUG] 2024-04-23 23:24:13.778 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:13.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:13.779 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:13.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:13.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:13.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.737815ms
[DEBUG] 2024-04-23 23:24:13.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:13.780 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:24:13.780 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:13.780 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:13.780 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:13.780 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:13.781 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:13.781 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:13.781 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:13.781 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:13.782 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:24:13.782 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:13.782 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:13.782 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:13.782 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:13.782 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:15.783 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:24:15.783 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:24:15.783 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:15.783 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:15.786 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:15.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:15.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:15.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.239089ms
[DEBUG] 2024-04-23 23:24:15.787 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:24:15.787 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:24:15.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:15.789 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:15.789 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:15.789 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.727301ms
[DEBUG] 2024-04-23 23:24:15.789 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:24:15.789 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:24:15.789 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:15.793 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:15.793 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:15.793 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:15.793 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:15.795 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:15.796 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:15.796 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:15.796 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:15.798 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:15.799 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:15.799 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:15.799 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:15.801 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:15.801 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:15.801 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:15.801 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 2.798386ms
[DEBUG] 2024-04-23 23:24:15.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:15.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:15.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:15.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 1.667952ms
[DEBUG] 2024-04-23 23:24:15.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:15.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:15.808 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:15.809 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:15.809 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:15.809 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.478434ms
[DEBUG] 2024-04-23 23:24:15.809 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:15.809 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:24:15.809 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:15.809 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:15.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:15.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:15.814 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:15.815 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:15.816 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:15.816 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:15.816 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:24:15.816 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:15.816 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:15.818 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:15.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:15.818 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:17.819 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:24:17.819 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:24:17.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:17.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:17.822 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:17.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:17.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:17.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.298314ms
[DEBUG] 2024-04-23 23:24:17.822 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:24:17.822 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:24:17.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:17.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:17.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:17.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.832134ms
[DEBUG] 2024-04-23 23:24:17.823 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:24:17.823 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:24:17.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:17.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:17.825 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:17.825 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:17.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:17.826 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:17.826 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:17.826 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:17.826 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:17.826 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:17.827 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:17.827 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:17.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:17.827 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:17.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:17.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:17.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.86737ms
[DEBUG] 2024-04-23 23:24:17.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:17.828 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:17.828 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:17.828 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.505694ms
[DEBUG] 2024-04-23 23:24:17.828 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:17.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:17.829 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:17.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:17.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:17.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.796903ms
[DEBUG] 2024-04-23 23:24:17.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:17.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:24:17.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:17.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:17.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:17.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:17.831 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:17.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:17.832 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:17.832 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:17.832 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:24:17.832 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:17.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:17.834 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:17.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:17.834 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:18.397 [HikariPool-7 housekeeper] HikariPool - HikariPool-7 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:24:19.835 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:24:19.835 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:24:19.835 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:19.835 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:19.836 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:24:19.838 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:19.839 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:19.839 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:19.839 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.25747ms
[DEBUG] 2024-04-23 23:24:19.839 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:24:19.839 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:24:19.839 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:19.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:19.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:19.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.761362ms
[DEBUG] 2024-04-23 23:24:19.841 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:24:19.841 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:24:19.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:19.845 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:19.845 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:19.845 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:19.845 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:19.848 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:19.848 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:19.848 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:19.848 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:19.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:19.851 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:19.851 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:19.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:19.853 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:19.854 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:19.854 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:19.854 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 2.924333ms
[DEBUG] 2024-04-23 23:24:19.854 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:19.856 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:19.856 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:19.856 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 1.716262ms
[DEBUG] 2024-04-23 23:24:19.856 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:19.858 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:19.860 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:19.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:19.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:19.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 2.757925ms
[DEBUG] 2024-04-23 23:24:19.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:19.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:24:19.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:19.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:19.863 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:19.864 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:19.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:19.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:19.867 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:19.868 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:19.868 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:24:19.868 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:19.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:19.869 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:19.869 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:19.870 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:21.870 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:24:21.871 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:24:21.871 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:21.871 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:21.874 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:21.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:21.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:21.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.594577ms
[DEBUG] 2024-04-23 23:24:21.874 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:24:21.875 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:24:21.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:21.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:21.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:21.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.800569ms
[DEBUG] 2024-04-23 23:24:21.875 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:24:21.875 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:24:21.876 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:21.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:21.877 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:21.877 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:21.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:21.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:21.878 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:21.878 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:21.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:21.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:21.879 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:21.879 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:21.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:21.879 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:21.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:21.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:21.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.805368ms
[DEBUG] 2024-04-23 23:24:21.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:21.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:21.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:21.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.430359ms
[DEBUG] 2024-04-23 23:24:21.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:21.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:21.881 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:21.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:21.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:21.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.730376ms
[DEBUG] 2024-04-23 23:24:21.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:21.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:24:21.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:21.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:21.882 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:21.882 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:21.883 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:21.883 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:21.883 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:21.883 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:21.883 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:24:21.883 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:21.883 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:21.884 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:21.884 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:21.884 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:23.885 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:24:23.885 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:24:23.885 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:23.885 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:23.888 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:23.888 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:23.888 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:23.888 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.217696ms
[DEBUG] 2024-04-23 23:24:23.889 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:24:23.889 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:24:23.889 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:23.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:23.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:23.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.467402ms
[DEBUG] 2024-04-23 23:24:23.890 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:24:23.890 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:24:23.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:23.891 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:23.892 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:23.892 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:23.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:23.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:23.892 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:23.892 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:23.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:23.893 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:23.893 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:23.893 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:23.893 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:23.894 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:23.894 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:23.894 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:23.894 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.765441ms
[DEBUG] 2024-04-23 23:24:23.894 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:23.895 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:23.895 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:23.895 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.458977ms
[DEBUG] 2024-04-23 23:24:23.895 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:23.895 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:23.896 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:23.896 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:23.896 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:23.896 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.772149ms
[DEBUG] 2024-04-23 23:24:23.896 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:23.896 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:24:23.896 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:23.896 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:23.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:23.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:23.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:23.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:23.898 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:23.898 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:23.898 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:24:23.898 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:23.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:23.899 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:23.899 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:23.900 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:25.900 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:24:25.900 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:24:25.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:25.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:25.903 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:25.904 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:25.904 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:25.904 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.278447ms
[DEBUG] 2024-04-23 23:24:25.904 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:24:25.904 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:24:25.904 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:25.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:25.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:25.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.184827ms
[DEBUG] 2024-04-23 23:24:25.905 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:24:25.905 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:24:25.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:25.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:25.907 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:25.907 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:25.907 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:25.907 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:25.907 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:25.907 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:25.907 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:25.908 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:25.908 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:25.908 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:25.908 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:25.909 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:25.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:25.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:25.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.759813ms
[DEBUG] 2024-04-23 23:24:25.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:25.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:25.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:25.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.433243ms
[DEBUG] 2024-04-23 23:24:25.910 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:25.910 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:25.911 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:25.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:25.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:25.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.718251ms
[DEBUG] 2024-04-23 23:24:25.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:25.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:24:25.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:25.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:25.912 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:25.912 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:25.912 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:25.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:25.913 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:25.913 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:25.913 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:24:25.913 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:25.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:25.914 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:25.914 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:25.914 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:26.070 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:24:26.263 [HikariPool-6 housekeeper] HikariPool - HikariPool-6 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:24:27.914 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:24:27.915 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:24:27.915 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:27.915 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:27.918 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:27.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:27.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:27.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.694277ms
[DEBUG] 2024-04-23 23:24:27.919 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:24:27.919 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:24:27.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:27.920 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:27.920 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:27.920 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.555204ms
[DEBUG] 2024-04-23 23:24:27.920 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:24:27.920 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:24:27.920 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:27.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:27.921 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:27.921 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:27.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:27.922 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:27.922 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:27.922 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:27.922 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:27.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:27.923 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:27.923 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:27.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:27.923 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:27.924 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:27.924 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:27.924 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.929806ms
[DEBUG] 2024-04-23 23:24:27.924 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:27.924 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:27.924 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:27.924 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.516327ms
[DEBUG] 2024-04-23 23:24:27.924 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:27.925 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:27.925 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:27.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:27.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:27.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.77615ms
[DEBUG] 2024-04-23 23:24:27.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:27.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:24:27.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:27.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:27.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:27.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:27.928 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:27.928 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:27.928 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:27.928 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:27.928 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:24:27.928 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:27.928 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:27.929 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:27.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:27.930 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:29.930 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:24:29.930 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:24:29.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:29.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:29.933 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:29.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:29.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:29.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.333973ms
[DEBUG] 2024-04-23 23:24:29.934 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:24:29.934 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:24:29.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:29.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:29.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:29.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.107149ms
[DEBUG] 2024-04-23 23:24:29.935 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:24:29.935 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:24:29.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:29.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:29.937 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:29.937 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:29.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:29.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:29.938 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:29.938 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:29.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:29.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:29.939 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:29.939 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:29.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:29.939 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:29.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:29.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:29.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.909436ms
[DEBUG] 2024-04-23 23:24:29.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:29.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:29.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:29.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.473485ms
[DEBUG] 2024-04-23 23:24:29.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:29.941 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:29.941 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:29.942 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:29.942 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:29.942 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.783695ms
[DEBUG] 2024-04-23 23:24:29.942 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:29.942 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:24:29.942 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:29.942 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:29.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:29.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:29.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:29.944 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:29.944 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:29.944 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:29.944 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:24:29.944 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:29.944 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:29.944 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:29.945 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:29.945 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:30.690 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:24:30.693 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:24:31.945 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:24:31.946 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:24:31.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:31.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:31.948 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:31.949 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:31.949 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:31.949 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.241699ms
[DEBUG] 2024-04-23 23:24:31.949 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:24:31.949 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:24:31.949 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:31.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:31.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:31.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.480793ms
[DEBUG] 2024-04-23 23:24:31.950 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:24:31.950 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:24:31.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:31.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:31.951 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:31.951 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:31.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:31.952 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:31.952 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:31.952 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:31.952 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:31.952 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:31.953 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:31.953 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:31.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:31.953 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:31.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:31.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:31.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.739254ms
[DEBUG] 2024-04-23 23:24:31.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:31.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:31.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:31.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.436815ms
[DEBUG] 2024-04-23 23:24:31.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:31.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:31.955 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:31.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:31.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:31.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.719622ms
[DEBUG] 2024-04-23 23:24:31.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:31.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:24:31.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:31.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:31.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:31.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:31.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:31.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:31.957 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:31.957 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:31.957 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:24:31.957 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:31.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:31.958 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@617848492 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:31.958 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:31.958 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:31.958 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911051693 end=1713911071958 duration=20265 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=-1 error=true>
]]></system-out>
  </testcase>
  <testcase name="testPartitionDiscoveryNonDefaultCatalog" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="22.022">
    <error message="javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore&#10;NestedThrowables:&#10;java.sql.BatchUpdateException: DELETE on table &apos;DBS&apos; caused a violation of foreign key constraint &apos;TBLS_FK1&apos; for key (3).  The statement has been rolled back." type="org.apache.hadoop.hive.metastore.api.MetaException"><![CDATA[org.apache.hadoop.hive.metastore.api.MetaException: 
javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
NestedThrowables:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.tearDown(TestPartitionManagement.java:93)
]]></error>
  </testcase>
  <testcase name="testPartitionDiscoveryTransactionalTable" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="22.52">
    <error message="javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore&#10;NestedThrowables:&#10;java.sql.BatchUpdateException: DELETE on table &apos;DBS&apos; caused a violation of foreign key constraint &apos;TBLS_FK1&apos; for key (2).  The statement has been rolled back." type="org.apache.hadoop.hive.metastore.api.MetaException"><![CDATA[org.apache.hadoop.hive.metastore.api.MetaException: 
javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
NestedThrowables:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.tearDown(TestPartitionManagement.java:100)
]]></error>
    <system-out><![CDATA[[INFO ] 2024-04-23 23:24:31.959 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:24:31.959 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:24:31.959 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:24:31.959 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:24:31.967 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:24:31.967 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:24:31.967 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:24:31.967 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:24:31.968 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:24:31.999 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111;create=true
[INFO ] 2024-04-23 23:24:32.370 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:24:32.371 [MetaStoreThread-38111] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:24:32.371 [MetaStoreThread-38111] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:24:32.371 [MetaStoreThread-38111] HMSHandler - 29: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:24:32.371 [MetaStoreThread-38111] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:24:32.371 [MetaStoreThread-38111] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:32.371 [MetaStoreThread-38111] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:32.371 [MetaStoreThread-38111] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111;create=true
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111;create=true
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38079;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111;create=true
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 120
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:24:32.372 [MetaStoreThread-38111] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:32.373 [MetaStoreThread-38111] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:24:32.373 [MetaStoreThread-38111] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:24:32.374 [MetaStoreThread-38111] HikariConfig - HikariPool-9 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:24:32.374 [MetaStoreThread-38111] HikariConfig - HikariPool-9 - configuration:
[DEBUG] 2024-04-23 23:24:32.374 [MetaStoreThread-38111] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:24:32.374 [MetaStoreThread-38111] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:24:32.374 [MetaStoreThread-38111] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:24:32.374 [MetaStoreThread-38111] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:24:32.374 [MetaStoreThread-38111] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:24:32.374 [MetaStoreThread-38111] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:24:32.374 [MetaStoreThread-38111] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:24:32.374 [MetaStoreThread-38111] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:24:32.374 [MetaStoreThread-38111] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:24:32.374 [MetaStoreThread-38111] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:24:32.374 [MetaStoreThread-38111] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:24:32.374 [MetaStoreThread-38111] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:24:32.374 [MetaStoreThread-38111] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111;create=true"
[DEBUG] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariConfig - poolName........................"HikariPool-9"
[DEBUG] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:24:32.375 [MetaStoreThread-38111] HikariDataSource - HikariPool-9 - Starting...
[INFO ] 2024-04-23 23:24:32.376 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:24:32.377 [MetaStoreThread-38111] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:32.377 [MetaStoreThread-38111] HikariDataSource - HikariPool-9 - Start completed.
[DEBUG] 2024-04-23 23:24:32.477 [HikariPool-9 housekeeper] HikariPool - HikariPool-9 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:24:32.478 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@863326102 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:32.480 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1917339053 (XID = 1157), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:32.481 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1131417767 (XID = 1159), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:32.482 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@308787938 (XID = 1161), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:32.483 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@201366840 (XID = 1163), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:32.485 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@371803188 (XID = 1165), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:32.487 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1665782497 (XID = 1167), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:32.488 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@879418012 (XID = 1169), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:32.489 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@826724142 (XID = 1171), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:32.489 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:24:32.618 [MetaStoreThread-38111] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:24:32.618 [MetaStoreThread-38111] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@71f939b4, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:24:32.619 [MetaStoreThread-38111] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:24:32.619 [MetaStoreThread-38111] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@71f939b4, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@150209bd created in the thread with id: 231
[DEBUG] 2024-04-23 23:24:32.619 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:32.619 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:32.619 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:32.688 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:24:32.688 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:24:32.688 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:24:32.688 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6192c463, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@767b585c will be shutdown
[DEBUG] 2024-04-23 23:24:32.688 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 26: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:24:32.688 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:24:32.759 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:32.834 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@863326102 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:32.851 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@863326102 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:32.887 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@863326102 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:32.902 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@863326102 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:32.907 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@863326102 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.010 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@863326102 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.034 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@863326102 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.041 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@863326102 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.046 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@863326102 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.048 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.049 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.049 [MetaStoreThread-38111] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:24:33.049 [MetaStoreThread-38111] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:24:33.049 [MetaStoreThread-38111] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@71f939b4 from thread id: 231
[DEBUG] 2024-04-23 23:24:33.049 [MetaStoreThread-38111] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:24:33.049 [MetaStoreThread-38111] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.053 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.056 [MetaStoreThread-38111] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.056 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:33.057 [MetaStoreThread-38111] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:24:33.057 [MetaStoreThread-38111] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.057 [MetaStoreThread-38111] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.058 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.058 [MetaStoreThread-38111] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.058 [MetaStoreThread-38111] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.061 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.061 [MetaStoreThread-38111] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.063 [MetaStoreThread-38111] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.063 [MetaStoreThread-38111] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.064 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.064 [MetaStoreThread-38111] ObjectStore - db details for db default retrieved using SQL in 2.319417ms
[DEBUG] 2024-04-23 23:24:33.064 [MetaStoreThread-38111] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:24:33.064 [MetaStoreThread-38111] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:24:33.064 [MetaStoreThread-38111] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.069 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.072 [MetaStoreThread-38111] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.073 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.076 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:33.076 [MetaStoreThread-38111] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:24:33.076 [MetaStoreThread-38111] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.076 [MetaStoreThread-38111] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.080 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.083 [MetaStoreThread-38111] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.085 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@863326102 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.087 [MetaStoreThread-38111] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.087 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:33.087 [MetaStoreThread-38111] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:24:33.088 [MetaStoreThread-38111] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.088 [MetaStoreThread-38111] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.088 [MetaStoreThread-38111] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.088 [MetaStoreThread-38111] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.089 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:33.089 [MetaStoreThread-38111] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:24:33.089 [MetaStoreThread-38111] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.089 [MetaStoreThread-38111] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.090 [MetaStoreThread-38111] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.090 [MetaStoreThread-38111] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.093 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@863326102 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.096 [MetaStoreThread-38111] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.098 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@863326102 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.100 [MetaStoreThread-38111] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.100 [MetaStoreThread-38111] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:33.101 [MetaStoreThread-38111] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:24:33.101 [MetaStoreThread-38111] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:24:33.101 [MetaStoreThread-38111] PerfLogger - </PERFLOG method=init start=1713911072371 end=1713911073101 duration=730 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=29 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:33.101 [MetaStoreThread-38111] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:24:33.101 [MetaStoreThread-38111] HiveMetaStore - Started the new metaserver on port [38111]...
[INFO ] 2024-04-23 23:24:33.101 [MetaStoreThread-38111] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:24:33.101 [MetaStoreThread-38111] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:24:33.101 [MetaStoreThread-38111] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:24:33.101 [MetaStoreThread-38111] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:24:33.101 [MetaStoreThread-38111] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:24:33.101 [MetaStoreThread-38111] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:24:33.101 [MetaStoreThread-38111] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:24:33.101 [MetaStoreThread-38111] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:24:33.101 [MetaStoreThread-38111] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:24:33.101 [MetaStoreThread-38111] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:24:33.101 [MetaStoreThread-38111] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:24:33.101 [MetaStoreThread-38111] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:24:33.101 [MetaStoreThread-38111] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:24:33.101 [MetaStoreThread-38111] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:24:33.101 [MetaStoreThread-38111] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:24:33.101 [MetaStoreThread-38111] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:24:33.372 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:24:33.373 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 30: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:24:33.373 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:24:33.385 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38111) is created
[INFO ] 2024-04-23 23:24:33.385 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 38111 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38111 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111;create=true
[INFO ] 2024-04-23 23:24:33.386 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:24:33.394 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:24:33.394 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:38111]
[INFO ] 2024-04-23 23:24:33.394 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:38111)
[INFO ] 2024-04-23 23:24:33.395 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:38111) current connections: 5
[DEBUG] 2024-04-23 23:24:33.396 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.396 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911073396 end=1713911073396 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.397 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.397 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.397 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 create_database: Database(name:db6, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:24:33.397 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db6, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:24:33.398 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111;create=true
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111;create=true
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@e84454c, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:24:33.399 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:24:33.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@e84454c, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4229292f created in the thread with id: 248
[DEBUG] 2024-04-23 23:24:33.400 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.400 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.400 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.401 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.402 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.402 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:24:33.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:24:33.402 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@e84454c from thread id: 248
[DEBUG] 2024-04-23 23:24:33.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.403 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.850594ms
[DEBUG] 2024-04-23 23:24:33.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db6, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:24:33.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:24:33.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.404 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.404 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:24:33.404 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:33.404 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:33.404 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:33.404 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[WARN ] 2024-04-23 23:24:33.404 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db for database db6. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:24:33.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.406 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.406 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713911073397 end=1713911073406 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.407 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.407 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.407 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 create_table_req: Table(tableName:tbl6, dbName:db6, owner:alex, createTime:1713911073, lastAccessTime:1713911073, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:do, type:double, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:bo, type:boolean, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:24:33.407 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl6, dbName:db6, owner:alex, createTime:1713911073, lastAccessTime:1713911073, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:do, type:double, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:bo, type:boolean, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:24:33.407 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.410 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:33.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.410 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.405735ms
[DEBUG] 2024-04-23 23:24:33.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:33.414 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.415 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.415 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:33.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.936053ms
[DEBUG] 2024-04-23 23:24:33.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:33.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:33.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:33.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.416 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:33.416 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:33.417 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:33.417 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:24:33.417 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38111/db6.db/tbl6
[DEBUG] 2024-04-23 23:24:33.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:33.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:33.427 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@863326102 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.431 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@863326102 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.435 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@863326102 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.439 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@863326102 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.454 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.455 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713911073407 end=1713911073454 duration=47 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.455 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.455 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.455 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 add_partition : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:24:33.455 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:24:33.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:33.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:33.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:33.485 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.485 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.489 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.489 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:33.490 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:33.490 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:33.490 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:24:33.490 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38111/db6.db/tbl6/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:24:33.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:33.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:33.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:33.498 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@863326102 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.509 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.510 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911073455 end=1713911073510 duration=55 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.510 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.511 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.511 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 add_partition : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:24:33.511 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:24:33.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:33.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:33.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:33.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.516 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:33.516 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:33.516 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:33.516 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:24:33.516 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38111/db6.db/tbl6/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:24:33.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:33.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:33.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:33.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.526 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.528 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911073511 end=1713911073528 duration=17 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.528 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.528 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.528 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 add_partition : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:24:33.528 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:24:33.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:33.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:33.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:33.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.534 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.534 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:33.534 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:33.534 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:33.534 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:24:33.534 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38111/db6.db/tbl6/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:24:33.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:33.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:33.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:33.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.544 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.546 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.547 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911073528 end=1713911073547 duration=19 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.547 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.547 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.547 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713911073547 end=1713911073547 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.548 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.548 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.548 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_table : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:24:33.548 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:24:33.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.549 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:33.549 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.549 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.549 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.549 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.25514ms
[DEBUG] 2024-04-23 23:24:33.549 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.549 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.549 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:33.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.556 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:33.557 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:24:33.557 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911073548 end=1713911073557 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.557 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=9, comments=HMS client
[DEBUG] 2024-04-23 23:24:33.557 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.557 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.557 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_partitions : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:24:33.557 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:24:33.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:24:33.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.562 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.712239ms + 0.009884ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:33.567 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.082039ms + 0.119381ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:33.569 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.951359ms + 0.380203ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:24:33.572 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.770355ms + 0.205213ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:33.573 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.695566ms + 0.131936ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:24:33.575 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.716357ms + 0.141874ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:33.577 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.637677ms + 0.173674ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:33.579 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.532651ms + 0.134593ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:33.581 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.398165ms + 0.359114ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:33.582 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.433862ms + 0.130922ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:24:33.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 24.790323ms
[DEBUG] 2024-04-23 23:24:33.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.583 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.583 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911073557 end=1713911073583 duration=26 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.593 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.593 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.593 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 alter_table: hive.db6.tbl6 newtbl=tbl6
[INFO ] 2024-04-23 23:24:33.593 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db6.tbl6 newtbl=tbl6	
[DEBUG] 2024-04-23 23:24:33.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.594 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:33.594 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.594 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.594 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.594 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.156782ms
[DEBUG] 2024-04-23 23:24:33.594 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:33.594 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:33.594 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:33.594 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:24:33.594 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.595 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:33.595 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.595 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.595 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.595 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.001618ms
[DEBUG] 2024-04-23 23:24:33.596 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.596 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.596 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:33.597 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.601 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.602 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.602 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.602 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:33.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.920562ms
[DEBUG] 2024-04-23 23:24:33.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:33.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:33.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:33.606 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.606 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db6
[WARN ] 2024-04-23 23:24:33.606 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:24:33.606 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.606 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:33.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:33.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:33.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:33.608 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:33.610 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:24:33.610 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:33.610 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:24:33.613 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:33.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.616 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.617 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713911073593 end=1713911073617 duration=24 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:33.618 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:24:33.618 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:38111]
[INFO ] 2024-04-23 23:24:33.618 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:38111)
[INFO ] 2024-04-23 23:24:33.618 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:38111) current connections: 6
[DEBUG] 2024-04-23 23:24:33.619 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.619 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911073619 end=1713911073619 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=32 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.619 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.619 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.619 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 32: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:24:33.619 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 32: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111;create=true
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111;create=true
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@13b0d065, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@13b0d065, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@66b9e860 created in the thread with id: 261
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.620 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.621 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.622 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.622 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.622 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:24:33.622 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:24:33.622 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@13b0d065 from thread id: 261
[DEBUG] 2024-04-23 23:24:33.622 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.622 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:24:33.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.629 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.630 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:33.630 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.630 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.631 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.240177ms
[DEBUG] 2024-04-23 23:24:33.631 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911073619 end=1713911073631 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=32 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:33.631 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 1
[DEBUG] 2024-04-23 23:24:33.632 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.632 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.632 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 32: source:127.0.0.1 get_database: db6
[INFO ] 2024-04-23 23:24:33.632 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db6	
[DEBUG] 2024-04-23 23:24:33.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.632 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:33.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.633 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.957863ms
[DEBUG] 2024-04-23 23:24:33.633 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911073632 end=1713911073633 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=32 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.633 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:24:33.633 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.633 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.633 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 32: source:127.0.0.1 get_table : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:24:33.634 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:24:33.634 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.634 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:33.634 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.634 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.635 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.635 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.073194ms
[DEBUG] 2024-04-23 23:24:33.635 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.635 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.635 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:33.637 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.642 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.644 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:33.645 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:24:33.645 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911073633 end=1713911073645 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=32 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.646 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=13, comments=HMS client
[INFO ] 2024-04-23 23:24:33.646 [main] PartitionManagementTask - Found 1 candidate tables for partition discovery
[INFO ] 2024-04-23 23:24:33.648 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:24:33.648 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:24:33.648 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:24:33.648 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:24:33.648 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:24:33.648 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:24:33.648 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:24:33.649 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:24:33.650 [main] PartitionManagementTask - Running partition discovery for table hive.db6.tbl6 retentionPeriod: -1s
[INFO ] 2024-04-23 23:24:33.652 [PartitionDiscoveryTask-0] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:24:33.652 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:38111]
[INFO ] 2024-04-23 23:24:33.652 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:38111)
[INFO ] 2024-04-23 23:24:33.652 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:38111) current connections: 7
[DEBUG] 2024-04-23 23:24:33.653 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.653 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911073653 end=1713911073653 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.653 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.653 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.653 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_database: db6
[INFO ] 2024-04-23 23:24:33.653 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db6	
[INFO ] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111;create=true
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111;create=true
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3acc93e1, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3acc93e1, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@46eb459 created in the thread with id: 263
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.654 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.655 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.656 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.656 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:24:33.656 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:24:33.656 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3acc93e1 from thread id: 263
[DEBUG] 2024-04-23 23:24:33.656 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.657 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:33.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.657 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.721523ms
[DEBUG] 2024-04-23 23:24:33.657 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911073653 end=1713911073657 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.657 [PartitionDiscoveryTask-0] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=4, comments=HMS client
[INFO ] 2024-04-23 23:24:33.657 [PartitionDiscoveryTask-0] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:24:33.657 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:38111]
[INFO ] 2024-04-23 23:24:33.657 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:38111)
[INFO ] 2024-04-23 23:24:33.658 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:38111) current connections: 8
[DEBUG] 2024-04-23 23:24:33.658 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.658 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911073658 end=1713911073658 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=34 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.658 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.658 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 34: source:127.0.0.1 get_table : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db6.tbl6	
[INFO ] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 34: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111;create=true
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111;create=true
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6251e2c7, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:24:33.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:24:33.660 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6251e2c7, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6fd48d6f created in the thread with id: 264
[DEBUG] 2024-04-23 23:24:33.660 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.660 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.660 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.661 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.661 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.661 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:24:33.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:24:33.661 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6251e2c7 from thread id: 264
[DEBUG] 2024-04-23 23:24:33.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.662 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:33.662 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.662 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.662 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.662 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.701521ms
[DEBUG] 2024-04-23 23:24:33.662 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.662 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.662 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:33.664 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.667 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.668 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:33.668 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:24:33.668 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911073658 end=1713911073668 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=34 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.669 [PartitionDiscoveryTask-0] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=11, comments=HMS client
[DEBUG] 2024-04-23 23:24:33.672 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.674 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partition_names from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.674 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 34: source:127.0.0.1 get_partition_names : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:24:33.674 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partition_names : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:24:33.674 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.674 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionNames
[DEBUG] 2024-04-23 23:24:33.679 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.679 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.680 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partition_names start=1713911073674 end=1713911073680 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=34 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.683 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.685 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions_by_names_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.685 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 34: source:127.0.0.1 get_partitions_by_names : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:24:33.685 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions_by_names : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:24:33.685 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.685 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.689 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.124007ms + 0.007428ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  and "PARTITIONS"."PART_NAME" in (?,?,?)]
[DEBUG] 2024-04-23 23:24:33.693 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.39903ms + 0.088384ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (1,2,3) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:33.695 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.892514ms + 0.308861ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (1,2,3) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:24:33.697 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.798212ms + 0.205792ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (1,2,3) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:33.698 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.398866ms + 0.130978ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:24:33.698 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.376023ms + 0.128458ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:33.699 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.376732ms + 0.125441ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:33.699 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.288027ms + 0.120999ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:33.700 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.37649ms + 0.277526ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:33.700 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.357167ms + 0.123601ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:24:33.700 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.700 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.700 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 15.004248ms
[DEBUG] 2024-04-23 23:24:33.700 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.700 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:33.700 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:33.703 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:33.705 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:33.705 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:24:33.705 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.706 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.709 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions_by_names_req start=1713911073685 end=1713911073709 duration=24 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=34 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.711 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - Using multi-threaded version of MSCK-GetPaths with number of threads 15
[DEBUG] 2024-04-23 23:24:33.715 [PartitionDiscoveryTask-0] MetaStoreServerUtils - tablePath:file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38111/db6.db/tbl6, partCols: [state, dt]
[DEBUG] 2024-04-23 23:24:33.715 [PartitionDiscoveryTask-0] MetaStoreServerUtils - Converting '2018-12-01' to type: 'date'.
[DEBUG] 2024-04-23 23:24:33.715 [PartitionDiscoveryTask-0] MetaStoreServerUtils - currPath=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38111/db6.db/tbl6/state=WA
[DEBUG] 2024-04-23 23:24:33.715 [PartitionDiscoveryTask-0] MetaStoreServerUtils - Converting 'WA' to type: 'string'.
[DEBUG] 2024-04-23 23:24:33.715 [PartitionDiscoveryTask-0] MetaStoreServerUtils - currPath=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38111/db6.db/tbl6
[DEBUG] 2024-04-23 23:24:33.715 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - PartitionName: state=WA/dt=2018-12-01
[DEBUG] 2024-04-23 23:24:33.716 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - Max writeId 0, max txnId 0 found in partition file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38111/db6.db/tbl6/state=WA/dt=2018-12-01
[DEBUG] 2024-04-23 23:24:33.716 [PartitionDiscoveryTask-0] MetaStoreServerUtils - tablePath:file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38111/db6.db/tbl6, partCols: [dt, state]
[DEBUG] 2024-04-23 23:24:33.716 [PartitionDiscoveryTask-0] MetaStoreServerUtils - Converting '2018-12-02' to type: 'date'.
[DEBUG] 2024-04-23 23:24:33.716 [PartitionDiscoveryTask-0] MetaStoreServerUtils - currPath=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38111/db6.db/tbl6/state=UT
[DEBUG] 2024-04-23 23:24:33.716 [PartitionDiscoveryTask-0] MetaStoreServerUtils - Converting 'UT' to type: 'string'.
[DEBUG] 2024-04-23 23:24:33.716 [PartitionDiscoveryTask-0] MetaStoreServerUtils - currPath=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38111/db6.db/tbl6
[DEBUG] 2024-04-23 23:24:33.716 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - PartitionName: state=UT/dt=2018-12-02
[DEBUG] 2024-04-23 23:24:33.716 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - Max writeId 0, max txnId 0 found in partition file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38111/db6.db/tbl6/state=UT/dt=2018-12-02
[DEBUG] 2024-04-23 23:24:33.716 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - Number of partitions not in metastore : 2
[INFO ] 2024-04-23 23:24:33.716 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - Number of partitionsNotInMs=[tbl6:state=UT/dt=2018-12-02, tbl6:state=WA/dt=2018-12-01], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
[INFO ] 2024-04-23 23:24:33.716 [PartitionDiscoveryTask-0] Msck - hive.db6.tbl6 - #partsNotInMs: 2 #partsNotInFs: 0 #expiredPartitions: 0 lockRequired: true (R: true A: true D: true)
[DEBUG] 2024-04-23 23:24:33.719 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.721 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.721 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:33.721 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.722 [TThreadPoolServer WorkerProcess-%d] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:24:33.725 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:24:33.728 [TThreadPoolServer WorkerProcess-%d] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:24:33.729 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:24:33.737 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:24:33.739 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:24:33.739 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:33.740 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.740 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=open_txns start=1713911073721 end=1713911073740 duration=19 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=34 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:33.744 [PartitionDiscoveryTask-0] Msck - Created lock(X) request with info - user: alex txnId: 1 agentInfo: PartitionDiscoveryTask-0 dbName: db6 tableName: tbl6
[DEBUG] 2024-04-23 23:24:33.747 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.748 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=lock from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.755 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Executing a batch of <INSERT INTO "HIVE_LOCKS" ( "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_LAST_HEARTBEAT", "HL_USER", "HL_HOST", "HL_AGENT_INFO") VALUES (?, ?, ?, ?, ?, ?, ?, ?, 0, ?, ?, ?)> queries. Batch size: 1
[DEBUG] 2024-04-23 23:24:33.756 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute query <SELECT "NL_NEXT" FROM "NEXT_LOCK_ID">
[DEBUG] 2024-04-23 23:24:33.757 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute updates in batch: <UPDATE "NEXT_LOCK_ID" SET "NL_NEXT" = 2>, and <UPDATE "HIVE_LOCKS" SET "HL_LOCK_EXT_ID" = 1 WHERE "HL_LOCK_EXT_ID" = 7158668666527549226>
[DEBUG] 2024-04-23 23:24:33.763 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 23:24:33.764 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Found 1 locks for extLockId=1. Locks: [lockid:1 intLockId:1 txnid:1 db:db6 table:tbl6 partition:null state:WAITING type:EXCLUSIVE]
[DEBUG] 2024-04-23 23:24:33.764 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute query <(select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='r' AND "EX"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NOT NULL AND "REQ"."HL_TABLE" IS NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NULL AND "EX"."HL_LOCK_TYPE"='r' AND "REQ"."HL_TABLE" IS NOT NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='w' AND "EX"."HL_LOCK_TYPE" IN ('x','e') fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='x' AND "EX"."HL_LOCK_TYPE"!='r' fetch first 1 rows only)>
[DEBUG] 2024-04-23 23:24:33.787 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LOCK_STATE" = 'a', "HL_LAST_HEARTBEAT" = 0,"HL_ACQUIRED_AT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_BLOCKEDBY_EXT_ID"=NULL,"HL_BLOCKEDBY_INT_ID"=NULL WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 23:24:33.791 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Successfully acquired locks: [lockid:1 intLockId:1 txnid:1 db:db6 table:tbl6 partition:null state:WAITING type:EXCLUSIVE]
[DEBUG] 2024-04-23 23:24:33.791 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.791 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=lock start=1713911073748 end=1713911073791 duration=43 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=34 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:33.792 [PartitionDiscoveryTask-0] Msck - Acquired lock(X) on hive.db6.tbl6. LockId: 1
[DEBUG] 2024-04-23 23:24:33.796 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.798 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_max_allocated_table_write_id from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.800 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute query <SELECT "NWI_NEXT" FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE" = 'db6' AND "NWI_TABLE" = 'tbl6'>
[DEBUG] 2024-04-23 23:24:33.801 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:33.801 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.801 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_max_allocated_table_write_id start=1713911073798 end=1713911073801 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=34 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.804 [PartitionDiscoveryTask-0] Msck - Repair: Added partition to metastore tbl6:state=UT/dt=2018-12-02
[DEBUG] 2024-04-23 23:24:33.804 [PartitionDiscoveryTask-0] Msck - Repair: Added partition to metastore tbl6:state=WA/dt=2018-12-01
[DEBUG] 2024-04-23 23:24:33.806 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.808 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partitions_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.810 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 34: add_partitions
[INFO ] 2024-04-23 23:24:33.810 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=add_partitions	
[DEBUG] 2024-04-23 23:24:33.810 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.811 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:33.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.812 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 2.072405ms
[DEBUG] 2024-04-23 23:24:33.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:33.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:33.815 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:33.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.820 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.821 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:33.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.482965ms
[DEBUG] 2024-04-23 23:24:33.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.825 [HMSHandler #1] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.lambda$createPartitionFolders$14(HMSHandler.java:4385)
[DEBUG] 2024-04-23 23:24:33.825 [HMSHandler #0] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.lambda$createPartitionFolders$14(HMSHandler.java:4385)
[DEBUG] 2024-04-23 23:24:33.826 [HMSHandler #1] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:33.826 [HMSHandler #1] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:33.826 [HMSHandler #0] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:33.826 [HMSHandler #0] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:33.826 [HMSHandler #0] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:33.826 [HMSHandler #0] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:24:33.826 [HMSHandler #1] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:33.826 [HMSHandler #1] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:24:33.826 [HMSHandler #0] MetaStoreServerUtils - Updating partition stats fast for: tbl6
[INFO ] 2024-04-23 23:24:33.826 [HMSHandler #1] MetaStoreServerUtils - Updating partition stats fast for: tbl6
[INFO ] 2024-04-23 23:24:33.827 [HMSHandler #0] MetaStoreServerUtils - Updated size to 0
[INFO ] 2024-04-23 23:24:33.827 [HMSHandler #1] MetaStoreServerUtils - Updated size to 0
[DEBUG] 2024-04-23 23:24:33.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:33.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:33.828 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:33.837 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.837 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.840 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.842 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partitions_req start=1713911073808 end=1713911073842 duration=34 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=34 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:33.843 [PartitionDiscoveryTask-0] Msck - Tables not in metastore: []
Tables missing on filesystem: []
Partitions not in metastore: [tbl6:state=UT/dt=2018-12-02, tbl6:state=WA/dt=2018-12-01]
Partitions missing from filesystem: []
Expired partitions: []

[INFO ] 2024-04-23 23:24:33.843 [PartitionDiscoveryTask-0] Msck - txnId: 1 succeeded. Committing..
[DEBUG] 2024-04-23 23:24:33.846 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.848 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.851 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:24:33.853 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
[DEBUG] 2024-04-23 23:24:33.853 [TThreadPoolServer WorkerProcess-%d] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1>
[DEBUG] 2024-04-23 23:24:33.853 [TThreadPoolServer WorkerProcess-%d] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 1>
[DEBUG] 2024-04-23 23:24:33.854 [TThreadPoolServer WorkerProcess-%d] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 1>
[DEBUG] 2024-04-23 23:24:33.854 [TThreadPoolServer WorkerProcess-%d] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:24:33.860 [TThreadPoolServer WorkerProcess-%d] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:24:33.860 [TThreadPoolServer WorkerProcess-%d] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:24:33.862 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:24:33.863 [TThreadPoolServer WorkerProcess-%d] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:1
[DEBUG] 2024-04-23 23:24:33.864 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:33.864 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.864 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:33.864 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.864 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=commit_txn start=1713911073848 end=1713911073864 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=34 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:33.865 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Closed a connection to metastore, current connections: 7
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 34: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[INFO ] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6251e2c7, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6fd48d6f will be shutdown
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3acc93e1, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@46eb459 will be shutdown
[INFO ] 2024-04-23 23:24:33.865 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 6
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911073865 end=1713911073865 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 34: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911073865 end=1713911073865 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=34 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_partitions : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 34: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 32: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:24:33.865 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Closed a connection to metastore, current connections: 5
[INFO ] 2024-04-23 23:24:33.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@13b0d065, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@66b9e860 will be shutdown
[DEBUG] 2024-04-23 23:24:33.866 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 32: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:24:33.866 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:24:33.866 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911073865 end=1713911073866 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=32 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.866 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:24:33.866 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 32: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:24:33.866 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:24:33.867 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.441818ms + 0.006695ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:33.872 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.74748ms + 0.17292ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,4,5,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:33.875 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.265922ms + 0.596471ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,4,5,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:24:33.877 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.778447ms + 0.190359ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,4,5,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:33.879 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.871625ms + 0.133699ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,5,6,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:24:33.881 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.680747ms + 0.129822ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,5,6,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:33.883 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.785815ms + 0.13963ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,5,6,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:33.886 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.080211ms + 0.146252ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,5,6,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:33.886 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.269218ms + 0.287599ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:33.888 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.795096ms + 0.130874ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,5,6,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:24:33.888 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.888 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.888 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 5 entries retrieved using SQL in 22.862358ms
[DEBUG] 2024-04-23 23:24:33.888 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.888 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.888 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911073865 end=1713911073888 duration=23 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:33.891 [pool-13-thread-2] PartitionManagementTask - Lock is held by some other partition discovery task. Skipping this attempt..#1
[INFO ] 2024-04-23 23:24:33.891 [pool-13-thread-3] PartitionManagementTask - Lock is held by some other partition discovery task. Skipping this attempt..#2
[INFO ] 2024-04-23 23:24:33.892 [pool-13-thread-1] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:24:33.892 [pool-13-thread-1] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:38111]
[INFO ] 2024-04-23 23:24:33.892 [pool-13-thread-1] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:38111)
[INFO ] 2024-04-23 23:24:33.892 [pool-13-thread-1] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:38111) current connections: 6
[DEBUG] 2024-04-23 23:24:33.892 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.892 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911073892 end=1713911073892 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.893 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.893 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.893 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:24:33.893 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:24:33.893 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111;create=true
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111;create=true
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7143d638, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7143d638, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@40f803b2 created in the thread with id: 281
[DEBUG] 2024-04-23 23:24:33.894 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.895 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.895 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.896 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.896 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.896 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:24:33.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:24:33.897 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7143d638 from thread id: 281
[DEBUG] 2024-04-23 23:24:33.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:24:33.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.900 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.902 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:33.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.902 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 2.056461ms
[DEBUG] 2024-04-23 23:24:33.902 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911073893 end=1713911073902 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:33.903 [pool-13-thread-1] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 1
[DEBUG] 2024-04-23 23:24:33.903 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.903 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.903 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_database: db6
[INFO ] 2024-04-23 23:24:33.903 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db6	
[DEBUG] 2024-04-23 23:24:33.903 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.904 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:33.904 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.904 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.904 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.904 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.269057ms
[DEBUG] 2024-04-23 23:24:33.904 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911073903 end=1713911073904 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.904 [pool-13-thread-1] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=1, comments=HMS client
[DEBUG] 2024-04-23 23:24:33.905 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.905 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.905 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: source:127.0.0.1 get_table : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:24:33.905 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:24:33.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.906 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:33.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.906 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.55002ms
[DEBUG] 2024-04-23 23:24:33.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:33.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.914 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:33.915 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:24:33.915 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911073905 end=1713911073915 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.916 [pool-13-thread-1] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=12, comments=HMS client
[INFO ] 2024-04-23 23:24:33.916 [pool-13-thread-1] PartitionManagementTask - Found 1 candidate tables for partition discovery
[INFO ] 2024-04-23 23:24:33.916 [pool-13-thread-1] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:24:33.916 [pool-13-thread-1] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:24:33.917 [pool-13-thread-1] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:24:33.917 [pool-13-thread-1] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:24:33.917 [pool-13-thread-1] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:24:33.917 [pool-13-thread-1] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:24:33.917 [pool-13-thread-1] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:24:33.917 [pool-13-thread-1] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:24:33.918 [pool-13-thread-1] PartitionManagementTask - Running partition discovery for table hive.db6.tbl6 retentionPeriod: -1s
[INFO ] 2024-04-23 23:24:33.919 [PartitionDiscoveryTask-0] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:24:33.919 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:38111]
[INFO ] 2024-04-23 23:24:33.919 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:38111)
[INFO ] 2024-04-23 23:24:33.919 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:38111) current connections: 7
[DEBUG] 2024-04-23 23:24:33.920 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.920 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911073920 end=1713911073920 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=36 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.920 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.920 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.920 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 36: source:127.0.0.1 get_database: db6
[INFO ] 2024-04-23 23:24:33.920 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db6	
[INFO ] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 36: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111;create=true
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111;create=true
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@a74a717, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:24:33.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@a74a717, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3b34aed4 created in the thread with id: 283
[DEBUG] 2024-04-23 23:24:33.922 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.922 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.922 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.923 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.924 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.924 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:24:33.924 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:24:33.924 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@a74a717 from thread id: 283
[DEBUG] 2024-04-23 23:24:33.924 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.924 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:33.924 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.924 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.924 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.924 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.721591ms
[DEBUG] 2024-04-23 23:24:33.925 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911073920 end=1713911073924 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=36 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.925 [PartitionDiscoveryTask-0] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=5, comments=HMS client
[INFO ] 2024-04-23 23:24:33.925 [PartitionDiscoveryTask-0] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:24:33.925 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:38111]
[INFO ] 2024-04-23 23:24:33.925 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:38111)
[INFO ] 2024-04-23 23:24:33.925 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:38111) current connections: 8
[DEBUG] 2024-04-23 23:24:33.926 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.926 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911073926 end=1713911073926 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.926 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.926 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_table : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db6.tbl6	
[INFO ] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111;create=true
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111;create=true
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@385eaf30, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:24:33.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:24:33.928 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@385eaf30, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@92cb6df created in the thread with id: 284
[DEBUG] 2024-04-23 23:24:33.928 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.928 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.928 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.929 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.929 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.929 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:24:33.930 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:24:33.930 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@385eaf30 from thread id: 284
[DEBUG] 2024-04-23 23:24:33.930 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.930 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:33.930 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.930 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.931 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.985789ms
[DEBUG] 2024-04-23 23:24:33.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:33.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.937 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:33.938 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:24:33.938 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911073926 end=1713911073938 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.938 [PartitionDiscoveryTask-0] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=12, comments=HMS client
[DEBUG] 2024-04-23 23:24:33.938 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.938 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partition_names from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.938 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_partition_names : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:24:33.938 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partition_names : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:24:33.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionNames
[DEBUG] 2024-04-23 23:24:33.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.940 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.940 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partition_names start=1713911073938 end=1713911073940 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.940 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.940 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions_by_names_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.940 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_partitions_by_names : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:24:33.940 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions_by_names : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:24:33.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:33.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.945 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 5.03503ms + 0.00701ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  and "PARTITIONS"."PART_NAME" in (?,?,?,?,?)]
[DEBUG] 2024-04-23 23:24:33.949 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.327729ms + 0.110016ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (1,2,3,4,5) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:33.952 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.752986ms + 0.486558ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (1,2,3,4,5) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:24:33.954 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.738331ms + 0.191725ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (1,2,3,4,5) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:33.955 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.567969ms + 0.158433ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,5,6,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:24:33.956 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.532187ms + 0.142485ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,5,6,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:33.956 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.401953ms + 0.128173ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,5,6,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:33.957 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.36087ms + 0.126961ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,5,6,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:33.957 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.230794ms + 0.285135ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:33.958 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.381154ms + 0.125857ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,5,6,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:24:33.958 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:33.958 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:33.958 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 5 entries retrieved using SQL in 17.327673ms
[DEBUG] 2024-04-23 23:24:33.958 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:33.958 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:33.958 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:33.960 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:33.963 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:33.963 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:24:33.963 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:33.964 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.965 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions_by_names_req start=1713911073940 end=1713911073965 duration=25 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:33.966 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - Using multi-threaded version of MSCK-GetPaths with number of threads 15
[DEBUG] 2024-04-23 23:24:33.968 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - Number of partitions not in metastore : 0
[INFO ] 2024-04-23 23:24:33.968 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - Number of partitionsNotInMs=[], partitionsNotOnFs=[tbl6:state=WA/dt=2018-12-01], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
[INFO ] 2024-04-23 23:24:33.968 [PartitionDiscoveryTask-0] Msck - hive.db6.tbl6 - #partsNotInMs: 0 #partsNotInFs: 1 #expiredPartitions: 0 lockRequired: true (R: true A: true D: true)
[DEBUG] 2024-04-23 23:24:33.968 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.968 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.969 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:33.969 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.969 [TThreadPoolServer WorkerProcess-%d] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:24:33.969 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:24:33.970 [TThreadPoolServer WorkerProcess-%d] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:24:33.970 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:24:33.971 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(2, 1)>
[INFO ] 2024-04-23 23:24:33.972 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:24:33.972 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:33.972 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.972 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=open_txns start=1713911073968 end=1713911073972 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:33.973 [PartitionDiscoveryTask-0] Msck - Created lock(X) request with info - user: alex txnId: 2 agentInfo: PartitionDiscoveryTask-0 dbName: db6 tableName: tbl6
[DEBUG] 2024-04-23 23:24:33.973 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:33.973 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=lock from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:33.975 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Executing a batch of <INSERT INTO "HIVE_LOCKS" ( "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_LAST_HEARTBEAT", "HL_USER", "HL_HOST", "HL_AGENT_INFO") VALUES (?, ?, ?, ?, ?, ?, ?, ?, 0, ?, ?, ?)> queries. Batch size: 1
[DEBUG] 2024-04-23 23:24:33.975 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute query <SELECT "NL_NEXT" FROM "NEXT_LOCK_ID">
[DEBUG] 2024-04-23 23:24:33.975 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute updates in batch: <UPDATE "NEXT_LOCK_ID" SET "NL_NEXT" = 3>, and <UPDATE "HIVE_LOCKS" SET "HL_LOCK_EXT_ID" = 2 WHERE "HL_LOCK_EXT_ID" = -6657475505173118182>
[DEBUG] 2024-04-23 23:24:33.980 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=2
[DEBUG] 2024-04-23 23:24:33.980 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Found 1 locks for extLockId=2. Locks: [lockid:2 intLockId:1 txnid:2 db:db6 table:tbl6 partition:null state:WAITING type:EXCLUSIVE]
[DEBUG] 2024-04-23 23:24:33.980 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute query <(select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 2) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 2) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='r' AND "EX"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NOT NULL AND "REQ"."HL_TABLE" IS NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 2) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 2) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NULL AND "EX"."HL_LOCK_TYPE"='r' AND "REQ"."HL_TABLE" IS NOT NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 2) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 2) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='w' AND "EX"."HL_LOCK_TYPE" IN ('x','e') fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 2) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 2) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='x' AND "EX"."HL_LOCK_TYPE"!='r' fetch first 1 rows only)>
[DEBUG] 2024-04-23 23:24:33.989 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LOCK_STATE" = 'a', "HL_LAST_HEARTBEAT" = 0,"HL_ACQUIRED_AT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_BLOCKEDBY_EXT_ID"=NULL,"HL_BLOCKEDBY_INT_ID"=NULL WHERE "HL_LOCK_EXT_ID" = 2>
[DEBUG] 2024-04-23 23:24:33.992 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Successfully acquired locks: [lockid:2 intLockId:1 txnid:2 db:db6 table:tbl6 partition:null state:WAITING type:EXCLUSIVE]
[DEBUG] 2024-04-23 23:24:33.992 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:33.992 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=lock start=1713911073973 end=1713911073992 duration=19 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:33.992 [PartitionDiscoveryTask-0] Msck - Acquired lock(X) on hive.db6.tbl6. LockId: 2
[DEBUG] 2024-04-23 23:24:33.993 [PartitionDiscoveryTask-0] Msck - Generated partExpr: state='WA' AND dt='2018-12-01' for partName: state=WA/dt=2018-12-01
[DEBUG] 2024-04-23 23:24:34.002 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:34.004 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_partitions_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:34.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:34.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:34.005 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:34.006 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:34.006 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:34.006 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.101884ms
[DEBUG] 2024-04-23 23:24:34.006 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:34.006 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:34.006 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:34.008 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:34.011 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:34.011 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db6
[DEBUG] 2024-04-23 23:24:34.011 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:34.012 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:34.012 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:34.012 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:34.012 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.37108ms
[DEBUG] 2024-04-23 23:24:34.012 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:34.012 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:34.012 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:34.013 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:34.014 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:34.015 [TThreadPoolServer WorkerProcess-%d] PartFilterExprUtil - Filter specified is state='WA' AND dt='2018-12-01'
[DEBUG] 2024-04-23 23:24:34.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:34.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:24:34.027 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:34.027 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:34.049 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 19.882414ms + 0.007696ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ? inner join "PARTITION_KEY_VALS" "FILTER0" on "FILTER0"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER0"."INTEGER_IDX" = 0 inner join "PARTITION_KEY_VALS" "FILTER1" on "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 where "DBS"."CTLG_NAME" = ?  and ( (("FILTER0"."PART_KEY_VAL" = ?) and (cast((case when "FILTER1"."PART_KEY_VAL" <> ? and "TBLS"."TBL_NAME" = ? and "DBS"."NAME" = ? and "DBS"."CTLG_NAME" = ? and "FILTER1"."PART_ID" = "PARTITIONS"."PART_ID" and "FILTER1"."INTEGER_IDX" = 1 then cast("FILTER1"."PART_KEY_VAL" as date) else null end) as date) = ?)) )]
[DEBUG] 2024-04-23 23:24:34.055 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.646706ms + 0.072815ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (5) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:34.058 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.438616ms + 0.429057ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (5) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:24:34.061 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.195417ms + 0.247961ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (5) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:34.064 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.578633ms + 0.192844ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (6) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:24:34.067 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.03292ms + 0.130018ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (6) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:34.069 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.256815ms + 0.128438ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (6) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:34.072 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.247934ms + 0.161774ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (6) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:34.072 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.286847ms + 0.288976ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:34.075 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.745138ms + 0.142104ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (6) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:24:34.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:34.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:34.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 47.959876ms
[DEBUG] 2024-04-23 23:24:34.076 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:34.079 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.126615ms + 0.004883ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  and "PARTITIONS"."PART_NAME" in (?)]
[DEBUG] 2024-04-23 23:24:34.083 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.714376ms + 0.004597ms, the query is [delete from "PART_PRIVS" where "PART_ID" in (5)]
[DEBUG] 2024-04-23 23:24:34.085 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.493507ms + 0.004296ms, the query is [delete from "PART_COL_PRIVS" where "PART_ID" in (5)]
[DEBUG] 2024-04-23 23:24:34.087 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.083107ms + 0.004014ms, the query is [delete from "PART_COL_STATS" where "PART_ID" in (5)]
[DEBUG] 2024-04-23 23:24:34.089 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.66314ms + 0.004361ms, the query is [delete from "PARTITION_PARAMS" where "PART_ID" in (5)]
[DEBUG] 2024-04-23 23:24:34.091 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.212427ms + 0.004388ms, the query is [delete from "PARTITION_KEY_VALS" where "PART_ID" in (5)]
[DEBUG] 2024-04-23 23:24:34.093 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.998774ms + 0.004271ms, the query is [delete from "PARTITIONS" where "PART_ID" in (5)]
[DEBUG] 2024-04-23 23:24:34.096 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.365502ms + 0.005219ms, the query is [delete from "SD_PARAMS" where "SD_ID" in (6)]
[DEBUG] 2024-04-23 23:24:34.098 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.344549ms + 0.004336ms, the query is [delete from "SORT_COLS" where "SD_ID" in (6)]
[DEBUG] 2024-04-23 23:24:34.099 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.564819ms + 0.004075ms, the query is [delete from "BUCKETING_COLS" where "SD_ID" in (6)]
[DEBUG] 2024-04-23 23:24:34.101 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.68156ms + 0.004111ms, the query is [delete from "SKEWED_COL_NAMES" where "SD_ID" in (6)]
[DEBUG] 2024-04-23 23:24:34.104 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.634243ms + 0.004359ms, the query is [delete from "SDS" where "SD_ID" in (6)]
[DEBUG] 2024-04-23 23:24:34.106 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.737092ms + 0.004234ms, the query is [delete from "SERDE_PARAMS" where "SERDE_ID" in (6)]
[DEBUG] 2024-04-23 23:24:34.108 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.168591ms + 0.004411ms, the query is [delete from "SERDES" where "SERDE_ID" in (6)]
[DEBUG] 2024-04-23 23:24:34.110 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:34.110 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:34.110 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 34.67564ms
[DEBUG] 2024-04-23 23:24:34.111 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:34.111 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:34.111 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6' AND "TC_TABLE"='tbl6' AND "TC_PARTITION"='state=WA/dt=2018-12-01'>
[DEBUG] 2024-04-23 23:24:34.112 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6' AND "CTC_TABLE"='tbl6' AND "CTC_PARTITION"='state=WA/dt=2018-12-01'>
[DEBUG] 2024-04-23 23:24:34.114 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6' AND "CQ_TABLE"='tbl6' AND "CQ_PARTITION"='state=WA/dt=2018-12-01'>
[DEBUG] 2024-04-23 23:24:34.116 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6' AND "CC_TABLE"='tbl6' AND "CC_PARTITION"='state=WA/dt=2018-12-01'>
[DEBUG] 2024-04-23 23:24:34.118 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:34.118 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:34.118 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:34.120 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:34.122 [TThreadPoolServer WorkerProcess-%d] HMSHandler - dropPartition() will move partition-directories to trash-directory.
[DEBUG] 2024-04-23 23:24:34.122 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:34.122 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:34.122 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:34.122 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:24:34.122 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38111/db6.db/tbl6/state=WA/dt=2018-12-01
[WARN ] 2024-04-23 23:24:34.122 [TThreadPoolServer WorkerProcess-%d] FileUtils - File file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38111/db6.db/tbl6/state=WA/dt=2018-12-01 does not exist; Force to delete it.
[ERROR] 2024-04-23 23:24:34.122 [TThreadPoolServer WorkerProcess-%d] FileUtils - Failed to delete file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38111/db6.db/tbl6/state=WA/dt=2018-12-01
[DEBUG] 2024-04-23 23:24:34.123 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_partitions_req start=1713911074004 end=1713911074123 duration=119 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:34.124 [PartitionDiscoveryTask-0] Msck - Tables not in metastore: []
Tables missing on filesystem: []
Partitions not in metastore: []
Partitions missing from filesystem: [tbl6:state=WA/dt=2018-12-01]
Expired partitions: []

[INFO ] 2024-04-23 23:24:34.124 [PartitionDiscoveryTask-0] Msck - txnId: 2 succeeded. Committing..
[DEBUG] 2024-04-23 23:24:34.124 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:34.124 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:34.126 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 2 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:24:34.128 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
[DEBUG] 2024-04-23 23:24:34.128 [TThreadPoolServer WorkerProcess-%d] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 2>
[DEBUG] 2024-04-23 23:24:34.128 [TThreadPoolServer WorkerProcess-%d] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 2>
[DEBUG] 2024-04-23 23:24:34.128 [TThreadPoolServer WorkerProcess-%d] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 2>
[DEBUG] 2024-04-23 23:24:34.128 [TThreadPoolServer WorkerProcess-%d] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:24:34.133 [TThreadPoolServer WorkerProcess-%d] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (2)>
[DEBUG] 2024-04-23 23:24:34.133 [TThreadPoolServer WorkerProcess-%d] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:24:34.135 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Removed transactions: ([2]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:24:34.135 [TThreadPoolServer WorkerProcess-%d] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:2
[DEBUG] 2024-04-23 23:24:34.135 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:34.135 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:34.135 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:34.135 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:34.135 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=commit_txn start=1713911074124 end=1713911074135 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:34.135 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Closed a connection to metastore, current connections: 7
[DEBUG] 2024-04-23 23:24:34.135 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:34.135 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:24:34.135 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Closed a connection to metastore, current connections: 6
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:24:34.136 [pool-13-thread-1] HiveMetaStoreClient - Closed a connection to metastore, current connections: 5
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 36: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@385eaf30, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@92cb6df will be shutdown
[INFO ] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@a74a717, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3b34aed4 will be shutdown
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 36: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911074136 end=1713911074136 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=36 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7143d638, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@40f803b2 will be shutdown
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_partitions : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911074135 end=1713911074136 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[INFO ] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db6.tbl6	
[INFO ] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911074136 end=1713911074136 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 36: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:24:34.137 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 35: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:24:34.137 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:24:34.136 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:24:34.137 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:24:34.137 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:24:34.138 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.665322ms + 0.005885ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:34.141 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.157795ms + 0.098832ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,4,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:34.144 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.055918ms + 0.476865ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,4,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:24:34.146 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.76475ms + 0.16745ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,4,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:34.148 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.846329ms + 0.146909ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,5,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:24:34.150 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.651378ms + 0.127964ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,5,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:34.152 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.994188ms + 0.147206ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,5,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:34.154 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.596426ms + 0.127782ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,5,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:34.155 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.291876ms + 0.383622ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:34.157 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.114762ms + 0.131788ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,5,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:24:34.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:34.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:34.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 4 entries retrieved using SQL in 21.115498ms
[DEBUG] 2024-04-23 23:24:34.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:34.157 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:34.157 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911074136 end=1713911074157 duration=21 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:34.158 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:34.158 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:34.158 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:24:34.159 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:24:34.159 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:24:34.159 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:34.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:34.161 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:34.161 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:24:34.161 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713911074158 end=1713911074161 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:34.161 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:34.161 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:34.161 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:24:34.161 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:24:34.161 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:34.164 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:34.164 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:34.164 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911074161 end=1713911074164 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:34.164 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:34.164 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:34.164 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_database: db6
[INFO ] 2024-04-23 23:24:34.164 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db6	
[DEBUG] 2024-04-23 23:24:34.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:34.166 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:34.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:34.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:34.166 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:34.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.442711ms
[DEBUG] 2024-04-23 23:24:34.166 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911074164 end=1713911074166 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:34.166 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:24:34.166 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:34.166 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:34.166 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_tables_by_type: db=@hive#db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:34.166 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:34.166 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:34.166 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:34.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:34.167 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:34.168 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:34.168 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:34.168 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:34.168 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.402766ms
[DEBUG] 2024-04-23 23:24:34.168 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:34.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:34.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:34.171 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:34.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.709955ms
[DEBUG] 2024-04-23 23:24:34.171 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911074166 end=1713911074171 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:34.171 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:34.171 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:34.171 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:24:34.171 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:24:34.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:34.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:34.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:34.174 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:34.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 3.231735ms
[DEBUG] 2024-04-23 23:24:34.174 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911074171 end=1713911074174 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:34.174 [main] HiveMetaStoreClient - Selecting dropDatabase method for db6 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:24:34.175 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:24:34.175 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:34.175 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:34.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:34.176 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:34.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:34.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:34.176 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:34.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.306079ms
[DEBUG] 2024-04-23 23:24:34.176 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_multi_table : db=db6 tbls=tbl6
[INFO ] 2024-04-23 23:24:34.176 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db6 tbls=tbl6	
[DEBUG] 2024-04-23 23:24:34.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:34.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:34.181 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:34.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:34.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:34.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.945496ms
[DEBUG] 2024-04-23 23:24:34.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:34.181 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:34.182 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911074175 end=1713911074182 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:34.182 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:34.182 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:34.182 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:24:34.182 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:24:34.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:34.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:34.183 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:34.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:34.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:34.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.992314ms
[DEBUG] 2024-04-23 23:24:34.183 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:24:34.183 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:24:34.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:34.184 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:34.184 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:34.184 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.516053ms
[DEBUG] 2024-04-23 23:24:34.184 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:24:34.184 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:24:34.184 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:34.202 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@863326102 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:34.205 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:34.205 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:34.205 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:34.205 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:34.211 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@863326102 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:34.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:34.214 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:34.214 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:34.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:34.233 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@863326102 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:34.236 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:34.236 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:34.236 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:34.236 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:34.236 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:24:34.237 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:34.237 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:34.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:34.237 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:34.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:34.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:34.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.915767ms
[DEBUG] 2024-04-23 23:24:34.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:34.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:34.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:34.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.497339ms
[DEBUG] 2024-04-23 23:24:34.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:34.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:34.239 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:34.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:34.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:34.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.895596ms
[DEBUG] 2024-04-23 23:24:34.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:34.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:24:34.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:34.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:34.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:34.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:34.259 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@863326102 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:34.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:34.266 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:34.266 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:34.266 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:34.266 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:34.268 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:34.269 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:34.271 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:34.273 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:34.274 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:34.276 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:34.276 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:34.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:34.277 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:34.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:34.277 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:36.278 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:24:36.278 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:24:36.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:36.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:36.279 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:36.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:36.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:36.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.291645ms
[DEBUG] 2024-04-23 23:24:36.279 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:24:36.279 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:24:36.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:36.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:36.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:36.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.813749ms
[DEBUG] 2024-04-23 23:24:36.280 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:24:36.280 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:24:36.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:36.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:36.282 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:36.282 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:36.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:36.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:36.283 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:36.283 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:36.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:36.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:36.284 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:36.284 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:36.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:36.284 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:36.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:36.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:36.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.827195ms
[DEBUG] 2024-04-23 23:24:36.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:36.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:36.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:36.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.446771ms
[DEBUG] 2024-04-23 23:24:36.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:36.286 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:36.286 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:36.286 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:36.286 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:36.286 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.912459ms
[DEBUG] 2024-04-23 23:24:36.286 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:36.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:24:36.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:36.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:36.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:36.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:36.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:36.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:36.289 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:36.289 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:36.289 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:36.289 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:36.289 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:36.289 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:36.289 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:36.289 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:36.289 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:36.290 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:36.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:36.291 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:36.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:36.291 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:38.292 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:24:38.292 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:24:38.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:38.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:38.295 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:38.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:38.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:38.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.711004ms
[DEBUG] 2024-04-23 23:24:38.296 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:24:38.296 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:24:38.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:38.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:38.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:38.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.099207ms
[DEBUG] 2024-04-23 23:24:38.297 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:24:38.297 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:24:38.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:38.299 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:38.299 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:38.299 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:38.299 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:38.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:38.300 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:38.300 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:38.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:38.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:38.301 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:38.301 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:38.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:38.302 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:38.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:38.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:38.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.985323ms
[DEBUG] 2024-04-23 23:24:38.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:38.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:38.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:38.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.559252ms
[DEBUG] 2024-04-23 23:24:38.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:38.303 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:38.304 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:38.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:38.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:38.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.883999ms
[DEBUG] 2024-04-23 23:24:38.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:38.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:24:38.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:38.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:38.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:38.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:38.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:38.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:38.306 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:38.306 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:38.306 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:38.306 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:38.306 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:38.306 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:38.306 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:38.307 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:38.307 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:38.307 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:38.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:38.308 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:38.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:38.308 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:40.309 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:24:40.309 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:24:40.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:40.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:40.311 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:40.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:40.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:40.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.410832ms
[DEBUG] 2024-04-23 23:24:40.312 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:24:40.313 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:24:40.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:40.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:40.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:40.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.825011ms
[DEBUG] 2024-04-23 23:24:40.315 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:24:40.315 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:24:40.315 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:40.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:40.319 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:40.319 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:40.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:40.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:40.322 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:40.322 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:40.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:40.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:40.325 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:40.325 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:40.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:40.327 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:40.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:40.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:40.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.025812ms
[DEBUG] 2024-04-23 23:24:40.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:40.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:40.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:40.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 1.827851ms
[DEBUG] 2024-04-23 23:24:40.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:40.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:40.334 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:40.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:40.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:40.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 2.95076ms
[DEBUG] 2024-04-23 23:24:40.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:40.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:24:40.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:40.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:40.338 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:40.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:40.341 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:40.342 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:40.343 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:40.343 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:40.343 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:40.343 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:40.343 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:40.343 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:40.343 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:40.343 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:40.343 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:40.344 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:40.344 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:40.344 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:40.345 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:40.345 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:40.467 [HikariPool-8 housekeeper] HikariPool - HikariPool-8 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:24:42.346 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:24:42.346 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:24:42.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:42.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:42.349 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:42.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:42.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:42.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.541476ms
[DEBUG] 2024-04-23 23:24:42.350 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:24:42.350 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:24:42.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:42.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:42.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:42.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.549593ms
[DEBUG] 2024-04-23 23:24:42.351 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:24:42.351 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:24:42.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:42.352 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:42.353 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:42.353 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:42.353 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:42.353 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:42.353 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:42.353 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:42.353 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:42.354 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:42.354 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:42.354 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:42.354 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:42.355 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:42.355 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:42.355 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:42.355 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.752813ms
[DEBUG] 2024-04-23 23:24:42.355 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:42.355 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:42.355 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:42.355 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.432603ms
[DEBUG] 2024-04-23 23:24:42.355 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:42.356 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:42.356 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:42.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:42.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:42.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.712297ms
[DEBUG] 2024-04-23 23:24:42.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:42.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:24:42.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:42.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:42.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:42.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:42.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:42.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:42.359 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:42.359 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:42.359 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:42.359 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:42.359 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:42.359 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:42.359 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:42.359 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:42.359 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:42.359 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:42.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:42.360 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:42.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:42.361 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:44.361 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:24:44.361 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:24:44.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:44.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:44.364 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:44.365 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:44.365 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:44.365 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.347986ms
[DEBUG] 2024-04-23 23:24:44.365 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:24:44.365 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:24:44.365 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:44.367 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:44.367 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:44.367 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.73352ms
[DEBUG] 2024-04-23 23:24:44.367 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:24:44.367 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:24:44.367 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:44.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:44.371 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:44.371 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:44.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:44.374 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:44.374 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:44.374 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:44.374 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:44.376 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:44.377 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:44.377 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:44.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:44.379 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:44.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:44.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:44.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 2.840759ms
[DEBUG] 2024-04-23 23:24:44.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:44.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:44.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:44.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 1.658081ms
[DEBUG] 2024-04-23 23:24:44.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:44.384 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:44.386 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:44.386 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:44.386 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:44.386 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 2.745346ms
[DEBUG] 2024-04-23 23:24:44.386 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:44.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:24:44.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:44.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:44.389 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:44.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:44.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:44.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:44.393 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:44.393 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:44.393 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:44.394 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:44.394 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:44.394 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:44.394 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:44.394 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:44.395 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:44.395 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:44.395 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:44.397 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:44.397 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:44.398 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:46.398 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:24:46.399 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:24:46.399 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:46.399 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:46.402 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:46.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:46.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:46.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.452376ms
[DEBUG] 2024-04-23 23:24:46.402 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:24:46.402 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:24:46.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:46.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:46.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:46.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.61556ms
[DEBUG] 2024-04-23 23:24:46.403 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:24:46.403 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:24:46.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:46.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:46.404 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:46.405 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:46.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:46.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:46.405 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:46.405 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:46.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:46.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:46.406 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:46.406 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:46.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:46.407 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:46.407 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:46.407 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:46.407 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.917985ms
[DEBUG] 2024-04-23 23:24:46.407 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:46.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:46.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:46.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.455736ms
[DEBUG] 2024-04-23 23:24:46.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:46.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:46.409 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:46.409 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:46.409 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:46.409 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.742944ms
[DEBUG] 2024-04-23 23:24:46.409 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:46.409 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:24:46.409 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:46.409 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:46.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:46.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:46.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:46.411 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:46.411 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:46.411 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:46.411 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:46.411 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:46.411 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:46.411 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:46.411 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:46.411 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:46.411 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:46.411 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:46.411 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:46.412 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:46.412 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:46.412 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:48.398 [HikariPool-7 housekeeper] HikariPool - HikariPool-7 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:24:48.413 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:24:48.413 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:24:48.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:48.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:48.416 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:48.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:48.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:48.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.65487ms
[DEBUG] 2024-04-23 23:24:48.417 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:24:48.417 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:24:48.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:48.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:48.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:48.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.26652ms
[DEBUG] 2024-04-23 23:24:48.419 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:24:48.419 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:24:48.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:48.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:48.420 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:48.420 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:48.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:48.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:48.421 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:48.421 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:48.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:48.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:48.422 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:48.422 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:48.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:48.423 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:48.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:48.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:48.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.017999ms
[DEBUG] 2024-04-23 23:24:48.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:48.424 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:48.424 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:48.424 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.542846ms
[DEBUG] 2024-04-23 23:24:48.424 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:48.424 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:48.425 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:48.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:48.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:48.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.827662ms
[DEBUG] 2024-04-23 23:24:48.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:48.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:24:48.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:48.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:48.426 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:48.426 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:48.427 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:48.427 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:48.427 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:48.427 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:48.427 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:48.427 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:48.427 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:48.427 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:48.427 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:48.427 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:48.428 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:48.428 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:48.428 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:48.428 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:48.428 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:48.429 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:49.836 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:24:50.429 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:24:50.430 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:24:50.430 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:50.430 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:50.432 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:50.433 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:50.433 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:50.433 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.393647ms
[DEBUG] 2024-04-23 23:24:50.433 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:24:50.433 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:24:50.434 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:50.435 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:50.435 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:50.435 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.321911ms
[DEBUG] 2024-04-23 23:24:50.435 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:24:50.435 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:24:50.435 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:50.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:50.436 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:50.436 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:50.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:50.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:50.437 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:50.437 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:50.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:50.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:50.438 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:50.438 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:50.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:50.439 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:50.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:50.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:50.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.899578ms
[DEBUG] 2024-04-23 23:24:50.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:50.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:50.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:50.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.480522ms
[DEBUG] 2024-04-23 23:24:50.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:50.440 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:50.441 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:50.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:50.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:50.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.748619ms
[DEBUG] 2024-04-23 23:24:50.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:50.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:24:50.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:50.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:50.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:50.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:50.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:50.443 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:50.443 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:50.443 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:50.443 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:50.443 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:50.443 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:50.443 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:50.443 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:50.443 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:50.443 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:50.443 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:50.443 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:50.444 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:50.444 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:50.444 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:52.445 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:24:52.445 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:24:52.445 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:52.445 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:52.448 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:52.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:52.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:52.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.421891ms
[DEBUG] 2024-04-23 23:24:52.449 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:24:52.449 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:24:52.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:52.450 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:52.450 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:52.450 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.291043ms
[DEBUG] 2024-04-23 23:24:52.451 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:24:52.451 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:24:52.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:52.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:52.452 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:52.452 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:52.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:52.453 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:52.453 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:52.453 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:52.453 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:52.453 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:52.454 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:52.454 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:52.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:52.455 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:52.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:52.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:52.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.144269ms
[DEBUG] 2024-04-23 23:24:52.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:52.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:52.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:52.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.607931ms
[DEBUG] 2024-04-23 23:24:52.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:52.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:52.457 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:52.457 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:52.457 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:52.457 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.90873ms
[DEBUG] 2024-04-23 23:24:52.457 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:52.457 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:24:52.457 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:52.457 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:52.458 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:52.458 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:52.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:52.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:52.460 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:52.460 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:52.460 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:52.460 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:52.460 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:52.460 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:52.460 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:52.460 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:52.460 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:52.460 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:52.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:52.461 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:52.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:52.461 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:54.462 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:24:54.462 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:24:54.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:54.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:54.466 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:54.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:54.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:54.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.744063ms
[DEBUG] 2024-04-23 23:24:54.466 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:24:54.466 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:24:54.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:54.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:54.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:54.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.676178ms
[DEBUG] 2024-04-23 23:24:54.467 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:24:54.467 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:24:54.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:54.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:54.469 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:54.469 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:54.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:54.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:54.470 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:54.470 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:54.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:54.471 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:54.471 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:54.471 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:54.471 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:54.472 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:54.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:54.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:54.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.974682ms
[DEBUG] 2024-04-23 23:24:54.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:54.473 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:54.473 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:54.473 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.542268ms
[DEBUG] 2024-04-23 23:24:54.473 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:54.473 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:54.474 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:54.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:54.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:54.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.884278ms
[DEBUG] 2024-04-23 23:24:54.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:54.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:24:54.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:54.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:54.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:54.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:54.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:54.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:54.477 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:54.477 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:54.477 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:54.477 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:54.477 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:54.477 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:54.477 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:54.477 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:24:54.477 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:54.477 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:54.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:54.478 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1168893309 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:54.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:54.478 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:54.478 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911074182 end=1713911094478 duration=20296 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=-1 error=true>
]]></system-out>
  </testcase>
  <testcase name="testPartitionDiscoveryDisabledByDefault" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="22.044">
    <error message="javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore&#10;NestedThrowables:&#10;java.sql.BatchUpdateException: DELETE on table &apos;DBS&apos; caused a violation of foreign key constraint &apos;TBLS_FK1&apos; for key (2).  The statement has been rolled back." type="org.apache.hadoop.hive.metastore.api.MetaException"><![CDATA[org.apache.hadoop.hive.metastore.api.MetaException: 
javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
NestedThrowables:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.tearDown(TestPartitionManagement.java:100)
]]></error>
    <system-out><![CDATA[[INFO ] 2024-04-23 23:24:54.479 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:24:54.479 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:24:54.480 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:24:54.480 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:24:54.487 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:24:54.487 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:24:54.487 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:24:54.487 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:24:54.488 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:24:54.537 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true
[INFO ] 2024-04-23 23:24:54.955 [MetaStoreThread-45719] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[INFO ] 2024-04-23 23:24:54.955 [main] MetaStoreTestUtils - Waiting the HMS to start.
[DEBUG] 2024-04-23 23:24:54.955 [MetaStoreThread-45719] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] HMSHandler - 38: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38111;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:24:54.956 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 120
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:24:54.957 [MetaStoreThread-45719] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:54.958 [MetaStoreThread-45719] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:24:54.958 [MetaStoreThread-45719] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - HikariPool-10 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - HikariPool-10 - configuration:
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true"
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:24:54.959 [MetaStoreThread-45719] HikariConfig - poolName........................"HikariPool-10"
[DEBUG] 2024-04-23 23:24:54.960 [MetaStoreThread-45719] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:24:54.960 [MetaStoreThread-45719] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:24:54.960 [MetaStoreThread-45719] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:24:54.960 [MetaStoreThread-45719] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:24:54.960 [MetaStoreThread-45719] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:24:54.960 [MetaStoreThread-45719] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:24:54.960 [MetaStoreThread-45719] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:24:54.960 [MetaStoreThread-45719] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:24:54.960 [MetaStoreThread-45719] HikariDataSource - HikariPool-10 - Starting...
[INFO ] 2024-04-23 23:24:54.961 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:24:54.962 [MetaStoreThread-45719] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:54.962 [MetaStoreThread-45719] HikariDataSource - HikariPool-10 - Start completed.
[DEBUG] 2024-04-23 23:24:55.062 [HikariPool-10 housekeeper] HikariPool - HikariPool-10 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:24:55.064 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1853053762 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.065 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@793661817 (XID = 1154), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.066 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@514580346 (XID = 1156), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.067 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1331801654 (XID = 1158), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.068 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1415431619 (XID = 1160), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.069 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1261409790 (XID = 1162), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.070 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@160585905 (XID = 1164), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.071 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1542117688 (XID = 1166), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.073 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@748113483 (XID = 1168), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.073 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:24:55.158 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:24:55.160 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:24:55.160 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:24:55.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@e84454c, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4229292f will be shutdown
[DEBUG] 2024-04-23 23:24:55.160 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 31: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:24:55.160 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:24:55.258 [MetaStoreThread-45719] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:24:55.258 [MetaStoreThread-45719] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@19c421e6, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:24:55.258 [MetaStoreThread-45719] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:24:55.258 [MetaStoreThread-45719] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@19c421e6, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6bc877fa created in the thread with id: 296
[DEBUG] 2024-04-23 23:24:55.258 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.258 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.259 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.348 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.416 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1853053762 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.432 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1853053762 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.470 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1853053762 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.489 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1853053762 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.494 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1853053762 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.593 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1853053762 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.617 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1853053762 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.623 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1853053762 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.628 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1853053762 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.631 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.632 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.632 [MetaStoreThread-45719] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:24:55.632 [MetaStoreThread-45719] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:24:55.633 [MetaStoreThread-45719] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@19c421e6 from thread id: 296
[DEBUG] 2024-04-23 23:24:55.633 [MetaStoreThread-45719] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:24:55.633 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:55.636 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.638 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:55.638 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:55.638 [MetaStoreThread-45719] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:24:55.639 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:55.639 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:55.639 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.639 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:55.640 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:55.642 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.642 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:55.644 [MetaStoreThread-45719] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:55.644 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:55.644 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.644 [MetaStoreThread-45719] ObjectStore - db details for db default retrieved using SQL in 1.894053ms
[DEBUG] 2024-04-23 23:24:55.644 [MetaStoreThread-45719] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:24:55.644 [MetaStoreThread-45719] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:24:55.644 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:55.649 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.651 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:55.652 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.654 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:55.654 [MetaStoreThread-45719] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:24:55.654 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:55.654 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:55.657 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.661 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:55.663 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1853053762 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.664 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:55.665 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:55.665 [MetaStoreThread-45719] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:24:55.665 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:55.665 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:55.665 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:55.666 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:55.666 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:55.666 [MetaStoreThread-45719] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:24:55.666 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:55.666 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:55.667 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:55.667 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:55.670 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1853053762 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.673 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:55.676 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1853053762 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.677 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:55.678 [MetaStoreThread-45719] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:55.678 [MetaStoreThread-45719] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:24:55.679 [MetaStoreThread-45719] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:24:55.679 [MetaStoreThread-45719] PerfLogger - </PERFLOG method=init start=1713911094955 end=1713911095679 duration=724 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=38 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:55.679 [MetaStoreThread-45719] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:24:55.679 [MetaStoreThread-45719] HiveMetaStore - Started the new metaserver on port [45719]...
[INFO ] 2024-04-23 23:24:55.679 [MetaStoreThread-45719] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:24:55.679 [MetaStoreThread-45719] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:24:55.679 [MetaStoreThread-45719] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:24:55.679 [MetaStoreThread-45719] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:24:55.679 [MetaStoreThread-45719] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:24:55.679 [MetaStoreThread-45719] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:24:55.679 [MetaStoreThread-45719] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:24:55.679 [MetaStoreThread-45719] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:24:55.679 [MetaStoreThread-45719] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:24:55.679 [MetaStoreThread-45719] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:24:55.679 [MetaStoreThread-45719] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:24:55.679 [MetaStoreThread-45719] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:24:55.679 [MetaStoreThread-45719] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:24:55.679 [MetaStoreThread-45719] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:24:55.679 [MetaStoreThread-45719] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:24:55.679 [MetaStoreThread-45719] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:24:55.957 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:24:55.958 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 39: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:24:55.958 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:24:55.965 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45719) is created
[INFO ] 2024-04-23 23:24:55.965 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 45719 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45719 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true
[INFO ] 2024-04-23 23:24:55.965 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:24:55.968 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:24:55.968 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:45719]
[INFO ] 2024-04-23 23:24:55.968 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:45719)
[INFO ] 2024-04-23 23:24:55.969 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:45719) current connections: 6
[DEBUG] 2024-04-23 23:24:55.969 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:55.969 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911095969 end=1713911095969 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:55.969 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:55.969 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:55.969 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 create_database: Database(name:db1, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:24:55.969 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db1, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true
[DEBUG] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:55.970 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3e8d127d, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:24:55.971 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:24:55.972 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3e8d127d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@86a18b8 created in the thread with id: 313
[DEBUG] 2024-04-23 23:24:55.972 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.972 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.972 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.973 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.974 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.974 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:24:55.974 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:24:55.974 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3e8d127d from thread id: 313
[DEBUG] 2024-04-23 23:24:55.974 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:55.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:55.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:55.975 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.935879ms
[DEBUG] 2024-04-23 23:24:55.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db1, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:24:55.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:24:55.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:55.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:55.976 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.976 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:24:55.976 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:55.976 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:55.976 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:55.976 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[WARN ] 2024-04-23 23:24:55.976 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db for database db1. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:24:55.977 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:55.977 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:55.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:55.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:55.979 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.979 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713911095969 end=1713911095979 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:55.980 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:55.980 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:55.980 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 create_table_req: Table(tableName:tbl1, dbName:db1, owner:alex, createTime:1713911095, lastAccessTime:1713911095, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:do, type:double, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:s, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:24:55.980 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl1, dbName:db1, owner:alex, createTime:1713911095, lastAccessTime:1713911095, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:do, type:double, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:s, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:24:55.980 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:55.984 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:55.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:55.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:55.984 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 3.919145ms
[DEBUG] 2024-04-23 23:24:55.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:55.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:55.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:24:55.989 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:55.989 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:55.989 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:55.989 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:55.989 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:55.990 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:55.990 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:55.990 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:55.990 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 1.034494ms
[DEBUG] 2024-04-23 23:24:55.990 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:55.990 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:55.990 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:24:55.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:55.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:55.991 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:55.991 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:55.991 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:55.991 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:24:55.991 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45719/db1.db/tbl1
[DEBUG] 2024-04-23 23:24:55.996 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:55.996 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:56.001 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:56.004 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1853053762 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.008 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1853053762 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.014 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1853053762 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.018 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1853053762 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.030 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.030 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.032 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.033 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713911095980 end=1713911096033 duration=53 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:56.033 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:56.033 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:56.033 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 add_partition : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:24:56.033 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:24:56.033 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.033 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.034 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:56.034 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:24:56.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:56.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.070 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.070 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:24:56.071 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:56.071 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:56.071 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:56.071 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:24:56.071 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45719/db1.db/tbl1/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:24:56.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:56.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:24:56.078 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:56.080 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1853053762 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.091 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.092 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911096033 end=1713911096092 duration=59 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:56.093 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:56.093 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:56.093 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 add_partition : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:24:56.093 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:24:56.093 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.093 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.093 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:56.093 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:24:56.095 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:56.098 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.098 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.098 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.098 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:56.098 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:56.098 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:56.099 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:24:56.099 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45719/db1.db/tbl1/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:24:56.104 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.104 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:56.104 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:24:56.105 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:56.107 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.107 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.110 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.111 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911096093 end=1713911096111 duration=18 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:56.111 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:56.111 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:56.111 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 add_partition : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:24:56.111 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:24:56.111 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.111 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.111 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:56.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:24:56.114 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:56.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.118 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:56.118 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:56.118 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:56.118 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:24:56.118 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45719/db1.db/tbl1/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:24:56.123 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.123 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:56.123 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:24:56.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:56.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.130 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.131 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911096111 end=1713911096131 duration=20 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:56.132 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:56.132 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:56.132 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713911096132 end=1713911096132 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:56.132 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:56.132 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:56.132 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_table : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:24:56.132 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:24:56.132 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.133 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:56.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:56.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.134 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 1.300284ms
[DEBUG] 2024-04-23 23:24:56.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:24:56.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.139 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[INFO ] 2024-04-23 23:24:56.140 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:24:56.140 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911096132 end=1713911096140 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:56.140 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=8, comments=HMS client
[DEBUG] 2024-04-23 23:24:56.140 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:56.141 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:56.141 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:24:56.141 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:24:56.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:24:56.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.144 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.458256ms + 0.005574ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:56.148 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.358535ms + 0.074976ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:56.150 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.528708ms + 0.33018ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:24:56.152 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.599004ms + 0.177315ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:56.154 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.550089ms + 0.130759ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:24:56.155 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.52061ms + 0.121199ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:56.157 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.438565ms + 0.120632ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:56.159 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.47476ms + 0.121576ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:56.161 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.03181ms + 0.232658ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:56.163 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.583055ms + 0.130615ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:24:56.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:56.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 22.025382ms
[DEBUG] 2024-04-23 23:24:56.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.163 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.163 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911096141 end=1713911096163 duration=22 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:56.175 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:56.175 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:56.175 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:24:56.175 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:24:56.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:24:56.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.176 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.590268ms + 0.004795ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:56.176 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.40469ms + 0.114165ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:56.177 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.20753ms + 0.295408ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:24:56.178 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.187241ms + 0.156822ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:56.178 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.199932ms + 0.107725ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:24:56.178 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.187084ms + 0.107049ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:56.179 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.169151ms + 0.142506ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:56.179 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.194499ms + 0.108383ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:56.179 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.242924ms + 0.218027ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:56.180 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.205222ms + 0.109454ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:24:56.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:56.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 4.757221ms
[DEBUG] 2024-04-23 23:24:56.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.180 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.180 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911096175 end=1713911096180 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:56.181 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:24:56.181 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:45719]
[INFO ] 2024-04-23 23:24:56.181 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:45719)
[INFO ] 2024-04-23 23:24:56.181 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:45719) current connections: 7
[DEBUG] 2024-04-23 23:24:56.182 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:56.182 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911096182 end=1713911096182 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=41 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:56.182 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:56.182 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:56.183 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 41: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:24:56.183 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:24:56.183 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 41: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:24:56.183 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:24:56.183 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:56.183 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:56.183 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:24:56.183 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:24:56.183 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true
[DEBUG] 2024-04-23 23:24:56.183 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:24:56.183 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:24:56.183 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:56.183 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:24:56.183 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:24:56.183 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@705e72e1, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@705e72e1, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@133b3c52 created in the thread with id: 326
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.184 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.186 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.186 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.186 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:24:56.186 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:24:56.186 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@705e72e1 from thread id: 326
[DEBUG] 2024-04-23 23:24:56.186 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.186 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:24:56.192 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.192 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.192 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911096182 end=1713911096192 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=41 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:56.192 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:24:56.192 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 6
[DEBUG] 2024-04-23 23:24:56.192 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:56.192 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:56.192 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:56.192 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 41: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:24:56.192 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:56.192 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:24:56.192 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:24:56.192 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1	
[INFO ] 2024-04-23 23:24:56.192 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@705e72e1, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@133b3c52 will be shutdown
[DEBUG] 2024-04-23 23:24:56.192 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:24:56.192 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.192 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.192 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 41: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:24:56.192 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:24:56.192 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911096192 end=1713911096192 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=41 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:56.192 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:24:56.193 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 41: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:24:56.193 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:24:56.193 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.01153ms + 0.005766ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:56.194 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.658566ms + 0.09941ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:56.195 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.273114ms + 0.331002ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:24:56.196 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.259642ms + 0.236911ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:56.196 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.27019ms + 0.165196ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:24:56.197 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.193212ms + 0.107624ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:56.197 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.164857ms + 0.105435ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:56.197 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.166416ms + 0.100116ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:56.198 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.235918ms + 0.203874ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:56.198 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.181039ms + 0.101712ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:24:56.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:56.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 5.761115ms
[DEBUG] 2024-04-23 23:24:56.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.198 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.198 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911096192 end=1713911096198 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:56.199 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:56.199 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:56.199 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 alter_table: hive.db1.tbl1 newtbl=tbl1
[INFO ] 2024-04-23 23:24:56.199 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db1.tbl1 newtbl=tbl1	
[DEBUG] 2024-04-23 23:24:56.199 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.200 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:56.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:56.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.200 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 1.172961ms
[DEBUG] 2024-04-23 23:24:56.201 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:56.201 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:56.201 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:56.201 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:24:56.201 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.201 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:56.202 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:56.202 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.202 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.202 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 1.05219ms
[DEBUG] 2024-04-23 23:24:56.202 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.202 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.202 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:24:56.203 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.206 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.207 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.209 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:56.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:56.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 1.036668ms
[DEBUG] 2024-04-23 23:24:56.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:56.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:24:56.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:56.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.214 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db1
[WARN ] 2024-04-23 23:24:56.214 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:24:56.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:56.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:56.216 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:56.216 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:24:56.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:56.218 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:24:56.218 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:56.218 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:24:56.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:56.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.225 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.227 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713911096199 end=1713911096227 duration=28 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:56.228 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:24:56.228 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:45719]
[INFO ] 2024-04-23 23:24:56.228 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:45719)
[INFO ] 2024-04-23 23:24:56.228 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:45719) current connections: 7
[DEBUG] 2024-04-23 23:24:56.229 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:56.229 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911096229 end=1713911096229 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:56.229 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:56.229 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:56.229 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:24:56.229 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:24:56.230 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:24:56.231 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:24:56.231 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:24:56.231 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:24:56.231 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:24:56.231 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:24:56.231 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:24:56.231 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:24:56.231 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@744db35e, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:24:56.231 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:24:56.231 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@744db35e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4573e5a7 created in the thread with id: 327
[DEBUG] 2024-04-23 23:24:56.231 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.231 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.231 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.232 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.233 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.233 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:24:56.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:24:56.233 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@744db35e from thread id: 327
[DEBUG] 2024-04-23 23:24:56.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:24:56.235 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.235 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.235 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911096229 end=1713911096235 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[INFO ] 2024-04-23 23:24:56.235 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:24:56.235 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 6
[DEBUG] 2024-04-23 23:24:56.235 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:56.236 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:56.236 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:56.236 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:24:56.236 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:24:56.236 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:24:56.236 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:24:56.236 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@744db35e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4573e5a7 will be shutdown
[INFO ] 2024-04-23 23:24:56.236 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:24:56.236 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:24:56.236 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.236 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:24:56.236 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[INFO ] 2024-04-23 23:24:56.236 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:24:56.236 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911096235 end=1713911096236 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:56.236 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:24:56.236 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:24:56.236 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:24:56.237 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.845623ms + 0.004533ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:56.237 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.447724ms + 0.062974ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:24:56.238 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.160098ms + 0.213575ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:24:56.238 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.240922ms + 0.239689ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:56.239 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.271847ms + 0.173082ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:24:56.239 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.250227ms + 0.173596ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:56.240 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.187871ms + 0.109848ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:56.240 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.152238ms + 0.104743ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:56.240 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.203673ms + 0.216906ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:24:56.241 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.161198ms + 0.105619ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:24:56.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:56.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 5.123218ms
[DEBUG] 2024-04-23 23:24:56.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.241 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.241 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911096236 end=1713911096241 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:56.241 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:56.241 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:56.242 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:24:56.242 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:24:56.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:24:56.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.244 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.244 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713911096241 end=1713911096244 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:56.244 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:56.244 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:56.244 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:24:56.244 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:24:56.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.247 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.247 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.247 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911096244 end=1713911096247 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:56.247 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:56.247 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:56.248 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_database: db1
[INFO ] 2024-04-23 23:24:56.248 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db1	
[DEBUG] 2024-04-23 23:24:56.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.248 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:56.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:56.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.249 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 1.127965ms
[DEBUG] 2024-04-23 23:24:56.249 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911096247 end=1713911096249 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:56.249 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:24:56.249 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:56.249 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:56.249 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_tables_by_type: db=@hive#db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:56.249 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:56.249 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:56.249 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:56.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.250 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:56.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:56.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.250 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 1.047098ms
[DEBUG] 2024-04-23 23:24:56.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:56.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.253 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.552226ms
[DEBUG] 2024-04-23 23:24:56.253 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911096249 end=1713911096253 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:56.253 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:56.253 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:56.253 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:24:56.253 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:24:56.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.255 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:56.255 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.255 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.255 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.440286ms
[DEBUG] 2024-04-23 23:24:56.256 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911096253 end=1713911096255 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:56.256 [main] HiveMetaStoreClient - Selecting dropDatabase method for db1 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:24:56.256 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:24:56.256 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:56.256 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:56.256 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.256 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:56.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:56.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.257 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.891621ms
[DEBUG] 2024-04-23 23:24:56.257 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_multi_table : db=db1 tbls=tbl1
[INFO ] 2024-04-23 23:24:56.257 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db1 tbls=tbl1	
[DEBUG] 2024-04-23 23:24:56.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.260 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.261 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:56.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:56.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.821193ms
[DEBUG] 2024-04-23 23:24:56.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.261 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.261 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911096256 end=1713911096261 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:24:56.261 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:24:56.261 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:24:56.261 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:24:56.261 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:24:56.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:56.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.262 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:56.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:56.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.734496ms
[DEBUG] 2024-04-23 23:24:56.262 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:24:56.262 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:24:56.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:56.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.429365ms
[DEBUG] 2024-04-23 23:24:56.262 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:24:56.262 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:24:56.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.263 [HikariPool-6 housekeeper] HikariPool - HikariPool-6 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:24:56.270 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1853053762 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.274 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.274 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:56.274 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:56.274 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.280 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1853053762 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.283 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:56.283 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:56.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.301 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1853053762 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.305 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:24:56.305 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:24:56.305 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:24:56.305 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:24:56.305 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:56.305 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:56.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.305 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:56.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:56.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.828395ms
[DEBUG] 2024-04-23 23:24:56.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:56.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.414099ms
[DEBUG] 2024-04-23 23:24:56.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:56.307 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:56.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:56.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:56.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.737472ms
[DEBUG] 2024-04-23 23:24:56.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:56.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:24:56.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:56.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:56.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:56.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:56.322 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1853053762 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:56.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:56.331 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:56.331 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.331 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:24:56.333 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:24:56.335 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:24:56.337 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:24:56.339 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:24:56.341 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:24:56.343 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:56.343 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.343 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:56.344 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:56.344 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:56.345 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:24:58.346 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:24:58.347 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:24:58.347 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:24:58.347 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:58.350 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:58.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:58.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:58.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 4.092465ms
[DEBUG] 2024-04-23 23:24:58.351 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:24:58.351 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:24:58.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:58.352 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:58.352 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:58.352 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.308543ms
[DEBUG] 2024-04-23 23:24:58.352 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:24:58.352 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:24:58.352 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:58.354 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:58.354 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:24:58.354 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:24:58.354 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:58.355 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:58.355 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:24:58.355 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:24:58.355 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:58.356 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:58.357 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:24:58.357 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:24:58.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:58.358 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:58.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:58.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:58.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 1.327396ms
[DEBUG] 2024-04-23 23:24:58.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:58.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:58.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:58.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.777242ms
[DEBUG] 2024-04-23 23:24:58.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:58.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:58.361 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:24:58.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:24:58.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:58.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 1.558329ms
[DEBUG] 2024-04-23 23:24:58.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:24:58.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:24:58.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:24:58.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:24:58.363 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:24:58.363 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:24:58.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:24:58.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:24:58.365 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:24:58.365 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:58.365 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:24:58.365 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:24:58.365 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:24:58.365 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:24:58.365 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:24:58.365 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:24:58.365 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:24:58.365 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:58.365 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:24:58.366 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:24:58.366 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:24:58.367 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:00.367 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:25:00.368 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:25:00.368 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:00.368 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:00.370 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:00.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:00.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:00.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 3.544368ms
[DEBUG] 2024-04-23 23:25:00.371 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:25:00.371 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:25:00.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:00.372 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:00.372 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:00.372 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.443359ms
[DEBUG] 2024-04-23 23:25:00.372 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:25:00.372 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:25:00.372 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:00.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:00.373 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:00.373 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:00.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:00.374 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:00.374 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:00.374 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:00.374 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:00.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:00.375 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:00.375 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:00.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:00.375 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:00.376 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:00.376 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:00.376 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.750809ms
[DEBUG] 2024-04-23 23:25:00.376 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:00.376 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:00.376 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:00.376 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.424289ms
[DEBUG] 2024-04-23 23:25:00.376 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:00.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:00.377 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:00.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:00.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:00.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.69874ms
[DEBUG] 2024-04-23 23:25:00.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:00.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:25:00.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:00.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:00.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:00.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:00.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:00.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:00.379 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:00.379 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:00.379 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:00.379 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:00.379 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:00.379 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:00.379 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:00.379 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:00.379 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:00.380 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:00.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:00.380 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:00.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:00.380 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:00.690 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:25:00.694 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:25:02.381 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:25:02.381 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:25:02.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:02.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:02.384 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:02.385 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:02.385 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:02.385 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 3.486522ms
[DEBUG] 2024-04-23 23:25:02.385 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:25:02.385 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:25:02.385 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:02.386 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:02.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:02.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.432052ms
[DEBUG] 2024-04-23 23:25:02.387 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:25:02.387 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:25:02.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:02.388 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:02.388 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:02.388 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:02.388 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:02.388 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:02.388 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:02.388 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:02.388 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:02.389 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:02.389 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:02.389 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:02.389 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:02.390 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:02.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:02.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:02.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.823015ms
[DEBUG] 2024-04-23 23:25:02.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:02.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:02.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:02.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.549391ms
[DEBUG] 2024-04-23 23:25:02.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:02.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:02.392 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:02.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:02.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:02.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.767372ms
[DEBUG] 2024-04-23 23:25:02.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:02.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:25:02.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:02.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:02.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:02.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:02.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:02.394 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:02.394 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:02.394 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:02.394 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:02.394 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:02.394 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:02.394 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:02.394 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:02.394 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:02.394 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:02.394 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:02.394 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:02.395 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:02.395 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:02.395 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:02.478 [HikariPool-9 housekeeper] HikariPool - HikariPool-9 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:25:04.161 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:25:04.396 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:25:04.396 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:25:04.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:04.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:04.399 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:04.399 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:04.399 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:04.399 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 3.328599ms
[DEBUG] 2024-04-23 23:25:04.399 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:25:04.399 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:25:04.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:04.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:04.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:04.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.446036ms
[DEBUG] 2024-04-23 23:25:04.400 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:25:04.400 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:25:04.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:04.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:04.401 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:04.401 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:04.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:04.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:04.402 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:04.402 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:04.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:04.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:04.403 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:04.403 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:04.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:04.403 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:04.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:04.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:04.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.728583ms
[DEBUG] 2024-04-23 23:25:04.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:04.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:04.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:04.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.424279ms
[DEBUG] 2024-04-23 23:25:04.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:04.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:04.405 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:04.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:04.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:04.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.694786ms
[DEBUG] 2024-04-23 23:25:04.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:04.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:25:04.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:04.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:04.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:04.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:04.407 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:04.407 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:04.407 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:04.407 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:04.407 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:04.407 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:04.407 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:04.407 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:04.407 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:04.407 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:04.407 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:04.408 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:04.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:04.408 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:04.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:04.408 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:06.409 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:25:06.409 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:25:06.409 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:06.409 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:06.412 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:06.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:06.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:06.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 3.490464ms
[DEBUG] 2024-04-23 23:25:06.413 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:25:06.413 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:25:06.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:06.414 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:06.414 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:06.414 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.585481ms
[DEBUG] 2024-04-23 23:25:06.414 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:25:06.414 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:25:06.414 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:06.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:06.415 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:06.415 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:06.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:06.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:06.416 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:06.416 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:06.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:06.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:06.417 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:06.417 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:06.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:06.417 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:06.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:06.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:06.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.954743ms
[DEBUG] 2024-04-23 23:25:06.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:06.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:06.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:06.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.717663ms
[DEBUG] 2024-04-23 23:25:06.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:06.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:06.420 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:06.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:06.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:06.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 1.374893ms
[DEBUG] 2024-04-23 23:25:06.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:06.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:25:06.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:06.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:06.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:06.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:06.424 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:06.424 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:06.424 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:06.424 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:06.424 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:06.424 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:06.424 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:06.425 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:06.425 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:06.425 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:06.425 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:06.425 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:06.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:06.426 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:06.426 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:06.426 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:08.427 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:25:08.427 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:25:08.427 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:08.427 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:08.430 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:08.431 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:08.431 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:08.431 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 3.636905ms
[DEBUG] 2024-04-23 23:25:08.431 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:25:08.431 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:25:08.431 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:08.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:08.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:08.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.919317ms
[DEBUG] 2024-04-23 23:25:08.432 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:25:08.432 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:25:08.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:08.433 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:08.433 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:08.433 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:08.433 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:08.434 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:08.434 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:08.434 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:08.434 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:08.434 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:08.435 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:08.435 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:08.435 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:08.435 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:08.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:08.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:08.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.824996ms
[DEBUG] 2024-04-23 23:25:08.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:08.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:08.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:08.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.462845ms
[DEBUG] 2024-04-23 23:25:08.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:08.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:08.437 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:08.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:08.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:08.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.754089ms
[DEBUG] 2024-04-23 23:25:08.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:08.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:25:08.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:08.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:08.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:08.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:08.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:08.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:08.440 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:08.440 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:08.440 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:08.440 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:08.440 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:08.440 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:08.440 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:08.440 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:08.440 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:08.440 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:08.440 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:08.441 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:08.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:08.441 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:10.442 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:25:10.442 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:25:10.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:10.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:10.445 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:10.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:10.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:10.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 3.769642ms
[DEBUG] 2024-04-23 23:25:10.446 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:25:10.446 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:25:10.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:10.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:10.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:10.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.733015ms
[DEBUG] 2024-04-23 23:25:10.448 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:25:10.448 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:25:10.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:10.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:10.452 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:10.452 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:10.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:10.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:10.455 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:10.455 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:10.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:10.457 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:10.457 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:10.457 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:10.457 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:10.459 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:10.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:10.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:10.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 2.814407ms
[DEBUG] 2024-04-23 23:25:10.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:10.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:10.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:10.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 1.648859ms
[DEBUG] 2024-04-23 23:25:10.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:10.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:10.466 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:10.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:10.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:10.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 2.720017ms
[DEBUG] 2024-04-23 23:25:10.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:10.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:25:10.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:10.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:10.467 [HikariPool-8 housekeeper] HikariPool - HikariPool-8 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:25:10.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:10.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:10.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:10.473 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:10.473 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:10.474 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:10.474 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:10.474 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:10.474 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:10.474 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:10.474 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:10.474 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:10.474 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:10.475 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:10.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:10.476 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:10.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:10.477 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:12.477 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:25:12.478 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:25:12.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:12.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:12.480 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:12.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:12.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:12.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 3.501302ms
[DEBUG] 2024-04-23 23:25:12.481 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:25:12.481 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:25:12.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:12.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:12.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:12.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.232532ms
[DEBUG] 2024-04-23 23:25:12.483 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:25:12.483 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:25:12.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:12.484 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:12.484 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:12.484 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:12.484 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:12.485 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:12.485 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:12.485 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:12.485 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:12.485 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:12.486 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:12.486 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:12.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:12.486 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:12.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:12.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:12.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.870772ms
[DEBUG] 2024-04-23 23:25:12.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:12.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:12.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:12.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.465556ms
[DEBUG] 2024-04-23 23:25:12.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:12.488 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:12.488 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:12.488 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:12.488 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:12.488 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.746867ms
[DEBUG] 2024-04-23 23:25:12.489 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:12.489 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:25:12.489 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:12.489 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:12.489 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:12.489 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:12.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:12.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:12.490 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:12.490 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:12.490 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:12.491 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:12.491 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:12.491 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:12.491 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:12.491 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:12.491 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:12.491 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:12.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:12.492 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:12.492 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:12.492 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:14.493 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:25:14.493 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:25:14.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:14.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:14.496 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:14.497 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:14.497 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:14.497 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 3.580122ms
[DEBUG] 2024-04-23 23:25:14.497 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:25:14.497 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:25:14.497 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:14.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:14.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:14.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.513549ms
[DEBUG] 2024-04-23 23:25:14.498 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:25:14.498 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:25:14.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:14.500 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:14.500 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:14.500 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:14.500 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:14.500 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:14.500 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:14.500 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:14.500 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:14.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:14.501 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:14.501 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:14.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:14.502 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:14.502 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:14.502 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:14.502 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.800699ms
[DEBUG] 2024-04-23 23:25:14.502 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:14.503 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:14.503 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:14.503 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.439142ms
[DEBUG] 2024-04-23 23:25:14.503 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:14.503 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:14.504 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:14.504 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:14.504 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:14.504 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.695206ms
[DEBUG] 2024-04-23 23:25:14.504 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:14.504 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:25:14.504 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:14.504 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:14.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:14.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:14.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:14.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:14.506 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:14.506 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:14.506 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:14.506 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:14.506 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:14.506 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:14.506 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:14.506 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:14.506 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:14.506 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:14.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:14.507 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:14.507 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:14.507 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:16.507 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:25:16.508 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:25:16.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:16.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:16.510 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:16.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:16.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:16.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 3.439543ms
[DEBUG] 2024-04-23 23:25:16.511 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:25:16.511 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:25:16.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:16.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:16.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:16.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.065207ms
[DEBUG] 2024-04-23 23:25:16.513 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:25:16.513 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:25:16.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:16.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:16.514 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:16.514 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:16.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:16.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:16.514 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:16.514 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:16.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:16.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:16.515 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:16.515 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:16.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:16.516 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:16.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:16.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:16.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.73869ms
[DEBUG] 2024-04-23 23:25:16.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:16.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:16.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:16.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.427921ms
[DEBUG] 2024-04-23 23:25:16.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:16.517 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:16.517 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:16.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:16.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:16.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.72082ms
[DEBUG] 2024-04-23 23:25:16.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:16.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:25:16.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:16.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:16.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:16.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:16.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:16.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:16.520 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:16.520 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:16.520 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:16.521 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:16.521 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:16.521 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:16.521 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:16.521 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:25:16.521 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:16.521 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:16.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:16.522 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1189233304 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:16.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:16.522 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:16.522 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911096261 end=1713911116522 duration=20261 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=-1 error=true>
]]></system-out>
  </testcase>
  <testcase name="testPartitionDiscoverySkipInvalidPath" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="22.042">
    <error message="javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore&#10;NestedThrowables:&#10;java.sql.BatchUpdateException: DELETE on table &apos;DBS&apos; caused a violation of foreign key constraint &apos;TBLS_FK1&apos; for key (2).  The statement has been rolled back." type="org.apache.hadoop.hive.metastore.api.MetaException"><![CDATA[org.apache.hadoop.hive.metastore.api.MetaException: 
javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
NestedThrowables:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.tearDown(TestPartitionManagement.java:100)
]]></error>
    <system-out><![CDATA[[INFO ] 2024-04-23 23:25:16.523 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:25:16.523 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:25:16.523 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:25:16.523 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:25:16.530 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:25:16.530 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:25:16.530 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:25:16.530 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:25:16.531 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:25:16.559 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031;create=true
[INFO ] 2024-04-23 23:25:16.913 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:25:16.913 [MetaStoreThread-37031] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:25:16.913 [MetaStoreThread-37031] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:25:16.913 [MetaStoreThread-37031] HMSHandler - 43: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:25:16.913 [MetaStoreThread-37031] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:25:16.913 [MetaStoreThread-37031] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:16.913 [MetaStoreThread-37031] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:25:16.913 [MetaStoreThread-37031] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031;create=true
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031;create=true
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031;create=true
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 120
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:25:16.914 [MetaStoreThread-37031] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:25:16.915 [MetaStoreThread-37031] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:25:16.915 [MetaStoreThread-37031] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:25:16.916 [MetaStoreThread-37031] HikariConfig - HikariPool-11 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:25:16.916 [MetaStoreThread-37031] HikariConfig - HikariPool-11 - configuration:
[DEBUG] 2024-04-23 23:25:16.916 [MetaStoreThread-37031] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:25:16.916 [MetaStoreThread-37031] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:25:16.916 [MetaStoreThread-37031] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:25:16.916 [MetaStoreThread-37031] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:25:16.916 [MetaStoreThread-37031] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:25:16.916 [MetaStoreThread-37031] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:25:16.916 [MetaStoreThread-37031] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:25:16.916 [MetaStoreThread-37031] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:25:16.916 [MetaStoreThread-37031] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:25:16.916 [MetaStoreThread-37031] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:25:16.916 [MetaStoreThread-37031] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:25:16.916 [MetaStoreThread-37031] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:25:16.916 [MetaStoreThread-37031] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:25:16.916 [MetaStoreThread-37031] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:25:16.916 [MetaStoreThread-37031] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:25:16.916 [MetaStoreThread-37031] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:25:16.916 [MetaStoreThread-37031] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:25:16.917 [MetaStoreThread-37031] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:25:16.917 [MetaStoreThread-37031] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031;create=true"
[DEBUG] 2024-04-23 23:25:16.917 [MetaStoreThread-37031] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:25:16.917 [MetaStoreThread-37031] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:25:16.917 [MetaStoreThread-37031] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:25:16.917 [MetaStoreThread-37031] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:25:16.917 [MetaStoreThread-37031] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:25:16.917 [MetaStoreThread-37031] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:25:16.917 [MetaStoreThread-37031] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:25:16.917 [MetaStoreThread-37031] HikariConfig - poolName........................"HikariPool-11"
[DEBUG] 2024-04-23 23:25:16.917 [MetaStoreThread-37031] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:25:16.917 [MetaStoreThread-37031] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:25:16.917 [MetaStoreThread-37031] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:25:16.917 [MetaStoreThread-37031] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:25:16.917 [MetaStoreThread-37031] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:25:16.917 [MetaStoreThread-37031] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:25:16.917 [MetaStoreThread-37031] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:25:16.917 [MetaStoreThread-37031] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:25:16.917 [MetaStoreThread-37031] HikariDataSource - HikariPool-11 - Starting...
[INFO ] 2024-04-23 23:25:16.919 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:25:16.919 [MetaStoreThread-37031] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[INFO ] 2024-04-23 23:25:16.919 [MetaStoreThread-37031] HikariDataSource - HikariPool-11 - Start completed.
[DEBUG] 2024-04-23 23:25:17.019 [HikariPool-11 housekeeper] HikariPool - HikariPool-11 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:25:17.021 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@516591018 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.023 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1610057617 (XID = 1157), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.024 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1851971819 (XID = 1159), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.025 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1071151326 (XID = 1161), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.027 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@509847514 (XID = 1163), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.028 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@999695271 (XID = 1165), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.029 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@706209929 (XID = 1167), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.030 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1122549024 (XID = 1169), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.032 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@817372377 (XID = 1171), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.032 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:25:17.126 [MetaStoreThread-37031] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:25:17.126 [MetaStoreThread-37031] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@464cce0f, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:25:17.126 [MetaStoreThread-37031] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:25:17.126 [MetaStoreThread-37031] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@464cce0f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@33f19fe2 created in the thread with id: 330
[DEBUG] 2024-04-23 23:25:17.126 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.127 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.127 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.207 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.285 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:25:17.285 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:25:17.285 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:25:17.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3e8d127d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@86a18b8 will be shutdown
[DEBUG] 2024-04-23 23:25:17.285 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 40: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:25:17.285 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:25:17.297 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@516591018 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.311 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@516591018 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.348 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@516591018 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.364 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@516591018 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.369 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@516591018 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.478 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@516591018 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.504 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@516591018 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.510 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@516591018 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.516 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@516591018 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.518 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.519 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.520 [MetaStoreThread-37031] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:25:17.520 [MetaStoreThread-37031] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:25:17.520 [MetaStoreThread-37031] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@464cce0f from thread id: 330
[DEBUG] 2024-04-23 23:25:17.520 [MetaStoreThread-37031] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:25:17.520 [MetaStoreThread-37031] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:17.523 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.525 [MetaStoreThread-37031] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:17.526 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[INFO ] 2024-04-23 23:25:17.526 [MetaStoreThread-37031] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:25:17.526 [MetaStoreThread-37031] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:17.526 [MetaStoreThread-37031] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:17.526 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.526 [MetaStoreThread-37031] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:17.526 [MetaStoreThread-37031] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:17.529 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.529 [MetaStoreThread-37031] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:17.531 [MetaStoreThread-37031] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:17.531 [MetaStoreThread-37031] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:17.531 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.531 [MetaStoreThread-37031] ObjectStore - db details for db default retrieved using SQL in 1.895187ms
[DEBUG] 2024-04-23 23:25:17.531 [MetaStoreThread-37031] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:25:17.531 [MetaStoreThread-37031] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:25:17.531 [MetaStoreThread-37031] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:17.536 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.538 [MetaStoreThread-37031] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:17.538 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.540 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[INFO ] 2024-04-23 23:25:17.541 [MetaStoreThread-37031] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:25:17.541 [MetaStoreThread-37031] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:17.541 [MetaStoreThread-37031] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:17.544 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.546 [MetaStoreThread-37031] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:17.548 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@516591018 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.550 [MetaStoreThread-37031] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:17.550 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[INFO ] 2024-04-23 23:25:17.550 [MetaStoreThread-37031] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:25:17.550 [MetaStoreThread-37031] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:17.550 [MetaStoreThread-37031] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:17.551 [MetaStoreThread-37031] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:17.551 [MetaStoreThread-37031] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:17.551 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[INFO ] 2024-04-23 23:25:17.551 [MetaStoreThread-37031] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:25:17.551 [MetaStoreThread-37031] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:17.551 [MetaStoreThread-37031] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:17.552 [MetaStoreThread-37031] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:17.552 [MetaStoreThread-37031] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:17.555 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@516591018 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.558 [MetaStoreThread-37031] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:17.560 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@516591018 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.561 [MetaStoreThread-37031] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:17.562 [MetaStoreThread-37031] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[INFO ] 2024-04-23 23:25:17.562 [MetaStoreThread-37031] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:25:17.562 [MetaStoreThread-37031] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:25:17.562 [MetaStoreThread-37031] PerfLogger - </PERFLOG method=init start=1713911116913 end=1713911117562 duration=649 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=43 retryCount=0 error=false>
[INFO ] 2024-04-23 23:25:17.562 [MetaStoreThread-37031] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:25:17.562 [MetaStoreThread-37031] HiveMetaStore - Started the new metaserver on port [37031]...
[INFO ] 2024-04-23 23:25:17.562 [MetaStoreThread-37031] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:25:17.562 [MetaStoreThread-37031] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:25:17.562 [MetaStoreThread-37031] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:25:17.562 [MetaStoreThread-37031] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:25:17.562 [MetaStoreThread-37031] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:25:17.562 [MetaStoreThread-37031] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:25:17.562 [MetaStoreThread-37031] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:25:17.562 [MetaStoreThread-37031] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:25:17.562 [MetaStoreThread-37031] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:25:17.562 [MetaStoreThread-37031] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:25:17.562 [MetaStoreThread-37031] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:25:17.562 [MetaStoreThread-37031] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:25:17.562 [MetaStoreThread-37031] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:25:17.562 [MetaStoreThread-37031] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:25:17.562 [MetaStoreThread-37031] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:25:17.562 [MetaStoreThread-37031] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:25:17.915 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:25:17.915 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 44: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:25:17.915 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:25:17.923 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/37031) is created
[INFO ] 2024-04-23 23:25:17.923 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 37031 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/37031 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031;create=true
[INFO ] 2024-04-23 23:25:17.923 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:25:17.926 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:25:17.926 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:37031]
[INFO ] 2024-04-23 23:25:17.926 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:37031)
[INFO ] 2024-04-23 23:25:17.926 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:37031) current connections: 7
[DEBUG] 2024-04-23 23:25:17.927 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:17.927 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911117927 end=1713911117927 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=45 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:17.927 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:17.927 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:17.927 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 create_database: Database(name:db8, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:25:17.927 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db8, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031;create=true
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031;create=true
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:25:17.928 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:25:17.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@768f275d, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:25:17.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:25:17.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@768f275d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@191ab1a3 created in the thread with id: 347
[DEBUG] 2024-04-23 23:25:17.930 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.930 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.930 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.931 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.932 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.932 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:25:17.932 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:25:17.932 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@768f275d from thread id: 347
[DEBUG] 2024-04-23 23:25:17.932 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:17.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:17.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:17.933 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.583303ms
[DEBUG] 2024-04-23 23:25:17.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db8, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:25:17.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:25:17.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:17.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:17.933 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.934 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:25:17.934 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:25:17.934 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:25:17.934 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:25:17.934 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[WARN ] 2024-04-23 23:25:17.934 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db for database db8. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:25:17.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:17.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:17.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:17.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:17.936 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.937 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713911117927 end=1713911117937 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=45 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:17.937 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:17.937 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:17.937 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 create_table_req: Table(tableName:tbl8, dbName:db8, owner:alex, createTime:1713911117, lastAccessTime:1713911117, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:do, type:double, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:s, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:25:17.937 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl8, dbName:db8, owner:alex, createTime:1713911117, lastAccessTime:1713911117, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:do, type:double, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:s, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:25:17.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:17.942 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:17.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:17.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:17.943 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 5.604488ms
[DEBUG] 2024-04-23 23:25:17.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:17.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:17.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:25:17.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:17.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:17.950 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:17.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:17.951 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:17.952 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:17.952 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:17.952 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.654397ms
[DEBUG] 2024-04-23 23:25:17.952 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:17.952 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:17.952 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:25:17.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:17.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:17.953 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:25:17.953 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:25:17.953 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:25:17.953 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:25:17.954 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/37031/db8.db/tbl8
[DEBUG] 2024-04-23 23:25:17.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:17.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:17.964 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:17.967 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@516591018 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.972 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@516591018 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.977 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@516591018 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.982 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@516591018 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:17.999 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:17.999 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.002 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.003 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713911117937 end=1713911118003 duration=66 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=45 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.003 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.003 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.004 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 add_partition : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:25:18.004 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:25:18.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:18.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:25:18.012 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:18.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.042 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.042 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:25:18.042 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:25:18.042 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:25:18.042 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:25:18.042 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/37031/db8.db/tbl8/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:25:18.047 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.047 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:18.047 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:25:18.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:18.051 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@516591018 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.061 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.063 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911118003 end=1713911118063 duration=60 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=45 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.063 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.063 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.063 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 add_partition : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:25:18.063 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:25:18.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:18.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:25:18.065 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:18.068 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.068 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.068 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.069 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:25:18.069 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:25:18.069 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:25:18.069 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:25:18.069 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/37031/db8.db/tbl8/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:25:18.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:18.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:25:18.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:18.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.079 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.080 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911118063 end=1713911118080 duration=17 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=45 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.081 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.081 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.081 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 add_partition : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:25:18.081 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:25:18.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:18.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:25:18.083 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:18.086 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.086 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.086 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.086 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:25:18.086 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:25:18.086 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:25:18.086 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:25:18.087 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/37031/db8.db/tbl8/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:25:18.091 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.091 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:18.091 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:25:18.092 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:18.095 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.095 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.097 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.098 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911118081 end=1713911118098 duration=17 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=45 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.099 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.099 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.099 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713911118099 end=1713911118099 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=45 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.099 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.099 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.099 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_table : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:25:18.099 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:25:18.099 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.100 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:18.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.100 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.101 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.183589ms
[DEBUG] 2024-04-23 23:25:18.101 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.101 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.101 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:25:18.103 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.106 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.107 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[INFO ] 2024-04-23 23:25:18.107 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:25:18.107 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911118099 end=1713911118107 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=45 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.108 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=9, comments=HMS client
[DEBUG] 2024-04-23 23:25:18.108 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.108 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.108 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_partitions : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:25:18.108 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:25:18.108 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:25:18.108 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.108 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.113 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.870525ms + 0.005572ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:25:18.117 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.22162ms + 0.214351ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:25:18.119 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.667856ms + 0.235806ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:25:18.121 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.511998ms + 0.180384ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:18.123 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.877789ms + 0.128418ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:25:18.124 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.555559ms + 0.126249ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:18.126 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.727336ms + 0.123895ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:18.128 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.750083ms + 0.156031ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:18.130 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.704996ms + 0.320334ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:18.133 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.9225ms + 0.154219ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:25:18.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 24.603405ms
[DEBUG] 2024-04-23 23:25:18.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.133 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.133 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911118108 end=1713911118133 duration=25 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=45 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.144 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.144 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.144 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 alter_table: hive.db8.tbl8 newtbl=tbl8
[INFO ] 2024-04-23 23:25:18.144 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db8.tbl8 newtbl=tbl8	
[DEBUG] 2024-04-23 23:25:18.144 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.145 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:18.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.145 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.166641ms
[DEBUG] 2024-04-23 23:25:18.145 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:25:18.145 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:25:18.145 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:25:18.145 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:25:18.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.146 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:18.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.146 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.019618ms
[DEBUG] 2024-04-23 23:25:18.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:25:18.148 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.151 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.152 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.153 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.153 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:18.154 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.154 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.154 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.061013ms
[DEBUG] 2024-04-23 23:25:18.154 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.154 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:18.154 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:25:18.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:18.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.157 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db8
[WARN ] 2024-04-23 23:25:18.157 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:25:18.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:18.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:18.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:18.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:25:18.159 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:18.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:25:18.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:18.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:25:18.164 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:18.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.168 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.169 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713911118144 end=1713911118169 duration=25 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=45 retryCount=0 error=false>
[INFO ] 2024-04-23 23:25:18.170 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:25:18.170 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:37031]
[INFO ] 2024-04-23 23:25:18.170 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:37031)
[INFO ] 2024-04-23 23:25:18.170 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:37031) current connections: 8
[DEBUG] 2024-04-23 23:25:18.171 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.171 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911118170 end=1713911118171 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.171 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.171 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.171 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:25:18.171 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:25:18.172 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:25:18.172 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:25:18.172 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:18.172 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:25:18.172 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:25:18.172 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:25:18.172 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031;create=true
[DEBUG] 2024-04-23 23:25:18.172 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:25:18.172 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:25:18.172 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:18.172 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:25:18.172 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:25:18.172 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:25:18.172 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:25:18.172 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:18.172 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:18.172 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:25:18.172 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:25:18.172 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:18.172 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031;create=true
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@a572d3e, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@a572d3e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@572da61e created in the thread with id: 360
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.173 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.175 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.175 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.175 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:25:18.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:25:18.175 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@a572d3e from thread id: 360
[DEBUG] 2024-04-23 23:25:18.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:25:18.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.181 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.183 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:18.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.183 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.965679ms
[DEBUG] 2024-04-23 23:25:18.183 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911118171 end=1713911118183 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[INFO ] 2024-04-23 23:25:18.183 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 1
[DEBUG] 2024-04-23 23:25:18.183 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.183 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.183 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_database: db8
[INFO ] 2024-04-23 23:25:18.184 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db8	
[DEBUG] 2024-04-23 23:25:18.184 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.184 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:18.184 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.184 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.184 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.184 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.832681ms
[DEBUG] 2024-04-23 23:25:18.184 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911118183 end=1713911118184 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.185 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:25:18.185 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.185 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.185 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_table : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:25:18.185 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:25:18.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.186 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:18.186 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.186 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.186 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.186 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.885945ms
[DEBUG] 2024-04-23 23:25:18.186 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.186 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.186 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:25:18.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.192 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[INFO ] 2024-04-23 23:25:18.193 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:25:18.193 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911118185 end=1713911118193 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.194 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=9, comments=HMS client
[INFO ] 2024-04-23 23:25:18.194 [main] PartitionManagementTask - Found 1 candidate tables for partition discovery
[INFO ] 2024-04-23 23:25:18.195 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:25:18.195 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:25:18.195 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:25:18.195 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:25:18.195 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:25:18.195 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:25:18.195 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:25:18.196 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[WARN ] 2024-04-23 23:25:18.197 [main] PartitionManagementTask - 'partition.retention.period' table property is defined but empty. Skipping retention period..
[INFO ] 2024-04-23 23:25:18.197 [main] PartitionManagementTask - Running partition discovery for table hive.db8.tbl8 retentionPeriod: -1s
[INFO ] 2024-04-23 23:25:18.198 [PartitionDiscoveryTask-0] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:25:18.198 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:37031]
[INFO ] 2024-04-23 23:25:18.198 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:37031)
[INFO ] 2024-04-23 23:25:18.199 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:37031) current connections: 9
[DEBUG] 2024-04-23 23:25:18.199 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.199 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911118199 end=1713911118199 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=47 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.199 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.199 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.200 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 47: source:127.0.0.1 get_database: db8
[INFO ] 2024-04-23 23:25:18.200 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db8	
[INFO ] 2024-04-23 23:25:18.200 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 47: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:25:18.200 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:25:18.200 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:18.200 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:25:18.200 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:25:18.200 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:25:18.200 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031;create=true
[DEBUG] 2024-04-23 23:25:18.200 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:25:18.200 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:25:18.200 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:18.200 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:25:18.200 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031;create=true
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@497b48ce, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@497b48ce, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7d05cbea created in the thread with id: 362
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.201 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.202 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.203 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.203 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:25:18.203 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:25:18.203 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@497b48ce from thread id: 362
[DEBUG] 2024-04-23 23:25:18.203 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.203 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:18.204 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.204 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.204 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.204 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.809915ms
[DEBUG] 2024-04-23 23:25:18.204 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911118199 end=1713911118204 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=47 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.204 [PartitionDiscoveryTask-0] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=5, comments=HMS client
[INFO ] 2024-04-23 23:25:18.204 [PartitionDiscoveryTask-0] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:25:18.204 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:37031]
[INFO ] 2024-04-23 23:25:18.204 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:37031)
[INFO ] 2024-04-23 23:25:18.205 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:37031) current connections: 10
[DEBUG] 2024-04-23 23:25:18.205 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.205 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911118205 end=1713911118205 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.205 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.205 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_table : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db8.tbl8	
[INFO ] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031;create=true
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:18.206 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031;create=true
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@29762754, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@29762754, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@518d19f9 created in the thread with id: 363
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.207 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.208 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.208 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.208 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:25:18.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:25:18.209 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@29762754 from thread id: 363
[DEBUG] 2024-04-23 23:25:18.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.209 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:18.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.209 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.783825ms
[DEBUG] 2024-04-23 23:25:18.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:25:18.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.215 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[INFO ] 2024-04-23 23:25:18.216 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:25:18.216 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911118205 end=1713911118216 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.216 [PartitionDiscoveryTask-0] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=11, comments=HMS client
[DEBUG] 2024-04-23 23:25:18.216 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.216 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partition_names from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.216 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_partition_names : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:25:18.216 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partition_names : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:25:18.216 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.216 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionNames
[DEBUG] 2024-04-23 23:25:18.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.221 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.222 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partition_names start=1713911118216 end=1713911118222 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.222 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.222 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions_by_names_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.222 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: source:127.0.0.1 get_partitions_by_names : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:25:18.222 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions_by_names : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:25:18.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.225 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.104712ms + 0.004962ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  and "PARTITIONS"."PART_NAME" in (?,?,?)]
[DEBUG] 2024-04-23 23:25:18.230 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.75562ms + 0.081489ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (1,2,3) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:25:18.233 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.618794ms + 0.399582ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (1,2,3) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:25:18.235 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.459139ms + 0.203131ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (1,2,3) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:18.236 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.18726ms + 0.118088ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:25:18.236 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.149329ms + 0.115984ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:18.236 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.134603ms + 0.113718ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:18.237 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.12902ms + 0.113096ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:18.237 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.193585ms + 0.238758ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:18.237 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.161436ms + 0.116224ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:25:18.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 15.237429ms
[DEBUG] 2024-04-23 23:25:18.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:18.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:25:18.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:18.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:18.242 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:25:18.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.243 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.244 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions_by_names_req start=1713911118222 end=1713911118244 duration=22 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.245 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - Using multi-threaded version of MSCK-GetPaths with number of threads 15
[WARN ] 2024-04-23 23:25:18.247 [MSCK-GetPaths-2] HiveMetaStoreChecker - Invalid partition name file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/37031/db8.db/tbl8/state=UT/dt=
[DEBUG] 2024-04-23 23:25:18.248 [PartitionDiscoveryTask-0] MetaStoreServerUtils - tablePath:file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/37031/db8.db/tbl8, partCols: [state, dt]
[DEBUG] 2024-04-23 23:25:18.248 [PartitionDiscoveryTask-0] MetaStoreServerUtils - Converting '2018-12-01' to type: 'date'.
[DEBUG] 2024-04-23 23:25:18.248 [PartitionDiscoveryTask-0] MetaStoreServerUtils - currPath=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/37031/db8.db/tbl8/state=WA
[DEBUG] 2024-04-23 23:25:18.248 [PartitionDiscoveryTask-0] MetaStoreServerUtils - Converting 'WA' to type: 'string'.
[DEBUG] 2024-04-23 23:25:18.248 [PartitionDiscoveryTask-0] MetaStoreServerUtils - currPath=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/37031/db8.db/tbl8
[DEBUG] 2024-04-23 23:25:18.248 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - PartitionName: state=WA/dt=2018-12-01
[DEBUG] 2024-04-23 23:25:18.248 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - Number of partitions not in metastore : 1
[INFO ] 2024-04-23 23:25:18.248 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - Number of partitionsNotInMs=[tbl8:state=WA/dt=2018-12-01], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
[INFO ] 2024-04-23 23:25:18.248 [PartitionDiscoveryTask-0] Msck - hive.db8.tbl8 - #partsNotInMs: 1 #partsNotInFs: 0 #expiredPartitions: 0 lockRequired: true (R: true A: true D: true)
[DEBUG] 2024-04-23 23:25:18.248 [PartitionDiscoveryTask-0] Msck - Repair: Added partition to metastore tbl8:state=WA/dt=2018-12-01
[DEBUG] 2024-04-23 23:25:18.249 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.249 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partitions_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.249 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: add_partitions
[INFO ] 2024-04-23 23:25:18.249 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=add_partitions	
[DEBUG] 2024-04-23 23:25:18.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.250 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:18.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.250 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.458297ms
[DEBUG] 2024-04-23 23:25:18.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:18.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:25:18.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:18.256 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.256 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.256 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:18.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.901933ms
[DEBUG] 2024-04-23 23:25:18.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.258 [HMSHandler #2] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.lambda$createPartitionFolders$14(HMSHandler.java:4385)
[DEBUG] 2024-04-23 23:25:18.258 [HMSHandler #2] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:25:18.258 [HMSHandler #2] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:25:18.258 [HMSHandler #2] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:25:18.258 [HMSHandler #2] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:25:18.259 [HMSHandler #2] MetaStoreServerUtils - Updating partition stats fast for: tbl8
[INFO ] 2024-04-23 23:25:18.259 [HMSHandler #2] MetaStoreServerUtils - Updated size to 0
[DEBUG] 2024-04-23 23:25:18.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:18.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:25:18.260 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:18.264 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.267 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.268 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partitions_req start=1713911118249 end=1713911118268 duration=19 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[INFO ] 2024-04-23 23:25:18.268 [PartitionDiscoveryTask-0] Msck - Tables not in metastore: []
Tables missing on filesystem: []
Partitions not in metastore: [tbl8:state=WA/dt=2018-12-01]
Partitions missing from filesystem: []
Expired partitions: []

[INFO ] 2024-04-23 23:25:18.268 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Closed a connection to metastore, current connections: 9
[DEBUG] 2024-04-23 23:25:18.268 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[INFO ] 2024-04-23 23:25:18.268 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Closed a connection to metastore, current connections: 8
[DEBUG] 2024-04-23 23:25:18.268 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.268 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:25:18.268 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[INFO ] 2024-04-23 23:25:18.268 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 7
[DEBUG] 2024-04-23 23:25:18.268 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.268 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:25:18.268 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:25:18.268 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:25:18.268 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:25:18.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@29762754, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@518d19f9 will be shutdown
[DEBUG] 2024-04-23 23:25:18.268 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.268 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 47: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:25:18.268 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:25:18.268 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:25:18.268 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:25:18.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@a572d3e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@572da61e will be shutdown
[DEBUG] 2024-04-23 23:25:18.268 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_partitions : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:25:18.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@497b48ce, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7d05cbea will be shutdown
[INFO ] 2024-04-23 23:25:18.268 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:25:18.269 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 47: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:25:18.269 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[INFO ] 2024-04-23 23:25:18.269 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:25:18.269 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.269 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911118268 end=1713911118269 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=47 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.269 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.269 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:25:18.269 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:25:18.269 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:25:18.269 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911118268 end=1713911118269 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[INFO ] 2024-04-23 23:25:18.269 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:25:18.269 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911118268 end=1713911118269 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.269 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:25:18.269 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:25:18.269 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:25:18.269 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:25:18.269 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 47: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:25:18.269 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 48: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:25:18.269 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:25:18.269 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:25:18.269 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:25:18.270 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.011458ms + 0.005132ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:25:18.273 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.895568ms + 0.078625ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,4,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:25:18.275 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.632548ms + 0.378028ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,4,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:25:18.277 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.521068ms + 0.154225ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,4,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:18.279 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.723533ms + 0.131096ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,5,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:25:18.281 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.915642ms + 0.126072ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,5,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:18.283 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.460811ms + 0.229007ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,5,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:18.284 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.530866ms + 0.121978ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,5,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:18.285 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.249453ms + 0.342805ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:18.287 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.649509ms + 0.127375ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,5,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:25:18.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 4 entries retrieved using SQL in 18.25781ms
[DEBUG] 2024-04-23 23:25:18.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.287 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.287 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911118268 end=1713911118287 duration=19 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=45 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.288 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.288 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.288 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:25:18.288 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:25:18.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:25:18.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.290 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.291 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713911118288 end=1713911118291 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=45 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.291 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.291 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.291 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:25:18.291 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:25:18.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.293 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.294 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911118291 end=1713911118294 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=45 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.294 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.294 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.294 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_database: db8
[INFO ] 2024-04-23 23:25:18.294 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db8	
[DEBUG] 2024-04-23 23:25:18.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.295 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:18.295 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.295 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.295 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.295 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.284929ms
[DEBUG] 2024-04-23 23:25:18.295 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911118294 end=1713911118295 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=45 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.295 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=1, comments=HMS client
[DEBUG] 2024-04-23 23:25:18.296 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.296 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.296 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_tables_by_type: db=@hive#db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:18.296 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:18.296 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:18.296 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:18.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.297 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:18.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.297 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.264446ms
[DEBUG] 2024-04-23 23:25:18.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.300 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 3.0643ms
[DEBUG] 2024-04-23 23:25:18.300 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911118296 end=1713911118300 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=45 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.300 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.301 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.301 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:25:18.301 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:25:18.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.304 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 3.15595ms
[DEBUG] 2024-04-23 23:25:18.304 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911118301 end=1713911118304 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=45 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.304 [main] HiveMetaStoreClient - Selecting dropDatabase method for db8 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:25:18.304 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:25:18.304 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.304 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.305 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:18.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.306 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.59359ms
[DEBUG] 2024-04-23 23:25:18.306 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_multi_table : db=db8 tbls=tbl8
[INFO ] 2024-04-23 23:25:18.306 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db8 tbls=tbl8	
[DEBUG] 2024-04-23 23:25:18.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.311 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:18.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.22593ms
[DEBUG] 2024-04-23 23:25:18.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.311 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.311 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911118304 end=1713911118311 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=45 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:18.311 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:18.312 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:18.312 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:25:18.312 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:25:18.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:18.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.312 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:18.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.881161ms
[DEBUG] 2024-04-23 23:25:18.313 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:25:18.313 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:25:18.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.604609ms
[DEBUG] 2024-04-23 23:25:18.313 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:25:18.313 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:25:18.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.322 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@516591018 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.325 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:18.325 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:18.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.329 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@516591018 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.332 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:18.332 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:18.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.353 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@516591018 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.356 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.357 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:25:18.357 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:25:18.357 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:25:18.357 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:25:18.357 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:18.357 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:18.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.357 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:18.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.924758ms
[DEBUG] 2024-04-23 23:25:18.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.524435ms
[DEBUG] 2024-04-23 23:25:18.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:18.360 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:18.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:18.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:18.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.940081ms
[DEBUG] 2024-04-23 23:25:18.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:18.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:25:18.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:18.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:18.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:18.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:18.376 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@516591018 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:18.384 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:18.384 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:18.384 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.384 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:18.386 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:18.388 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:18.389 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:18.391 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:18.393 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:18.395 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:18.395 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.395 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:18.396 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:18.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:18.396 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:18.398 [HikariPool-7 housekeeper] HikariPool - HikariPool-7 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:25:19.837 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:25:20.398 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:25:20.398 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:25:20.398 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:20.398 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:20.400 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:20.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:20.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:20.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.08036ms
[DEBUG] 2024-04-23 23:25:20.401 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:25:20.401 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:25:20.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:20.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:20.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:20.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.698374ms
[DEBUG] 2024-04-23 23:25:20.403 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:25:20.403 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:25:20.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:20.407 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:20.408 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:20.408 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:20.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:20.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:20.410 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:20.410 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:20.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:20.412 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:20.413 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:20.413 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:20.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:20.415 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:20.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:20.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:20.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 2.788327ms
[DEBUG] 2024-04-23 23:25:20.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:20.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:20.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:20.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 1.638314ms
[DEBUG] 2024-04-23 23:25:20.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:20.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:20.422 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:20.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:20.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:20.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 2.671019ms
[DEBUG] 2024-04-23 23:25:20.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:20.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:25:20.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:20.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:20.426 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:20.426 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:20.428 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:20.429 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:20.429 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:20.429 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:20.430 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:20.430 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:20.430 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:20.430 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:20.430 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:20.430 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:20.430 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:20.431 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:20.431 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:20.433 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:20.433 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:20.433 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:22.434 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:25:22.434 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:25:22.434 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:22.434 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:22.437 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:22.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:22.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:22.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.127594ms
[DEBUG] 2024-04-23 23:25:22.438 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:25:22.438 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:25:22.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:22.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:22.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:22.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.610409ms
[DEBUG] 2024-04-23 23:25:22.439 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:25:22.439 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:25:22.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:22.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:22.441 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:22.441 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:22.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:22.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:22.441 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:22.442 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:22.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:22.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:22.442 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:22.442 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:22.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:22.443 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:22.443 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:22.443 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:22.443 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.812083ms
[DEBUG] 2024-04-23 23:25:22.443 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:22.444 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:22.444 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:22.444 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.461822ms
[DEBUG] 2024-04-23 23:25:22.444 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:22.444 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:22.445 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:22.445 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:22.445 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:22.445 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.684116ms
[DEBUG] 2024-04-23 23:25:22.445 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:22.445 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:25:22.445 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:22.445 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:22.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:22.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:22.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:22.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:22.447 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:22.447 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:22.447 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:22.447 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:22.447 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:22.447 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:22.447 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:22.447 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:22.447 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:22.447 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:22.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:22.449 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:22.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:22.450 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:24.450 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:25:24.451 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:25:24.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:24.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:24.453 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:24.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:24.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:24.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.362171ms
[DEBUG] 2024-04-23 23:25:24.454 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:25:24.454 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:25:24.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:24.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:24.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:24.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.905159ms
[DEBUG] 2024-04-23 23:25:24.455 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:25:24.455 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:25:24.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:24.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:24.457 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:24.457 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:24.457 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:24.457 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:24.457 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:24.457 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:24.457 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:24.458 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:24.458 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:24.458 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:24.458 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:24.458 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:24.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:24.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:24.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.759094ms
[DEBUG] 2024-04-23 23:25:24.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:24.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:24.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:24.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.428185ms
[DEBUG] 2024-04-23 23:25:24.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:24.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:24.460 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:24.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:24.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:24.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.687202ms
[DEBUG] 2024-04-23 23:25:24.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:24.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:25:24.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:24.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:24.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:24.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:24.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:24.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:24.462 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:24.462 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:24.462 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:24.462 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:24.463 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:24.463 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:24.463 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:24.463 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:24.463 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:24.463 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:24.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:24.463 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:24.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:24.464 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:25.063 [HikariPool-10 housekeeper] HikariPool - HikariPool-10 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:25:26.071 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:25:26.263 [HikariPool-6 housekeeper] HikariPool - HikariPool-6 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:25:26.464 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:25:26.464 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:25:26.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:26.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:26.467 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:26.468 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:26.468 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:26.468 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.435617ms
[DEBUG] 2024-04-23 23:25:26.468 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:25:26.468 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:25:26.468 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:26.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:26.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:26.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.542081ms
[DEBUG] 2024-04-23 23:25:26.470 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:25:26.470 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:25:26.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:26.471 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:26.471 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:26.471 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:26.471 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:26.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:26.472 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:26.472 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:26.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:26.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:26.473 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:26.473 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:26.473 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:26.473 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:26.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:26.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:26.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.792317ms
[DEBUG] 2024-04-23 23:25:26.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:26.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:26.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:26.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.457599ms
[DEBUG] 2024-04-23 23:25:26.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:26.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:26.475 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:26.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:26.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:26.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.785061ms
[DEBUG] 2024-04-23 23:25:26.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:26.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:25:26.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:26.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:26.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:26.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:26.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:26.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:26.478 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:26.478 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:26.478 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:26.478 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:26.478 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:26.478 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:26.478 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:26.478 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:26.478 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:26.478 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:26.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:26.479 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:26.479 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:26.479 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:28.479 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:25:28.480 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:25:28.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:28.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:28.482 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:28.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:28.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:28.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.593696ms
[DEBUG] 2024-04-23 23:25:28.483 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:25:28.484 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:25:28.484 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:28.485 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:28.485 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:28.485 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.760959ms
[DEBUG] 2024-04-23 23:25:28.485 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:25:28.485 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:25:28.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:28.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:28.487 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:28.487 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:28.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:28.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:28.488 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:28.488 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:28.488 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:28.488 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:28.488 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:28.488 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:28.488 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:28.489 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:28.489 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:28.489 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:28.489 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.794888ms
[DEBUG] 2024-04-23 23:25:28.489 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:28.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:28.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:28.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.471846ms
[DEBUG] 2024-04-23 23:25:28.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:28.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:28.491 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:28.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:28.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:28.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.799253ms
[DEBUG] 2024-04-23 23:25:28.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:28.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:25:28.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:28.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:28.492 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:28.492 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:28.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:28.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:28.493 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:28.493 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:28.493 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:28.493 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:28.493 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:28.493 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:28.493 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:28.493 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:28.493 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:28.494 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:28.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:28.494 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:28.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:28.495 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:30.495 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:25:30.495 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:25:30.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:30.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:30.498 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:30.499 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:30.499 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:30.499 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.351806ms
[DEBUG] 2024-04-23 23:25:30.499 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:25:30.499 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:25:30.499 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:30.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:30.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:30.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.621113ms
[DEBUG] 2024-04-23 23:25:30.501 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:25:30.501 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:25:30.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:30.502 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:30.502 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:30.502 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:30.502 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:30.503 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:30.503 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:30.503 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:30.503 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:30.503 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:30.504 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:30.504 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:30.504 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:30.504 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:30.504 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:30.504 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:30.504 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.757363ms
[DEBUG] 2024-04-23 23:25:30.504 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:30.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:30.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:30.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.441222ms
[DEBUG] 2024-04-23 23:25:30.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:30.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:30.506 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:30.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:30.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:30.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.718609ms
[DEBUG] 2024-04-23 23:25:30.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:30.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:25:30.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:30.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:30.507 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:30.507 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:30.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:30.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:30.508 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:30.508 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:30.508 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:30.508 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:30.508 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:30.508 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:30.509 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:30.509 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:30.509 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:30.509 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:30.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:30.510 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:30.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:30.510 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:30.691 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:25:30.694 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:25:32.479 [HikariPool-9 housekeeper] HikariPool - HikariPool-9 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:25:32.511 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:25:32.511 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:25:32.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:32.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:32.513 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:32.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:32.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:32.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 2.629072ms
[DEBUG] 2024-04-23 23:25:32.514 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:25:32.514 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:25:32.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:32.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:32.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:32.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.490335ms
[DEBUG] 2024-04-23 23:25:32.514 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:25:32.514 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:25:32.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:32.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:32.515 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:32.516 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:32.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:32.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:32.516 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:32.516 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:32.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:32.517 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:32.517 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:32.517 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:32.517 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:32.518 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:32.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:32.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:32.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.74597ms
[DEBUG] 2024-04-23 23:25:32.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:32.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:32.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:32.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.444983ms
[DEBUG] 2024-04-23 23:25:32.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:32.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:32.519 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:32.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:32.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:32.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.720398ms
[DEBUG] 2024-04-23 23:25:32.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:32.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:25:32.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:32.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:32.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:32.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:32.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:32.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:32.522 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:32.522 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:32.522 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:32.522 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:32.522 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:32.522 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:32.522 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:32.522 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:32.522 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:32.522 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:32.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:32.523 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:32.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:32.523 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:34.162 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:25:34.524 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:25:34.524 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:25:34.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:34.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:34.527 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:34.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:34.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:34.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 2.723465ms
[DEBUG] 2024-04-23 23:25:34.527 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:25:34.527 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:25:34.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:34.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:34.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:34.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.490436ms
[DEBUG] 2024-04-23 23:25:34.527 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:25:34.527 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:25:34.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:34.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:34.529 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:34.529 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:34.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:34.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:34.529 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:34.529 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:34.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:34.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:34.530 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:34.530 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:34.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:34.531 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:34.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:34.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:34.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.85233ms
[DEBUG] 2024-04-23 23:25:34.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:34.532 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:34.532 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:34.532 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.450926ms
[DEBUG] 2024-04-23 23:25:34.532 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:34.532 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:34.533 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:34.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:34.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:34.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.72437ms
[DEBUG] 2024-04-23 23:25:34.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:34.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:25:34.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:34.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:34.534 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:34.534 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:34.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:34.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:34.535 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:34.535 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:34.535 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:34.535 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:34.535 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:34.535 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:34.535 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:34.535 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:34.535 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:34.536 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:34.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:34.536 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:34.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:34.536 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:36.537 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:25:36.537 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:25:36.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:36.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:36.539 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:36.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:36.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:36.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.226503ms
[DEBUG] 2024-04-23 23:25:36.540 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:25:36.540 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:25:36.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:36.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:36.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:36.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.701366ms
[DEBUG] 2024-04-23 23:25:36.541 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:25:36.541 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:25:36.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:36.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:36.543 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:36.543 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:36.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:36.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:36.544 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:36.544 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:36.544 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:36.544 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:36.544 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:36.544 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:36.544 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:36.545 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:36.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:36.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:36.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.790701ms
[DEBUG] 2024-04-23 23:25:36.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:36.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:36.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:36.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.486899ms
[DEBUG] 2024-04-23 23:25:36.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:36.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:36.547 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:36.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:36.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:36.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.823817ms
[DEBUG] 2024-04-23 23:25:36.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:36.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:25:36.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:36.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:36.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:36.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:36.549 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:36.549 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:36.549 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:36.549 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:36.549 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:36.549 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:36.549 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:36.549 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:36.549 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:36.550 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:36.550 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:36.550 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:36.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:36.550 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:36.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:36.551 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:38.551 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:25:38.552 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:25:38.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:38.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:38.554 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:38.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:38.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:38.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.043827ms
[DEBUG] 2024-04-23 23:25:38.555 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:25:38.555 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:25:38.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:38.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:38.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:38.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.486823ms
[DEBUG] 2024-04-23 23:25:38.555 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:25:38.555 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:25:38.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:38.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:38.557 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:38.557 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:38.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:38.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:38.557 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:38.557 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:38.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:38.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:38.558 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:38.558 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:38.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:38.559 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:38.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:38.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:38.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.80163ms
[DEBUG] 2024-04-23 23:25:38.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:38.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:38.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:38.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.49288ms
[DEBUG] 2024-04-23 23:25:38.560 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:38.560 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:38.561 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:38.561 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:38.561 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:38.561 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.756645ms
[DEBUG] 2024-04-23 23:25:38.561 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:38.561 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:25:38.561 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:38.561 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:38.562 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:38.562 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:38.562 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:38.563 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:38.563 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:38.563 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:38.563 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:38.563 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:38.563 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:38.563 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:38.563 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:38.563 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:25:38.563 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:38.563 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:38.563 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:38.564 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@269309708 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:38.564 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:38.564 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:38.564 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911118312 end=1713911138564 duration=20252 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=45 retryCount=-1 error=true>
]]></system-out>
  </testcase>
  <testcase name="testPartitionDiscoveryEnabledBothTableTypes" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="21.903">
    <failure message="expected:&lt;5&gt; but was:&lt;3&gt;" type="java.lang.AssertionError"><![CDATA[java.lang.AssertionError: expected:<5> but was:<3>
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.testPartitionDiscoveryEnabledBothTableTypes(TestPartitionManagement.java:270)
]]></failure>
    <system-out><![CDATA[[INFO ] 2024-04-23 23:25:38.565 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:25:38.565 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:25:38.565 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:25:38.565 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:25:38.572 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:25:38.572 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:25:38.572 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:25:38.572 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:25:38.573 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:25:38.614 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243;create=true
[INFO ] 2024-04-23 23:25:38.973 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:25:38.973 [MetaStoreThread-46243] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] HMSHandler - 49: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243;create=true
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:25:38.974 [MetaStoreThread-46243] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243;create=true
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37031;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243;create=true
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 120
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:38.975 [MetaStoreThread-46243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:38.976 [MetaStoreThread-46243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:38.976 [MetaStoreThread-46243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:25:38.976 [MetaStoreThread-46243] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:25:38.976 [MetaStoreThread-46243] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:25:38.977 [MetaStoreThread-46243] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:25:38.977 [MetaStoreThread-46243] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:25:38.978 [MetaStoreThread-46243] HikariConfig - HikariPool-12 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:25:38.978 [MetaStoreThread-46243] HikariConfig - HikariPool-12 - configuration:
[DEBUG] 2024-04-23 23:25:38.978 [MetaStoreThread-46243] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:25:38.978 [MetaStoreThread-46243] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:25:38.978 [MetaStoreThread-46243] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:25:38.978 [MetaStoreThread-46243] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:25:38.978 [MetaStoreThread-46243] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:25:38.978 [MetaStoreThread-46243] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:25:38.978 [MetaStoreThread-46243] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:25:38.978 [MetaStoreThread-46243] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:25:38.978 [MetaStoreThread-46243] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:25:38.978 [MetaStoreThread-46243] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:25:38.978 [MetaStoreThread-46243] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:25:38.978 [MetaStoreThread-46243] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:25:38.978 [MetaStoreThread-46243] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:25:38.978 [MetaStoreThread-46243] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:25:38.978 [MetaStoreThread-46243] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:25:38.978 [MetaStoreThread-46243] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:25:38.978 [MetaStoreThread-46243] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:25:38.979 [MetaStoreThread-46243] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:25:38.979 [MetaStoreThread-46243] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243;create=true"
[DEBUG] 2024-04-23 23:25:38.979 [MetaStoreThread-46243] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:25:38.979 [MetaStoreThread-46243] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:25:38.979 [MetaStoreThread-46243] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:25:38.979 [MetaStoreThread-46243] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:25:38.979 [MetaStoreThread-46243] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:25:38.979 [MetaStoreThread-46243] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:25:38.979 [MetaStoreThread-46243] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:25:38.979 [MetaStoreThread-46243] HikariConfig - poolName........................"HikariPool-12"
[DEBUG] 2024-04-23 23:25:38.979 [MetaStoreThread-46243] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:25:38.979 [MetaStoreThread-46243] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:25:38.979 [MetaStoreThread-46243] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:25:38.979 [MetaStoreThread-46243] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:25:38.979 [MetaStoreThread-46243] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:25:38.979 [MetaStoreThread-46243] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:25:38.979 [MetaStoreThread-46243] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:25:38.979 [MetaStoreThread-46243] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:25:38.979 [MetaStoreThread-46243] HikariDataSource - HikariPool-12 - Starting...
[INFO ] 2024-04-23 23:25:38.981 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:25:38.981 [MetaStoreThread-46243] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[INFO ] 2024-04-23 23:25:38.981 [MetaStoreThread-46243] HikariDataSource - HikariPool-12 - Start completed.
[DEBUG] 2024-04-23 23:25:39.081 [HikariPool-12 housekeeper] HikariPool - HikariPool-12 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:25:39.083 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@325754293 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.085 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1381472142 (XID = 1157), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.086 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1674536261 (XID = 1159), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.087 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@846751937 (XID = 1161), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.089 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1892298167 (XID = 1163), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.090 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@909522448 (XID = 1165), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.091 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1133947983 (XID = 1167), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.093 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1214277177 (XID = 1169), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.094 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1485156667 (XID = 1171), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.094 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:25:39.196 [MetaStoreThread-46243] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:25:39.196 [MetaStoreThread-46243] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@20c72989, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:25:39.196 [MetaStoreThread-46243] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:25:39.196 [MetaStoreThread-46243] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@20c72989, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@75f0d78c created in the thread with id: 377
[DEBUG] 2024-04-23 23:25:39.196 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.196 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.196 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.270 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.331 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@325754293 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.343 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@325754293 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.378 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@325754293 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.392 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@325754293 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.397 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@325754293 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.493 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@325754293 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.515 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@325754293 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.521 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@325754293 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.526 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@325754293 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.528 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.529 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.529 [MetaStoreThread-46243] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:25:39.529 [MetaStoreThread-46243] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:25:39.530 [MetaStoreThread-46243] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@20c72989 from thread id: 377
[DEBUG] 2024-04-23 23:25:39.530 [MetaStoreThread-46243] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:25:39.530 [MetaStoreThread-46243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:39.532 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.535 [MetaStoreThread-46243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:39.535 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[INFO ] 2024-04-23 23:25:39.535 [MetaStoreThread-46243] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:25:39.535 [MetaStoreThread-46243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:39.535 [MetaStoreThread-46243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:39.536 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.536 [MetaStoreThread-46243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:39.536 [MetaStoreThread-46243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:39.538 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.538 [MetaStoreThread-46243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:39.539 [MetaStoreThread-46243] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:39.540 [MetaStoreThread-46243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:39.540 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.540 [MetaStoreThread-46243] ObjectStore - db details for db default retrieved using SQL in 1.693699ms
[DEBUG] 2024-04-23 23:25:39.540 [MetaStoreThread-46243] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:25:39.540 [MetaStoreThread-46243] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:25:39.540 [MetaStoreThread-46243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:39.544 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.546 [MetaStoreThread-46243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:39.546 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.548 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[INFO ] 2024-04-23 23:25:39.548 [MetaStoreThread-46243] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:25:39.549 [MetaStoreThread-46243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:39.549 [MetaStoreThread-46243] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:39.552 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.554 [MetaStoreThread-46243] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:39.556 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@325754293 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.557 [MetaStoreThread-46243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:39.557 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[INFO ] 2024-04-23 23:25:39.557 [MetaStoreThread-46243] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:25:39.558 [MetaStoreThread-46243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:39.558 [MetaStoreThread-46243] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:39.558 [MetaStoreThread-46243] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:39.558 [MetaStoreThread-46243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:39.559 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[INFO ] 2024-04-23 23:25:39.559 [MetaStoreThread-46243] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:25:39.559 [MetaStoreThread-46243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:39.559 [MetaStoreThread-46243] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:39.559 [MetaStoreThread-46243] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:39.560 [MetaStoreThread-46243] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:39.562 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@325754293 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.565 [MetaStoreThread-46243] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:39.567 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@325754293 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.568 [MetaStoreThread-46243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:39.569 [MetaStoreThread-46243] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[INFO ] 2024-04-23 23:25:39.569 [MetaStoreThread-46243] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:25:39.569 [MetaStoreThread-46243] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:25:39.569 [MetaStoreThread-46243] PerfLogger - </PERFLOG method=init start=1713911138974 end=1713911139569 duration=595 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=49 retryCount=0 error=false>
[INFO ] 2024-04-23 23:25:39.569 [MetaStoreThread-46243] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:25:39.569 [MetaStoreThread-46243] HiveMetaStore - Started the new metaserver on port [46243]...
[INFO ] 2024-04-23 23:25:39.569 [MetaStoreThread-46243] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:25:39.569 [MetaStoreThread-46243] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:25:39.569 [MetaStoreThread-46243] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:25:39.569 [MetaStoreThread-46243] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:25:39.569 [MetaStoreThread-46243] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:25:39.569 [MetaStoreThread-46243] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:25:39.569 [MetaStoreThread-46243] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:25:39.569 [MetaStoreThread-46243] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:25:39.569 [MetaStoreThread-46243] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:25:39.569 [MetaStoreThread-46243] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:25:39.597 [MetaStoreThread-46243] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:25:39.598 [MetaStoreThread-46243] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:25:39.598 [MetaStoreThread-46243] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:25:39.598 [MetaStoreThread-46243] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:25:39.598 [MetaStoreThread-46243] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:25:39.598 [MetaStoreThread-46243] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:25:39.598 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:25:39.599 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:25:39.599 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:25:39.599 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@768f275d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@191ab1a3 will be shutdown
[DEBUG] 2024-04-23 23:25:39.599 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:25:39.599 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:25:39.976 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:25:39.976 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:25:39.976 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:25:39.984 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/46243) is created
[INFO ] 2024-04-23 23:25:39.984 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 46243 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/46243 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243;create=true
[INFO ] 2024-04-23 23:25:39.984 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:25:39.986 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:25:39.986 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:46243]
[INFO ] 2024-04-23 23:25:39.987 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:46243)
[INFO ] 2024-04-23 23:25:39.987 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:46243) current connections: 8
[DEBUG] 2024-04-23 23:25:39.987 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:39.987 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911139987 end=1713911139987 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:39.988 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:39.988 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:39.988 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 create_database: Database(name:db2, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:25:39.988 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db2, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243;create=true
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243;create=true
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7c2a8072, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:25:39.989 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:25:39.990 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7c2a8072, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@340450df created in the thread with id: 394
[DEBUG] 2024-04-23 23:25:39.990 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.991 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.991 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.992 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.992 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.992 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:25:39.992 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:25:39.992 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7c2a8072 from thread id: 394
[DEBUG] 2024-04-23 23:25:39.992 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:39.992 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:39.992 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:39.992 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.370735ms
[DEBUG] 2024-04-23 23:25:39.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db2, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:25:39.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:25:39.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:39.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:39.993 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.993 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:25:39.993 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:25:39.993 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:25:39.993 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:25:39.993 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[WARN ] 2024-04-23 23:25:39.993 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db for database db2. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:25:39.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:39.994 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:39.994 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:39.994 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:39.995 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.996 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713911139988 end=1713911139996 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:39.996 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:39.996 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:39.996 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 create_table_req: Table(tableName:tbl2, dbName:db2, owner:alex, createTime:1713911139, lastAccessTime:1713911139, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:s, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:25:39.996 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl2, dbName:db2, owner:alex, createTime:1713911139, lastAccessTime:1713911139, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:s, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:25:39.996 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:39.999 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:39.999 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:39.999 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:39.999 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:39.999 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.32586ms
[DEBUG] 2024-04-23 23:25:39.999 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:39.999 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:39.999 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:25:40.003 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.004 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.004 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:40.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:40.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.965662ms
[DEBUG] 2024-04-23 23:25:40.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:40.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:25:40.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:40.005 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.006 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:25:40.006 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:25:40.006 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:25:40.006 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:25:40.006 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/46243/db2.db/tbl2
[DEBUG] 2024-04-23 23:25:40.010 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.010 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:40.013 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:40.017 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@325754293 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.022 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@325754293 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.026 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@325754293 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.031 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@325754293 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.042 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.042 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.044 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.045 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713911139996 end=1713911140045 duration=49 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:40.045 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:40.045 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:40.045 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 add_partition : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:25:40.045 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:25:40.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:40.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:25:40.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:40.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.080 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:25:40.080 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:25:40.080 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:25:40.080 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:25:40.080 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/46243/db2.db/tbl2/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:25:40.084 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.084 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:40.084 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:25:40.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:40.088 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@325754293 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.095 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.095 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.098 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.099 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911140045 end=1713911140099 duration=54 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:40.099 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:40.099 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:40.099 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 add_partition : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:25:40.099 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:25:40.099 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:40.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:25:40.101 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:40.104 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.104 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.104 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.105 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:25:40.105 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:25:40.105 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:25:40.105 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:25:40.105 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/46243/db2.db/tbl2/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:25:40.109 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.109 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:40.109 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:25:40.110 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:40.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.115 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.116 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911140099 end=1713911140116 duration=17 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:40.116 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:40.117 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:40.117 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 add_partition : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:25:40.117 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:25:40.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:40.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:25:40.118 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:40.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.122 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:25:40.122 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:25:40.122 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:25:40.122 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:25:40.122 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/46243/db2.db/tbl2/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:25:40.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:40.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:25:40.127 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:40.129 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.130 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.132 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.134 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911140116 end=1713911140134 duration=18 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:40.134 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:40.134 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:40.134 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713911140134 end=1713911140134 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:40.134 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:40.134 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:40.135 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_table : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:25:40.135 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:25:40.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.136 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:40.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:40.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.137 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.857728ms
[DEBUG] 2024-04-23 23:25:40.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:25:40.140 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.143 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.145 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[INFO ] 2024-04-23 23:25:40.146 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:25:40.146 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911140134 end=1713911140146 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:40.146 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=12, comments=HMS client
[DEBUG] 2024-04-23 23:25:40.146 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:40.146 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:40.146 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:25:40.146 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:25:40.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:25:40.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.151 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.814822ms + 0.006721ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:25:40.156 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.359748ms + 0.089298ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:25:40.158 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.620033ms + 0.232323ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:25:40.160 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.651852ms + 0.205513ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:40.163 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.922999ms + 0.204059ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:25:40.164 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.578074ms + 0.124194ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:40.166 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.437052ms + 0.121849ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:40.168 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.65085ms + 0.122559ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:40.170 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.556814ms + 0.245941ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:40.171 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.627843ms + 0.124429ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:25:40.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:40.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 25.072094ms
[DEBUG] 2024-04-23 23:25:40.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.172 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.172 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911140146 end=1713911140172 duration=26 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:40.181 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:40.181 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:40.181 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:25:40.181 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:25:40.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:25:40.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.182 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.560387ms + 0.004087ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:25:40.182 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.429198ms + 0.054076ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:25:40.183 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.155432ms + 0.291293ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:25:40.183 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.16159ms + 0.141148ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:40.184 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.155305ms + 0.100418ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:25:40.184 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.150557ms + 0.098054ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:40.184 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.144182ms + 0.097653ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:40.184 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.142286ms + 0.096837ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:40.185 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.199451ms + 0.220641ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:40.185 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.196278ms + 0.09913ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:25:40.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:40.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 4.189418ms
[DEBUG] 2024-04-23 23:25:40.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.185 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.186 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911140181 end=1713911140186 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:40.186 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:40.186 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:40.186 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 alter_table: hive.db2.tbl2 newtbl=tbl2
[INFO ] 2024-04-23 23:25:40.186 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db2.tbl2 newtbl=tbl2	
[DEBUG] 2024-04-23 23:25:40.186 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.187 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:40.187 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:40.187 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.187 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.187 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.979816ms
[DEBUG] 2024-04-23 23:25:40.188 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:25:40.188 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:25:40.188 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:25:40.188 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:25:40.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.188 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:40.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:40.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.188 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.189 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.856561ms
[DEBUG] 2024-04-23 23:25:40.189 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.189 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.189 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:25:40.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.192 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.193 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.195 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:40.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:40.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.930346ms
[DEBUG] 2024-04-23 23:25:40.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:40.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:25:40.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:40.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.198 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db2
[WARN ] 2024-04-23 23:25:40.199 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:25:40.199 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.199 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:40.199 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:40.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:40.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:25:40.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:40.201 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:25:40.201 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:40.201 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:25:40.205 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:40.207 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.207 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.208 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.209 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713911140186 end=1713911140209 duration=23 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[INFO ] 2024-04-23 23:25:40.210 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:25:40.210 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:46243]
[INFO ] 2024-04-23 23:25:40.210 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:46243)
[INFO ] 2024-04-23 23:25:40.210 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:46243) current connections: 9
[DEBUG] 2024-04-23 23:25:40.211 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:40.211 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911140211 end=1713911140211 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=52 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:40.212 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:40.212 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:40.212 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 52: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:25:40.212 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 52: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243;create=true
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243;create=true
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3801a811, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3801a811, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6dda2bd4 created in the thread with id: 407
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.213 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.214 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.215 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.215 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.215 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:25:40.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:25:40.215 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3801a811 from thread id: 407
[DEBUG] 2024-04-23 23:25:40.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:25:40.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.221 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.221 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911140212 end=1713911140221 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=52 retryCount=0 error=false>
[INFO ] 2024-04-23 23:25:40.221 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:25:40.221 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 8
[DEBUG] 2024-04-23 23:25:40.221 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:40.221 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:40.221 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:40.221 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 52: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:25:40.221 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:25:40.221 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:25:40.221 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:25:40.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3801a811, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6dda2bd4 will be shutdown
[INFO ] 2024-04-23 23:25:40.221 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:25:40.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:25:40.221 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 52: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:25:40.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[INFO ] 2024-04-23 23:25:40.221 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:25:40.221 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911140221 end=1713911140221 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=52 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:40.221 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:25:40.222 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 52: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:25:40.222 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:25:40.222 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.879385ms + 0.005951ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:25:40.223 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.403534ms + 0.055232ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:25:40.223 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.138288ms + 0.187264ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:25:40.224 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.125053ms + 0.134592ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:40.224 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.125336ms + 0.102195ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:25:40.224 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.118755ms + 0.101794ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:40.224 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.114337ms + 0.100879ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:40.225 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.114001ms + 0.10047ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:40.225 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.149183ms + 0.174971ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:25:40.225 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.124561ms + 0.10045ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:25:40.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:40.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 3.91208ms
[DEBUG] 2024-04-23 23:25:40.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.225 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.225 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911140221 end=1713911140225 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:40.226 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:40.226 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:40.226 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:25:40.226 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:25:40.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:25:40.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.228 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.228 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.228 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713911140226 end=1713911140228 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:40.228 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:40.228 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:40.228 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:25:40.228 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:25:40.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.231 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.231 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911140228 end=1713911140231 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:40.231 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:40.231 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:40.231 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_database: db2
[INFO ] 2024-04-23 23:25:40.231 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db2	
[DEBUG] 2024-04-23 23:25:40.231 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.232 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:40.232 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:40.232 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.232 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.232 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.94791ms
[DEBUG] 2024-04-23 23:25:40.232 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911140231 end=1713911140232 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:40.232 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=1, comments=HMS client
[DEBUG] 2024-04-23 23:25:40.232 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:40.233 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:40.233 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_tables_by_type: db=@hive#db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:40.233 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:40.233 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:40.233 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:40.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.233 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:40.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:40.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.233 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.871367ms
[DEBUG] 2024-04-23 23:25:40.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.236 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:40.236 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.236 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.236 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.523989ms
[DEBUG] 2024-04-23 23:25:40.236 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911140233 end=1713911140236 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:40.236 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:40.236 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:40.236 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:25:40.236 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:25:40.236 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:40.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.239 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.320384ms
[DEBUG] 2024-04-23 23:25:40.239 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911140236 end=1713911140239 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:40.239 [main] HiveMetaStoreClient - Selecting dropDatabase method for db2 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:25:40.239 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:25:40.239 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:40.239 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:40.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.240 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:40.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:40.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.240 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.952839ms
[DEBUG] 2024-04-23 23:25:40.240 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_multi_table : db=db2 tbls=tbl2
[INFO ] 2024-04-23 23:25:40.240 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db2 tbls=tbl2	
[DEBUG] 2024-04-23 23:25:40.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.244 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:40.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:40.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.831782ms
[DEBUG] 2024-04-23 23:25:40.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.244 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.244 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911140239 end=1713911140244 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:25:40.245 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:25:40.245 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:25:40.245 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:25:40.245 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:25:40.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:40.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.246 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:40.246 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:40.246 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.246 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.972603ms
[DEBUG] 2024-04-23 23:25:40.246 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:25:40.246 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:25:40.246 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.247 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:40.247 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.247 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.571344ms
[DEBUG] 2024-04-23 23:25:40.247 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:25:40.247 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:25:40.247 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.253 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@325754293 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.256 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.256 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:40.256 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:40.256 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.261 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@325754293 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.264 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.265 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:40.265 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:40.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.287 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@325754293 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.290 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:25:40.290 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:25:40.290 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:25:40.290 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:25:40.290 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:40.290 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:40.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.291 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:40.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:40.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.896544ms
[DEBUG] 2024-04-23 23:25:40.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:40.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.465889ms
[DEBUG] 2024-04-23 23:25:40.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:40.293 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:40.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:40.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:40.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.775945ms
[DEBUG] 2024-04-23 23:25:40.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:40.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:25:40.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:40.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:40.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:40.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:40.307 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@325754293 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:40.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:40.314 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:40.314 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.314 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:40.315 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:40.316 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:40.317 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:40.318 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:40.319 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:40.320 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:40.321 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:40.321 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:40.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:40.322 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:40.468 [HikariPool-8 housekeeper] HikariPool - HikariPool-8 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:25:42.324 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:25:42.324 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:25:42.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:42.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:42.327 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:42.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:42.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:42.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.642239ms
[DEBUG] 2024-04-23 23:25:42.328 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:25:42.328 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:25:42.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:42.329 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:42.329 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:42.329 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.172299ms
[DEBUG] 2024-04-23 23:25:42.329 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:25:42.329 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:25:42.329 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:42.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:42.330 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:42.330 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:42.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:42.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:42.331 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:42.331 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:42.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:42.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:42.332 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:42.332 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:42.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:42.333 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:42.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:42.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:42.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.759525ms
[DEBUG] 2024-04-23 23:25:42.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:42.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:42.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:42.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.4169ms
[DEBUG] 2024-04-23 23:25:42.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:42.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:42.335 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:42.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:42.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:42.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.933805ms
[DEBUG] 2024-04-23 23:25:42.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:42.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:25:42.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:42.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:42.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:42.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:42.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:42.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:42.337 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:42.337 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:42.337 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:42.337 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:42.337 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:42.338 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:42.338 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:42.338 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:42.338 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:42.338 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:42.338 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:42.339 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:42.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:42.339 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:44.339 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:25:44.340 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:25:44.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:44.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:44.342 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:44.343 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:44.343 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:44.343 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.534355ms
[DEBUG] 2024-04-23 23:25:44.343 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:25:44.344 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:25:44.344 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:44.344 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:44.344 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:44.344 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.530225ms
[DEBUG] 2024-04-23 23:25:44.344 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:25:44.344 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:25:44.344 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:44.345 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:44.345 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:44.345 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:44.345 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:44.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:44.346 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:44.346 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:44.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:44.347 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:44.347 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:44.347 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:44.347 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:44.348 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:44.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:44.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:44.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.740574ms
[DEBUG] 2024-04-23 23:25:44.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:44.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:44.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:44.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.433283ms
[DEBUG] 2024-04-23 23:25:44.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:44.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:44.349 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:44.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:44.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:44.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.70891ms
[DEBUG] 2024-04-23 23:25:44.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:44.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:25:44.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:44.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:44.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:44.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:44.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:44.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:44.351 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:44.352 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:44.352 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:44.352 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:44.352 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:44.352 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:44.352 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:44.352 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:44.352 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:44.352 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:44.352 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:44.353 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:44.353 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:44.353 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:46.354 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:25:46.354 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:25:46.354 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:46.354 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:46.356 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:46.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:46.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:46.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.269453ms
[DEBUG] 2024-04-23 23:25:46.357 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:25:46.357 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:25:46.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:46.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:46.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:46.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.4824ms
[DEBUG] 2024-04-23 23:25:46.359 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:25:46.359 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:25:46.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:46.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:46.360 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:46.360 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:46.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:46.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:46.361 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:46.361 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:46.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:46.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:46.362 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:46.362 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:46.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:46.362 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:46.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:46.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:46.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.785508ms
[DEBUG] 2024-04-23 23:25:46.363 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:46.363 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:46.363 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:46.363 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.446448ms
[DEBUG] 2024-04-23 23:25:46.363 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:46.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:46.364 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:46.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:46.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:46.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.710791ms
[DEBUG] 2024-04-23 23:25:46.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:46.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:25:46.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:46.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:46.365 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:46.365 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:46.366 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:46.367 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:46.367 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:46.367 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:46.367 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:46.367 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:46.367 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:46.367 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:46.368 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:46.368 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:46.368 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:46.368 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:46.368 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:46.369 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:46.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:46.369 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:47.020 [HikariPool-11 housekeeper] HikariPool - HikariPool-11 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:25:48.370 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:25:48.370 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:25:48.370 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:48.370 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:48.373 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:48.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:48.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:48.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.355791ms
[DEBUG] 2024-04-23 23:25:48.374 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:25:48.374 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:25:48.374 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:48.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:48.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:48.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.213723ms
[DEBUG] 2024-04-23 23:25:48.375 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:25:48.375 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:25:48.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:48.376 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:48.376 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:48.376 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:48.376 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:48.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:48.377 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:48.377 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:48.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:48.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:48.378 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:48.378 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:48.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:48.378 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:48.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:48.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:48.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.715818ms
[DEBUG] 2024-04-23 23:25:48.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:48.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:48.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:48.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.47172ms
[DEBUG] 2024-04-23 23:25:48.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:48.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:48.380 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:48.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:48.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:48.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.707165ms
[DEBUG] 2024-04-23 23:25:48.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:48.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:25:48.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:48.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:48.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:48.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:48.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:48.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:48.382 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:48.382 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:48.382 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:48.382 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:48.382 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:48.382 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:48.382 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:48.382 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:48.382 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:48.382 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:48.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:48.383 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:48.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:48.383 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:48.399 [HikariPool-7 housekeeper] HikariPool - HikariPool-7 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:25:49.838 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:25:50.384 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:25:50.384 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:25:50.384 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:50.384 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:50.387 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:50.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:50.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:50.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 2.788563ms
[DEBUG] 2024-04-23 23:25:50.387 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:25:50.387 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:25:50.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:50.388 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:50.388 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:50.388 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.505166ms
[DEBUG] 2024-04-23 23:25:50.388 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:25:50.388 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:25:50.388 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:50.389 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:50.389 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:50.389 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:50.389 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:50.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:50.390 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:50.390 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:50.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:50.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:50.390 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:50.390 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:50.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:50.391 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:50.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:50.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:50.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.757578ms
[DEBUG] 2024-04-23 23:25:50.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:50.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:50.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:50.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.44592ms
[DEBUG] 2024-04-23 23:25:50.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:50.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:50.393 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:50.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:50.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:50.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.713543ms
[DEBUG] 2024-04-23 23:25:50.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:50.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:25:50.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:50.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:50.394 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:50.394 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:50.395 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:50.395 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:50.395 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:50.395 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:50.395 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:50.395 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:50.395 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:50.395 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:50.395 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:50.395 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:50.395 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:50.396 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:50.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:50.396 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:50.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:50.396 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:52.397 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:25:52.397 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:25:52.397 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:52.398 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:52.400 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:52.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:52.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:52.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 2.569296ms
[DEBUG] 2024-04-23 23:25:52.400 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:25:52.400 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:25:52.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:52.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:52.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:52.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.473574ms
[DEBUG] 2024-04-23 23:25:52.401 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:25:52.401 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:25:52.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:52.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:52.402 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:52.402 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:52.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:52.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:52.403 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:52.403 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:52.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:52.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:52.404 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:52.404 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:52.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:52.404 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:52.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:52.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:52.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.800356ms
[DEBUG] 2024-04-23 23:25:52.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:52.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:52.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:52.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.465282ms
[DEBUG] 2024-04-23 23:25:52.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:52.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:52.406 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:52.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:52.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:52.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.740667ms
[DEBUG] 2024-04-23 23:25:52.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:52.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:25:52.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:52.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:52.407 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:52.407 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:52.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:52.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:52.408 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:52.408 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:52.408 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:52.408 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:52.408 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:52.408 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:52.408 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:52.409 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:52.409 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:52.409 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:52.409 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:52.409 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:52.409 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:52.410 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:54.410 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:25:54.411 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:25:54.411 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:54.411 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:54.413 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:54.414 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:54.414 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:54.414 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.114271ms
[DEBUG] 2024-04-23 23:25:54.414 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:25:54.414 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:25:54.414 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:54.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:54.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:54.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.691171ms
[DEBUG] 2024-04-23 23:25:54.416 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:25:54.416 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:25:54.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:54.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:54.417 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:54.417 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:54.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:54.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:54.418 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:54.418 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:54.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:54.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:54.418 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:54.418 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:54.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:54.419 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:54.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:54.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:54.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.709654ms
[DEBUG] 2024-04-23 23:25:54.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:54.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:54.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:54.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.418379ms
[DEBUG] 2024-04-23 23:25:54.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:54.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:54.421 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:54.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:54.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:54.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.672825ms
[DEBUG] 2024-04-23 23:25:54.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:54.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:25:54.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:54.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:54.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:54.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:54.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:54.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:54.423 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:54.423 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:54.423 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:54.423 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:54.423 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:54.423 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:54.423 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:54.423 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:54.423 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:54.423 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:54.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:54.424 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:54.424 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:54.424 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:55.064 [HikariPool-10 housekeeper] HikariPool - HikariPool-10 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:25:56.071 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:25:56.264 [HikariPool-6 housekeeper] HikariPool - HikariPool-6 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:25:56.425 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:25:56.425 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:25:56.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:56.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:56.427 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:56.428 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:56.428 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:56.428 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 2.82871ms
[DEBUG] 2024-04-23 23:25:56.428 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:25:56.428 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:25:56.428 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:56.428 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:56.428 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:56.428 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.437356ms
[DEBUG] 2024-04-23 23:25:56.428 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:25:56.428 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:25:56.428 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:56.429 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:56.429 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:56.429 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:56.429 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:56.430 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:56.430 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:56.430 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:56.430 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:56.431 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:56.431 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:56.431 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:56.431 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:56.431 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:56.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:56.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:56.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.723497ms
[DEBUG] 2024-04-23 23:25:56.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:56.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:56.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:56.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.422995ms
[DEBUG] 2024-04-23 23:25:56.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:56.433 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:56.433 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:56.433 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:56.433 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:56.433 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.709016ms
[DEBUG] 2024-04-23 23:25:56.433 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:56.433 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:25:56.433 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:56.433 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:56.434 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:56.434 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:56.435 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:56.435 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:56.435 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:56.435 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:56.435 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:56.435 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:56.435 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:56.435 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:56.435 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:56.435 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:56.435 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:56.436 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:56.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:56.436 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:56.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:56.436 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:25:58.437 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:25:58.437 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:25:58.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:25:58.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:58.440 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:58.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:58.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:58.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.192656ms
[DEBUG] 2024-04-23 23:25:58.441 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:25:58.441 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:25:58.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:58.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:58.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:58.443 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.690868ms
[DEBUG] 2024-04-23 23:25:58.443 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:25:58.443 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:25:58.443 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:58.444 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:58.444 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:25:58.444 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:25:58.444 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:58.445 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:58.445 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:25:58.445 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:25:58.445 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:58.445 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:58.446 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:25:58.446 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:25:58.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:58.446 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:58.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:58.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:58.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.902313ms
[DEBUG] 2024-04-23 23:25:58.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:58.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:58.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:58.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.459703ms
[DEBUG] 2024-04-23 23:25:58.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:58.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:58.448 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:25:58.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:25:58.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:58.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.730243ms
[DEBUG] 2024-04-23 23:25:58.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:25:58.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:25:58.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:25:58.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:25:58.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:25:58.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:25:58.450 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:25:58.450 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:25:58.451 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:25:58.451 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:58.451 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:58.451 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:58.451 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:58.451 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:58.451 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:58.451 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:25:58.451 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:25:58.451 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:58.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:25:58.452 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:25:58.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:25:58.452 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:26:00.453 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:26:00.453 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:26:00.453 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:00.453 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:00.455 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:00.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:00.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:00.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.117237ms
[DEBUG] 2024-04-23 23:26:00.456 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:26:00.456 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:26:00.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:00.458 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:00.458 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:00.458 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.623891ms
[DEBUG] 2024-04-23 23:26:00.458 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:26:00.458 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:26:00.458 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:00.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:00.459 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:26:00.459 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:26:00.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:00.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:00.460 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:26:00.460 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:26:00.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:00.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:00.461 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:26:00.461 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:26:00.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:00.461 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:00.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:00.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:00.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.761238ms
[DEBUG] 2024-04-23 23:26:00.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:00.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:00.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:00.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.452276ms
[DEBUG] 2024-04-23 23:26:00.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:00.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:00.463 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:00.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:00.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:00.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.672907ms
[DEBUG] 2024-04-23 23:26:00.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:26:00.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:26:00.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:00.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:00.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:00.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:26:00.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:26:00.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:00.465 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:26:00.465 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:00.465 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:26:00.465 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:26:00.465 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:26:00.465 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:26:00.466 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:26:00.466 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:26:00.466 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:26:00.466 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:00.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:00.467 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861484129 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:00.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:26:00.467 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:26:00.467 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911140245 end=1713911160467 duration=20222 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=-1 error=true>
]]></system-out>
  </testcase>
  <testcase name="testPartitionDiscoveryEnabledBothTableTypes" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="21.903">
    <error message="javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore&#10;NestedThrowables:&#10;java.sql.BatchUpdateException: DELETE on table &apos;DBS&apos; caused a violation of foreign key constraint &apos;TBLS_FK1&apos; for key (2).  The statement has been rolled back." type="org.apache.hadoop.hive.metastore.api.MetaException"><![CDATA[org.apache.hadoop.hive.metastore.api.MetaException: 
javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
NestedThrowables:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.tearDown(TestPartitionManagement.java:100)
]]></error>
  </testcase>
  <testcase name="testPartitionExprFilter" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="21.957">
    <failure message="expected:&lt;2&gt; but was:&lt;3&gt;" type="java.lang.AssertionError"><![CDATA[java.lang.AssertionError: expected:<2> but was:<3>
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.testPartitionExprFilter(TestPartitionManagement.java:720)
]]></failure>
    <system-out><![CDATA[[INFO ] 2024-04-23 23:26:00.468 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:26:00.468 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:26:00.468 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:26:00.468 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:26:00.475 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:26:00.475 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:26:00.475 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:26:00.475 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:26:00.476 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:26:00.504 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695;create=true
[DEBUG] 2024-04-23 23:26:00.691 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:26:00.695 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:26:00.877 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:26:00.877 [MetaStoreThread-33695] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:26:00.878 [MetaStoreThread-33695] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:26:00.878 [MetaStoreThread-33695] HMSHandler - 53: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:26:00.878 [MetaStoreThread-33695] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:26:00.878 [MetaStoreThread-33695] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:26:00.878 [MetaStoreThread-33695] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:26:00.878 [MetaStoreThread-33695] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:26:00.878 [MetaStoreThread-33695] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:26:00.878 [MetaStoreThread-33695] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695;create=true
[DEBUG] 2024-04-23 23:26:00.878 [MetaStoreThread-33695] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:26:00.878 [MetaStoreThread-33695] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:26:00.878 [MetaStoreThread-33695] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:26:00.878 [MetaStoreThread-33695] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:26:00.878 [MetaStoreThread-33695] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:26:00.878 [MetaStoreThread-33695] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:26:00.878 [MetaStoreThread-33695] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:26:00.878 [MetaStoreThread-33695] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:26:00.878 [MetaStoreThread-33695] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:26:00.878 [MetaStoreThread-33695] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:26:00.878 [MetaStoreThread-33695] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:26:00.878 [MetaStoreThread-33695] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:26:00.878 [MetaStoreThread-33695] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695;create=true
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_46243;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695;create=true
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 120
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:26:00.879 [MetaStoreThread-33695] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:26:00.880 [MetaStoreThread-33695] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:26:00.880 [MetaStoreThread-33695] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:26:00.880 [MetaStoreThread-33695] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:26:00.880 [MetaStoreThread-33695] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:26:00.880 [MetaStoreThread-33695] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:26:00.880 [MetaStoreThread-33695] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:26:00.880 [MetaStoreThread-33695] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:26:00.881 [MetaStoreThread-33695] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:26:00.881 [MetaStoreThread-33695] HikariConfig - HikariPool-13 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:26:00.881 [MetaStoreThread-33695] HikariConfig - HikariPool-13 - configuration:
[DEBUG] 2024-04-23 23:26:00.881 [MetaStoreThread-33695] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:26:00.881 [MetaStoreThread-33695] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:26:00.881 [MetaStoreThread-33695] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:26:00.881 [MetaStoreThread-33695] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:26:00.881 [MetaStoreThread-33695] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:26:00.881 [MetaStoreThread-33695] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:26:00.881 [MetaStoreThread-33695] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:26:00.881 [MetaStoreThread-33695] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695;create=true"
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - poolName........................"HikariPool-13"
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:26:00.882 [MetaStoreThread-33695] HikariDataSource - HikariPool-13 - Starting...
[INFO ] 2024-04-23 23:26:00.884 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:26:00.884 [MetaStoreThread-33695] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[INFO ] 2024-04-23 23:26:00.884 [MetaStoreThread-33695] HikariDataSource - HikariPool-13 - Start completed.
[DEBUG] 2024-04-23 23:26:00.984 [HikariPool-13 housekeeper] HikariPool - HikariPool-13 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:26:00.986 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1022395398 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:00.987 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2110623293 (XID = 1145), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:00.988 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1291473272 (XID = 1147), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:00.989 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@501379442 (XID = 1149), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:00.991 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1713389197 (XID = 1151), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:00.992 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@430737449 (XID = 1153), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:00.993 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2027780094 (XID = 1155), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:00.994 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1247481900 (XID = 1157), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:00.995 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@823825981 (XID = 1159), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:00.995 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:26:01.093 [MetaStoreThread-33695] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:26:01.093 [MetaStoreThread-33695] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4f6592ea, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:26:01.093 [MetaStoreThread-33695] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:26:01.094 [MetaStoreThread-33695] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4f6592ea, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@569a8712 created in the thread with id: 410
[DEBUG] 2024-04-23 23:26:01.094 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.094 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.094 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.180 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.250 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1022395398 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.264 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1022395398 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.295 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1022395398 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.309 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1022395398 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.313 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1022395398 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.413 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1022395398 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.438 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1022395398 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.445 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1022395398 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.453 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1022395398 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.456 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.459 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.459 [MetaStoreThread-33695] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:26:01.459 [MetaStoreThread-33695] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:26:01.459 [MetaStoreThread-33695] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4f6592ea from thread id: 410
[DEBUG] 2024-04-23 23:26:01.459 [MetaStoreThread-33695] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:26:01.459 [MetaStoreThread-33695] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:01.464 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.467 [MetaStoreThread-33695] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:01.467 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[INFO ] 2024-04-23 23:26:01.467 [MetaStoreThread-33695] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:26:01.468 [MetaStoreThread-33695] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:01.468 [MetaStoreThread-33695] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:01.468 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.468 [MetaStoreThread-33695] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:01.469 [MetaStoreThread-33695] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:01.471 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.471 [MetaStoreThread-33695] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:01.473 [MetaStoreThread-33695] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:01.473 [MetaStoreThread-33695] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:01.473 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.473 [MetaStoreThread-33695] ObjectStore - db details for db default retrieved using SQL in 1.820827ms
[DEBUG] 2024-04-23 23:26:01.473 [MetaStoreThread-33695] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:26:01.473 [MetaStoreThread-33695] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:26:01.473 [MetaStoreThread-33695] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:01.478 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.480 [MetaStoreThread-33695] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:01.481 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.483 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[INFO ] 2024-04-23 23:26:01.483 [MetaStoreThread-33695] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:26:01.483 [MetaStoreThread-33695] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:01.483 [MetaStoreThread-33695] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:01.486 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.489 [MetaStoreThread-33695] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:01.491 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1022395398 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.492 [MetaStoreThread-33695] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:01.493 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[INFO ] 2024-04-23 23:26:01.493 [MetaStoreThread-33695] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:26:01.493 [MetaStoreThread-33695] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:01.493 [MetaStoreThread-33695] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:01.493 [MetaStoreThread-33695] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:01.494 [MetaStoreThread-33695] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:01.494 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[INFO ] 2024-04-23 23:26:01.494 [MetaStoreThread-33695] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:26:01.494 [MetaStoreThread-33695] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:01.494 [MetaStoreThread-33695] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:01.495 [MetaStoreThread-33695] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:01.495 [MetaStoreThread-33695] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:01.498 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1022395398 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.500 [MetaStoreThread-33695] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:01.502 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1022395398 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.503 [MetaStoreThread-33695] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:01.504 [MetaStoreThread-33695] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[INFO ] 2024-04-23 23:26:01.504 [MetaStoreThread-33695] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:26:01.504 [MetaStoreThread-33695] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:26:01.504 [MetaStoreThread-33695] PerfLogger - </PERFLOG method=init start=1713911160878 end=1713911161504 duration=626 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=53 retryCount=0 error=false>
[INFO ] 2024-04-23 23:26:01.505 [MetaStoreThread-33695] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:26:01.505 [MetaStoreThread-33695] HiveMetaStore - Started the new metaserver on port [33695]...
[INFO ] 2024-04-23 23:26:01.505 [MetaStoreThread-33695] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:26:01.505 [MetaStoreThread-33695] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:26:01.505 [MetaStoreThread-33695] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:26:01.505 [MetaStoreThread-33695] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:26:01.505 [MetaStoreThread-33695] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:26:01.505 [MetaStoreThread-33695] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:26:01.505 [MetaStoreThread-33695] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:26:01.505 [MetaStoreThread-33695] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:26:01.505 [MetaStoreThread-33695] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:26:01.505 [MetaStoreThread-33695] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:26:01.505 [MetaStoreThread-33695] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:26:01.505 [MetaStoreThread-33695] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:26:01.505 [MetaStoreThread-33695] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:26:01.505 [MetaStoreThread-33695] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:26:01.505 [MetaStoreThread-33695] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:26:01.505 [MetaStoreThread-33695] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:26:01.879 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:26:01.880 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 54: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:26:01.880 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:26:01.891 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33695) is created
[INFO ] 2024-04-23 23:26:01.891 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 33695 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33695 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695;create=true
[INFO ] 2024-04-23 23:26:01.891 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:26:01.898 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:26:01.898 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:33695]
[INFO ] 2024-04-23 23:26:01.899 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:33695)
[INFO ] 2024-04-23 23:26:01.899 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:33695) current connections: 9
[DEBUG] 2024-04-23 23:26:01.900 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:26:01.901 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911161900 end=1713911161901 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=55 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:26:01.901 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:26:01.902 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:26:01.902 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 create_database: Database(name:db10, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:26:01.902 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db10, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695;create=true
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695;create=true
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:26:01.904 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:26:01.905 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:26:01.905 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:26:01.905 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:26:01.905 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:26:01.905 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:26:01.905 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:26:01.905 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:26:01.905 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:26:01.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@340e8c84, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:26:01.906 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:26:01.907 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@340e8c84, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@140ba762 created in the thread with id: 427
[DEBUG] 2024-04-23 23:26:01.908 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.908 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.908 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.911 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.912 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.912 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:26:01.912 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:26:01.912 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@340e8c84 from thread id: 427
[DEBUG] 2024-04-23 23:26:01.912 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:01.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:01.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:01.913 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.987138ms
[DEBUG] 2024-04-23 23:26:01.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db10, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:26:01.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:26:01.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:01.914 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:01.915 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.915 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:26:01.915 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:26:01.915 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:26:01.915 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:26:01.915 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:26:01.916 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db
[INFO ] 2024-04-23 23:26:01.916 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db
[INFO ] 2024-04-23 23:26:01.921 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db
[DEBUG] 2024-04-23 23:26:01.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:01.922 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:01.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:01.924 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:01.927 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.927 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713911161902 end=1713911161927 duration=25 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=55 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:26:01.928 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:26:01.928 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:26:01.928 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 create_table_req: Table(tableName:tbl10, dbName:db10, owner:alex, createTime:1713911161, lastAccessTime:1713911161, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:b, type:binary, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:bo, type:boolean, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:), FieldSchema(name:modts, type:timestamp, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:26:01.928 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl10, dbName:db10, owner:alex, createTime:1713911161, lastAccessTime:1713911161, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:b, type:binary, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:bo, type:boolean, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:), FieldSchema(name:modts, type:timestamp, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:26:01.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:01.935 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:01.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:01.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:01.936 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 7.841326ms
[DEBUG] 2024-04-23 23:26:01.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:01.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:01.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:26:01.944 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:01.945 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:01.945 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.945 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:01.945 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:01.946 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:01.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:01.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:01.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.47603ms
[DEBUG] 2024-04-23 23:26:01.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:01.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:01.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:26:01.947 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:01.947 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:01.948 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:26:01.948 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:26:01.948 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:26:01.948 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:26:01.948 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33695/db10.db/tbl10
[DEBUG] 2024-04-23 23:26:01.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:01.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:01.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:01.960 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1022395398 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.964 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1022395398 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.968 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1022395398 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.973 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1022395398 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:01.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:01.986 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:01.987 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713911161928 end=1713911161987 duration=59 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=55 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:26:01.987 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:26:01.987 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:26:01.987 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 add_partition : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:26:01.987 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:26:01.987 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:01.987 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:01.987 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:01.987 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:26:01.994 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:02.014 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.014 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.018 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.019 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:26:02.019 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:26:02.019 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:26:02.019 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:26:02.019 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33695/db10.db/tbl10/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01/modts=__HIVE_DEFAULT_PARTITION__
[DEBUG] 2024-04-23 23:26:02.025 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.025 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:02.025 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:26:02.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:02.028 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1022395398 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:02.040 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.041 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911161987 end=1713911162041 duration=54 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=55 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:26:02.041 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:26:02.041 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:26:02.041 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 add_partition : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:26:02.041 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:26:02.041 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:02.041 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.041 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:02.041 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:26:02.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:02.046 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.046 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.046 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.047 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:26:02.047 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:26:02.047 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:26:02.047 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:26:02.047 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33695/db10.db/tbl10/state=CA/dt=1986-04-28/modts=2020-02-21 08%3A30%3A01
[DEBUG] 2024-04-23 23:26:02.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:02.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:26:02.055 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:02.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:02.060 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.061 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911162041 end=1713911162061 duration=20 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=55 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:26:02.061 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:26:02.061 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:26:02.061 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 add_partition : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:26:02.062 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:26:02.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:02.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:02.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:26:02.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:02.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.067 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:26:02.067 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:26:02.067 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:26:02.067 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:26:02.067 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33695/db10.db/tbl10/state=MN/dt=2018-11-31/modts=2020-02-21 08%3A19%3A01
[DEBUG] 2024-04-23 23:26:02.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:02.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:26:02.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:02.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:02.080 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.081 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911162061 end=1713911162081 duration=20 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=55 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:26:02.081 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:26:02.081 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:26:02.081 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713911162081 end=1713911162081 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=55 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:26:02.081 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:26:02.081 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:26:02.082 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_table : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:26:02.082 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:26:02.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:02.083 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:02.083 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:02.083 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:02.083 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.083 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.333317ms
[DEBUG] 2024-04-23 23:26:02.083 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:02.083 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.083 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:26:02.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.088 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:02.089 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[INFO ] 2024-04-23 23:26:02.090 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:26:02.090 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911162081 end=1713911162090 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=55 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:26:02.090 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=9, comments=HMS client
[DEBUG] 2024-04-23 23:26:02.090 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:26:02.091 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:26:02.091 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 alter_table: hive.db10.tbl10 newtbl=tbl10
[INFO ] 2024-04-23 23:26:02.091 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db10.tbl10 newtbl=tbl10	
[DEBUG] 2024-04-23 23:26:02.091 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:02.092 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:02.092 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:02.092 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:02.092 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.092 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.422023ms
[DEBUG] 2024-04-23 23:26:02.092 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:26:02.092 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:26:02.092 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:26:02.092 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:26:02.093 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:02.093 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:02.094 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:02.094 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:02.094 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.094 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.281123ms
[DEBUG] 2024-04-23 23:26:02.094 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:02.094 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.094 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:26:02.096 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.099 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:02.100 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.101 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:02.101 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.101 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:02.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:02.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.967454ms
[DEBUG] 2024-04-23 23:26:02.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:02.102 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:26:02.103 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:02.106 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.106 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db10
[WARN ] 2024-04-23 23:26:02.106 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:26:02.106 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.106 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:02.107 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:02.107 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:02.107 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:26:02.108 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:02.109 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:26:02.109 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:02.109 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:26:02.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:02.116 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.116 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:02.120 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.121 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713911162091 end=1713911162121 duration=30 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=55 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:26:02.121 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:26:02.121 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:26:02.121 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_partitions : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:26:02.121 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:26:02.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:26:02.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:02.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.125 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.627178ms + 0.005531ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:26:02.128 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.700511ms + 0.070211ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:26:02.130 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.686334ms + 0.223917ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:26:02.132 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.467219ms + 0.169797ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:26:02.134 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.556527ms + 0.121503ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:26:02.136 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.63038ms + 0.114824ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:26:02.137 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.34002ms + 0.110824ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:26:02.138 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.209918ms + 0.108666ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:26:02.140 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.410006ms + 0.200442ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:26:02.142 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.346912ms + 0.109747ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:26:02.142 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:02.142 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.142 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 20.138148ms
[DEBUG] 2024-04-23 23:26:02.142 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:02.142 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.142 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911162121 end=1713911162142 duration=21 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=55 retryCount=0 error=false>
[INFO ] 2024-04-23 23:26:02.143 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:26:02.143 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:33695]
[INFO ] 2024-04-23 23:26:02.144 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:33695)
[INFO ] 2024-04-23 23:26:02.144 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:33695) current connections: 10
[DEBUG] 2024-04-23 23:26:02.144 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:26:02.144 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911162144 end=1713911162144 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=56 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:26:02.145 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:26:02.145 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:26:02.145 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 56: source:127.0.0.1 get_table_metas : tbl=hive.*db10*.*
[INFO ] 2024-04-23 23:26:02.145 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*db10*.*	
[INFO ] 2024-04-23 23:26:02.145 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 56: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:26:02.145 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:26:02.145 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:26:02.145 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:26:02.145 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:26:02.145 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:26:02.145 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695;create=true
[DEBUG] 2024-04-23 23:26:02.145 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:26:02.145 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:26:02.145 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:26:02.145 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:26:02.145 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:26:02.145 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:26:02.145 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695;create=true
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@260277cf, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@260277cf, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@73a42534 created in the thread with id: 440
[DEBUG] 2024-04-23 23:26:02.146 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.147 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.147 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.148 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.148 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.148 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@7e8fb2f3
[DEBUG] 2024-04-23 23:26:02.148 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:26:02.148 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@260277cf from thread id: 440
[DEBUG] 2024-04-23 23:26:02.148 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:02.148 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (database.name.matches(:param2) ) &&  (tableType == :param3 ) params: hive, (?i).*db10.*, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:26:02.153 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:02.153 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.153 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911162145 end=1713911162153 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=56 retryCount=0 error=false>
[INFO ] 2024-04-23 23:26:02.154 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: *db10* tablePattern: * found: 0
[INFO ] 2024-04-23 23:26:02.154 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 9
[DEBUG] 2024-04-23 23:26:02.154 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:26:02.154 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:26:02.154 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:26:02.154 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 56: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:26:02.154 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:26:02.154 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:26:02.154 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@260277cf, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@73a42534 will be shutdown
[DEBUG] 2024-04-23 23:26:02.154 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_partitions : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:26:02.154 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:26:02.154 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 56: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:26:02.154 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:26:02.154 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911162154 end=1713911162154 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=56 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:26:02.154 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:26:02.154 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:02.154 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.154 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:26:02.154 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 56: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:26:02.154 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:26:02.155 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.883082ms + 0.004462ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:26:02.156 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.362011ms + 0.092363ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:26:02.156 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.138907ms + 0.188777ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:26:02.156 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.159765ms + 0.132214ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:26:02.157 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.156665ms + 0.093618ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:26:02.157 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.149636ms + 0.092767ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:26:02.157 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.164631ms + 0.222308ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:26:02.158 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.229469ms + 0.206766ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:26:02.159 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.283145ms + 0.323663ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:26:02.159 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.269092ms + 0.1722ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:26:02.159 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:02.159 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.159 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 5.11631ms
[DEBUG] 2024-04-23 23:26:02.159 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:02.159 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.159 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911162154 end=1713911162159 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=55 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:26:02.160 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:26:02.160 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:26:02.160 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:26:02.160 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:26:02.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:26:02.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:02.162 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:02.162 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.162 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713911162160 end=1713911162162 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=55 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:26:02.162 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:26:02.162 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:26:02.162 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:26:02.162 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:26:02.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:02.164 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:02.165 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.165 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911162162 end=1713911162165 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=55 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:26:02.165 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:26:02.165 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:26:02.165 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_database: db10
[INFO ] 2024-04-23 23:26:02.165 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db10	
[DEBUG] 2024-04-23 23:26:02.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:02.166 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:02.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:02.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:02.166 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.931606ms
[DEBUG] 2024-04-23 23:26:02.166 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911162165 end=1713911162166 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=55 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:26:02.166 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=1, comments=HMS client
[DEBUG] 2024-04-23 23:26:02.166 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:26:02.166 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:26:02.166 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_tables_by_type: db=@hive#db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:26:02.166 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:26:02.166 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:26:02.166 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:26:02.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:02.167 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:02.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:02.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:02.167 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.941764ms
[DEBUG] 2024-04-23 23:26:02.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:02.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:02.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:02.170 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.42335ms
[DEBUG] 2024-04-23 23:26:02.170 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911162166 end=1713911162170 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=55 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:26:02.170 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:26:02.170 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:26:02.170 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:26:02.170 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:26:02.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:02.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:02.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:02.173 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.173 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.368525ms
[DEBUG] 2024-04-23 23:26:02.173 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911162170 end=1713911162173 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=55 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:26:02.173 [main] HiveMetaStoreClient - Selecting dropDatabase method for db10 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:26:02.173 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:26:02.173 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:26:02.173 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:26:02.173 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:02.174 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:02.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:02.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:02.174 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.947617ms
[DEBUG] 2024-04-23 23:26:02.174 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_multi_table : db=db10 tbls=tbl10
[INFO ] 2024-04-23 23:26:02.174 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db10 tbls=tbl10	
[DEBUG] 2024-04-23 23:26:02.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:02.177 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.178 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:02.178 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:02.178 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.178 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.946155ms
[DEBUG] 2024-04-23 23:26:02.178 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:02.178 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.179 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911162173 end=1713911162179 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=55 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:26:02.179 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:26:02.179 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:26:02.179 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:26:02.179 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:26:02.179 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:02.179 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.180 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:02.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:02.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.29973ms
[DEBUG] 2024-04-23 23:26:02.181 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:26:02.181 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:26:02.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:02.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.749249ms
[DEBUG] 2024-04-23 23:26:02.181 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:26:02.181 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:26:02.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.191 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1022395398 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.194 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:26:02.194 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:26:02.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.200 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1022395398 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.203 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.203 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:26:02.203 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:26:02.203 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.236 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:26:02.238 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:26:02.238 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:26:02.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7c2a8072, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@340450df will be shutdown
[DEBUG] 2024-04-23 23:26:02.238 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:26:02.238 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:26:02.241 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1022395398 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.244 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:26:02.244 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:26:02.244 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:26:02.244 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:26:02.244 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:26:02.244 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:26:02.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.245 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:02.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:02.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.91217ms
[DEBUG] 2024-04-23 23:26:02.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:02.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.485962ms
[DEBUG] 2024-04-23 23:26:02.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.246 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:02.246 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:02.247 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:02.247 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:02.247 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.797656ms
[DEBUG] 2024-04-23 23:26:02.247 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:26:02.247 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:26:02.247 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:02.247 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:02.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:02.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:26:02.262 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1022395398 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:26:02.269 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:02.269 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:26:02.269 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.269 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:02.271 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:02.273 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:02.274 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:02.276 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:02.277 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:02.279 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:26:02.279 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:02.280 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:02.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:26:02.280 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:26:02.479 [HikariPool-9 housekeeper] HikariPool - HikariPool-9 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:26:04.162 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:26:04.281 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:26:04.281 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:26:04.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:04.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:04.284 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:04.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:04.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:04.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.775609ms
[DEBUG] 2024-04-23 23:26:04.285 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:26:04.285 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:26:04.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:04.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:04.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:04.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.490804ms
[DEBUG] 2024-04-23 23:26:04.286 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:26:04.286 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:26:04.286 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:04.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:04.287 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:26:04.287 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:26:04.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:04.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:04.287 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:26:04.288 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:26:04.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:04.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:04.288 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:26:04.288 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:26:04.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:04.289 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:04.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:04.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:04.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.762357ms
[DEBUG] 2024-04-23 23:26:04.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:04.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:04.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:04.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.438002ms
[DEBUG] 2024-04-23 23:26:04.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:04.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:04.291 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:04.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:04.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:04.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.932987ms
[DEBUG] 2024-04-23 23:26:04.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:26:04.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:26:04.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:04.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:04.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:04.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:26:04.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:26:04.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:04.293 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:26:04.293 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:04.293 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:04.293 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:04.293 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:04.293 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:04.293 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:04.293 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:04.294 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:26:04.294 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:04.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:04.294 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:04.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:26:04.295 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:26:06.295 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:26:06.296 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:26:06.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:06.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:06.298 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:06.299 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:06.299 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:06.299 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.236284ms
[DEBUG] 2024-04-23 23:26:06.299 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:26:06.299 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:26:06.299 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:06.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:06.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:06.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.887996ms
[DEBUG] 2024-04-23 23:26:06.300 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:26:06.300 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:26:06.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:06.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:06.302 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:26:06.302 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:26:06.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:06.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:06.302 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:26:06.302 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:26:06.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:06.303 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:06.303 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:26:06.303 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:26:06.303 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:06.304 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:06.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:06.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:06.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.887592ms
[DEBUG] 2024-04-23 23:26:06.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:06.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:06.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:06.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.493928ms
[DEBUG] 2024-04-23 23:26:06.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:06.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:06.306 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:06.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:06.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:06.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.79667ms
[DEBUG] 2024-04-23 23:26:06.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:26:06.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:26:06.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:06.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:06.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:06.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:26:06.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:26:06.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:06.308 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:26:06.308 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:06.308 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:06.309 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:06.309 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:06.309 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:06.309 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:06.309 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:06.309 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:26:06.309 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:06.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:06.310 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:06.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:26:06.310 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:26:08.311 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:26:08.311 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:26:08.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:08.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:08.314 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:08.315 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:08.315 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:08.315 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.565836ms
[DEBUG] 2024-04-23 23:26:08.315 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:26:08.315 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:26:08.315 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:08.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:08.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:08.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.333849ms
[DEBUG] 2024-04-23 23:26:08.316 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:26:08.316 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:26:08.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:08.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:08.318 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:26:08.318 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:26:08.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:08.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:08.318 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:26:08.318 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:26:08.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:08.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:08.319 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:26:08.319 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:26:08.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:08.320 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:08.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:08.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:08.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.821235ms
[DEBUG] 2024-04-23 23:26:08.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:08.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:08.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:08.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.485953ms
[DEBUG] 2024-04-23 23:26:08.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:08.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:08.322 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:08.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:08.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:08.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.778658ms
[DEBUG] 2024-04-23 23:26:08.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:26:08.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:26:08.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:08.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:08.323 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:08.323 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:26:08.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:26:08.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:08.324 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:26:08.324 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:08.324 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:08.324 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:08.324 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:08.324 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:08.324 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:08.325 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:08.325 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:26:08.325 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:08.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:08.325 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:08.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:26:08.326 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:26:09.082 [HikariPool-12 housekeeper] HikariPool - HikariPool-12 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:26:10.327 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:26:10.327 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:26:10.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:10.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:10.329 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:10.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:10.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:10.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.437372ms
[DEBUG] 2024-04-23 23:26:10.330 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:26:10.331 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:26:10.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:10.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:10.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:10.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.934667ms
[DEBUG] 2024-04-23 23:26:10.332 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:26:10.332 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:26:10.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:10.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:10.333 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:26:10.333 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:26:10.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:10.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:10.334 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:26:10.334 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:26:10.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:10.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:10.334 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:26:10.334 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:26:10.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:10.335 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:10.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:10.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:10.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.807731ms
[DEBUG] 2024-04-23 23:26:10.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:10.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:10.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:10.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.435968ms
[DEBUG] 2024-04-23 23:26:10.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:10.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:10.337 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:10.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:10.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:10.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.733916ms
[DEBUG] 2024-04-23 23:26:10.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:26:10.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:26:10.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:10.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:10.338 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:10.338 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:26:10.338 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:26:10.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:10.339 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:26:10.339 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:10.339 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:10.339 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:10.339 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:10.339 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:10.339 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:10.339 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:10.339 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:26:10.339 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:10.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:10.340 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:10.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:26:10.340 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:26:10.469 [HikariPool-8 housekeeper] HikariPool - HikariPool-8 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:26:12.341 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:26:12.341 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:26:12.342 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:12.342 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:12.344 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:12.345 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:12.345 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:12.345 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.187133ms
[DEBUG] 2024-04-23 23:26:12.345 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:26:12.345 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:26:12.345 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:12.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:12.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:12.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.161969ms
[DEBUG] 2024-04-23 23:26:12.346 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:26:12.346 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:26:12.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:12.347 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:12.347 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:26:12.348 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:26:12.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:12.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:12.348 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:26:12.348 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:26:12.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:12.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:12.349 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:26:12.349 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:26:12.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:12.350 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:12.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:12.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:12.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.747479ms
[DEBUG] 2024-04-23 23:26:12.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:12.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:12.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:12.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.437545ms
[DEBUG] 2024-04-23 23:26:12.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:12.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:12.351 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:12.352 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:12.352 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:12.352 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.707107ms
[DEBUG] 2024-04-23 23:26:12.352 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:26:12.352 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:26:12.352 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:12.352 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:12.352 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:12.352 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:26:12.353 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:26:12.353 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:12.353 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:26:12.353 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:12.353 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:12.353 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:12.354 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:12.354 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:12.354 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:12.354 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:12.354 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:26:12.354 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:12.354 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:12.354 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:12.354 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:26:12.355 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:26:14.355 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:26:14.355 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:26:14.355 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:14.355 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:14.357 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:14.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:14.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:14.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 2.043786ms
[DEBUG] 2024-04-23 23:26:14.357 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:26:14.357 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:26:14.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:14.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:14.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:14.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.632299ms
[DEBUG] 2024-04-23 23:26:14.358 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:26:14.358 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:26:14.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:14.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:14.360 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:26:14.360 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:26:14.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:14.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:14.360 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:26:14.360 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:26:14.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:14.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:14.361 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:26:14.361 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:26:14.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:14.362 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:14.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:14.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:14.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.806112ms
[DEBUG] 2024-04-23 23:26:14.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:14.363 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:14.363 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:14.363 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.563613ms
[DEBUG] 2024-04-23 23:26:14.363 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:14.363 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:14.364 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:14.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:14.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:14.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.82017ms
[DEBUG] 2024-04-23 23:26:14.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:26:14.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:26:14.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:14.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:14.365 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:14.365 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:26:14.366 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:26:14.366 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:14.366 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:26:14.366 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:14.366 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:14.366 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:14.366 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:14.366 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:14.367 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:14.367 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:14.367 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:26:14.367 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:14.367 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:14.368 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:14.368 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:26:14.368 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:26:16.369 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:26:16.369 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:26:16.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:16.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:16.372 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:16.372 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:16.372 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:16.372 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.49683ms
[DEBUG] 2024-04-23 23:26:16.373 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:26:16.373 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:26:16.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:16.374 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:16.374 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:16.374 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.327912ms
[DEBUG] 2024-04-23 23:26:16.374 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:26:16.374 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:26:16.374 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:16.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:16.375 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:26:16.375 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:26:16.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:16.376 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:16.376 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:26:16.376 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:26:16.376 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:16.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:16.377 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:26:16.377 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:26:16.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:16.377 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:16.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:16.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:16.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.751741ms
[DEBUG] 2024-04-23 23:26:16.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:16.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:16.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:16.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.436183ms
[DEBUG] 2024-04-23 23:26:16.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:16.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:16.379 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:16.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:16.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:16.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.705982ms
[DEBUG] 2024-04-23 23:26:16.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:26:16.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:26:16.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:16.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:16.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:16.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:26:16.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:26:16.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:16.381 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:26:16.381 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:16.381 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:16.381 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:16.381 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:16.382 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:16.382 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:16.382 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:16.382 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:26:16.382 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:16.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:16.383 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:16.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:26:16.383 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:26:17.021 [HikariPool-11 housekeeper] HikariPool - HikariPool-11 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:26:18.384 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:26:18.384 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:26:18.384 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:18.384 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:18.386 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:18.386 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:18.386 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:18.386 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 2.48154ms
[DEBUG] 2024-04-23 23:26:18.386 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:26:18.386 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:26:18.386 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:18.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:18.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:18.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.534059ms
[DEBUG] 2024-04-23 23:26:18.387 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:26:18.387 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:26:18.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:18.388 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:18.388 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:26:18.388 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:26:18.388 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:18.389 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:18.389 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:26:18.389 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:26:18.389 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:18.389 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:18.390 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:26:18.390 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:26:18.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:18.390 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:18.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:18.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:18.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.774784ms
[DEBUG] 2024-04-23 23:26:18.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:18.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:18.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:18.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.488232ms
[DEBUG] 2024-04-23 23:26:18.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:18.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:18.392 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:18.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:18.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:18.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.711048ms
[DEBUG] 2024-04-23 23:26:18.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:26:18.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:26:18.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:18.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:18.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:18.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:26:18.394 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:26:18.394 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:18.394 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:26:18.394 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:18.394 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:18.394 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:18.394 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:18.394 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:18.395 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:18.395 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:18.395 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:26:18.395 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:18.395 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:18.396 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:18.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:26:18.396 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:26:18.399 [HikariPool-7 housekeeper] HikariPool - HikariPool-7 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:26:19.839 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:26:20.397 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:26:20.397 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:26:20.397 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:20.397 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:20.399 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:20.399 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:20.399 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:20.399 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 2.455497ms
[DEBUG] 2024-04-23 23:26:20.399 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:26:20.399 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:26:20.399 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:20.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:20.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:20.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.483564ms
[DEBUG] 2024-04-23 23:26:20.400 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:26:20.400 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:26:20.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:20.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:20.401 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:26:20.401 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:26:20.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:20.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:20.402 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:26:20.402 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:26:20.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:20.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:20.403 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:26:20.403 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:26:20.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:20.403 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:20.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:20.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:20.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.809777ms
[DEBUG] 2024-04-23 23:26:20.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:20.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:20.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:20.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.526211ms
[DEBUG] 2024-04-23 23:26:20.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:20.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:20.405 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:20.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:20.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:20.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.779611ms
[DEBUG] 2024-04-23 23:26:20.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:26:20.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:26:20.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:20.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:20.407 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:20.407 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:26:20.407 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:26:20.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:20.408 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:26:20.408 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:20.408 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:20.408 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:20.408 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:20.408 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:20.408 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:20.408 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:20.408 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:26:20.408 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:20.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:20.409 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:20.409 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:26:20.410 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:26:22.410 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:26:22.411 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:26:22.411 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:26:22.411 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:22.413 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:22.414 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:22.414 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:22.414 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.431055ms
[DEBUG] 2024-04-23 23:26:22.414 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:26:22.414 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:26:22.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:22.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:22.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:22.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.913484ms
[DEBUG] 2024-04-23 23:26:22.416 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:26:22.416 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:26:22.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:22.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:22.417 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:26:22.417 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:26:22.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:22.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:22.417 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:26:22.417 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:26:22.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:22.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:22.418 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 55: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:26:22.418 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:26:22.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:22.419 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:22.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:22.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:22.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.800251ms
[DEBUG] 2024-04-23 23:26:22.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:22.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:22.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:22.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.436054ms
[DEBUG] 2024-04-23 23:26:22.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:22.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:22.421 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:26:22.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:26:22.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:22.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.734645ms
[DEBUG] 2024-04-23 23:26:22.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:26:22.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:26:22.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:26:22.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:26:22.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:26:22.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:26:22.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:26:22.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:26:22.423 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:26:22.423 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:22.423 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:22.423 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:22.423 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:22.423 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:22.423 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:22.423 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:26:22.423 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:26:22.423 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@787401505 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35203), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:22.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:26:22.424 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1845498951 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33695), (DRDAID = null) 
[DEBUG] 2024-04-23 23:26:22.424 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:26:22.424 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor67.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy34.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:26:22.424 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911162179 end=1713911182424 duration=20245 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=55 retryCount=-1 error=true>
]]></system-out>
  </testcase>
  <testcase name="testPartitionExprFilter" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="21.957">
    <error message="javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore&#10;NestedThrowables:&#10;java.sql.BatchUpdateException: DELETE on table &apos;DBS&apos; caused a violation of foreign key constraint &apos;TBLS_FK1&apos; for key (2).  The statement has been rolled back." type="org.apache.hadoop.hive.metastore.api.MetaException"><![CDATA[org.apache.hadoop.hive.metastore.api.MetaException: 
javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
NestedThrowables:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.tearDown(TestPartitionManagement.java:100)
]]></error>
  </testcase>
</testsuite>